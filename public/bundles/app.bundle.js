webpackJsonp([0],[
/* 0 */,
/* 1 */,
/* 2 */,
/* 3 */,
/* 4 */,
/* 5 */,
/* 6 */,
/* 7 */,
/* 8 */,
/* 9 */,
/* 10 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;(function(root, factory) {
    /* istanbul ignore next */
    if (true) {
        // AMD. Register as an anonymous module.
        !(__WEBPACK_AMD_DEFINE_ARRAY__ = [], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),
				__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?
				(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
    } else if (typeof exports === 'object') {
        // Node. Does not work with strict CommonJS, but
        // only CommonJS-like environments that support module.exports,
        // like Node.
        module.exports = factory();
    } else {
        // Browser globals (root is window)
        root.StringMask = factory();
    }
}(this, function() {
    var tokens = {
        '0': {pattern: /\d/, _default: '0'},
        '9': {pattern: /\d/, optional: true},
        '#': {pattern: /\d/, optional: true, recursive: true},
        'A': {pattern: /[a-zA-Z0-9]/},
        'S': {pattern: /[a-zA-Z]/},
        'U': {pattern: /[a-zA-Z]/, transform: function(c) { return c.toLocaleUpperCase(); }},
        'L': {pattern: /[a-zA-Z]/, transform: function(c) { return c.toLocaleLowerCase(); }},
        '$': {escape: true}
    };

    function isEscaped(pattern, pos) {
        var count = 0;
        var i = pos - 1;
        var token = {escape: true};
        while (i >= 0 && token && token.escape) {
            token = tokens[pattern.charAt(i)];
            count += token && token.escape ? 1 : 0;
            i--;
        }
        return count > 0 && count % 2 === 1;
    }

    function calcOptionalNumbersToUse(pattern, value) {
        var numbersInP = pattern.replace(/[^0]/g,'').length;
        var numbersInV = value.replace(/[^\d]/g,'').length;
        return numbersInV - numbersInP;
    }

    function concatChar(text, character, options, token) {
        if (token && typeof token.transform === 'function') {
            character = token.transform(character);
        }
        if (options.reverse) {
            return character + text;
        }
        return text + character;
    }

    function hasMoreTokens(pattern, pos, inc) {
        var pc = pattern.charAt(pos);
        var token = tokens[pc];
        if (pc === '') {
            return false;
        }
        return token && !token.escape ? true : hasMoreTokens(pattern, pos + inc, inc);
    }

    function hasMoreRecursiveTokens(pattern, pos, inc) {
        var pc = pattern.charAt(pos);
        var token = tokens[pc];
        if (pc === '') {
            return false;
        }
        return token && token.recursive ? true : hasMoreRecursiveTokens(pattern, pos + inc, inc);
    }

    function insertChar(text, char, position) {
        var t = text.split('');
        t.splice(position, 0, char);
        return t.join('');
    }

    function StringMask(pattern, opt) {
        this.options = opt || {};
        this.options = {
            reverse: this.options.reverse || false,
            usedefaults: this.options.usedefaults || this.options.reverse
        };
        this.pattern = pattern;
    }

    StringMask.prototype.process = function proccess(value) {
        if (!value) {
            return {result: '', valid: false};
        }
        value = value + '';
        var pattern2 = this.pattern;
        var valid = true;
        var formatted = '';
        var valuePos = this.options.reverse ? value.length - 1 : 0;
        var patternPos = 0;
        var optionalNumbersToUse = calcOptionalNumbersToUse(pattern2, value);
        var escapeNext = false;
        var recursive = [];
        var inRecursiveMode = false;

        var steps = {
            start: this.options.reverse ? pattern2.length - 1 : 0,
            end: this.options.reverse ? -1 : pattern2.length,
            inc: this.options.reverse ? -1 : 1
        };

        function continueCondition(options) {
            if (!inRecursiveMode && !recursive.length && hasMoreTokens(pattern2, patternPos, steps.inc)) {
                // continue in the normal iteration
                return true;
            } else if (!inRecursiveMode && recursive.length &&
                hasMoreRecursiveTokens(pattern2, patternPos, steps.inc)) {
                // continue looking for the recursive tokens
                // Note: all chars in the patterns after the recursive portion will be handled as static string
                return true;
            } else if (!inRecursiveMode) {
                // start to handle the recursive portion of the pattern
                inRecursiveMode = recursive.length > 0;
            }

            if (inRecursiveMode) {
                var pc = recursive.shift();
                recursive.push(pc);
                if (options.reverse && valuePos >= 0) {
                    patternPos++;
                    pattern2 = insertChar(pattern2, pc, patternPos);
                    return true;
                } else if (!options.reverse && valuePos < value.length) {
                    pattern2 = insertChar(pattern2, pc, patternPos);
                    return true;
                }
            }
            return patternPos < pattern2.length && patternPos >= 0;
        }

        /**
         * Iterate over the pattern's chars parsing/matching the input value chars
         * until the end of the pattern. If the pattern ends with recursive chars
         * the iteration will continue until the end of the input value.
         *
         * Note: The iteration must stop if an invalid char is found.
         */
        for (patternPos = steps.start; continueCondition(this.options); patternPos = patternPos + steps.inc) {
            // Value char
            var vc = value.charAt(valuePos);
            // Pattern char to match with the value char
            var pc = pattern2.charAt(patternPos);

            var token = tokens[pc];
            if (recursive.length && token && !token.recursive) {
                // In the recursive portion of the pattern: tokens not recursive must be seen as static chars
                token = null;
            }

            // 1. Handle escape tokens in pattern
            // go to next iteration: if the pattern char is a escape char or was escaped
            if (!inRecursiveMode || vc) {
                if (this.options.reverse && isEscaped(pattern2, patternPos)) {
                    // pattern char is escaped, just add it and move on
                    formatted = concatChar(formatted, pc, this.options, token);
                    // skip escape token
                    patternPos = patternPos + steps.inc;
                    continue;
                } else if (!this.options.reverse && escapeNext) {
                    // pattern char is escaped, just add it and move on
                    formatted = concatChar(formatted, pc, this.options, token);
                    escapeNext = false;
                    continue;
                } else if (!this.options.reverse && token && token.escape) {
                    // mark to escape the next pattern char
                    escapeNext = true;
                    continue;
                }
            }

            // 2. Handle recursive tokens in pattern
            // go to next iteration: if the value str is finished or
            //                       if there is a normal token in the recursive portion of the pattern
            if (!inRecursiveMode && token && token.recursive) {
                // save it to repeat in the end of the pattern and handle the value char now
                recursive.push(pc);
            } else if (inRecursiveMode && !vc) {
                // in recursive mode but value is finished. Add the pattern char if it is not a recursive token
                formatted = concatChar(formatted, pc, this.options, token);
                continue;
            } else if (!inRecursiveMode && recursive.length > 0 && !vc) {
                // recursiveMode not started but already in the recursive portion of the pattern
                continue;
            }

            // 3. Handle the value
            // break iterations: if value is invalid for the given pattern
            if (!token) {
                // add char of the pattern
                formatted = concatChar(formatted, pc, this.options, token);
                if (!inRecursiveMode && recursive.length) {
                    // save it to repeat in the end of the pattern
                    recursive.push(pc);
                }
            } else if (token.optional) {
                // if token is optional, only add the value char if it matchs the token pattern
                //                       if not, move on to the next pattern char
                if (token.pattern.test(vc) && optionalNumbersToUse) {
                    formatted = concatChar(formatted, vc, this.options, token);
                    valuePos = valuePos + steps.inc;
                    optionalNumbersToUse--;
                } else if (recursive.length > 0 && vc) {
                    valid = false;
                    break;
                }
            } else if (token.pattern.test(vc)) {
                // if token isn't optional the value char must match the token pattern
                formatted = concatChar(formatted, vc, this.options, token);
                valuePos = valuePos + steps.inc;
            } else if (!vc && token._default && this.options.usedefaults) {
                // if the token isn't optional and has a default value, use it if the value is finished
                formatted = concatChar(formatted, token._default, this.options, token);
            } else {
                // the string value don't match the given pattern
                valid = false;
                break;
            }
        }

        return {result: formatted, valid: valid};
    };

    StringMask.prototype.apply = function(value) {
        return this.process(value).result;
    };

    StringMask.prototype.validate = function(value) {
        return this.process(value).valid;
    };

    StringMask.process = function(value, pattern, options) {
        return new StringMask(pattern, options).process(value);
    };

    StringMask.apply = function(value, pattern, options) {
        return new StringMask(pattern, options).apply(value);
    };

    StringMask.validate = function(value, pattern, options) {
        return new StringMask(pattern, options).validate(value);
    };

    return StringMask;
}));


/***/ }),
/* 11 */,
/* 12 */,
/* 13 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = toDate;
var MILLISECONDS_IN_HOUR = 3600000;
var MILLISECONDS_IN_MINUTE = 60000;
var DEFAULT_ADDITIONAL_DIGITS = 2;

var patterns = {
  dateTimeDelimeter: /[T ]/,
  plainTime: /:/,

  // year tokens
  YY: /^(\d{2})$/,
  YYY: [/^([+-]\d{2})$/, // 0 additional digits
  /^([+-]\d{3})$/, // 1 additional digit
  /^([+-]\d{4})$/ // 2 additional digits
  ],
  YYYY: /^(\d{4})/,
  YYYYY: [/^([+-]\d{4})/, // 0 additional digits
  /^([+-]\d{5})/, // 1 additional digit
  /^([+-]\d{6})/ // 2 additional digits
  ],

  // date tokens
  MM: /^-(\d{2})$/,
  DDD: /^-?(\d{3})$/,
  MMDD: /^-?(\d{2})-?(\d{2})$/,
  Www: /^-?W(\d{2})$/,
  WwwD: /^-?W(\d{2})-?(\d{1})$/,

  HH: /^(\d{2}([.,]\d*)?)$/,
  HHMM: /^(\d{2}):?(\d{2}([.,]\d*)?)$/,
  HHMMSS: /^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,

  // timezone tokens
  timezone: /([Z+-].*)$/,
  timezoneZ: /^(Z)$/,
  timezoneHH: /^([+-])(\d{2})$/,
  timezoneHHMM: /^([+-])(\d{2}):?(\d{2})$/
};

/**
 * @name toDate
 * @category Common Helpers
 * @summary Convert the given argument to an instance of Date.
 *
 * @description
 * Convert the given argument to an instance of Date.
 *
 * If the argument is an instance of Date, the function returns its clone.
 *
 * If the argument is a number, it is treated as a timestamp.
 *
 * If an argument is a string, the function tries to parse it.
 * Function accepts complete ISO 8601 formats as well as partial implementations.
 * ISO 8601: http://en.wikipedia.org/wiki/ISO_8601
 *
 * If the argument is null, it is treated as an invalid date.
 *
 * If all above fails, the function passes the given argument to Date constructor.
 *
 * **Note**: *all* Date arguments passed to any *date-fns* function is processed by `toDate`.
 * All *date-fns* functions will throw `RangeError` if `options.additionalDigits` is not 0, 1, 2 or undefined.
 *
 * @param {*} argument - the value to convert
 * @param {Options} [options] - the object with options. See [Options]{@link https://date-fns.org/docs/Options}
 * @param {0|1|2} [options.additionalDigits=2] - the additional number of digits in the extended year format
 * @returns {Date} the parsed date in the local time zone
 * @throws {TypeError} 1 argument required
 * @throws {RangeError} `options.additionalDigits` must be 0, 1 or 2
 *
 * @example
 * // Convert string '2014-02-11T11:30:30' to date:
 * var result = toDate('2014-02-11T11:30:30')
 * //=> Tue Feb 11 2014 11:30:30
 *
 * @example
 * // Convert string '+02014101' to date,
 * // if the additional number of digits in the extended year format is 1:
 * var result = toDate('+02014101', {additionalDigits: 1})
 * //=> Fri Apr 11 2014 00:00:00
 */
function toDate(argument, dirtyOptions) {
  if (arguments.length < 1) {
    throw new TypeError('1 argument required, but only ' + arguments.length + ' present');
  }

  if (argument === null) {
    return new Date(NaN);
  }

  var options = dirtyOptions || {};

  var additionalDigits = options.additionalDigits === undefined ? DEFAULT_ADDITIONAL_DIGITS : Number(options.additionalDigits);
  if (additionalDigits !== 2 && additionalDigits !== 1 && additionalDigits !== 0) {
    throw new RangeError('additionalDigits must be 0, 1 or 2');
  }

  // Clone the date
  if (argument instanceof Date) {
    // Prevent the date to lose the milliseconds when passed to new Date() in IE10
    return new Date(argument.getTime());
  } else if (typeof argument !== 'string') {
    return new Date(argument);
  }

  var dateStrings = splitDateString(argument);

  var parseYearResult = parseYear(dateStrings.date, additionalDigits);
  var year = parseYearResult.year;
  var restDateString = parseYearResult.restDateString;

  var date = parseDate(restDateString, year);

  if (date) {
    var timestamp = date.getTime();
    var time = 0;
    var offset;

    if (dateStrings.time) {
      time = parseTime(dateStrings.time);
    }

    if (dateStrings.timezone) {
      offset = parseTimezone(dateStrings.timezone);
    } else {
      // get offset accurate to hour in timezones that change offset
      offset = new Date(timestamp + time).getTimezoneOffset();
      offset = new Date(timestamp + time + offset * MILLISECONDS_IN_MINUTE).getTimezoneOffset();
    }

    return new Date(timestamp + time + offset * MILLISECONDS_IN_MINUTE);
  } else {
    return new Date(argument);
  }
}

function splitDateString(dateString) {
  var dateStrings = {};
  var array = dateString.split(patterns.dateTimeDelimeter);
  var timeString;

  if (patterns.plainTime.test(array[0])) {
    dateStrings.date = null;
    timeString = array[0];
  } else {
    dateStrings.date = array[0];
    timeString = array[1];
  }

  if (timeString) {
    var token = patterns.timezone.exec(timeString);
    if (token) {
      dateStrings.time = timeString.replace(token[1], '');
      dateStrings.timezone = token[1];
    } else {
      dateStrings.time = timeString;
    }
  }

  return dateStrings;
}

function parseYear(dateString, additionalDigits) {
  var patternYYY = patterns.YYY[additionalDigits];
  var patternYYYYY = patterns.YYYYY[additionalDigits];

  var token;

  // YYYY or ±YYYYY
  token = patterns.YYYY.exec(dateString) || patternYYYYY.exec(dateString);
  if (token) {
    var yearString = token[1];
    return {
      year: parseInt(yearString, 10),
      restDateString: dateString.slice(yearString.length)
    };
  }

  // YY or ±YYY
  token = patterns.YY.exec(dateString) || patternYYY.exec(dateString);
  if (token) {
    var centuryString = token[1];
    return {
      year: parseInt(centuryString, 10) * 100,
      restDateString: dateString.slice(centuryString.length)
    };
  }

  // Invalid ISO-formatted year
  return {
    year: null
  };
}

function parseDate(dateString, year) {
  // Invalid ISO-formatted year
  if (year === null) {
    return null;
  }

  var token;
  var date;
  var month;
  var week;

  // YYYY
  if (dateString.length === 0) {
    date = new Date(0);
    date.setUTCFullYear(year);
    return date;
  }

  // YYYY-MM
  token = patterns.MM.exec(dateString);
  if (token) {
    date = new Date(0);
    month = parseInt(token[1], 10) - 1;
    date.setUTCFullYear(year, month);
    return date;
  }

  // YYYY-DDD or YYYYDDD
  token = patterns.DDD.exec(dateString);
  if (token) {
    date = new Date(0);
    var dayOfYear = parseInt(token[1], 10);
    date.setUTCFullYear(year, 0, dayOfYear);
    return date;
  }

  // YYYY-MM-DD or YYYYMMDD
  token = patterns.MMDD.exec(dateString);
  if (token) {
    date = new Date(0);
    month = parseInt(token[1], 10) - 1;
    var day = parseInt(token[2], 10);
    date.setUTCFullYear(year, month, day);
    return date;
  }

  // YYYY-Www or YYYYWww
  token = patterns.Www.exec(dateString);
  if (token) {
    week = parseInt(token[1], 10) - 1;
    return dayOfISOYear(year, week);
  }

  // YYYY-Www-D or YYYYWwwD
  token = patterns.WwwD.exec(dateString);
  if (token) {
    week = parseInt(token[1], 10) - 1;
    var dayOfWeek = parseInt(token[2], 10) - 1;
    return dayOfISOYear(year, week, dayOfWeek);
  }

  // Invalid ISO-formatted date
  return null;
}

function parseTime(timeString) {
  var token;
  var hours;
  var minutes;

  // hh
  token = patterns.HH.exec(timeString);
  if (token) {
    hours = parseFloat(token[1].replace(',', '.'));
    return hours % 24 * MILLISECONDS_IN_HOUR;
  }

  // hh:mm or hhmm
  token = patterns.HHMM.exec(timeString);
  if (token) {
    hours = parseInt(token[1], 10);
    minutes = parseFloat(token[2].replace(',', '.'));
    return hours % 24 * MILLISECONDS_IN_HOUR + minutes * MILLISECONDS_IN_MINUTE;
  }

  // hh:mm:ss or hhmmss
  token = patterns.HHMMSS.exec(timeString);
  if (token) {
    hours = parseInt(token[1], 10);
    minutes = parseInt(token[2], 10);
    var seconds = parseFloat(token[3].replace(',', '.'));
    return hours % 24 * MILLISECONDS_IN_HOUR + minutes * MILLISECONDS_IN_MINUTE + seconds * 1000;
  }

  // Invalid ISO-formatted time
  return null;
}

function parseTimezone(timezoneString) {
  var token;
  var absoluteOffset;

  // Z
  token = patterns.timezoneZ.exec(timezoneString);
  if (token) {
    return 0;
  }

  // ±hh
  token = patterns.timezoneHH.exec(timezoneString);
  if (token) {
    absoluteOffset = parseInt(token[2], 10) * 60;
    return token[1] === '+' ? -absoluteOffset : absoluteOffset;
  }

  // ±hh:mm or ±hhmm
  token = patterns.timezoneHHMM.exec(timezoneString);
  if (token) {
    absoluteOffset = parseInt(token[2], 10) * 60 + parseInt(token[3], 10);
    return token[1] === '+' ? -absoluteOffset : absoluteOffset;
  }

  return 0;
}

function dayOfISOYear(isoYear, week, day) {
  week = week || 0;
  day = day || 0;
  var date = new Date(0);
  date.setUTCFullYear(isoYear, 0, 4);
  var fourthOfJanuaryDay = date.getUTCDay() || 7;
  var diff = week * 7 + day + 1 - fourthOfJanuaryDay;
  date.setUTCDate(date.getUTCDate() + diff);
  return date;
}
module.exports = exports['default'];

/***/ }),
/* 14 */,
/* 15 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


module.exports = function maskFactory(maskDefinition) {
	return function MaskDirective() {
		return {
			restrict: 'A',
			require: 'ngModel',
			link: function(scope, element, attrs, ctrl) {
				ctrl.$formatters.push(function formatter(value) {
					if (ctrl.$isEmpty(value)) {
						return value;
					}

					var cleanValue = maskDefinition.clearValue(value.toString());
					return maskDefinition.format(cleanValue);
				});

				ctrl.$parsers.push(function parser(value) {
					if (ctrl.$isEmpty(value)) {
						return value;
					}

					var cleanValue = maskDefinition.clearValue(value.toString());
					var formattedValue = maskDefinition.format(cleanValue);

					if (ctrl.$viewValue !== formattedValue) {
						ctrl.$setViewValue(formattedValue);
						ctrl.$render();
					}

					if (angular.isUndefined(maskDefinition.getModelValue)) {
						return cleanValue;
					}

					var actualModelType = typeof ctrl.$modelValue;
					return maskDefinition.getModelValue(formattedValue, actualModelType);
				});

				angular.forEach(maskDefinition.validations, function(validatorFn, validationErrorKey) {
					ctrl.$validators[validationErrorKey] = function validator(modelValue, viewValue) {
						return ctrl.$isEmpty(modelValue) || validatorFn(modelValue, viewValue);
					};
				});
			}
		};
	};
};


/***/ }),
/* 16 */,
/* 17 */,
/* 18 */,
/* 19 */,
/* 20 */,
/* 21 */,
/* 22 */,
/* 23 */,
/* 24 */,
/* 25 */,
/* 26 */,
/* 27 */,
/* 28 */,
/* 29 */,
/* 30 */,
/* 31 */,
/* 32 */,
/* 33 */,
/* 34 */,
/* 35 */,
/* 36 */,
/* 37 */,
/* 38 */,
/* 39 */,
/* 40 */,
/* 41 */,
/* 42 */,
/* 43 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = startOfUTCISOWeek;

var _index = __webpack_require__(13);

var _index2 = _interopRequireDefault(_index);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

// This function will be a part of public API when UTC function will be implemented.
// See issue: https://github.com/date-fns/date-fns/issues/376
function startOfUTCISOWeek(dirtyDate, dirtyOptions) {
  var weekStartsOn = 1;

  var date = (0, _index2.default)(dirtyDate, dirtyOptions);
  var day = date.getUTCDay();
  var diff = (day < weekStartsOn ? 7 : 0) + day - weekStartsOn;

  date.setUTCDate(date.getUTCDate() - diff);
  date.setUTCHours(0, 0, 0, 0);
  return date;
}
module.exports = exports['default'];

/***/ }),
/* 44 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/**
 * br-validations
 * A library of validations applicable to several Brazilian data like I.E., CNPJ, CPF and others
 * @version v0.3.0
 * @link http://github.com/the-darc/br-validations
 * @license MIT
 */
(function (root, factory) {
	/* istanbul ignore next */
	if (true) {
		// AMD. Register as an anonymous module.
		!(__WEBPACK_AMD_DEFINE_ARRAY__ = [], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),
				__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?
				(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
	} else if (typeof exports === 'object') {
		// Node. Does not work with strict CommonJS, but
		// only CommonJS-like environments that support module.exports,
		// like Node.
		module.exports = factory();
	} else {
		// Browser globals (root is window)
		root.BrV = factory();
	}
}(this, function () {
var CNPJ = {};

CNPJ.validate = function(c) {
	var b = [6,5,4,3,2,9,8,7,6,5,4,3,2];
	c = c.replace(/[^\d]/g,'');

	var r = /^(0{14}|1{14}|2{14}|3{14}|4{14}|5{14}|6{14}|7{14}|8{14}|9{14})$/;
	if (!c || c.length !== 14 || r.test(c)) {
		return false;
	}
	c = c.split('');

	for (var i = 0, n = 0; i < 12; i++) {
		n += c[i] * b[i+1];
	}
	n = 11 - n%11;
	n = n >= 10 ? 0 : n;
	if (parseInt(c[12]) !== n)  {
		return false;
	}

	for (i = 0, n = 0; i <= 12; i++) {
		n += c[i] * b[i];
	}
	n = 11 - n%11;
	n = n >= 10 ? 0 : n;
	if (parseInt(c[13]) !== n)  {
		return false;
	}
	return true;
};


var CPF = {};

CPF.validate = function(cpf) {
	cpf = cpf.replace(/[^\d]+/g,'');
	var r = /^(0{11}|1{11}|2{11}|3{11}|4{11}|5{11}|6{11}|7{11}|8{11}|9{11})$/;
	if (!cpf || cpf.length !== 11 || r.test(cpf)) {
		return false;
	}
	function validateDigit(digit) {
		var add = 0;
		var init = digit - 9;
		for (var i = 0; i < 9; i ++) {
			add += parseInt(cpf.charAt(i + init)) * (i+1);
		}
		return (add%11)%10 === parseInt(cpf.charAt(digit));
	}
	return validateDigit(9) && validateDigit(10);
};

var IE = function(uf) {
	if (!(this instanceof IE)) {
		return new IE(uf);
	}

	this.rules = IErules[uf] || [];
	this.rule;
	IE.prototype._defineRule = function(value) {
		this.rule = undefined;
		for (var r = 0; r < this.rules.length && this.rule === undefined; r++) {
			var str = value.replace(/[^\d]/g,'');
			var ruleCandidate = this.rules[r];
			if (str.length === ruleCandidate.chars && (!ruleCandidate.match || ruleCandidate.match.test(value))) {
				this.rule = ruleCandidate;
			}
		}
		return !!this.rule;
	};

	IE.prototype.validate = function(value) {
		if (!value || !this._defineRule(value)) {
			return false;
		}
		return this.rule.validate(value);
	};
};

var IErules = {};

var algorithmSteps = {
	handleStr: {
		onlyNumbers: function(str) {
			return str.replace(/[^\d]/g,'').split('');
		},
		mgSpec: function(str) {
			var s = str.replace(/[^\d]/g,'');
			s = s.substr(0,3)+'0'+s.substr(3, s.length);
			return s.split('');
		}
	},
	sum: {
		normalSum: function(handledStr, pesos) {
			var nums = handledStr;
			var sum = 0;
			for (var i = 0; i < pesos.length; i++) {
				sum += parseInt(nums[i]) * pesos[i];
			}
			return sum;
		},
		individualSum: function(handledStr, pesos) {
			var nums = handledStr;
			var sum = 0;
			for (var i = 0; i < pesos.length; i++) {
				var mult = parseInt(nums[i]) * pesos[i];
				sum += mult%10 + parseInt(mult/10);
			}
			return sum;
		},
		apSpec: function(handledStr, pesos) {
			var sum = this.normalSum(handledStr, pesos);
			var ref = handledStr.join('');
			if (ref >= '030000010' && ref <= '030170009') {
				return sum + 5;
			}
			if (ref >= '030170010' && ref <= '030190229') {
				return sum + 9;
			}
			return sum;
		}
	},
	rest: {
		mod11: function(sum) {
			return sum%11;
		},
		mod10: function(sum) {
			return sum%10;
		},
		mod9: function(sum) {
			return sum%9;
		}
	},
	expectedDV: {
		minusRestOf11: function(rest) {
			return rest < 2 ? 0 : 11 - rest;
		},
		minusRestOf11v2: function(rest) {
			return rest < 2 ? 11 - rest - 10 : 11 - rest;
		},
		minusRestOf10: function(rest) {
			return rest < 1 ? 0 : 10 - rest;
		},
		mod10: function(rest) {
			return rest%10;
		},
		goSpec: function(rest, handledStr) {
			var ref = handledStr.join('');
			if (rest === 1) {
				return ref >= '101031050' && ref <= '101199979' ? 1 : 0;
			}
			return rest === 0 ? 0 : 11 - rest;
		},
		apSpec: function(rest, handledStr) {
			var ref = handledStr.join('');
			if (rest === 0) {
				return ref >= '030170010' && ref <= '030190229' ? 1 : 0;
			}
			return rest === 1 ? 0 : 11 - rest;
		},
		voidFn: function(rest) {
			return rest;
		}
	}
};


/**
 * options {
 *     pesos: Array of values used to operate in sum step
 *     dvPos: Position of the DV to validate considering the handledStr
 *     algorithmSteps: The four DV's validation algorithm steps names
 * }
 */
function validateDV(value, options) {
	var steps = options.algorithmSteps;

	// Step 01: Handle String
	var handledStr = algorithmSteps.handleStr[steps[0]](value);

	// Step 02: Sum chars
	var sum = algorithmSteps.sum[steps[1]](handledStr, options.pesos);

	// Step 03: Rest calculation
	var rest = algorithmSteps.rest[steps[2]](sum);

	// Fixed Step: Get current DV
	var currentDV = parseInt(handledStr[options.dvpos]);

	// Step 04: Expected DV calculation
	var expectedDV = algorithmSteps.expectedDV[steps[3]](rest, handledStr);

	// Fixed step: DV verification
	return currentDV === expectedDV;
}

function validateIE(value, rule) {
	for (var i = 0; i < rule.dvs.length; i++) {
		// console.log('>> >> dv'+i);
		if (!validateDV(value, rule.dvs[i])) {
			return false;
		}
	}
	return true;
}

IErules.PE = [{
	//mask: new StringMask('0000000-00'),
	chars: 9,
	dvs: [{
		dvpos: 7,
		pesos: [8,7,6,5,4,3,2],
		algorithmSteps: ['onlyNumbers', 'normalSum', 'mod11', 'minusRestOf11']
	},{
		dvpos: 8,
		pesos: [9,8,7,6,5,4,3,2],
		algorithmSteps: ['onlyNumbers', 'normalSum', 'mod11', 'minusRestOf11']
	}],
	validate: function(value) { return validateIE(value, this); }
},{
	// mask: new StringMask('00.0.000.0000000-0'),
	chars: 14,
	pesos: [[1,2,3,4,5,9,8,7,6,5,4,3,2]],
	dvs: [{
		dvpos: 13,
		pesos: [5,4,3,2,1,9,8,7,6,5,4,3,2],
		algorithmSteps: ['onlyNumbers', 'normalSum', 'mod11', 'minusRestOf11v2']
	}],
	validate: function(value) { return validateIE(value, this); }
}];

IErules.RS = [{
	// mask: new StringMask('000/0000000'),
	chars: 10,
	dvs: [{
		dvpos: 9,
		pesos: [2,9,8,7,6,5,4,3,2],
		algorithmSteps: ['onlyNumbers', 'normalSum', 'mod11', 'minusRestOf11']
	}],
	validate: function(value) { return validateIE(value, this); }
}];

IErules.AC = [{
	// mask: new StringMask('00.000.000/000-00'),
	chars: 13,
	match: /^01/,
	dvs: [{
		dvpos: 11,
		pesos: [4,3,2,9,8,7,6,5,4,3,2],
		algorithmSteps: ['onlyNumbers', 'normalSum', 'mod11', 'minusRestOf11']
	},{
		dvpos: 12,
		pesos: [5,4,3,2,9,8,7,6,5,4,3,2],
		algorithmSteps: ['onlyNumbers', 'normalSum', 'mod11', 'minusRestOf11']
	}],
	validate: function(value) { return validateIE(value, this); }
}];

IErules.MG = [{
	// mask: new StringMask('000.000.000/0000'),
	chars: 13,
	dvs: [{
		dvpos: 12,
		pesos: [1,2,1,2,1,2,1,2,1,2,1,2],
		algorithmSteps: ['mgSpec', 'individualSum', 'mod10', 'minusRestOf10']
	},{
		dvpos: 12,
		pesos: [3,2,11,10,9,8,7,6,5,4,3,2],
		algorithmSteps: ['onlyNumbers', 'normalSum', 'mod11', 'minusRestOf11']
	}],
	validate: function(value) { return validateIE(value, this); }
}];

IErules.SP = [{
	// mask: new StringMask('000.000.000.000'),
	chars: 12,
	match: /^[0-9]/,
	dvs: [{
		dvpos: 8,
		pesos: [1,3,4,5,6,7,8,10],
		algorithmSteps: ['onlyNumbers', 'normalSum', 'mod11', 'mod10']
	},{
		dvpos: 11,
		pesos: [3,2,10,9,8,7,6,5,4,3,2],
		algorithmSteps: ['onlyNumbers', 'normalSum', 'mod11', 'mod10']
	}],
	validate: function(value) { return validateIE(value, this); }
},{
	// mask: new StringMask('P-00000000.0/000')
	chars: 12,
	match: /^P/i,
	dvs: [{
		dvpos: 8,
		pesos: [1,3,4,5,6,7,8,10],
		algorithmSteps: ['onlyNumbers', 'normalSum', 'mod11', 'mod10']
	}],
	validate: function(value) { return validateIE(value, this); }
}];

IErules.DF = [{
	// mask: new StringMask('00000000000-00'),
	chars: 13,
	dvs: [{
		dvpos: 11,
		pesos: [4,3,2,9,8,7,6,5,4,3,2],
		algorithmSteps: ['onlyNumbers', 'normalSum', 'mod11', 'minusRestOf11']
	},{
		dvpos: 12,
		pesos: [5,4,3,2,9,8,7,6,5,4,3,2],
		algorithmSteps: ['onlyNumbers', 'normalSum', 'mod11', 'minusRestOf11']
	}],
	validate: function(value) { return validateIE(value, this); }
}];

IErules.ES = [{
	// mask: new StringMask('000.000.00-0')
	chars: 9,
	dvs: [{
		dvpos: 8,
		pesos: [9,8,7,6,5,4,3,2],
		algorithmSteps: ['onlyNumbers', 'normalSum', 'mod11', 'minusRestOf11']
	}],
	validate: function(value) { return validateIE(value, this); }
}];

IErules.BA = [{
	// mask: new StringMask('000000-00')
	chars: 8,
	match: /^[0123458]/,
	dvs: [{
		dvpos: 7,
		pesos: [7,6,5,4,3,2],
		algorithmSteps: ['onlyNumbers', 'normalSum', 'mod10', 'minusRestOf10']
	},{
		dvpos: 6,
		pesos: [8,7,6,5,4,3,0,2],
		algorithmSteps: ['onlyNumbers', 'normalSum', 'mod10', 'minusRestOf10']
	}],
	validate: function(value) { return validateIE(value, this); }
},{
	chars: 8,
	match: /^[679]/,
	dvs: [{
		dvpos: 7,
		pesos: [7,6,5,4,3,2],
		algorithmSteps: ['onlyNumbers', 'normalSum', 'mod11', 'minusRestOf11']
	},{
		dvpos: 6,
		pesos: [8,7,6,5,4,3,0,2],
		algorithmSteps: ['onlyNumbers', 'normalSum', 'mod11', 'minusRestOf11']
	}],
	validate: function(value) { return validateIE(value, this); }
},{
	// mask: new StringMask('0000000-00')
	chars: 9,
	match: /^[0-9][0123458]/,
	dvs: [{
		dvpos: 8,
		pesos: [8,7,6,5,4,3,2],
		algorithmSteps: ['onlyNumbers', 'normalSum', 'mod10', 'minusRestOf10']
	},{
		dvpos: 7,
		pesos: [9,8,7,6,5,4,3,0,2],
		algorithmSteps: ['onlyNumbers', 'normalSum', 'mod10', 'minusRestOf10']
	}],
	validate: function(value) { return validateIE(value, this); }
},{
	chars: 9,
	match: /^[0-9][679]/,
	dvs: [{
		dvpos: 8,
		pesos: [8,7,6,5,4,3,2],
		algorithmSteps: ['onlyNumbers', 'normalSum', 'mod11', 'minusRestOf11']
	},{
		dvpos: 7,
		pesos: [9,8,7,6,5,4,3,0,2],
		algorithmSteps: ['onlyNumbers', 'normalSum', 'mod11', 'minusRestOf11']
	}],
	validate: function(value) { return validateIE(value, this); }
}];

IErules.AM = [{
	//mask: new StringMask('00.000.000-0')
	chars: 9,
	dvs: [{
		dvpos: 8,
		pesos: [9,8,7,6,5,4,3,2],
		algorithmSteps: ['onlyNumbers', 'normalSum', 'mod11', 'minusRestOf11']
	}],
	validate: function(value) { return validateIE(value, this); }
}];

IErules.RN = [{
	// {mask: new StringMask('00.000.000-0')
	chars: 9,
	match: /^20/,
	dvs: [{
		dvpos: 8,
		pesos: [9,8,7,6,5,4,3,2],
		algorithmSteps: ['onlyNumbers', 'normalSum', 'mod11', 'minusRestOf11']
	}],
	validate: function(value) { return validateIE(value, this); }
},{
	// {mask: new StringMask('00.0.000.000-0'), chars: 10}
	chars: 10,
	match: /^20/,
	dvs: [{
		dvpos: 8,
		pesos: [10,9,8,7,6,5,4,3,2],
		algorithmSteps: ['onlyNumbers', 'normalSum', 'mod11', 'minusRestOf11']
	}],
	validate: function(value) { return validateIE(value, this); }
}];

IErules.RO = [{
	// mask: new StringMask('0000000000000-0')
	chars: 14,
	dvs: [{
		dvpos: 13,
		pesos: [6,5,4,3,2,9,8,7,6,5,4,3,2],
		algorithmSteps: ['onlyNumbers', 'normalSum', 'mod11', 'minusRestOf11v2']
	}],
	validate: function(value) { return validateIE(value, this); }
}];

IErules.PR = [{
	// mask: new StringMask('00000000-00')
	chars: 10,
	dvs: [{
		dvpos: 8,
		pesos: [3,2,7,6,5,4,3,2],
		algorithmSteps: ['onlyNumbers', 'normalSum', 'mod11', 'minusRestOf11']
	},{
		dvpos: 9,
		pesos: [4,3,2,7,6,5,4,3,2],
		algorithmSteps: ['onlyNumbers', 'normalSum', 'mod11', 'minusRestOf11']
	}],
	validate: function(value) { return validateIE(value, this); }
}];

IErules.SC = [{
	// {mask: new StringMask('000.000.000'), uf: 'SANTA CATARINA'}
	chars: 9,
	dvs: [{
		dvpos: 8,
		pesos: [9,8,7,6,5,4,3,2],
		algorithmSteps: ['onlyNumbers', 'normalSum', 'mod11', 'minusRestOf11']
	}],
	validate: function(value) { return validateIE(value, this); }
}];

IErules.RJ = [{
	// {mask: new StringMask('00.000.00-0'), uf: 'RIO DE JANEIRO'}
	chars: 8,
	dvs: [{
		dvpos: 7,
		pesos: [2,7,6,5,4,3,2],
		algorithmSteps: ['onlyNumbers', 'normalSum', 'mod11', 'minusRestOf11']
	}],
	validate: function(value) { return validateIE(value, this); }
}];

IErules.PA = [{
	// {mask: new StringMask('00-000000-0')
	chars: 9,
	match: /^15/,
	dvs: [{
		dvpos: 8,
		pesos: [9,8,7,6,5,4,3,2],
		algorithmSteps: ['onlyNumbers', 'normalSum', 'mod11', 'minusRestOf11']
	}],
	validate: function(value) { return validateIE(value, this); }
}];

IErules.SE = [{
	// {mask: new StringMask('00000000-0')
	chars: 9,
	dvs: [{
		dvpos: 8,
		pesos: [9,8,7,6,5,4,3,2],
		algorithmSteps: ['onlyNumbers', 'normalSum', 'mod11', 'minusRestOf11']
	}],
	validate: function(value) { return validateIE(value, this); }
}];

IErules.PB = [{
	// {mask: new StringMask('00000000-0')
	chars: 9,
	dvs: [{
		dvpos: 8,
		pesos: [9,8,7,6,5,4,3,2],
		algorithmSteps: ['onlyNumbers', 'normalSum', 'mod11', 'minusRestOf11']
	}],
	validate: function(value) { return validateIE(value, this); }
}];

IErules.CE = [{
	// {mask: new StringMask('00000000-0')
	chars: 9,
	dvs: [{
		dvpos: 8,
		pesos: [9,8,7,6,5,4,3,2],
		algorithmSteps: ['onlyNumbers', 'normalSum', 'mod11', 'minusRestOf11']
	}],
	validate: function(value) { return validateIE(value, this); }
}];

IErules.PI = [{
	// {mask: new StringMask('000000000')
	chars: 9,
	dvs: [{
		dvpos: 8,
		pesos: [9,8,7,6,5,4,3,2],
		algorithmSteps: ['onlyNumbers', 'normalSum', 'mod11', 'minusRestOf11']
	}],
	validate: function(value) { return validateIE(value, this); }
}];

IErules.MA = [{
	// {mask: new StringMask('000000000')
	chars: 9,
	match: /^12/,
	dvs: [{
		dvpos: 8,
		pesos: [9,8,7,6,5,4,3,2],
		algorithmSteps: ['onlyNumbers', 'normalSum', 'mod11', 'minusRestOf11']
	}],
	validate: function(value) { return validateIE(value, this); }
}];

IErules.MT = [{
	// {mask: new StringMask('0000000000-0')
	chars: 11,
	dvs: [{
		dvpos: 10,
		pesos: [3,2,9,8,7,6,5,4,3,2],
		algorithmSteps: ['onlyNumbers', 'normalSum', 'mod11', 'minusRestOf11']
	}],
	validate: function(value) { return validateIE(value, this); }
}];

IErules.MS = [{
	// {mask: new StringMask('000000000')
	chars: 9,
	match: /^28/,
	dvs: [{
		dvpos: 8,
		pesos: [9,8,7,6,5,4,3,2],
		algorithmSteps: ['onlyNumbers', 'normalSum', 'mod11', 'minusRestOf11']
	}],
	validate: function(value) { return validateIE(value, this); }
}];

IErules.TO = [{
	// {mask: new StringMask('00000000000'),
	chars: 11,
	match: /^[0-9]{2}((0[123])|(99))/,
	dvs: [{
		dvpos: 10,
		pesos: [9,8,0,0,7,6,5,4,3,2],
		algorithmSteps: ['onlyNumbers', 'normalSum', 'mod11', 'minusRestOf11']
	}],
	validate: function(value) { return validateIE(value, this); }
}];

IErules.AL = [{
	// {mask: new StringMask('000000000')
	chars: 9,
	match: /^24[03578]/,
	dvs: [{
		dvpos: 8,
		pesos: [9,8,7,6,5,4,3,2],
		algorithmSteps: ['onlyNumbers', 'normalSum', 'mod11', 'minusRestOf11']
	}],
	validate: function(value) { return validateIE(value, this); }
}];

IErules.RR = [{
	// {mask: new StringMask('00000000-0')
	chars: 9,
	match: /^24/,
	dvs: [{
		dvpos: 8,
		pesos: [1,2,3,4,5,6,7,8],
		algorithmSteps: ['onlyNumbers', 'normalSum', 'mod9', 'voidFn']
	}],
	validate: function(value) { return validateIE(value, this); }
}];

IErules.GO = [{
	// {mask: new StringMask('00.000.000-0')
	chars: 9,
	match: /^1[015]/,
	dvs: [{
		dvpos: 8,
		pesos: [9,8,7,6,5,4,3,2],
		algorithmSteps: ['onlyNumbers', 'normalSum', 'mod11', 'goSpec']
	}],
	validate: function(value) { return validateIE(value, this); }
}];

IErules.AP = [{
	// {mask: new StringMask('000000000')
	chars: 9,
	match: /^03/,
	dvs: [{
		dvpos: 8,
		pesos: [9,8,7,6,5,4,3,2],
		algorithmSteps: ['onlyNumbers', 'apSpec', 'mod11', 'apSpec']
	}],
	validate: function(value) { return validateIE(value, this); }
}];


var PIS = {};

PIS.validate = function(pis) {
	pis = pis.replace(/[^\d]+/g,'');
	var r = /^(0{11}|1{11}|2{11}|3{11}|4{11}|5{11}|6{11}|7{11}|8{11}|9{11})$/;

	if (!pis || pis.length !== 11 || r.test(pis)) {
		return false;
	}

	var pisi = pis.substring(0,10);
	var pisd = pis.substring(10);

	function calculateDigit(pis){
        var p = [3,2,9,8,7,6,5,4,3,2];
        var s = 0;
        for(var i = 0; i <= 9; i++){
            s += parseInt(pis.charAt(i)) * p[i];
        }
        var r = 11 - (s%11);
        return (r === 10 || r === 11) ? 0 : r;
	}

	return Number(pisd) === calculateDigit(pisi);
};

	return {
		ie: IE,
		cpf: CPF,
		cnpj: CNPJ,
		pis: PIS
	};
}));

/***/ }),
/* 45 */,
/* 46 */,
/* 47 */,
/* 48 */,
/* 49 */,
/* 50 */,
/* 51 */,
/* 52 */,
/* 53 */,
/* 54 */,
/* 55 */,
/* 56 */,
/* 57 */,
/* 58 */,
/* 59 */,
/* 60 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = startOfUTCISOWeekYear;

var _index = __webpack_require__(90);

var _index2 = _interopRequireDefault(_index);

var _index3 = __webpack_require__(43);

var _index4 = _interopRequireDefault(_index3);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

// This function will be a part of public API when UTC function will be implemented.
// See issue: https://github.com/date-fns/date-fns/issues/376
function startOfUTCISOWeekYear(dirtyDate, dirtyOptions) {
  var year = (0, _index2.default)(dirtyDate, dirtyOptions);
  var fourthOfJanuary = new Date(0);
  fourthOfJanuary.setUTCFullYear(year, 0, 4);
  fourthOfJanuary.setUTCHours(0, 0, 0, 0);
  var date = (0, _index4.default)(fourthOfJanuary, dirtyOptions);
  return date;
}
module.exports = exports['default'];

/***/ }),
/* 61 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


module.exports = {
	maxNumber: function(ctrl, value, limit) {
		var max = parseFloat(limit, 10);
		return ctrl.$isEmpty(value) || isNaN(max) || value <= max;
	},
	minNumber: function(ctrl, value, limit) {
		var min = parseFloat(limit, 10);
		return ctrl.$isEmpty(value) || isNaN(min) || value >= min;
	}
};


/***/ }),
/* 62 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


function clearDelimitersAndLeadingZeros(value) {
	if (value === '0') {
		return '0';
	}

	var cleanValue = value.toString().replace(/^-/,'').replace(/^0*/, '');
	return cleanValue.replace(/[^0-9]/g, '');
}

function prepareNumberToFormatter(value, decimals) {
	return clearDelimitersAndLeadingZeros((parseFloat(value)).toFixed(decimals));
}

module.exports = {
	clearDelimitersAndLeadingZeros: clearDelimitersAndLeadingZeros,
	prepareNumberToFormatter: prepareNumberToFormatter
};


/***/ }),
/* 63 */
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function($) {


//angular
//    .module('AOTC')
//    .component('comparableComponent', _comparableComponent
//   )


//.directive("fileinput", [
//    _fileinput])
//    .directive("ngImageSelect", [_ngImageSelect
//      ]);

var _comparableComponent = {
    templateUrl: 'modules/ComparableModule/SalesComparable/comparableComponent/comparable.component.html',
    controllerAs: 'comparableComponent',
    controller: ["ComparablePropService", "User_Config", "$timeout", "$scope", "$state", "AOTCService", "Upload", "ComparableSelectionService",
        function (ComparablePropService, User_Config, $timeout, $scope, $state, AOTCService, Upload, ComparableSelectionService) {



            ////console.log('comparable----checin')
            ////console.log("comparableComponent controller");
            var vm = this;
            $("#preloader").css("display", "block");

            var propertyDetails = JSON.parse(localStorage.getItem('propertyDetails'));
            vm.zillowData = [];
            vm.imageArr = [];
            vm.flipBack = flipBack;
            vm.flipFront = flipFront;

            var userRole = localStorage.getItem('role');

            // set property Images crawling from Zillow and get from db if exists

            function initializeCards() {
                ////console.log($scope.savedComaprables.length)

                $timeout(function () {
                    for (var i = 0; i < $scope.savedComaprables.length; i++) {
                        var id = '#card_' + i;
                        $(id).flip({
                            trigger: 'manual'
                        });
                    }
                }, 100);
            }


            $('#mydiv').hide();


            function imagePreLoader() {

            }

            function flipBack(id) {
                $(id).flip(false);
            }

            function flipFront(id) {
                $(id).flip(true);
            }

            // Sort already selected comps to top
            var vm = this;
            // $('#successModal').modal('close');
            $('#preloader').css('display', 'none');
            vm.submitManualData = submitManualData;
            vm.property = JSON.parse(localStorage.getItem('propertyDetails'));
            ////console.log("vm.property in manualIE: ", vm.property)

            vm.formData = {

            };
            vm.PrinciplePropData = JSON.parse(localStorage.getItem('principalForm'));
            ////console.log("key" + vm.PrinciplePropData);

            vm.modalYesbutton = modalYesbutton;
            vm.gotoPropertyDetails = gotoPropertyDetails;
            vm.resetForm = resetForm;

            function resetForm() {
                vm.formData = {};
                $scope.manualForm.$setPristine();
                $scope.manualForm.$setUntouched();
                $scope.picFile = null;
                $scope.isSubmitting = false;
            }

            function gotoPropertyDetails() {
                $('#successModal').modal('hide');
                $state.go('updateIERR');
            }

            function modalYesbutton() {
                ////console.log('reset form');
                vm.formData = {};

                $scope.manualForm.$setPristine();
                $scope.manualForm.$setUntouched();

                $('#successModal').modal('toggle');

            }


            function submitManualData() {

                $("#preloader").css("display", "block");
                ////console.log('appeal')

                vm.formData.compScore = vm.formData.compScore;
                vm.formData.taxAssessment = vm.formData.taxAssessment.toString();
                vm.formData.percentile = vm.formData.percentileValue.toString();
                vm.formData.rentLastUpdate = vm.formData.rentLastUpdate.toString();
                vm.formData.rentValueChangeDuration = vm.formData.rentValueChangeDuration.toString();
                vm.formData.taxAssessmentYear = vm.formData.taxAssessmentYear.toString();
                vm.formData.rentValueChange = vm.formData.rentValueChange.toString();
                vm.formData.finishedSqFt = vm.formData.finishedSqFt.toString();
                vm.formData.lastUpdate = vm.formData.lastUpdate.toString();
                vm.formData.amount = vm.PrinciplePropData.zEstimate.toString();
                vm.formData.valueChange = vm.PrinciplePropData.valueChange.toString();
                vm.formData.valueChangeDuration = vm.PrinciplePropData.valueChangeDuration.toString();
                vm.formData.valuationRangeHigh = vm.PrinciplePropData.valuationRangeHigh.toString();
                vm.formData.valuationRangeLow = vm.PrinciplePropData.valuationRangeLow.toString();
                vm.formData.lotSizeSqFt = vm.PrinciplePropData.lotSizeSf.toString();
                vm.formData.lastSoldDate = vm.PrinciplePropData.lastSoldDate.toString();
                vm.formData.lastSoldPrice = vm.PrinciplePropData.lastSoldPrice.toString();
                vm.formData.yearBuilt = vm.PrinciplePropData.yearBuilt.toString();
                vm.formData.imageFileName = $scope.imagePath;
                vm.PrinciplePropData.valueChangeDuration = vm.formData.valueChangeDuration;
                vm.PrinciplePropData.rentValueChangeDuration = vm.formData.rentValueChangeDuration;
                vm.PrinciplePropData.valueChangeDuration = vm.formData.valueChangeDuration;


                $scope.savedComaprables.push(vm.formData)
                initializeCards();
                var data = {};
                data.principal = [];
                data.comps = [];
                data.principal.push(vm.PrinciplePropData);
                data.comps = ($scope.savedComaprables);
                data.propId = localStorage.getItem("propertyId");
                ////console.log(data);
                var url = 'salesComps/addCompsToPropManual';
                AOTCService.postDataToServer(url, data)
                    .then(function (result) {
                        ////console.log("CompForm: ", result);
                        if (result.data.success) {
                            $scope.$emit('success', result.data.message);
                            $scope.manualForm.$setPristine();
                            $scope.manualForm.$setUntouched();
                            $('#compsForm').modal('hide');
                            resetForm();

                            // $state.go('TaskManager');
                        } else {
                            $scope.$emit('danger', result.data.message);
                        }
                        $("#preloader").css("display", "none");

                    }, function (result) {
                        //////console.log(result);
                        $("#preloader").css("display", "none");
                    });
                //call to server
                //
            }

            // setTimeout(function() {
            //     vm.formData.baseRent = 2017;
            //     $scope.$apply();
            //     $('#successModal').modal('show');

            // }, 100);




            $scope.savedComaprables = [];
            var count = 0;

            $scope.getSavedComparables = function () {
                $("#preloader").css("display", "block");

                ////console.log('I am goingin')

                //getSavedCom parables if exists saved comparable then redirect to comparison
                ComparableSelectionService.getSavedComparables().
                then(function (result) {
                    ////console.log('getSavedComparables : ', result);
                    var serverData = result.data;
                    ////console.log(serverData.res)
                    $("#preloader").css("display", "none");

                    if (serverData.success) {
                        count = 1;

                        $scope.savedComaprables = serverData.result.comparables;

                        $timeout(function () {
                            initializeCards();
                        }, 200);
                    }
                }, function (err) {
                    $("#preloader").css("display", "none");
                    ////console.log('err : ', err);
                })
            }



            ///=================================date picker===========================//


            $('#sandbox-container input').datepicker({
                autoclose: true
            });


            $('#sandbox-container input').on('show', function (e) {
                console.debug('show', e.date, $(this).data('stickyDate'));

                if (e.date) {
                    $(this).data('stickyDate', e.date);
                } else {
                    $(this).data('stickyDate', null);
                }
            });

            $('#sandbox-container input').on('hide', function (e) {
                console.debug('hide', e.date, $(this).data('stickyDate'));
                var stickyDate = $(this).data('stickyDate');

                if (!e.date && stickyDate) {
                    console.debug('restore stickyDate', stickyDate);
                    $(this).datepicker('setDate', stickyDate);
                    $(this).data('stickyDate', null);
                }
            });
            $scope.uploadImage = function (file) {
                ////console.log('submit' + file)

                ////console.log(file)
                if (file) {
                    ////console.log('submit' + file)
                    file.upload = Upload.upload({
                        url: 'salesComps/addCompsImageManual',
                        data: {file: file },
                    });

                    file.upload.then(function (response) {
                        $timeout(function () {
                            file.result = response.data;
                            $scope.isSubmitting = true;
                            $scope.imagePath = file.result;
                            submitManualData();
                            ////console.log(file.result)
                        });
                    }, function (response) {
                        if (response.status > 0)
                            $scope.errorMsg = response.status + ': ' + response.data;
                    }, function (evt) {
                        // Math.min is to fix IE which reports 200% sometimes
                        file.progress = Math.min(100, parseInt(100.0 * evt.loaded / evt.total));
                    });
                }

            }

        }]

};
function _ngImageSelect() {
    return {
        link: function ($scope, el) {
            el.bind("change", function (e) {
                $scope.file = (e.srcElement || e.target).files;
                var ctx = document.getElementById('myCanvas').getContext('2d');
                ctx.clearRect(0, 0, 300, 130);
                var img = new Image();
                img.src = scope.filepreview;
                img.onload = function () {
                    ctx.drawImage(img, 0, 0);

                }

            })
        }
    }
}
function _fileinput() {
    return {
        scope: {
            fileinput: "=",
            filepreview: "=",

        },
        link: function (scope, element, attributes) {
            element.bind("change", function (changeEvent) {
                scope.fileinput = changeEvent.target.files[0];
                scope.filepreview = '';

                var reader = new FileReader();
                reader.onload = function (loadEvent) {
                    scope.$apply(function () {
                        ////console.log(scope.fileinput)


                        scope.filepreview = loadEvent.target.result;
                        var ctx = document.getElementById('myCanvas').getContext('2d');
                        ctx.clearRect(0, 0, 300, 130);
                        var img = new Image();
                        img.src = scope.filepreview;
                        img.onload = function () {
                            ctx.drawImage(img, 0, 0);

                        }


                    });
                }
                reader.readAsDataURL(scope.fileinput);
            });
        }
    }
}

module.exports = { comparableComponent: _comparableComponent, fileinput: _fileinput, ngImageSelect: _ngImageSelect };
/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 64 */,
/* 65 */
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function($) {
var _editArrangeSurveyComponent = {};


//angular
//    .module('AOTC')
//        .directive('myDraggable', _myDraggable
//)
//    .filter('nameFilter',_nameFilter
//)
//    .component('editArrangeSurveyComponent', _editArrangeSurveyComponent);

function _myDraggable() {

    return {
        link: function (scope, el, attrs) {
            el.draggable({
                connectToSortable: attrs.myDraggable,
                helper: "clone",
                revert: "invalid"
            });
            el.disableSelection();
        }
    }

}

function _nameFilter() {

    return function (objects) {
        var filterResult = new Array();
        var count = 0;
        var myArray = [];
        for (var obj in objects) {
            if (objects[obj]) {
                objects[obj].id = count;
                count++;
                myArray.push(objects[obj]);
            }
        }



        return myArray;
    }
}

_editArrangeSurveyComponent = {
    templateUrl: 'modules/SurveyModule/EditSurvey/EditableSurveysMenu/EditArrangeSurvey/EditArrangeSurvey.component.html',
    controllerAs: 'EditArrangeSurveyCtrl',
    controller:
    ["$scope", "sharedService", "ArrangeSurveyService", "CreateSurveyService", "$state", "FillSurveyService", "$stateParams",

        function ($scope, sharedService, ArrangeSurveyService, CreateSurveyService, $state, FillSurveyService, $stateParams) {
            var vm = this;
            console.log($scope.tempSelections)
            $scope.tempSelections = null
            var globalSet = null
            $scope.models = {
                selected: null,
                lists: {},
                restoreList: {}
            };

            $scope.len = 0;
            $scope.example1data = [{}];
            $scope.example1model = [];

            $scope.setSections = { "A": [] }
            $scope.models = {
                selected: null,
                lists: {},
                restoreList: {}
            };

            $scope.models2 = {
                selected: null,
                lists: { "B": [] }
            };


            if (localStorage.getItem("section")) {
                console.log(localStorage.getItem("section"))
                var temp = JSON.parse(localStorage.getItem("section"))
                $scope.models.lists = temp
                $scope.tempSelections = temp
                console.log($scope.models.lists)
                var temp = $scope.models.lists

                for (var data in temp) {

                    for (var i = 0; i < temp[data].length; i++) {
                        for (var j = 0; j < CreateSurveyService.validateQuestions.length; j++) {
                            if (temp[data][i]) {
                                if (temp[data][i].id == CreateSurveyService.validateQuestions[j].id) {
                                    console.log(temp[data][i])
                                    temp[data].splice(i, 1)

                                }
                            }
                        }

                    }
                }
                initModel();


            }
            else {
                checkSelectedQuestions();
            }
            $scope.service = CreateSurveyService.validateQuestions

            function checkSelectedQuestions() {
                $("#preloader").css("display", "block");

                FillSurveyService.getEditSurveyDetails($stateParams.id)
                    .then(function (result) {
                        console.log(result);


                        if (!result.data.success) {
                            $scope.$emit('error', result.data.message);
                            return;
                        }
                        $("#preloader").css("display", "none");
                        console.log(CreateSurveyService.selectQuestions)
                        $scope.tempSelections = result.data.result;
                        $scope.models.lists = $scope.tempSelections


                        globalSet = $scope.models.lists

                        initModel();

                    }, function (result) {
                        $("#preloader").css("display", "none");
                    });


            }
            $scope.enableList = true;
            $scope.user = {
                name: ''
            };
            // $(document).click(function(){
            //     $("#dropOut").hide('slow');
            // });

            $("#dropOut").click(function (e) {
                e.stopPropagation();
            });


            $scope.sectionData = {
                sectionText: ''
            };
            $scope.example14settings = {
                externalIdProp: "",
                closeOnBlur: true
            };
            $scope.killDropDown = function () {
                $(".dropdown ul").remove();

                // $('#dropOut').dropdown("toggle");
                /*
                 $("#dropOut").empty();

                 */
            }
            $scope.name = '';
            $scope.sectionName = [];
            $scope.loadings = false;
            // $scope.addDiv=function(){
            //     $scope.sectionName.push($scope.name);
            //     console.log($scope.sectionName);
            // };


            $scope.enableListFunction = function () {

                if ($scope.enableList == true) {
                    $scope.enableList = false;
                }
                else {
                    $scope.enableList = true;
                }


            }



            $scope.removed = [{}]
            getAllSections();
            function getAllSections() {
                ArrangeSurveyService.getAllSections().
                    then(function (result) {
                        var serverData = result.data;
                        if (serverData.success) {
                            if (serverData) {
                                vm.sections = serverData.result;
                                //startAgain();
                                for (var i = 0; i < vm.sections.length; ++i) {

                                    $scope.example1data[i] = ({ id: vm.sections[i].section, label: vm.sections[i].section, sectionId: vm.sections[i].sectionId })
                                }

                            }

                        }
                    }, function (err) {
                        //some error
                        console.log("Error: ", err);
                        $("#preloader").css("display", "none");
                    })
            }

            if (!CreateSurveyService.editQuestions) {
                if (!CreateSurveyService.editQuestions[0].question) {

                    var i = 0;
                    CreateSurveyService.editQuestions.splice(i, 1);
                }
            }


            $scope.inits = function () {

                if (CreateSurveyService.editQuestions) {

                    vm.data = CreateSurveyService.editQuestions;
                    $scope.models2.lists.B = CreateSurveyService.editQuestions;

                }
                else {

                    $scope.error = 'You have not yet selected any question';

                }
                console.log($scope.service)

            };



            $scope.gotoSectionSettings = function () {

                $state.go('SectionSettings')

            }



            //Library Integartion



            // Generate initial model

            function initModel() {
                var tempSelections = $scope.tempSelections


                if (tempSelections[0]) {
                    for (var item in tempSelections) {



                        $scope.example1model.push({
                            "id": tempSelections[item][tempSelections[item].length - 1].key,
                            "label": tempSelections[item][tempSelections[item].length - 1].key,
                            "sectionId": tempSelections[item][tempSelections[item].length - 1].sectionID
                        })


                    }

                }
                $scope.len = $scope.example1model.length
                console.log($scope.len)
            }

            function startAgain() {

                $('#btnget').click(function () {

                    alert($('#chkveg').val());


                });
            }
            $(function () {
                $(".grid").sortable({
                });
            });

            list = [];




            $scope.onItemSelect = function (data, item) {

                var startCount = 0;

                console.log($scope.len)

                if (data.length < $scope.len) {

                    var checkExist = 0;



                    if (checkExist == 0) {
                        var indexList = 0;

                        for (var listMaker in $scope.models.lists) {
                            var matched = 0;
                            restoreLen = 0;
                            for (var k in $scope.models.restoreList) {
                                var tempArr = $scope.models.lists[listMaker];
                                var tempArr2 = $scope.models.restoreList[k];

                                if (tempArr && tempArr2 && tempArr[tempArr.length - 1].key == tempArr2[tempArr2.length - 1].key) {
                                    matched = 1;
                                    break;
                                }
                                restoreLen++
                            }
                            if (matched == 1) {

                                $scope.models.restoreList[restoreLen] = $scope.models.lists[indexList]
                                indexList++
                                restoreLen++
                            }
                            else {
                                $scope.models.restoreList[restoreLen] = $scope.models.lists[indexList]
                                indexList++
                                restoreLen++
                            }

                        }


                        if ($scope.removed) {
                            var temp = $scope.removed.length;
                        }
                        else {
                            var temp = 0
                        }


                        $scope.removed[temp] = data

                        for (var i = 0; i < $scope.len; i++) {
                            var check = 0;
                            for (var k = 0; k < data.length; k++) {


                                for (var s = 0; s < $scope.models.lists[i].length; s++) {
                                    var extractKey = $scope.models.lists[i][s].key;

                                    if (extractKey) {
                                        break;
                                    }
                                }
                                if (extractKey == data[k].id) {

                                    check = 1;
                                    break;
                                }


                                //  $scope.models.lists[data[i].id.toString()]=[{}]
                                // $scope.len=$scope.models.lists.length

                            }
                            if (data.length == 0) {

                                for (var s = 0; s < $scope.models.lists[i].length; s++) {

                                    var extractKey = $scope.models.lists[i][s].key

                                    if (extractKey) {
                                        break;
                                    }
                                }

                            }
                            if (check == 0) {

                                var found = false;
                                var list = $scope.models.lists;
                                //get the length to properly iterate, requires proper keys e.g. 0,1,2,3
                                var length = +Object.keys(list).sort().reverse()[0] + 1;
                                //iterate over
                                for (var i = 0; i < length - 1; i++) {


                                    for (var s = 0; s < list[i].length; s++) {

                                        var tempArr4 = $scope.models.lists[s];
                                        var extractKey2 = list[i][s].key

                                        if (extractKey2) {

                                            if (extractKey === extractKey2 || found) {
                                                //if found override current with next
                                                found = true;
                                                list[i] = list[i + 1];


                                            }
                                        }


                                    }
                                }
                                //delete last one if weve found sth before, or if the last is the one to be deleted

                                for (var k in list[i]) {
                                    if (list[i][k].key) {
                                        var deleteKey = (list[i][k].key)
                                        break;

                                    }
                                }
                                if (deleteKey === extractKey || found) {


                                    // $scope.models.restoreList=$scope.models.lists[i][s]

                                    delete list[i];
                                }
                                $scope.models.lists = list
                                $scope.len--
                                break;

                            }

                        }
                        if (data.length == 0) {
                            $scope.models.lists = {}
                            $scope.len = 0;

                        }
                    }
                }
                else {
                    checkExist = 0;
                    var run = 0
                    if (run == 0) {
                        for (var k in $scope.models.restoreList) {
                            var tempArr3 = $scope.models.restoreList[k];


                            if (tempArr3 && data[data.length - 1] && tempArr3[tempArr3.length - 1].key == data[data.length - 1].id) {
                                var y = 0;
                                checkExist = 1;
                                var levelFound = 0;

                                for (s in $scope.models.lists) {
                                    var tempArr4 = $scope.models.lists[s];

                                    if (tempArr4[tempArr4.length - 1].key == data[data.length - 1].id) {
                                        levelFound = 1;

                                    }
                                    y++
                                }
                                if (levelFound == 0) {
                                    $scope.models.lists[y] = tempArr3
                                    $scope.len = data.length
                                    checkExist = y++
                                    break;
                                }
                            }
                            run++
                        }
                        var lastindx = 0;
                        var restoreIndex = 0
                        var newIndex = 0;
                        var replacable = $scope.models.restoreList;
                        if (checkExist == 0) {
                            for (var i = 0; i < data.length; i++) {


                                if (!$scope.models.lists[i]) {
                                    $scope.models.lists[i] = [{ "key": data[i].id, "sectionID": data[i].sectionId }]
                                    $scope.len = data.length


                                }

                            }
                        }
                        run++

                    }
                }
                globalSet = $scope.models.lists
                CreateSurveyService.variableSelected = $scope.models.restoreList;
                localStorage.setItem('section', angular.toJson(globalSet))
                ArrangeSurveyService.selectQuestions = $scope.models.lists;

            }
            $scope.dragoverCallback = function (index, external, type, callback) {
                $scope.logListEvent('dragged over', index, external, type);
                // Invoke callback to origin for container types.
                if (type == 'container' && !external) {
                    console.log('Container being dragged contains ' + callback() + ' items');
                }
                return index < 10; // Disallow dropping in the third row.
            };

            $scope.dropCallback = function (index, item, external, type) {
                $scope.logListEvent('dropped at', index, external, type);
                // Return false here to cancel drop. Return true if you insert the item yourself.
                return item;
            };

            $scope.logEvent = function (message) {
                console.log(message);
            };

            $scope.logListEvent = function (action, index, external, type) {
                var message = external ? 'External ' : '';
                message += type + ' element was ' + action + ' position ' + index;
            };

            $scope.save = function () {

            }

            Array.prototype.insert = function (index, item) {
                this.splice(index, 0, item);
            };


            $scope.$on('my-sorted', function (ev, val) {
                console.log(val.from + " " + val.to)
                var temp = [];
                $scope.myObj = $scope.models.lists;
                $scope.model3 = []
                for (var i in $scope.myObj) {
                    if ($scope.myObj.hasOwnProperty(i)) {
                        $scope.model3.push($scope.myObj[i]);
                    }
                }

                temp = $scope.model3.splice(parseInt(val.from), 1);
                $scope.model3.insert(parseInt(val.to), temp[0]);
                for (var i = 0; i < $scope.model3.length; i++) {
                    $scope.myObj[i] = $scope.model3[i];
                }
                // $scope.models.lists.splice(val.to, 0,val.name);

            })

            $scope.$on('my-created', function (ev, val) {


            })


            $scope.addSection = function (data) {
                ArrangeSurveyService.addSection(data).then(function (result) {
                    var serverData = result.data;

                    if (serverData.success) {
                        if (serverData) {
                            getAllSections();

                        }
                    }
                }, function (err) {
                    //some error
                    console.log("Error: ", err);
                    $("#preloader").css("display", "none");
                })

            }


            $(function () {
                $(".sortable_list").sortable({
                    connectWith: ".connectedSortable",

                    drop: function (event, ui) {
                        $(this).droppable('destroy');
                    }

                }).disableSelection();

            });

            $(".sortable_list").sortable({
                cancel: ".fixed"
            });

            // Initialize model



        }],
}

_myDraggable.$inject = [];
_nameFilter.$inject = [];
module.exports = { myDraggable: _myDraggable, nameFilter: _nameFilter, editArrangeSurveyComponent: _editArrangeSurveyComponent };



/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 66 */
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function($) {

//angular
//    .module('AOTC')
//    .filter('nameFilter',_nameFilter )
//    .directive('myDraggable', _myDraggable)
//    .component('arrangeSurveyComponent',_arrangeSurveyComponent);
function _nameFilter() {

    return function (objects) {
        var filterResult = new Array();
        var count = 0;
        var myArray = [];
        for (var obj in objects) {
            objects[obj].id = count;
            count++;
            myArray.push(objects[obj]);
        }



        return myArray;
    }
};
function _myDraggable() {

    return {
        link: function (scope, el, attrs) {
            el.draggable({
                connectToSortable: attrs.myDraggable,
                helper: "clone",
                revert: "invalid"
            });
            el.disableSelection();
        }
    }

};

var _arrangeSurveyComponent = {
    templateUrl: 'modules/SurveyModule/Wizards/ArrangeSurvey/ArrangeSurvey.html',
    controllerAs: 'ArrangeSurveyCtrl',
    controller:
        ["$scope", "sharedService", "ArrangeSurveyService", "CreateSurveyService", "$state",
            function ($scope, sharedService, ArrangeSurveyService, CreateSurveyService, $state) {
                var vm = this;
                $scope.enableList = true;
                $scope.user = {
                    name: ''
                };
                // $(document).click(function(){
                //     $("#dropOut").hide('slow');
                // });

                $("#dropOut").click(function (e) {
                    e.stopPropagation();
                });


                $scope.sectionData = {
                    sectionText: ''
                };
                $scope.example14settings = {
                    externalIdProp: "",
                    closeOnBlur: true
                };
                $scope.killDropDown = function () {
                    console.log('aaaaaaaaaaaa')
                    $(".dropdown ul").remove();

                    // $('#dropOut').dropdown("toggle");
                    /*
                                        $("#dropOut").empty();
                    
                    */
                }
                $scope.name = '';
                $scope.sectionName = [];
                $scope.loadings = false;
                // $scope.addDiv=function(){
                //     $scope.sectionName.push($scope.name);
                //     console.log($scope.sectionName);
                // };


                $scope.enableListFunction = function () {

                    console.log($scope.enableList)
                    if ($scope.enableList == true) {
                        $scope.enableList = false;
                    }
                    else {
                        $scope.enableList = true;
                    }


                }



                $scope.example1model = [];
                $scope.removed = [{}]
                $scope.example1data = [{}];
                getAllSections();
                function getAllSections() {
                    ArrangeSurveyService.getAllSections().
                        then(function (result) {
                            var serverData = result.data;
                            if (serverData.success) {
                                if (serverData) {
                                    vm.sections = serverData.result;
                                    //startAgain();
                                    console.log(vm.sections);
                                    for (var i = 0; i < vm.sections.length; ++i) {

                                        $scope.example1data[i] = ({ id: vm.sections[i].section, label: vm.sections[i].section, sectionId: vm.sections[i].sectionId })
                                    }

                                }

                            }
                        }, function (err) {
                            //some error
                            console.log("Error: ", err);
                            $("#preloader").css("display", "none");
                        })
                }

                if (!CreateSurveyService.questions) {
                    if (!CreateSurveyService.questions[0].question) {

                        var i = 0;
                        CreateSurveyService.questions.splice(i, 1);
                    }
                }


                $scope.init = function () {

                    console.log(CreateSurveyService.questions)

                    if (CreateSurveyService.questions) {

                        vm.data = CreateSurveyService.questions;
                        $scope.models2.lists.B = CreateSurveyService.questions;
                        console.log("question")

                    }
                    else {

                        $scope.error = 'You have not yet selected any question';

                    }

                };



                $scope.gotoSectionSettings = function () {

                    $state.go('SectionSettings')

                }



                //Library Integartion

                $scope.setSections = { "A": [] }
                $scope.models = {
                    selected: null,
                    lists: {},
                    restoreList: {}
                };


                $scope.models2 = {
                    selected: null,
                    lists: { "B": [] }
                };

                // Generate initial model
                $scope.restoreList = {

                }


                function startAgain() {

                    $('#btnget').click(function () {

                        alert($('#chkveg').val());


                    });
                }
                $(function () {
                    $(".grid").sortable({
                    });
                });

                list = [];
                $scope.len = 0;
                var restoreLen = 0;

                ArrangeSurveyService.selectQuestions = $scope.models.lists;


                $scope.onItemSelect = function (data, item) {

                    var startCount = 0;



                    if (data.length < $scope.len) {

                        var checkExist = 0;



                        if (checkExist == 0) {
                            var indexList = 0;

                            for (var listMaker in $scope.models.lists) {
                                var matched = 0;
                                restoreLen = 0;
                                for (var k in $scope.models.restoreList) {
                                    var tempArr = $scope.models.lists[listMaker];
                                    var tempArr2 = $scope.models.restoreList[k];

                                    if (tempArr && tempArr2 && tempArr[tempArr.length - 1].key == tempArr2[tempArr2.length - 1].key) {
                                        matched = 1;
                                        break;
                                    }
                                    restoreLen++
                                }
                                if (matched == 1) {

                                    $scope.models.restoreList[restoreLen] = $scope.models.lists[indexList]
                                    indexList++
                                    restoreLen++
                                }
                                else {
                                    $scope.models.restoreList[restoreLen] = $scope.models.lists[indexList]
                                    indexList++
                                    restoreLen++
                                }

                            }


                            if ($scope.removed) {
                                var temp = $scope.removed.length;
                            }
                            else {
                                var temp = 0
                            }


                            $scope.removed[temp] = data

                            for (var i = 0; i < $scope.len; i++) {
                                var check = 0;
                                for (var k = 0; k < data.length; k++) {


                                    for (var s = 0; s < $scope.models.lists[i].length; s++) {
                                        var extractKey = $scope.models.lists[i][s].key;

                                        if (extractKey) {
                                            break;
                                        }
                                    }
                                    console.log(extractKey + data[k].id)
                                    if (extractKey == data[k].id) {

                                        check = 1;
                                        break;
                                    }


                                    //  $scope.models.lists[data[i].id.toString()]=[{}]
                                    // $scope.len=$scope.models.lists.length

                                }
                                if (data.length == 0) {

                                    for (var s = 0; s < $scope.models.lists[i].length; s++) {

                                        var extractKey = $scope.models.lists[i][s].key

                                        if (extractKey) {
                                            break;
                                        }
                                    }

                                }
                                if (check == 0) {

                                    var found = false;
                                    var list = $scope.models.lists;
                                    //get the length to properly iterate, requires proper keys e.g. 0,1,2,3
                                    var length = +Object.keys(list).sort().reverse()[0] + 1;
                                    //iterate over
                                    for (var i = 0; i < length - 1; i++) {


                                        for (var s = 0; s < list[i].length; s++) {

                                            var tempArr4 = $scope.models.lists[s];
                                            var extractKey2 = list[i][s].key

                                            if (extractKey2) {

                                                if (extractKey === extractKey2 || found) {
                                                    //if found override current with next
                                                    found = true;
                                                    list[i] = list[i + 1];


                                                }
                                            }


                                        }
                                    }
                                    //delete last one if weve found sth before, or if the last is the one to be deleted

                                    for (var k in list[i]) {
                                        if (list[i][k].key) {
                                            var deleteKey = (list[i][k].key)
                                            break;

                                        }
                                    }
                                    console.log(deleteKey + extractKey)
                                    if (deleteKey === extractKey || found) {


                                        // $scope.models.restoreList=$scope.models.lists[i][s]

                                        delete list[i];
                                    }
                                    $scope.models.lists = list
                                    $scope.len--
                                    break;

                                }

                            }
                            if (data.length == 0) {
                                $scope.models.lists = {}
                                $scope.len = 0;

                            }
                        }
                    }
                    else {
                        checkExist = 0;
                        var run = 0
                        if (run == 0) {
                            for (var k in $scope.models.restoreList) {
                                var tempArr3 = $scope.models.restoreList[k];


                                if (tempArr3 && data[data.length - 1] && tempArr3[tempArr3.length - 1].key == data[data.length - 1].id) {
                                    var y = 0;
                                    checkExist = 1;
                                    var levelFound = 0;

                                    for (s in $scope.models.lists) {
                                        var tempArr4 = $scope.models.lists[s];

                                        if (tempArr4[tempArr4.length - 1].key == data[data.length - 1].id) {
                                            levelFound = 1;

                                        }
                                        y++
                                    }
                                    if (levelFound == 0) {
                                        $scope.models.lists[y] = tempArr3
                                        $scope.len = data.length
                                        checkExist = y++
                                        break;
                                    }
                                }
                                run++
                            }
                            var lastindx = 0;
                            var restoreIndex = 0
                            var newIndex = 0;
                            var replacable = $scope.models.restoreList;
                            if (checkExist == 0) {
                                for (var i = 0; i < data.length; i++) {
                                    console.log('in-------')


                                    if (!$scope.models.lists[i]) {
                                        $scope.models.lists[i] = [{ "key": data[i].id, "sectionID": data[i].sectionId }]
                                        $scope.len = data.length


                                    }

                                }
                            }
                            run++

                        }
                    }
                    ArrangeSurveyService.selectQuestions = $scope.models.lists;
                }
                $scope.dragoverCallback = function (index, external, type, callback) {
                    $scope.logListEvent('dragged over', index, external, type);
                    // Invoke callback to origin for container types.
                    if (type == 'container' && !external) {
                        console.log('Container being dragged contains ' + callback() + ' items');
                    }
                    return index < 10; // Disallow dropping in the third row.
                };


                $scope.dropCallback = function (index, item, external, type) {
                    $scope.logListEvent('dropped at', index, external, type);
                    // Return false here to cancel drop. Return true if you insert the item yourself.
                    return item;
                };

                $scope.logEvent = function (message) {
                    console.log(message);
                };

                $scope.logListEvent = function (action, index, external, type) {
                    var message = external ? 'External ' : '';
                    message += type + ' element was ' + action + ' position ' + index;
                };

                $scope.save = function () {

                }

                Array.prototype.insert = function (index, item) {
                    this.splice(index, 0, item);
                };


                $scope.$on('my-sorted', function (ev, val) {
                    console.log(val.from + " " + val.to)
                    var temp = [];
                    $scope.myObj = $scope.models.lists;
                    $scope.model3 = []
                    for (var i in $scope.myObj) {
                        if ($scope.myObj.hasOwnProperty(i)) {
                            $scope.model3.push($scope.myObj[i]);
                        }
                    }

                    temp = $scope.model3.splice(parseInt(val.from), 1);
                    $scope.model3.insert(parseInt(val.to), temp[0]);
                    for (var i = 0; i < $scope.model3.length; i++) {
                        $scope.myObj[i] = $scope.model3[i];
                    }
                    // $scope.models.lists.splice(val.to, 0,val.name);

                })

                $scope.$on('my-created', function (ev, val) {


                })


                $scope.addSection = function (data) {
                    console.log('sss')
                    ArrangeSurveyService.addSection(data).then(function (result) {
                        var serverData = result.data;
                        console.log(serverData)
                        if (serverData.success) {
                            if (serverData) {
                                console.log('sss')
                                getAllSections();

                            }
                        }
                    }, function (err) {
                        //some error
                        console.log("Error: ", err);
                        $("#preloader").css("display", "none");
                    })

                }


                // $(function() {
                //     $( ".sortable_list" ).sortable({
                //         connectWith: ".connectedSortable",
                //
                //         drop: function (event, ui) {
                //             $(this).droppable('destroy');
                //         }
                //
                //     }).disableSelection();
                //
                // });
                //
                // $(".sortable_list").sortable({
                //     cancel: ".fixed"
                // });

                // Initialize model



            }],

};

module.exports = { nameFilter: _nameFilter, myDraggable: _myDraggable, arrangeSurveyComponent: _arrangeSurveyComponent };
/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 67 */,
/* 68 */,
/* 69 */,
/* 70 */,
/* 71 */,
/* 72 */,
/* 73 */,
/* 74 */,
/* 75 */,
/* 76 */,
/* 77 */,
/* 78 */,
/* 79 */,
/* 80 */,
/* 81 */,
/* 82 */,
/* 83 */,
/* 84 */,
/* 85 */,
/* 86 */,
/* 87 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = isValid;

var _index = __webpack_require__(13);

var _index2 = _interopRequireDefault(_index);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

/**
 * @name isValid
 * @category Common Helpers
 * @summary Is the given date valid?
 *
 * @description
 * Returns false if argument is Invalid Date and true otherwise.
 * Argument is converted to Date using `toDate`. See [toDate]{@link https://date-fns.org/docs/toDate}
 * Invalid Date is a Date, whose time value is NaN.
 *
 * Time value of Date: http://es5.github.io/#x15.9.1.1
 *
 * @param {*} date - the date to check
 * @param {Options} [options] - the object with options. See [Options]{@link https://date-fns.org/docs/Options}
 * @param {0|1|2} [options.additionalDigits=2] - passed to `toDate`. See [toDate]{@link https://date-fns.org/docs/toDate}
 * @returns {Boolean} the date is valid
 * @throws {TypeError} 1 argument required
 * @throws {RangeError} `options.additionalDigits` must be 0, 1 or 2
 *
 * @example
 * // For the valid date:
 * var result = isValid(new Date(2014, 1, 31))
 * //=> true
 *
 * @example
 * // For the value, convertable into a date:
 * var result = isValid('2014-02-31')
 * //=> true
 *
 * @example
 * // For the invalid date:
 * var result = isValid(new Date(''))
 * //=> false
 */
function isValid(dirtyDate, dirtyOptions) {
  if (arguments.length < 1) {
    throw new TypeError('1 argument required, but only ' + arguments.length + ' present');
  }

  var date = (0, _index2.default)(dirtyDate, dirtyOptions);
  return !isNaN(date);
}
module.exports = exports['default'];

/***/ }),
/* 88 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});

var _index = __webpack_require__(154);

var _index2 = _interopRequireDefault(_index);

var _index3 = __webpack_require__(155);

var _index4 = _interopRequireDefault(_index3);

var _index5 = __webpack_require__(157);

var _index6 = _interopRequireDefault(_index5);

var _index7 = __webpack_require__(158);

var _index8 = _interopRequireDefault(_index7);

var _index9 = __webpack_require__(161);

var _index10 = _interopRequireDefault(_index9);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

/**
 * @type {Locale}
 * @category Locales
 * @summary English locale (United States).
 * @language English
 * @iso-639-2 eng
 */
var locale = {
  formatDistance: _index2.default,
  formatLong: _index4.default,
  formatRelative: _index6.default,
  localize: _index8.default,
  match: _index10.default,
  options: {
    weekStartsOn: 0 /* Sunday */
    , firstWeekContainsDate: 1
  }
};

exports.default = locale;
module.exports = exports['default'];

/***/ }),
/* 89 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = getUTCISOWeek;

var _index = __webpack_require__(13);

var _index2 = _interopRequireDefault(_index);

var _index3 = __webpack_require__(43);

var _index4 = _interopRequireDefault(_index3);

var _index5 = __webpack_require__(60);

var _index6 = _interopRequireDefault(_index5);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var MILLISECONDS_IN_WEEK = 604800000;

// This function will be a part of public API when UTC function will be implemented.
// See issue: https://github.com/date-fns/date-fns/issues/376
function getUTCISOWeek(dirtyDate, dirtyOptions) {
  var date = (0, _index2.default)(dirtyDate, dirtyOptions);
  var diff = (0, _index4.default)(date, dirtyOptions).getTime() - (0, _index6.default)(date, dirtyOptions).getTime();

  // Round the number of days to the nearest integer
  // because the number of milliseconds in a week is not constant
  // (e.g. it's different in the week of the daylight saving time clock shift)
  return Math.round(diff / MILLISECONDS_IN_WEEK) + 1;
}
module.exports = exports['default'];

/***/ }),
/* 90 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = getUTCISOWeekYear;

var _index = __webpack_require__(13);

var _index2 = _interopRequireDefault(_index);

var _index3 = __webpack_require__(43);

var _index4 = _interopRequireDefault(_index3);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

// This function will be a part of public API when UTC function will be implemented.
// See issue: https://github.com/date-fns/date-fns/issues/376
function getUTCISOWeekYear(dirtyDate, dirtyOptions) {
  var date = (0, _index2.default)(dirtyDate, dirtyOptions);
  var year = date.getUTCFullYear();

  var fourthOfJanuaryOfNextYear = new Date(0);
  fourthOfJanuaryOfNextYear.setUTCFullYear(year + 1, 0, 4);
  fourthOfJanuaryOfNextYear.setUTCHours(0, 0, 0, 0);
  var startOfNextYear = (0, _index4.default)(fourthOfJanuaryOfNextYear, dirtyOptions);

  var fourthOfJanuaryOfThisYear = new Date(0);
  fourthOfJanuaryOfThisYear.setUTCFullYear(year, 0, 4);
  fourthOfJanuaryOfThisYear.setUTCHours(0, 0, 0, 0);
  var startOfThisYear = (0, _index4.default)(fourthOfJanuaryOfThisYear, dirtyOptions);

  if (date.getTime() >= startOfNextYear.getTime()) {
    return year + 1;
  } else if (date.getTime() >= startOfThisYear.getTime()) {
    return year;
  } else {
    return year - 1;
  }
}
module.exports = exports['default'];

/***/ }),
/* 91 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = cloneObject;
function cloneObject(dirtyObject) {
  dirtyObject = dirtyObject || {};
  var object = {};

  for (var property in dirtyObject) {
    if (dirtyObject.hasOwnProperty(property)) {
      object[property] = dirtyObject[property];
    }
  }

  return object;
}
module.exports = exports["default"];

/***/ }),
/* 92 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var StringMask = __webpack_require__(10);

function viewMask(decimals, decimalDelimiter, thousandsDelimiter) {
	var mask = '#' + thousandsDelimiter + '##0';

	if (decimals > 0) {
		mask += decimalDelimiter;
		for (var i = 0; i < decimals; i++) {
			mask += '0';
		}
	}

	return new StringMask(mask, {
		reverse: true
	});
}

function modelMask(decimals) {
	var mask = '###0';

	if (decimals > 0) {
		mask += '.';
		for (var i = 0; i < decimals; i++) {
			mask += '0';
		}
	}

	return new StringMask(mask, {
		reverse: true
	});
}

module.exports = {
	viewMask: viewMask,
	modelMask: modelMask
};


/***/ }),
/* 93 */,
/* 94 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {




//angular.module('AOTC')
//    .component('contractEditor', _contractEditor)
//    .directive('ckEditor', ['$timeout', directiveFunction]);

var _contractEditor = {
    templateUrl: 'modules/ContractModule/components/contract-editor/contract-editor.html',
    controllerAs: 'ContractEditor',
    controller: ["$scope", "$timeout", "$location", "$state", "UtilService", "newContractService", "$stateParams", "$rootScope", controllerFunction]
    //end of component
};

function controllerFunction($scope, $timeout, $location, $state, UtilService, newContractService, $stateParams, $rootScope) {

    $scope.content = '';
    $scope.contractFiles = [];
    $scope.financialAndNonFinancialTerms = [];
    $scope.contractId = $stateParams.id || null;
    $scope.IsViewMode = $stateParams.id ? true : false;

    $scope.saveDatatoService = function (data) {
        newContractService.dataContent = data;
    };

    var articles = [
        { name: 'Test Clause 1', description: '</br><p>00.00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; A standard contract for the construction of a house will contain drawings and specifications as approved by the Board, General Conditions for the execution of the Works which include the house itself and the exterior works such as the septic tank, drainage, water cistern, access roads and landscaping where required.</p>' },
        { name: 'Test Clause 2', description: '<p>&nbsp;</p><p>00.00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The plans drawn are in accordance with the requirements of the Board and the relevant Regulations in all respects, and include adequate information on items such as the structure of the building, electricity, plumbing, septic tank, drainage, water cistern and guttering, access roadways, landscaping and descriptions of the materials to be used.&nbsp;&nbsp;</p>' },
        { name: 'Choice of Law and Forum Clause', description: 'this agreement shall be interpreted under the laws..' }
    ];
    $scope.articles = articles;
    //name: name,
    //content: $scope.content,
    //agenttName: agenttName,
    //status: 'NotStarted'

    $scope.savedContract = newContractService.getContractData($scope.contractId);


    //Assigning Data to scope variables
    try {
        //$scope.contractName = $scope.savedContract.contractName;
        //$scope.agentName = $scope.savedContract.agentName;
        //$scope.content = $scope.savedContract.body;

        if ($scope.contractId) {
            getContractsByUserId();
        }

        function getContractsByUserId() {
            $('#preloader').css('display', 'block');

            newContractService.getContractsByUserId($scope.contractId)
                .then(function (response) {
                    $('#preloader').css('display', 'none');
                    //copy id to contracts objects
                    //gridOptions.rowData = addID(response.result);
                    //newContractService.contractDataByUserId = addID(response.result);
                    //newContractService.contractDataByUserId = response.result.contract.properties;

                    //financialTerms

                    newContractService.contractDataByUserId = response.result;

                    $rootScope.$broadcast('contractDataByUserId-added');

                    var _builder = newContractService.contractDataByUserId.contract.properties;

                    $scope.contractName = _builder.contractName;
                    $scope.agentName = _builder.agentName;
                    $scope.content = _builder.body;
                    //save data to fetch later
                    //newContractService.saveContractData(response.result);
                    //show ag-grid
                }, function (err) {
                    console.log(err);
                });
        };


    }
    catch (_e) { }

    //function addID(_data) {
    //    var _tempArray = [];
    //    angular.forEach(_data, function (_item) {
    //        _item.contracts['id'] = _item.id;
    //        _tempArray.push(_item.contracts);
    //    });
    //    return _tempArray;
    //}

    getContractFiles();

    $scope.$on('updateDocument', function (evt, args) {
        console.log(newContractService.getFinancialAndNonFinancialTerms());
        $scope.financialAndNonFinancialTerms = newContractService.getFinancialAndNonFinancialTerms();
        updateDocument();
    });


    function updateDocument() {
        // $scope.financialAndNonFinancialTerms;
        // $scope.content;
        for (var i = 0; i < $scope.financialAndNonFinancialTerms.length; i++) {
            var label = $scope.financialAndNonFinancialTerms[i].label;
            console.log('label=>', label);
            var matchedLabelIndex = findIndeces(label, $scope.content);
            if (matchedLabelIndex.startIndex) {
                console.log('data=>', matchedLabelIndex);
                $scope.content =
                    $scope.content.substring(0, matchedLabelIndex.startIndex) +
                    $scope.financialAndNonFinancialTerms[i].value +
                    $scope.content.substring(matchedLabelIndex.endIndex + 1, $scope.content.length)
            }
        }
        newContractService.dataContent = $scope.content;

    }

    function findIndeces(label, content) {

        var foundStartIndex = false;
        var validSyntax = true;
        var searchRecord = {};
        var record = {};

        var htmlContent = content;

        for (var i = 0; i < htmlContent.length; i++) {

            if (validSyntax && htmlContent[i] === "[" && htmlContent[i + 1] === "[") {
                // console.log('found startIndex' , htmlContent[i] , htmlContent[i+1] , i , i+1)
                // console.log('foundStartIndex' , foundStartIndex)
                if (foundStartIndex) {
                    validSyntax = false;
                    break;
                }
                foundStartIndex = true;
                searchRecord = {};
                searchRecord.startIndex = i;

            }

            if (validSyntax && htmlContent[i] === "]" && htmlContent[i + 1] === "]") {
                // console.log('found endIndex' , htmlContent[i] , htmlContent[i+1] , i , i+1)
                // console.log('foundStartIndex' , foundStartIndex)

                if (!foundStartIndex) {
                    validSyntax = false;
                    break;
                }
                foundStartIndex = false;
                searchRecord.endIndex = i + 1;
                searchRecord.text = htmlToPlaintext(htmlContent.substring(searchRecord.startIndex + 2, searchRecord.endIndex - 1)).trim();
                if (searchRecord.text == label.replace(/[^a-zA-Z ]/g, "").trim().toLowerCase()) {

                    record = searchRecord;
                    break;
                }
            }

        }
        console.log('validSyntax = ', validSyntax);
        if (foundStartIndex) {
            validSyntax = false;
            return null;
        }
        return record;
    }

    function htmlToPlaintext(text) {
        var plain = text ? String(text).replace(/<[^>]+>/gm, '') : '';
        var htmlHavingSpecialChar = htmlDecode(plain);
        var plainText = htmlHavingSpecialChar.replace(/[^a-zA-Z ]/g, "").toLowerCase()
        return plainText;
    }

    function htmlDecode(input) {

        var e = document.createElement('div');
        e.innerHTML = input;
        return e.childNodes.length === 0 ? "" : e.childNodes[0].nodeValue;
    }

    //==================================== CONTRACT Modal =======================================================//
    $scope.saveSelection = -1;
    // $scope.saveContract = function (name, agenttName) {
    //     //if ($scope.saveSelection == 0) {
    //     //    saveContractFormat(name, agenttName);
    //     //}
    //
    //     if ($scope.saveSelection == 1) {
    //         saveNewContract(name, agenttName);
    //     }
    // }


    //========================== New Contract With Modal Open And Server Call =================================//
    $scope.openContractModel = function () {
        $scope.saveSelection = 1;
        $scope.contractLabel = 'New Contract.';
        $('#newFormat').modal('toggle');
    }

    function saveNewContract(name, agenttName) {

        var propIds = JSON.parse(localStorage.getItem('selectedPopertiesId'));
        //var json = {
        //    contractName: name,
        //    body: $scope.content,
        //    propertyId: propIds.join(','),
        //    terms: $scope.financialAndNonFinancialTerms
        //};

        var json = {
            name: name,
            content: $scope.content,
            agenttName: agenttName,
            status: 'NotStarted'
        };

        $('#preloader').css('display', 'block');

        newContractService.addContractTemplate(json) //addContract
            .then(function (response) {
                console.log(response);
                $('#preloader').css('display', 'none');
                $('#newFormat').modal('toggle');

                if (!response.success) {
                    $scope.$emit('danger', response.message);
                    return;
                }
                $scope.content = '';
                $scope.$emit('success', response.message);
                $timeout(function () {
                    $state.go('SavedContractList');
                }, 2000);

            }, function (err) {
                $('#preloader').css('display', 'none');
                console.log(err);
            });

    }


    //========================== New Contract Format With Modal Open And Server Call =================================//

    $scope.openContractFormatModel = function () {

        $scope.saveSelection = 0;
        $scope.contractLabel = 'New Contract Format.';
        $('#newFormat').modal('toggle');

    }


    function saveContractFormat(name, agenttName) {
        var json = {
            name: name,
            content: $scope.content,
            agenttName: agenttName,
            status: 'NotStarted'
        };

        $("#preloader").css("display", "block");
        newContractService.addContractTemplate(json)
            .then(function (response) {
                $('#preloader').css('display', 'none');
                $('#newFormat').modal('toggle');
                console.log(response);

                if (!response.success) {
                    return;
                }

                $scope.$emit('success', response.message);
                $scope.content = '';

                getContractFiles();
            }, function (err) {
                $('#preloader').css('display', 'none');
                console.log(err);
            });

    }

    function getContractFiles() {

        $("#preloader").css("display", "block");
        newContractService.getContracts()
            .then(function (response) {
                $('#preloader').css('display', 'none');

                console.log(response);
                $scope.contractFiles = [];

                if (!response.success) {
                    return;
                }

                $scope.contractFiles = response.result;

            }, function (err) {
                $('#preloader').css('display', 'none');
                console.log(err);
            });

    }

    $scope.options = {
        language: 'en',
        allowedContent: true,
        entities: false
    };

    $scope.clearFile = function () {
        UtilService.clearFile();
    };

    $scope.onReady = function () {
        console.log('done I am ready')
    };

    $scope.fileUploaded = function () {

        $scope.FileNames = [];
        var files = document.getElementById('file-1').files;
        $scope.fileData = files;

        for (var i = 0; i < files.length; i++) {
            $scope.FileNames.push({
                name: files[i].name
            });
        }

        // Parsing is done. Update UI.
        $scope.$apply();
        $('#uploadedContracts').modal('toggle');
    }

    $scope.uploadSelectedFiles = function () {

        if ($scope.fileData.length > 0) {
            $("#preloader").css("display", "block");

            newContractService.uploadContractsFiles($scope.fileData).
            then(function (result) {
                console.log(result);
                $('#uploadedContracts').modal('toggle');


                $("#preloader").css("display", "none");
                $scope.$emit('success', result.data.message);
                getContractFiles();

            }, function (err) {

                $("#preloader").css("display", "none");
                console.log(result);

            });

        }
    }



    //end of controller
}

function directiveFunction($timeout) {
    return {
        require: '?ngModel',
        link: function (scope, elm, attr, ngModel) {
            var config = {
                allowedContent: true,
                height: 450
                // toolbar: [
                //     {name: 'clipboard',   groups: [ 'clipboard', 'undo' ] , items: [ 'Cut', 'Copy', 'Paste', 'PasteText', 'PasteFromWord', '-', 'Undo', 'Redo' ] },
                //     {name: 'basicstyles', items: ['Bold', 'Italic', 'Underline', '-', 'RemoveFormat']},
                //     {name: 'paragraph', items: ['NumberedList', 'BulletedList', '-', 'Outdent', 'Indent']},
                //     {name: 'text-align', items: ['JustifyLeft', 'JustifyCenter', 'JustifyRight', 'JustifyBlock']},
                //     {name: 'styles', items: ['Font', 'FontSize']},
                //     {name: 'colors', items: ['TextColor', 'BGColor']},
                //     {name: 'tools', items: ['Table', 'HorizontalRule', 'Maximize']},
                // ]
            };

            // elm[0].setAttribute('contenteditable', true);
            var ck = window.CKEDITOR.replace(elm[0], config);

            if (!ngModel) return;

            CKEDITOR.on('instanceReady', function () {
                console.log('instanceReady')

                // ck.setData(ngModel.$viewValue);


                CKEDITOR.document.getById('contactList').on('dragstart', function (evt) {

                    var target = evt.data.getTarget().getAscendant('div', true);
                    CKEDITOR.plugins.clipboard.initDragDataTransfer(evt);

                    var dataTransfer = evt.data.dataTransfer;
                    console.log('data is => ', target.data('contact'))
                    // console.log('data is => ', CONTACTS[target.data('contact')])
                    // dataTransfer.setData('contact', CONTACTS[target.data('contact')]);
                    // dataTransfer.setData('text/html', target.getText());

                    dataTransfer.setData('text/html', scope.articles[target.data('contact')].description);


                });



                CKEDITOR.document.getById('contractList').on('dragstart', function (evt) {

                    var target = evt.data.getTarget().getAscendant('div', true);
                    CKEDITOR.plugins.clipboard.initDragDataTransfer(evt);
                    var dataTransfer = evt.data.dataTransfer;

                    dataTransfer.setData('text/html', scope.contractFiles[target.data('contact')].body);

                });

            });

            ngModel.$render = function () {
                console.log("render");

                ck.setData(ngModel.$viewValue);
            };

            ck.on('change', updateModel);
            ck.on('key', updateModel);
            ck.on('dataReady', updateModel);

            ck.on('dragstart', function (evt) {
                console.log("dragstart");
            });

            ck.on('dragenter', function (evt) {
                console.log("dragenter");
            });

            ck.on('dragover', function (evt) {
                console.log("dragover");
            });

            function updateModel() {
                console.log('updateModel')
                $timeout(function () {
                    ngModel.$setViewValue(ck.getData());
                }, 200);
                // scope.$apply(function() {
                //     ngModel.$setViewValue(ck.getData());
                // });
            }

            CKEDITOR.disableAutoInline = true;
            // Implements a simple widget that represents contact details (see http://microformats.org/wiki/h-card).
            // CKEDITOR.plugins.add('hcard', {
            //     requires: 'widget',
            //
            //     init: function(editor) {
            //         console.log('init editor');
            //
            //         editor.widgets.add('hcard', {
            //             allowedContent: 'span(!h-card); a[href](!u-email,!p-name); span(!p-tel)',
            //             requiredContent: 'span(h-card)',
            //             pathName: 'hcard',
            //
            //             upcast: function(el) {
            //                 return el.name == 'span' && el.hasClass('h-card');
            //             }
            //         });
            //
            //         // This feature does not have a button, so it needs to be registered manually.
            //         editor.addFeature(editor.widgets.registered.hcard);
            //
            //         // Handle dropping a contact by transforming the contact object into HTML.
            //         // Note: All pasted and dropped content is handled in one event - editor#paste.
            //         editor.on('paste', function(evt) {
            //             console.log('paste');
            //             var contact = evt.data.dataTransfer.getData('contact');
            //             if (!contact) {
            //                 return;
            //             }
            //
            //             evt.data.dataValue =
            //                 '' +
            //                 '' + contact.name + '' +
            //                 ' ' +
            //                 '' + contact.tel + '' +
            //                 '';
            //         });
            //     }
            // });
        }
    };
}

directiveFunction.$inject = ["$timeout"];
module.exports = { contractEditor: _contractEditor, directiveFunction: directiveFunction };
/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 95 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


_phoneInput.$inject = ["$filter", "$browser"];
module.exports = { phoneInput: _phoneInput, tel: _tel };

//angular.module('AOTC')
//.directive('phoneInput', _phoneInput
//)


//.filter('tel', _tel
//);
function _phoneInput($filter, $browser) {
    return {
        require: 'ngModel',
        link: function ($scope, $element, $attrs, ngModelCtrl) {
            var listener = function () {
                var value = $element.val().replace(/[^0-9]/g, '');
                $element.val($filter('tel')(value, false));
            };

            // This runs when we update the text field
            ngModelCtrl.$parsers.push(function (viewValue) {
                return viewValue.replace(/[^0-9]/g, '').slice(0, 10);
            });

            // This runs when the model gets updated on the scope directly and keeps our view in sync
            ngModelCtrl.$render = function () {
                $element.val($filter('tel')(ngModelCtrl.$viewValue, false));
            };

            $element.bind('change', listener);
            $element.bind('keydown', function (event) {
                var key = event.keyCode;
                // If the keys include the CTRL, SHIFT, ALT, or META keys, or the arrow keys, do nothing.
                // This lets us support copy and paste too
                if (key == 91 || (15 < key && key < 19) || (37 <= key && key <= 40)) {
                    return;
                }
                $browser.defer(listener); // Have to do this or changes don't get picked up properly
            });

            $element.bind('paste cut', function () {
                $browser.defer(listener);
            });
        }

    };
}
function _tel() {
    return function (tel) {
        // ////console.log(tel);
        if (!tel) { return ''; }

        var value = tel.toString().trim().replace(/^\+/, '');

        if (value.match(/[^0-9]/)) {
            return tel;
        }

        var country, city, number;

        switch (value.length) {
            case 1:
            case 2:
            case 3:
                city = value;
                break;

            default:
                city = value.slice(0, 3);
                number = value.slice(3);
        }

        if (number) {
            if (number.length > 3) {
                number = number.slice(0, 3) + '-' + number.slice(3, 7);
            }
            else {
                number = number;
            }

            return ("(" + city + ") " + number).trim();
        }
        else {
            return "(" + city;
        }

    };
}

/***/ }),
/* 96 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {

_PropertyDetailsTab.$inject = ["User_Config", "fileReader", "UtilService", "$stateParams", "$location", "$scope", "$http", "__env", "$log", "AOTCService", "PropertyDetailsTabService", "$timeout"];
module.exports = { PropertyDetailsTab: _PropertyDetailsTab, ngPropertyImageSelect: _ngPropertyImageSelect };

var async = __webpack_require__(97);



//angular.module('AOTC').controller('PropertyDetailsTab', _PropertyDetailsTab
//    )
//.directive("ngPropertyImageSelect", _ngPropertyImageSelect);

function _ngPropertyImageSelect() {
    return {
        link: function ($scope, el) {
            el.bind("change", function (e) {
                $scope.file = (e.srcElement || e.target).files;
                $scope.getImages();
            })
        }
    }
}


function _PropertyDetailsTab(User_Config, fileReader, UtilService, $stateParams, $location, $scope, $http, __env, $log, AOTCService, PropertyDetailsTabService, $timeout) {
    /*! flip - v1.1.2 - 2016-10-20
* https://github.com/nnattawat/flip
* Copyright (c) 2016 Nattawat Nonsung; Licensed MIT */

    ////console.log("PropertyDetailsTab");

    var vm = this;
    $scope.isArray = function(value){
        try{
            if(Array.isArray(value))
            {
              var _val = '';
              for(var i=0;i<value.length;i++){
                if(i!=(value.length-1)) _val += value[i] + ', ';
                else _val += value[i];
              }
              return _val;
            }
            else return value;
        }
        catch(_e){
            return value;
        }
      };
    vm.deleteImageById = deleteImageById;
    vm.flipBack = flipBack;
    vm.flipFront = flipFront;
    vm.isDeleting = false;

    $(document).ready(function () {
        $('#propCard').flip({
            trigger: 'manual'
        });
    });



    vm.propertyDetails = JSON.parse(localStorage.getItem('propertyDetails'));
    vm.propertyId = JSON.parse(localStorage.getItem('propertyId'));
    vm.images = [];
    vm.properties = [];
    vm.showAllData = false;

    vm.myModelCheck = myModelCheck;
    vm.deleteByID = deleteByID;
    vm.setMainImage = setMainImage;

    vm.imageDeleteId = '';
    vm.imageDeleteTag = '';
    vm.deleteByIDImage = null;
    vm.modelMessage = {
        title: "",
        message: ""
    };

    // Public prop details
    vm.publicProperty = null;

    if (vm.propertyDetails.publicProperty != null) {
        vm.publicProperty = vm.propertyDetails.publicProperty;
    }

    // initial image index
    $scope._Index = 0;

    // Map Options
    $scope.map = { center: { latitude: vm.propertyDetails.latitude, longitude: vm.propertyDetails.longitude }, zoom: 15 };
    $scope.marker = {
        id: 1,
        coords: {
            latitude: vm.propertyDetails.latitude,
            longitude: vm.propertyDetails.longitude
        },
        options: {
            draggable: false,
            icon: "assets/img/marker.png"
        },
        events: {

        }
    };

    // Upload Images 
    $scope.imageSrc = [];
    vm.newUploadedImages = []
    vm.uploadImages = uploadImages;
    vm.removeUploadedPicture = removeUploadedPicture;
    $scope.toggleImageLoader = false;

    // Get all images initially
    getAllImages(false);

    $scope.isActive = function (index) {
        return $scope._Index === index;
    };
    ///modules/PropertyModule/View_IE_RR/tabs/propertyDetails/propertyData.json 

    var getData = function () {
        $http.get('/modules/PropertyModule/IE_RR_Module/View_IE_RR/tabs/propertyDetails/propertyData.json').then(function (_data) {
            vm.publicProperty = _data.data['propertyData0'];
        });
    }();

    $scope.showPhoto = function (index) {
        $scope._Index = index;
    };

    // show prev image
    $scope.showPrev = function () {
        if ($scope._Index > 6) {
            $('#drag').animate({
                'right': "-=100px"
            });
        }
        $scope._Index = ($scope._Index > 0) ? --$scope._Index : vm.images.length - 1;
    };

    // show next image
    $scope.showNext = function () {

        $scope._Index = ($scope._Index < vm.images.length - 1) ? ++$scope._Index : 0;
        //$('#drag').hide("slide", {direction: "left" },  1020);
        if ($scope._Index > 6) {
            $('#drag').animate({
                'right': "+=100px"
            });
        }
    };

    function deleteImageById(imageId, tag) {
        var len = (vm.images).length;
        var index = $scope._Index;

        if (len === (index + 1)) {
            $scope.showPhoto(len - 2);
        }

        PropertyDetailsTabService.deleteImageById(imageId, tag)
            .then(function (result) {
                ////console.log('Server result deleteImageById ->' + result);
                if (result.data.success) {
                    $scope._Index = 0;
                    getAllImages(false);
                    // updateDrag(true);

                    $scope.$emit('success', 'Record deleted successfully');
                } else {
                    $scope.$emit('error', 'Record deleted unsuccessfull');
                }
            }, function (err) {
                ////console.log('err is ', err);
            })
    }

    function flipBack(id) {
        $('#propCard').flip(false);
    }

    function flipFront(id) {
        $('#propCard').flip(true);
    }

    function deleteByID(name, id, tag) {

        vm.modelMessage.title = 'Delete Picture';
        vm.modelMessage.message = "Are you sure you want to delete picture “" + name + "” from this property?";
        vm.imageDeleteId = id;
        vm.imageDeleteTag = tag;
    }

    function myModelCheck() {
        vm.isDeleting = true;
        if (vm.imageDeleteId != null) {
            deleteImageById(vm.imageDeleteId, vm.imageDeleteTag)
        }
    }

    function updateDrag(flag) {

        $timeout(function () {
            // var items = $(".nav li").length;
            var items = vm.images.length;

            // Flag is defined to load the previous image if the image delete is last one.
            // if(flag){
            //     $scope.showPhoto(items - 1);
            // }

            var leftRight = 0;
            // var val = items * 9;

            if (items > 7) {
                leftRight = (items - 7) * -100;
                // leftRight = (items - 7) * -(val);
            }

            $('.nav').draggable({
                axis: "x",
                stop: function () {
                    var ml = parseInt($(this).css('left'));
                    if (ml > 0)
                        $(this).animate({ left: "0px" });
                    if (ml < leftRight)
                        $(this).animate({ left: leftRight + "px" });
                }
            });
        }, 500);
    }

    function setMainImage(imageId) {

        var propertyId = localStorage.getItem('propertyId');

        PropertyDetailsTabService.setMainImage(propertyId, imageId)
            .then(function (result) {
                ////console.log('Server result setMainImage -->', result);
                if (result.data.success) {
                    getAllImages(true);
                    updateDrag(false);
                    $scope.$emit('success', 'Main picture set successfully');
                } else {
                    $scope.$emit('error', 'Main picture set unsuccessfull');
                }
            }, function (err) {
                ////console.log('err is ', err);
            })
    }

    // getAllImages
    function getAllImages(flagMainImage) {
        vm.images = [];
        PropertyDetailsTabService.getAllImages().
        then(function (result) {
            ////console.log('getAllImages: ', result);

            var serverData = result.data;

            if (serverData.success) {
                var images = serverData.result;

                if (images.length > 0) {
                    vm.noImage = false;
                    vm.images = images;
                    updateDrag(false);
                    vm.isDeleting = false;
                    if (flagMainImage) {
                        $scope._Index = 0;
                        // showPhoto(0);
                    }
                } else {
                    vm.noImage = true;
                    vm.images = [{
                        properties: {
                            fileName: User_Config.NO_IMAGE_AVAILABLE
                        }
                    }];
                }
            }
        }, function (err) {
            //some error
            ////console.log("Error: ", err);
            $("#preloader").css("display", "none");
        })
    }

    // upload images functions
    vm.showImageModal = function () {

        $scope.imageSrc = [];
        $('#imageModal').modal('toggle');
    }

    function removeUploadedPicture(image) {

        for (var i = 0; i < $scope.imageSrc.length; i++) {

            if ($scope.imageSrc[i] == image) {
                $scope.imageSrc.splice(i, 1);
            }
        }
    }

    $scope.getImages = function () {
        $scope.toggleImageLoader = false;

        if ($scope.file.length > 0)
            $scope.imageSrc = [];

        async.forEach($scope.file, function (file, callback) {

            fileReader.readAsDataUrl(file, $scope)
                .then(function (result) {

                    var image = {
                        imageSrc: result,
                        file: file
                    };

                    $scope.imageSrc.push(image);
                    callback();
                });

        }, function (err) {
            if (err) return next(err);
            $scope.toggleImageLoader = true;
        });
    };

    function uploadImages() {

        vm.newUploadedImages = []

        for (var i = 0; i < $scope.imageSrc.length; i++) {
            vm.newUploadedImages.push($scope.imageSrc[i].file);
        }

        var totalImages = vm.images.length + vm.newUploadedImages.length;
        if (vm.noImage) {
            totalImages = vm.newUploadedImages.length;
        }

        if (totalImages > 10) {
            $scope.$emit('danger', 'Can not add more than 10 pictures');
            return;
        }
        sendImagesData();
    }

    function sendImagesData() {

        if (vm.newUploadedImages) {

            $("#preloader").css("display", "block");
            var url = '/propertyImages/addImages?propId=' + vm.propertyId;

            AOTCService.uploadFiles(url, vm.newUploadedImages)
                .then(function (result) {
                    $("#preloader").css("display", "none");

                    var serverData = result.data;

                    if (serverData.success != true) {
                        $scpoe.$emit('error', serverData.message);
                        return;
                    }

                    $('#imageModal').modal('toggle');
                    $scope.$emit('success', serverData.message);
                    getAllImages(false);
                }, function (result) {
                    $("#preloader").css("display", "none");
                    ////console.log(result);
                });
        } else {
            $scpoe.$emit('error', 'Please upload a picture');
        }
    }

}


// function getProperty() {

//     var url = '/properties/getSlavePropertiesByMasterId?id=' + vm.propertyId;

//     $("#preloader").css("display", "block");

//     AOTCService.getDataFromServer(url)
//         .then(function(result) {
//             ////console.log(result);
//             // ////console.log(result.data.length);
//             var serverData = result.data;
//             if (serverData.success) {

//                 vm.properties = serverData.result[0].prop;
//                 // ////console.log(vm.properties);
//                 localStorage.setItem('propertiesCount', vm.properties.length);

//                 for (var i = 0; i < vm.properties.length; i++) {
//                     var prop = vm.properties[i];
//                     prop.id = prop._id;
//                     prop.showAllData = false;

//                     if (i == 0) {
//                         prop.isActive = true;
//                         prop.activeClass = 'glyphicon-minus'
//                     } else {
//                         prop.isActive = false;
//                         prop.activeClass = 'glyphicon-plus'
//                     }
//                 }
//             }
//             $("#preloader").css("display", "none");
//         }, function(result) {
//             //some error
//             ////console.log(result);
//             $("#preloader").css("display", "none");
//         });
// }

/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 97 */
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(setImmediate, process, global, module) {(function (global, factory) {
   true ? factory(exports) :
  typeof define === 'function' && define.amd ? define(['exports'], factory) :
  (factory((global.async = global.async || {})));
}(this, (function (exports) { 'use strict';

function slice(arrayLike, start) {
    start = start|0;
    var newLen = Math.max(arrayLike.length - start, 0);
    var newArr = Array(newLen);
    for(var idx = 0; idx < newLen; idx++)  {
        newArr[idx] = arrayLike[start + idx];
    }
    return newArr;
}

/**
 * Creates a continuation function with some arguments already applied.
 *
 * Useful as a shorthand when combined with other control flow functions. Any
 * arguments passed to the returned function are added to the arguments
 * originally passed to apply.
 *
 * @name apply
 * @static
 * @memberOf module:Utils
 * @method
 * @category Util
 * @param {Function} fn - The function you want to eventually apply all
 * arguments to. Invokes with (arguments...).
 * @param {...*} arguments... - Any number of arguments to automatically apply
 * when the continuation is called.
 * @returns {Function} the partially-applied function
 * @example
 *
 * // using apply
 * async.parallel([
 *     async.apply(fs.writeFile, 'testfile1', 'test1'),
 *     async.apply(fs.writeFile, 'testfile2', 'test2')
 * ]);
 *
 *
 * // the same process without using apply
 * async.parallel([
 *     function(callback) {
 *         fs.writeFile('testfile1', 'test1', callback);
 *     },
 *     function(callback) {
 *         fs.writeFile('testfile2', 'test2', callback);
 *     }
 * ]);
 *
 * // It's possible to pass any number of additional arguments when calling the
 * // continuation:
 *
 * node> var fn = async.apply(sys.puts, 'one');
 * node> fn('two', 'three');
 * one
 * two
 * three
 */
var apply = function(fn/*, ...args*/) {
    var args = slice(arguments, 1);
    return function(/*callArgs*/) {
        var callArgs = slice(arguments);
        return fn.apply(null, args.concat(callArgs));
    };
};

var initialParams = function (fn) {
    return function (/*...args, callback*/) {
        var args = slice(arguments);
        var callback = args.pop();
        fn.call(this, args, callback);
    };
};

/**
 * Checks if `value` is the
 * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)
 * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is an object, else `false`.
 * @example
 *
 * _.isObject({});
 * // => true
 *
 * _.isObject([1, 2, 3]);
 * // => true
 *
 * _.isObject(_.noop);
 * // => true
 *
 * _.isObject(null);
 * // => false
 */
function isObject(value) {
  var type = typeof value;
  return value != null && (type == 'object' || type == 'function');
}

var hasSetImmediate = typeof setImmediate === 'function' && setImmediate;
var hasNextTick = typeof process === 'object' && typeof process.nextTick === 'function';

function fallback(fn) {
    setTimeout(fn, 0);
}

function wrap(defer) {
    return function (fn/*, ...args*/) {
        var args = slice(arguments, 1);
        defer(function () {
            fn.apply(null, args);
        });
    };
}

var _defer;

if (hasSetImmediate) {
    _defer = setImmediate;
} else if (hasNextTick) {
    _defer = process.nextTick;
} else {
    _defer = fallback;
}

var setImmediate$1 = wrap(_defer);

/**
 * Take a sync function and make it async, passing its return value to a
 * callback. This is useful for plugging sync functions into a waterfall,
 * series, or other async functions. Any arguments passed to the generated
 * function will be passed to the wrapped function (except for the final
 * callback argument). Errors thrown will be passed to the callback.
 *
 * If the function passed to `asyncify` returns a Promise, that promises's
 * resolved/rejected state will be used to call the callback, rather than simply
 * the synchronous return value.
 *
 * This also means you can asyncify ES2017 `async` functions.
 *
 * @name asyncify
 * @static
 * @memberOf module:Utils
 * @method
 * @alias wrapSync
 * @category Util
 * @param {Function} func - The synchronous function, or Promise-returning
 * function to convert to an {@link AsyncFunction}.
 * @returns {AsyncFunction} An asynchronous wrapper of the `func`. To be
 * invoked with `(args..., callback)`.
 * @example
 *
 * // passing a regular synchronous function
 * async.waterfall([
 *     async.apply(fs.readFile, filename, "utf8"),
 *     async.asyncify(JSON.parse),
 *     function (data, next) {
 *         // data is the result of parsing the text.
 *         // If there was a parsing error, it would have been caught.
 *     }
 * ], callback);
 *
 * // passing a function returning a promise
 * async.waterfall([
 *     async.apply(fs.readFile, filename, "utf8"),
 *     async.asyncify(function (contents) {
 *         return db.model.create(contents);
 *     }),
 *     function (model, next) {
 *         // `model` is the instantiated model object.
 *         // If there was an error, this function would be skipped.
 *     }
 * ], callback);
 *
 * // es2017 example, though `asyncify` is not needed if your JS environment
 * // supports async functions out of the box
 * var q = async.queue(async.asyncify(async function(file) {
 *     var intermediateStep = await processFile(file);
 *     return await somePromise(intermediateStep)
 * }));
 *
 * q.push(files);
 */
function asyncify(func) {
    return initialParams(function (args, callback) {
        var result;
        try {
            result = func.apply(this, args);
        } catch (e) {
            return callback(e);
        }
        // if result is Promise object
        if (isObject(result) && typeof result.then === 'function') {
            result.then(function(value) {
                invokeCallback(callback, null, value);
            }, function(err) {
                invokeCallback(callback, err.message ? err : new Error(err));
            });
        } else {
            callback(null, result);
        }
    });
}

function invokeCallback(callback, error, value) {
    try {
        callback(error, value);
    } catch (e) {
        setImmediate$1(rethrow, e);
    }
}

function rethrow(error) {
    throw error;
}

var supportsSymbol = typeof Symbol === 'function';

function isAsync(fn) {
    return supportsSymbol && fn[Symbol.toStringTag] === 'AsyncFunction';
}

function wrapAsync(asyncFn) {
    return isAsync(asyncFn) ? asyncify(asyncFn) : asyncFn;
}

function applyEach$1(eachfn) {
    return function(fns/*, ...args*/) {
        var args = slice(arguments, 1);
        var go = initialParams(function(args, callback) {
            var that = this;
            return eachfn(fns, function (fn, cb) {
                wrapAsync(fn).apply(that, args.concat(cb));
            }, callback);
        });
        if (args.length) {
            return go.apply(this, args);
        }
        else {
            return go;
        }
    };
}

/** Detect free variable `global` from Node.js. */
var freeGlobal = typeof global == 'object' && global && global.Object === Object && global;

/** Detect free variable `self`. */
var freeSelf = typeof self == 'object' && self && self.Object === Object && self;

/** Used as a reference to the global object. */
var root = freeGlobal || freeSelf || Function('return this')();

/** Built-in value references. */
var Symbol$1 = root.Symbol;

/** Used for built-in method references. */
var objectProto = Object.prototype;

/** Used to check objects for own properties. */
var hasOwnProperty = objectProto.hasOwnProperty;

/**
 * Used to resolve the
 * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)
 * of values.
 */
var nativeObjectToString = objectProto.toString;

/** Built-in value references. */
var symToStringTag$1 = Symbol$1 ? Symbol$1.toStringTag : undefined;

/**
 * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.
 *
 * @private
 * @param {*} value The value to query.
 * @returns {string} Returns the raw `toStringTag`.
 */
function getRawTag(value) {
  var isOwn = hasOwnProperty.call(value, symToStringTag$1),
      tag = value[symToStringTag$1];

  try {
    value[symToStringTag$1] = undefined;
    var unmasked = true;
  } catch (e) {}

  var result = nativeObjectToString.call(value);
  if (unmasked) {
    if (isOwn) {
      value[symToStringTag$1] = tag;
    } else {
      delete value[symToStringTag$1];
    }
  }
  return result;
}

/** Used for built-in method references. */
var objectProto$1 = Object.prototype;

/**
 * Used to resolve the
 * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)
 * of values.
 */
var nativeObjectToString$1 = objectProto$1.toString;

/**
 * Converts `value` to a string using `Object.prototype.toString`.
 *
 * @private
 * @param {*} value The value to convert.
 * @returns {string} Returns the converted string.
 */
function objectToString(value) {
  return nativeObjectToString$1.call(value);
}

/** `Object#toString` result references. */
var nullTag = '[object Null]';
var undefinedTag = '[object Undefined]';

/** Built-in value references. */
var symToStringTag = Symbol$1 ? Symbol$1.toStringTag : undefined;

/**
 * The base implementation of `getTag` without fallbacks for buggy environments.
 *
 * @private
 * @param {*} value The value to query.
 * @returns {string} Returns the `toStringTag`.
 */
function baseGetTag(value) {
  if (value == null) {
    return value === undefined ? undefinedTag : nullTag;
  }
  return (symToStringTag && symToStringTag in Object(value))
    ? getRawTag(value)
    : objectToString(value);
}

/** `Object#toString` result references. */
var asyncTag = '[object AsyncFunction]';
var funcTag = '[object Function]';
var genTag = '[object GeneratorFunction]';
var proxyTag = '[object Proxy]';

/**
 * Checks if `value` is classified as a `Function` object.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a function, else `false`.
 * @example
 *
 * _.isFunction(_);
 * // => true
 *
 * _.isFunction(/abc/);
 * // => false
 */
function isFunction(value) {
  if (!isObject(value)) {
    return false;
  }
  // The use of `Object#toString` avoids issues with the `typeof` operator
  // in Safari 9 which returns 'object' for typed arrays and other constructors.
  var tag = baseGetTag(value);
  return tag == funcTag || tag == genTag || tag == asyncTag || tag == proxyTag;
}

/** Used as references for various `Number` constants. */
var MAX_SAFE_INTEGER = 9007199254740991;

/**
 * Checks if `value` is a valid array-like length.
 *
 * **Note:** This method is loosely based on
 * [`ToLength`](http://ecma-international.org/ecma-262/7.0/#sec-tolength).
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.
 * @example
 *
 * _.isLength(3);
 * // => true
 *
 * _.isLength(Number.MIN_VALUE);
 * // => false
 *
 * _.isLength(Infinity);
 * // => false
 *
 * _.isLength('3');
 * // => false
 */
function isLength(value) {
  return typeof value == 'number' &&
    value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;
}

/**
 * Checks if `value` is array-like. A value is considered array-like if it's
 * not a function and has a `value.length` that's an integer greater than or
 * equal to `0` and less than or equal to `Number.MAX_SAFE_INTEGER`.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is array-like, else `false`.
 * @example
 *
 * _.isArrayLike([1, 2, 3]);
 * // => true
 *
 * _.isArrayLike(document.body.children);
 * // => true
 *
 * _.isArrayLike('abc');
 * // => true
 *
 * _.isArrayLike(_.noop);
 * // => false
 */
function isArrayLike(value) {
  return value != null && isLength(value.length) && !isFunction(value);
}

// A temporary value used to identify if the loop should be broken.
// See #1064, #1293
var breakLoop = {};

/**
 * This method returns `undefined`.
 *
 * @static
 * @memberOf _
 * @since 2.3.0
 * @category Util
 * @example
 *
 * _.times(2, _.noop);
 * // => [undefined, undefined]
 */
function noop() {
  // No operation performed.
}

function once(fn) {
    return function () {
        if (fn === null) return;
        var callFn = fn;
        fn = null;
        callFn.apply(this, arguments);
    };
}

var iteratorSymbol = typeof Symbol === 'function' && Symbol.iterator;

var getIterator = function (coll) {
    return iteratorSymbol && coll[iteratorSymbol] && coll[iteratorSymbol]();
};

/**
 * The base implementation of `_.times` without support for iteratee shorthands
 * or max array length checks.
 *
 * @private
 * @param {number} n The number of times to invoke `iteratee`.
 * @param {Function} iteratee The function invoked per iteration.
 * @returns {Array} Returns the array of results.
 */
function baseTimes(n, iteratee) {
  var index = -1,
      result = Array(n);

  while (++index < n) {
    result[index] = iteratee(index);
  }
  return result;
}

/**
 * Checks if `value` is object-like. A value is object-like if it's not `null`
 * and has a `typeof` result of "object".
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is object-like, else `false`.
 * @example
 *
 * _.isObjectLike({});
 * // => true
 *
 * _.isObjectLike([1, 2, 3]);
 * // => true
 *
 * _.isObjectLike(_.noop);
 * // => false
 *
 * _.isObjectLike(null);
 * // => false
 */
function isObjectLike(value) {
  return value != null && typeof value == 'object';
}

/** `Object#toString` result references. */
var argsTag = '[object Arguments]';

/**
 * The base implementation of `_.isArguments`.
 *
 * @private
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is an `arguments` object,
 */
function baseIsArguments(value) {
  return isObjectLike(value) && baseGetTag(value) == argsTag;
}

/** Used for built-in method references. */
var objectProto$3 = Object.prototype;

/** Used to check objects for own properties. */
var hasOwnProperty$2 = objectProto$3.hasOwnProperty;

/** Built-in value references. */
var propertyIsEnumerable = objectProto$3.propertyIsEnumerable;

/**
 * Checks if `value` is likely an `arguments` object.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is an `arguments` object,
 *  else `false`.
 * @example
 *
 * _.isArguments(function() { return arguments; }());
 * // => true
 *
 * _.isArguments([1, 2, 3]);
 * // => false
 */
var isArguments = baseIsArguments(function() { return arguments; }()) ? baseIsArguments : function(value) {
  return isObjectLike(value) && hasOwnProperty$2.call(value, 'callee') &&
    !propertyIsEnumerable.call(value, 'callee');
};

/**
 * Checks if `value` is classified as an `Array` object.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is an array, else `false`.
 * @example
 *
 * _.isArray([1, 2, 3]);
 * // => true
 *
 * _.isArray(document.body.children);
 * // => false
 *
 * _.isArray('abc');
 * // => false
 *
 * _.isArray(_.noop);
 * // => false
 */
var isArray = Array.isArray;

/**
 * This method returns `false`.
 *
 * @static
 * @memberOf _
 * @since 4.13.0
 * @category Util
 * @returns {boolean} Returns `false`.
 * @example
 *
 * _.times(2, _.stubFalse);
 * // => [false, false]
 */
function stubFalse() {
  return false;
}

/** Detect free variable `exports`. */
var freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;

/** Detect free variable `module`. */
var freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;

/** Detect the popular CommonJS extension `module.exports`. */
var moduleExports = freeModule && freeModule.exports === freeExports;

/** Built-in value references. */
var Buffer = moduleExports ? root.Buffer : undefined;

/* Built-in method references for those with the same name as other `lodash` methods. */
var nativeIsBuffer = Buffer ? Buffer.isBuffer : undefined;

/**
 * Checks if `value` is a buffer.
 *
 * @static
 * @memberOf _
 * @since 4.3.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a buffer, else `false`.
 * @example
 *
 * _.isBuffer(new Buffer(2));
 * // => true
 *
 * _.isBuffer(new Uint8Array(2));
 * // => false
 */
var isBuffer = nativeIsBuffer || stubFalse;

/** Used as references for various `Number` constants. */
var MAX_SAFE_INTEGER$1 = 9007199254740991;

/** Used to detect unsigned integer values. */
var reIsUint = /^(?:0|[1-9]\d*)$/;

/**
 * Checks if `value` is a valid array-like index.
 *
 * @private
 * @param {*} value The value to check.
 * @param {number} [length=MAX_SAFE_INTEGER] The upper bounds of a valid index.
 * @returns {boolean} Returns `true` if `value` is a valid index, else `false`.
 */
function isIndex(value, length) {
  length = length == null ? MAX_SAFE_INTEGER$1 : length;
  return !!length &&
    (typeof value == 'number' || reIsUint.test(value)) &&
    (value > -1 && value % 1 == 0 && value < length);
}

/** `Object#toString` result references. */
var argsTag$1 = '[object Arguments]';
var arrayTag = '[object Array]';
var boolTag = '[object Boolean]';
var dateTag = '[object Date]';
var errorTag = '[object Error]';
var funcTag$1 = '[object Function]';
var mapTag = '[object Map]';
var numberTag = '[object Number]';
var objectTag = '[object Object]';
var regexpTag = '[object RegExp]';
var setTag = '[object Set]';
var stringTag = '[object String]';
var weakMapTag = '[object WeakMap]';

var arrayBufferTag = '[object ArrayBuffer]';
var dataViewTag = '[object DataView]';
var float32Tag = '[object Float32Array]';
var float64Tag = '[object Float64Array]';
var int8Tag = '[object Int8Array]';
var int16Tag = '[object Int16Array]';
var int32Tag = '[object Int32Array]';
var uint8Tag = '[object Uint8Array]';
var uint8ClampedTag = '[object Uint8ClampedArray]';
var uint16Tag = '[object Uint16Array]';
var uint32Tag = '[object Uint32Array]';

/** Used to identify `toStringTag` values of typed arrays. */
var typedArrayTags = {};
typedArrayTags[float32Tag] = typedArrayTags[float64Tag] =
typedArrayTags[int8Tag] = typedArrayTags[int16Tag] =
typedArrayTags[int32Tag] = typedArrayTags[uint8Tag] =
typedArrayTags[uint8ClampedTag] = typedArrayTags[uint16Tag] =
typedArrayTags[uint32Tag] = true;
typedArrayTags[argsTag$1] = typedArrayTags[arrayTag] =
typedArrayTags[arrayBufferTag] = typedArrayTags[boolTag] =
typedArrayTags[dataViewTag] = typedArrayTags[dateTag] =
typedArrayTags[errorTag] = typedArrayTags[funcTag$1] =
typedArrayTags[mapTag] = typedArrayTags[numberTag] =
typedArrayTags[objectTag] = typedArrayTags[regexpTag] =
typedArrayTags[setTag] = typedArrayTags[stringTag] =
typedArrayTags[weakMapTag] = false;

/**
 * The base implementation of `_.isTypedArray` without Node.js optimizations.
 *
 * @private
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.
 */
function baseIsTypedArray(value) {
  return isObjectLike(value) &&
    isLength(value.length) && !!typedArrayTags[baseGetTag(value)];
}

/**
 * The base implementation of `_.unary` without support for storing metadata.
 *
 * @private
 * @param {Function} func The function to cap arguments for.
 * @returns {Function} Returns the new capped function.
 */
function baseUnary(func) {
  return function(value) {
    return func(value);
  };
}

/** Detect free variable `exports`. */
var freeExports$1 = typeof exports == 'object' && exports && !exports.nodeType && exports;

/** Detect free variable `module`. */
var freeModule$1 = freeExports$1 && typeof module == 'object' && module && !module.nodeType && module;

/** Detect the popular CommonJS extension `module.exports`. */
var moduleExports$1 = freeModule$1 && freeModule$1.exports === freeExports$1;

/** Detect free variable `process` from Node.js. */
var freeProcess = moduleExports$1 && freeGlobal.process;

/** Used to access faster Node.js helpers. */
var nodeUtil = (function() {
  try {
    return freeProcess && freeProcess.binding && freeProcess.binding('util');
  } catch (e) {}
}());

/* Node.js helper references. */
var nodeIsTypedArray = nodeUtil && nodeUtil.isTypedArray;

/**
 * Checks if `value` is classified as a typed array.
 *
 * @static
 * @memberOf _
 * @since 3.0.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.
 * @example
 *
 * _.isTypedArray(new Uint8Array);
 * // => true
 *
 * _.isTypedArray([]);
 * // => false
 */
var isTypedArray = nodeIsTypedArray ? baseUnary(nodeIsTypedArray) : baseIsTypedArray;

/** Used for built-in method references. */
var objectProto$2 = Object.prototype;

/** Used to check objects for own properties. */
var hasOwnProperty$1 = objectProto$2.hasOwnProperty;

/**
 * Creates an array of the enumerable property names of the array-like `value`.
 *
 * @private
 * @param {*} value The value to query.
 * @param {boolean} inherited Specify returning inherited property names.
 * @returns {Array} Returns the array of property names.
 */
function arrayLikeKeys(value, inherited) {
  var isArr = isArray(value),
      isArg = !isArr && isArguments(value),
      isBuff = !isArr && !isArg && isBuffer(value),
      isType = !isArr && !isArg && !isBuff && isTypedArray(value),
      skipIndexes = isArr || isArg || isBuff || isType,
      result = skipIndexes ? baseTimes(value.length, String) : [],
      length = result.length;

  for (var key in value) {
    if ((inherited || hasOwnProperty$1.call(value, key)) &&
        !(skipIndexes && (
           // Safari 9 has enumerable `arguments.length` in strict mode.
           key == 'length' ||
           // Node.js 0.10 has enumerable non-index properties on buffers.
           (isBuff && (key == 'offset' || key == 'parent')) ||
           // PhantomJS 2 has enumerable non-index properties on typed arrays.
           (isType && (key == 'buffer' || key == 'byteLength' || key == 'byteOffset')) ||
           // Skip index properties.
           isIndex(key, length)
        ))) {
      result.push(key);
    }
  }
  return result;
}

/** Used for built-in method references. */
var objectProto$5 = Object.prototype;

/**
 * Checks if `value` is likely a prototype object.
 *
 * @private
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a prototype, else `false`.
 */
function isPrototype(value) {
  var Ctor = value && value.constructor,
      proto = (typeof Ctor == 'function' && Ctor.prototype) || objectProto$5;

  return value === proto;
}

/**
 * Creates a unary function that invokes `func` with its argument transformed.
 *
 * @private
 * @param {Function} func The function to wrap.
 * @param {Function} transform The argument transform.
 * @returns {Function} Returns the new function.
 */
function overArg(func, transform) {
  return function(arg) {
    return func(transform(arg));
  };
}

/* Built-in method references for those with the same name as other `lodash` methods. */
var nativeKeys = overArg(Object.keys, Object);

/** Used for built-in method references. */
var objectProto$4 = Object.prototype;

/** Used to check objects for own properties. */
var hasOwnProperty$3 = objectProto$4.hasOwnProperty;

/**
 * The base implementation of `_.keys` which doesn't treat sparse arrays as dense.
 *
 * @private
 * @param {Object} object The object to query.
 * @returns {Array} Returns the array of property names.
 */
function baseKeys(object) {
  if (!isPrototype(object)) {
    return nativeKeys(object);
  }
  var result = [];
  for (var key in Object(object)) {
    if (hasOwnProperty$3.call(object, key) && key != 'constructor') {
      result.push(key);
    }
  }
  return result;
}

/**
 * Creates an array of the own enumerable property names of `object`.
 *
 * **Note:** Non-object values are coerced to objects. See the
 * [ES spec](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)
 * for more details.
 *
 * @static
 * @since 0.1.0
 * @memberOf _
 * @category Object
 * @param {Object} object The object to query.
 * @returns {Array} Returns the array of property names.
 * @example
 *
 * function Foo() {
 *   this.a = 1;
 *   this.b = 2;
 * }
 *
 * Foo.prototype.c = 3;
 *
 * _.keys(new Foo);
 * // => ['a', 'b'] (iteration order is not guaranteed)
 *
 * _.keys('hi');
 * // => ['0', '1']
 */
function keys(object) {
  return isArrayLike(object) ? arrayLikeKeys(object) : baseKeys(object);
}

function createArrayIterator(coll) {
    var i = -1;
    var len = coll.length;
    return function next() {
        return ++i < len ? {value: coll[i], key: i} : null;
    }
}

function createES2015Iterator(iterator) {
    var i = -1;
    return function next() {
        var item = iterator.next();
        if (item.done)
            return null;
        i++;
        return {value: item.value, key: i};
    }
}

function createObjectIterator(obj) {
    var okeys = keys(obj);
    var i = -1;
    var len = okeys.length;
    return function next() {
        var key = okeys[++i];
        return i < len ? {value: obj[key], key: key} : null;
    };
}

function iterator(coll) {
    if (isArrayLike(coll)) {
        return createArrayIterator(coll);
    }

    var iterator = getIterator(coll);
    return iterator ? createES2015Iterator(iterator) : createObjectIterator(coll);
}

function onlyOnce(fn) {
    return function() {
        if (fn === null) throw new Error("Callback was already called.");
        var callFn = fn;
        fn = null;
        callFn.apply(this, arguments);
    };
}

function _eachOfLimit(limit) {
    return function (obj, iteratee, callback) {
        callback = once(callback || noop);
        if (limit <= 0 || !obj) {
            return callback(null);
        }
        var nextElem = iterator(obj);
        var done = false;
        var running = 0;

        function iterateeCallback(err, value) {
            running -= 1;
            if (err) {
                done = true;
                callback(err);
            }
            else if (value === breakLoop || (done && running <= 0)) {
                done = true;
                return callback(null);
            }
            else {
                replenish();
            }
        }

        function replenish () {
            while (running < limit && !done) {
                var elem = nextElem();
                if (elem === null) {
                    done = true;
                    if (running <= 0) {
                        callback(null);
                    }
                    return;
                }
                running += 1;
                iteratee(elem.value, elem.key, onlyOnce(iterateeCallback));
            }
        }

        replenish();
    };
}

/**
 * The same as [`eachOf`]{@link module:Collections.eachOf} but runs a maximum of `limit` async operations at a
 * time.
 *
 * @name eachOfLimit
 * @static
 * @memberOf module:Collections
 * @method
 * @see [async.eachOf]{@link module:Collections.eachOf}
 * @alias forEachOfLimit
 * @category Collection
 * @param {Array|Iterable|Object} coll - A collection to iterate over.
 * @param {number} limit - The maximum number of async operations at a time.
 * @param {AsyncFunction} iteratee - An async function to apply to each
 * item in `coll`. The `key` is the item's key, or index in the case of an
 * array.
 * Invoked with (item, key, callback).
 * @param {Function} [callback] - A callback which is called when all
 * `iteratee` functions have finished, or an error occurs. Invoked with (err).
 */
function eachOfLimit(coll, limit, iteratee, callback) {
    _eachOfLimit(limit)(coll, wrapAsync(iteratee), callback);
}

function doLimit(fn, limit) {
    return function (iterable, iteratee, callback) {
        return fn(iterable, limit, iteratee, callback);
    };
}

// eachOf implementation optimized for array-likes
function eachOfArrayLike(coll, iteratee, callback) {
    callback = once(callback || noop);
    var index = 0,
        completed = 0,
        length = coll.length;
    if (length === 0) {
        callback(null);
    }

    function iteratorCallback(err, value) {
        if (err) {
            callback(err);
        } else if ((++completed === length) || value === breakLoop) {
            callback(null);
        }
    }

    for (; index < length; index++) {
        iteratee(coll[index], index, onlyOnce(iteratorCallback));
    }
}

// a generic version of eachOf which can handle array, object, and iterator cases.
var eachOfGeneric = doLimit(eachOfLimit, Infinity);

/**
 * Like [`each`]{@link module:Collections.each}, except that it passes the key (or index) as the second argument
 * to the iteratee.
 *
 * @name eachOf
 * @static
 * @memberOf module:Collections
 * @method
 * @alias forEachOf
 * @category Collection
 * @see [async.each]{@link module:Collections.each}
 * @param {Array|Iterable|Object} coll - A collection to iterate over.
 * @param {AsyncFunction} iteratee - A function to apply to each
 * item in `coll`.
 * The `key` is the item's key, or index in the case of an array.
 * Invoked with (item, key, callback).
 * @param {Function} [callback] - A callback which is called when all
 * `iteratee` functions have finished, or an error occurs. Invoked with (err).
 * @example
 *
 * var obj = {dev: "/dev.json", test: "/test.json", prod: "/prod.json"};
 * var configs = {};
 *
 * async.forEachOf(obj, function (value, key, callback) {
 *     fs.readFile(__dirname + value, "utf8", function (err, data) {
 *         if (err) return callback(err);
 *         try {
 *             configs[key] = JSON.parse(data);
 *         } catch (e) {
 *             return callback(e);
 *         }
 *         callback();
 *     });
 * }, function (err) {
 *     if (err) console.error(err.message);
 *     // configs is now a map of JSON data
 *     doSomethingWith(configs);
 * });
 */
var eachOf = function(coll, iteratee, callback) {
    var eachOfImplementation = isArrayLike(coll) ? eachOfArrayLike : eachOfGeneric;
    eachOfImplementation(coll, wrapAsync(iteratee), callback);
};

function doParallel(fn) {
    return function (obj, iteratee, callback) {
        return fn(eachOf, obj, wrapAsync(iteratee), callback);
    };
}

function _asyncMap(eachfn, arr, iteratee, callback) {
    callback = callback || noop;
    arr = arr || [];
    var results = [];
    var counter = 0;
    var _iteratee = wrapAsync(iteratee);

    eachfn(arr, function (value, _, callback) {
        var index = counter++;
        _iteratee(value, function (err, v) {
            results[index] = v;
            callback(err);
        });
    }, function (err) {
        callback(err, results);
    });
}

/**
 * Produces a new collection of values by mapping each value in `coll` through
 * the `iteratee` function. The `iteratee` is called with an item from `coll`
 * and a callback for when it has finished processing. Each of these callback
 * takes 2 arguments: an `error`, and the transformed item from `coll`. If
 * `iteratee` passes an error to its callback, the main `callback` (for the
 * `map` function) is immediately called with the error.
 *
 * Note, that since this function applies the `iteratee` to each item in
 * parallel, there is no guarantee that the `iteratee` functions will complete
 * in order. However, the results array will be in the same order as the
 * original `coll`.
 *
 * If `map` is passed an Object, the results will be an Array.  The results
 * will roughly be in the order of the original Objects' keys (but this can
 * vary across JavaScript engines).
 *
 * @name map
 * @static
 * @memberOf module:Collections
 * @method
 * @category Collection
 * @param {Array|Iterable|Object} coll - A collection to iterate over.
 * @param {AsyncFunction} iteratee - An async function to apply to each item in
 * `coll`.
 * The iteratee should complete with the transformed item.
 * Invoked with (item, callback).
 * @param {Function} [callback] - A callback which is called when all `iteratee`
 * functions have finished, or an error occurs. Results is an Array of the
 * transformed items from the `coll`. Invoked with (err, results).
 * @example
 *
 * async.map(['file1','file2','file3'], fs.stat, function(err, results) {
 *     // results is now an array of stats for each file
 * });
 */
var map = doParallel(_asyncMap);

/**
 * Applies the provided arguments to each function in the array, calling
 * `callback` after all functions have completed. If you only provide the first
 * argument, `fns`, then it will return a function which lets you pass in the
 * arguments as if it were a single function call. If more arguments are
 * provided, `callback` is required while `args` is still optional.
 *
 * @name applyEach
 * @static
 * @memberOf module:ControlFlow
 * @method
 * @category Control Flow
 * @param {Array|Iterable|Object} fns - A collection of {@link AsyncFunction}s
 * to all call with the same arguments
 * @param {...*} [args] - any number of separate arguments to pass to the
 * function.
 * @param {Function} [callback] - the final argument should be the callback,
 * called when all functions have completed processing.
 * @returns {Function} - If only the first argument, `fns`, is provided, it will
 * return a function which lets you pass in the arguments as if it were a single
 * function call. The signature is `(..args, callback)`. If invoked with any
 * arguments, `callback` is required.
 * @example
 *
 * async.applyEach([enableSearch, updateSchema], 'bucket', callback);
 *
 * // partial application example:
 * async.each(
 *     buckets,
 *     async.applyEach([enableSearch, updateSchema]),
 *     callback
 * );
 */
var applyEach = applyEach$1(map);

function doParallelLimit(fn) {
    return function (obj, limit, iteratee, callback) {
        return fn(_eachOfLimit(limit), obj, wrapAsync(iteratee), callback);
    };
}

/**
 * The same as [`map`]{@link module:Collections.map} but runs a maximum of `limit` async operations at a time.
 *
 * @name mapLimit
 * @static
 * @memberOf module:Collections
 * @method
 * @see [async.map]{@link module:Collections.map}
 * @category Collection
 * @param {Array|Iterable|Object} coll - A collection to iterate over.
 * @param {number} limit - The maximum number of async operations at a time.
 * @param {AsyncFunction} iteratee - An async function to apply to each item in
 * `coll`.
 * The iteratee should complete with the transformed item.
 * Invoked with (item, callback).
 * @param {Function} [callback] - A callback which is called when all `iteratee`
 * functions have finished, or an error occurs. Results is an array of the
 * transformed items from the `coll`. Invoked with (err, results).
 */
var mapLimit = doParallelLimit(_asyncMap);

/**
 * The same as [`map`]{@link module:Collections.map} but runs only a single async operation at a time.
 *
 * @name mapSeries
 * @static
 * @memberOf module:Collections
 * @method
 * @see [async.map]{@link module:Collections.map}
 * @category Collection
 * @param {Array|Iterable|Object} coll - A collection to iterate over.
 * @param {AsyncFunction} iteratee - An async function to apply to each item in
 * `coll`.
 * The iteratee should complete with the transformed item.
 * Invoked with (item, callback).
 * @param {Function} [callback] - A callback which is called when all `iteratee`
 * functions have finished, or an error occurs. Results is an array of the
 * transformed items from the `coll`. Invoked with (err, results).
 */
var mapSeries = doLimit(mapLimit, 1);

/**
 * The same as [`applyEach`]{@link module:ControlFlow.applyEach} but runs only a single async operation at a time.
 *
 * @name applyEachSeries
 * @static
 * @memberOf module:ControlFlow
 * @method
 * @see [async.applyEach]{@link module:ControlFlow.applyEach}
 * @category Control Flow
 * @param {Array|Iterable|Object} fns - A collection of {@link AsyncFunction}s to all
 * call with the same arguments
 * @param {...*} [args] - any number of separate arguments to pass to the
 * function.
 * @param {Function} [callback] - the final argument should be the callback,
 * called when all functions have completed processing.
 * @returns {Function} - If only the first argument is provided, it will return
 * a function which lets you pass in the arguments as if it were a single
 * function call.
 */
var applyEachSeries = applyEach$1(mapSeries);

/**
 * A specialized version of `_.forEach` for arrays without support for
 * iteratee shorthands.
 *
 * @private
 * @param {Array} [array] The array to iterate over.
 * @param {Function} iteratee The function invoked per iteration.
 * @returns {Array} Returns `array`.
 */
function arrayEach(array, iteratee) {
  var index = -1,
      length = array == null ? 0 : array.length;

  while (++index < length) {
    if (iteratee(array[index], index, array) === false) {
      break;
    }
  }
  return array;
}

/**
 * Creates a base function for methods like `_.forIn` and `_.forOwn`.
 *
 * @private
 * @param {boolean} [fromRight] Specify iterating from right to left.
 * @returns {Function} Returns the new base function.
 */
function createBaseFor(fromRight) {
  return function(object, iteratee, keysFunc) {
    var index = -1,
        iterable = Object(object),
        props = keysFunc(object),
        length = props.length;

    while (length--) {
      var key = props[fromRight ? length : ++index];
      if (iteratee(iterable[key], key, iterable) === false) {
        break;
      }
    }
    return object;
  };
}

/**
 * The base implementation of `baseForOwn` which iterates over `object`
 * properties returned by `keysFunc` and invokes `iteratee` for each property.
 * Iteratee functions may exit iteration early by explicitly returning `false`.
 *
 * @private
 * @param {Object} object The object to iterate over.
 * @param {Function} iteratee The function invoked per iteration.
 * @param {Function} keysFunc The function to get the keys of `object`.
 * @returns {Object} Returns `object`.
 */
var baseFor = createBaseFor();

/**
 * The base implementation of `_.forOwn` without support for iteratee shorthands.
 *
 * @private
 * @param {Object} object The object to iterate over.
 * @param {Function} iteratee The function invoked per iteration.
 * @returns {Object} Returns `object`.
 */
function baseForOwn(object, iteratee) {
  return object && baseFor(object, iteratee, keys);
}

/**
 * The base implementation of `_.findIndex` and `_.findLastIndex` without
 * support for iteratee shorthands.
 *
 * @private
 * @param {Array} array The array to inspect.
 * @param {Function} predicate The function invoked per iteration.
 * @param {number} fromIndex The index to search from.
 * @param {boolean} [fromRight] Specify iterating from right to left.
 * @returns {number} Returns the index of the matched value, else `-1`.
 */
function baseFindIndex(array, predicate, fromIndex, fromRight) {
  var length = array.length,
      index = fromIndex + (fromRight ? 1 : -1);

  while ((fromRight ? index-- : ++index < length)) {
    if (predicate(array[index], index, array)) {
      return index;
    }
  }
  return -1;
}

/**
 * The base implementation of `_.isNaN` without support for number objects.
 *
 * @private
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is `NaN`, else `false`.
 */
function baseIsNaN(value) {
  return value !== value;
}

/**
 * A specialized version of `_.indexOf` which performs strict equality
 * comparisons of values, i.e. `===`.
 *
 * @private
 * @param {Array} array The array to inspect.
 * @param {*} value The value to search for.
 * @param {number} fromIndex The index to search from.
 * @returns {number} Returns the index of the matched value, else `-1`.
 */
function strictIndexOf(array, value, fromIndex) {
  var index = fromIndex - 1,
      length = array.length;

  while (++index < length) {
    if (array[index] === value) {
      return index;
    }
  }
  return -1;
}

/**
 * The base implementation of `_.indexOf` without `fromIndex` bounds checks.
 *
 * @private
 * @param {Array} array The array to inspect.
 * @param {*} value The value to search for.
 * @param {number} fromIndex The index to search from.
 * @returns {number} Returns the index of the matched value, else `-1`.
 */
function baseIndexOf(array, value, fromIndex) {
  return value === value
    ? strictIndexOf(array, value, fromIndex)
    : baseFindIndex(array, baseIsNaN, fromIndex);
}

/**
 * Determines the best order for running the {@link AsyncFunction}s in `tasks`, based on
 * their requirements. Each function can optionally depend on other functions
 * being completed first, and each function is run as soon as its requirements
 * are satisfied.
 *
 * If any of the {@link AsyncFunction}s pass an error to their callback, the `auto` sequence
 * will stop. Further tasks will not execute (so any other functions depending
 * on it will not run), and the main `callback` is immediately called with the
 * error.
 *
 * {@link AsyncFunction}s also receive an object containing the results of functions which
 * have completed so far as the first argument, if they have dependencies. If a
 * task function has no dependencies, it will only be passed a callback.
 *
 * @name auto
 * @static
 * @memberOf module:ControlFlow
 * @method
 * @category Control Flow
 * @param {Object} tasks - An object. Each of its properties is either a
 * function or an array of requirements, with the {@link AsyncFunction} itself the last item
 * in the array. The object's key of a property serves as the name of the task
 * defined by that property, i.e. can be used when specifying requirements for
 * other tasks. The function receives one or two arguments:
 * * a `results` object, containing the results of the previously executed
 *   functions, only passed if the task has any dependencies,
 * * a `callback(err, result)` function, which must be called when finished,
 *   passing an `error` (which can be `null`) and the result of the function's
 *   execution.
 * @param {number} [concurrency=Infinity] - An optional `integer` for
 * determining the maximum number of tasks that can be run in parallel. By
 * default, as many as possible.
 * @param {Function} [callback] - An optional callback which is called when all
 * the tasks have been completed. It receives the `err` argument if any `tasks`
 * pass an error to their callback. Results are always returned; however, if an
 * error occurs, no further `tasks` will be performed, and the results object
 * will only contain partial results. Invoked with (err, results).
 * @returns undefined
 * @example
 *
 * async.auto({
 *     // this function will just be passed a callback
 *     readData: async.apply(fs.readFile, 'data.txt', 'utf-8'),
 *     showData: ['readData', function(results, cb) {
 *         // results.readData is the file's contents
 *         // ...
 *     }]
 * }, callback);
 *
 * async.auto({
 *     get_data: function(callback) {
 *         console.log('in get_data');
 *         // async code to get some data
 *         callback(null, 'data', 'converted to array');
 *     },
 *     make_folder: function(callback) {
 *         console.log('in make_folder');
 *         // async code to create a directory to store a file in
 *         // this is run at the same time as getting the data
 *         callback(null, 'folder');
 *     },
 *     write_file: ['get_data', 'make_folder', function(results, callback) {
 *         console.log('in write_file', JSON.stringify(results));
 *         // once there is some data and the directory exists,
 *         // write the data to a file in the directory
 *         callback(null, 'filename');
 *     }],
 *     email_link: ['write_file', function(results, callback) {
 *         console.log('in email_link', JSON.stringify(results));
 *         // once the file is written let's email a link to it...
 *         // results.write_file contains the filename returned by write_file.
 *         callback(null, {'file':results.write_file, 'email':'user@example.com'});
 *     }]
 * }, function(err, results) {
 *     console.log('err = ', err);
 *     console.log('results = ', results);
 * });
 */
var auto = function (tasks, concurrency, callback) {
    if (typeof concurrency === 'function') {
        // concurrency is optional, shift the args.
        callback = concurrency;
        concurrency = null;
    }
    callback = once(callback || noop);
    var keys$$1 = keys(tasks);
    var numTasks = keys$$1.length;
    if (!numTasks) {
        return callback(null);
    }
    if (!concurrency) {
        concurrency = numTasks;
    }

    var results = {};
    var runningTasks = 0;
    var hasError = false;

    var listeners = Object.create(null);

    var readyTasks = [];

    // for cycle detection:
    var readyToCheck = []; // tasks that have been identified as reachable
    // without the possibility of returning to an ancestor task
    var uncheckedDependencies = {};

    baseForOwn(tasks, function (task, key) {
        if (!isArray(task)) {
            // no dependencies
            enqueueTask(key, [task]);
            readyToCheck.push(key);
            return;
        }

        var dependencies = task.slice(0, task.length - 1);
        var remainingDependencies = dependencies.length;
        if (remainingDependencies === 0) {
            enqueueTask(key, task);
            readyToCheck.push(key);
            return;
        }
        uncheckedDependencies[key] = remainingDependencies;

        arrayEach(dependencies, function (dependencyName) {
            if (!tasks[dependencyName]) {
                throw new Error('async.auto task `' + key +
                    '` has a non-existent dependency `' +
                    dependencyName + '` in ' +
                    dependencies.join(', '));
            }
            addListener(dependencyName, function () {
                remainingDependencies--;
                if (remainingDependencies === 0) {
                    enqueueTask(key, task);
                }
            });
        });
    });

    checkForDeadlocks();
    processQueue();

    function enqueueTask(key, task) {
        readyTasks.push(function () {
            runTask(key, task);
        });
    }

    function processQueue() {
        if (readyTasks.length === 0 && runningTasks === 0) {
            return callback(null, results);
        }
        while(readyTasks.length && runningTasks < concurrency) {
            var run = readyTasks.shift();
            run();
        }

    }

    function addListener(taskName, fn) {
        var taskListeners = listeners[taskName];
        if (!taskListeners) {
            taskListeners = listeners[taskName] = [];
        }

        taskListeners.push(fn);
    }

    function taskComplete(taskName) {
        var taskListeners = listeners[taskName] || [];
        arrayEach(taskListeners, function (fn) {
            fn();
        });
        processQueue();
    }


    function runTask(key, task) {
        if (hasError) return;

        var taskCallback = onlyOnce(function(err, result) {
            runningTasks--;
            if (arguments.length > 2) {
                result = slice(arguments, 1);
            }
            if (err) {
                var safeResults = {};
                baseForOwn(results, function(val, rkey) {
                    safeResults[rkey] = val;
                });
                safeResults[key] = result;
                hasError = true;
                listeners = Object.create(null);

                callback(err, safeResults);
            } else {
                results[key] = result;
                taskComplete(key);
            }
        });

        runningTasks++;
        var taskFn = wrapAsync(task[task.length - 1]);
        if (task.length > 1) {
            taskFn(results, taskCallback);
        } else {
            taskFn(taskCallback);
        }
    }

    function checkForDeadlocks() {
        // Kahn's algorithm
        // https://en.wikipedia.org/wiki/Topological_sorting#Kahn.27s_algorithm
        // http://connalle.blogspot.com/2013/10/topological-sortingkahn-algorithm.html
        var currentTask;
        var counter = 0;
        while (readyToCheck.length) {
            currentTask = readyToCheck.pop();
            counter++;
            arrayEach(getDependents(currentTask), function (dependent) {
                if (--uncheckedDependencies[dependent] === 0) {
                    readyToCheck.push(dependent);
                }
            });
        }

        if (counter !== numTasks) {
            throw new Error(
                'async.auto cannot execute tasks due to a recursive dependency'
            );
        }
    }

    function getDependents(taskName) {
        var result = [];
        baseForOwn(tasks, function (task, key) {
            if (isArray(task) && baseIndexOf(task, taskName, 0) >= 0) {
                result.push(key);
            }
        });
        return result;
    }
};

/**
 * A specialized version of `_.map` for arrays without support for iteratee
 * shorthands.
 *
 * @private
 * @param {Array} [array] The array to iterate over.
 * @param {Function} iteratee The function invoked per iteration.
 * @returns {Array} Returns the new mapped array.
 */
function arrayMap(array, iteratee) {
  var index = -1,
      length = array == null ? 0 : array.length,
      result = Array(length);

  while (++index < length) {
    result[index] = iteratee(array[index], index, array);
  }
  return result;
}

/** `Object#toString` result references. */
var symbolTag = '[object Symbol]';

/**
 * Checks if `value` is classified as a `Symbol` primitive or object.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.
 * @example
 *
 * _.isSymbol(Symbol.iterator);
 * // => true
 *
 * _.isSymbol('abc');
 * // => false
 */
function isSymbol(value) {
  return typeof value == 'symbol' ||
    (isObjectLike(value) && baseGetTag(value) == symbolTag);
}

/** Used as references for various `Number` constants. */
var INFINITY = 1 / 0;

/** Used to convert symbols to primitives and strings. */
var symbolProto = Symbol$1 ? Symbol$1.prototype : undefined;
var symbolToString = symbolProto ? symbolProto.toString : undefined;

/**
 * The base implementation of `_.toString` which doesn't convert nullish
 * values to empty strings.
 *
 * @private
 * @param {*} value The value to process.
 * @returns {string} Returns the string.
 */
function baseToString(value) {
  // Exit early for strings to avoid a performance hit in some environments.
  if (typeof value == 'string') {
    return value;
  }
  if (isArray(value)) {
    // Recursively convert values (susceptible to call stack limits).
    return arrayMap(value, baseToString) + '';
  }
  if (isSymbol(value)) {
    return symbolToString ? symbolToString.call(value) : '';
  }
  var result = (value + '');
  return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;
}

/**
 * The base implementation of `_.slice` without an iteratee call guard.
 *
 * @private
 * @param {Array} array The array to slice.
 * @param {number} [start=0] The start position.
 * @param {number} [end=array.length] The end position.
 * @returns {Array} Returns the slice of `array`.
 */
function baseSlice(array, start, end) {
  var index = -1,
      length = array.length;

  if (start < 0) {
    start = -start > length ? 0 : (length + start);
  }
  end = end > length ? length : end;
  if (end < 0) {
    end += length;
  }
  length = start > end ? 0 : ((end - start) >>> 0);
  start >>>= 0;

  var result = Array(length);
  while (++index < length) {
    result[index] = array[index + start];
  }
  return result;
}

/**
 * Casts `array` to a slice if it's needed.
 *
 * @private
 * @param {Array} array The array to inspect.
 * @param {number} start The start position.
 * @param {number} [end=array.length] The end position.
 * @returns {Array} Returns the cast slice.
 */
function castSlice(array, start, end) {
  var length = array.length;
  end = end === undefined ? length : end;
  return (!start && end >= length) ? array : baseSlice(array, start, end);
}

/**
 * Used by `_.trim` and `_.trimEnd` to get the index of the last string symbol
 * that is not found in the character symbols.
 *
 * @private
 * @param {Array} strSymbols The string symbols to inspect.
 * @param {Array} chrSymbols The character symbols to find.
 * @returns {number} Returns the index of the last unmatched string symbol.
 */
function charsEndIndex(strSymbols, chrSymbols) {
  var index = strSymbols.length;

  while (index-- && baseIndexOf(chrSymbols, strSymbols[index], 0) > -1) {}
  return index;
}

/**
 * Used by `_.trim` and `_.trimStart` to get the index of the first string symbol
 * that is not found in the character symbols.
 *
 * @private
 * @param {Array} strSymbols The string symbols to inspect.
 * @param {Array} chrSymbols The character symbols to find.
 * @returns {number} Returns the index of the first unmatched string symbol.
 */
function charsStartIndex(strSymbols, chrSymbols) {
  var index = -1,
      length = strSymbols.length;

  while (++index < length && baseIndexOf(chrSymbols, strSymbols[index], 0) > -1) {}
  return index;
}

/**
 * Converts an ASCII `string` to an array.
 *
 * @private
 * @param {string} string The string to convert.
 * @returns {Array} Returns the converted array.
 */
function asciiToArray(string) {
  return string.split('');
}

/** Used to compose unicode character classes. */
var rsAstralRange = '\\ud800-\\udfff';
var rsComboMarksRange = '\\u0300-\\u036f';
var reComboHalfMarksRange = '\\ufe20-\\ufe2f';
var rsComboSymbolsRange = '\\u20d0-\\u20ff';
var rsComboRange = rsComboMarksRange + reComboHalfMarksRange + rsComboSymbolsRange;
var rsVarRange = '\\ufe0e\\ufe0f';

/** Used to compose unicode capture groups. */
var rsZWJ = '\\u200d';

/** Used to detect strings with [zero-width joiners or code points from the astral planes](http://eev.ee/blog/2015/09/12/dark-corners-of-unicode/). */
var reHasUnicode = RegExp('[' + rsZWJ + rsAstralRange  + rsComboRange + rsVarRange + ']');

/**
 * Checks if `string` contains Unicode symbols.
 *
 * @private
 * @param {string} string The string to inspect.
 * @returns {boolean} Returns `true` if a symbol is found, else `false`.
 */
function hasUnicode(string) {
  return reHasUnicode.test(string);
}

/** Used to compose unicode character classes. */
var rsAstralRange$1 = '\\ud800-\\udfff';
var rsComboMarksRange$1 = '\\u0300-\\u036f';
var reComboHalfMarksRange$1 = '\\ufe20-\\ufe2f';
var rsComboSymbolsRange$1 = '\\u20d0-\\u20ff';
var rsComboRange$1 = rsComboMarksRange$1 + reComboHalfMarksRange$1 + rsComboSymbolsRange$1;
var rsVarRange$1 = '\\ufe0e\\ufe0f';

/** Used to compose unicode capture groups. */
var rsAstral = '[' + rsAstralRange$1 + ']';
var rsCombo = '[' + rsComboRange$1 + ']';
var rsFitz = '\\ud83c[\\udffb-\\udfff]';
var rsModifier = '(?:' + rsCombo + '|' + rsFitz + ')';
var rsNonAstral = '[^' + rsAstralRange$1 + ']';
var rsRegional = '(?:\\ud83c[\\udde6-\\uddff]){2}';
var rsSurrPair = '[\\ud800-\\udbff][\\udc00-\\udfff]';
var rsZWJ$1 = '\\u200d';

/** Used to compose unicode regexes. */
var reOptMod = rsModifier + '?';
var rsOptVar = '[' + rsVarRange$1 + ']?';
var rsOptJoin = '(?:' + rsZWJ$1 + '(?:' + [rsNonAstral, rsRegional, rsSurrPair].join('|') + ')' + rsOptVar + reOptMod + ')*';
var rsSeq = rsOptVar + reOptMod + rsOptJoin;
var rsSymbol = '(?:' + [rsNonAstral + rsCombo + '?', rsCombo, rsRegional, rsSurrPair, rsAstral].join('|') + ')';

/** Used to match [string symbols](https://mathiasbynens.be/notes/javascript-unicode). */
var reUnicode = RegExp(rsFitz + '(?=' + rsFitz + ')|' + rsSymbol + rsSeq, 'g');

/**
 * Converts a Unicode `string` to an array.
 *
 * @private
 * @param {string} string The string to convert.
 * @returns {Array} Returns the converted array.
 */
function unicodeToArray(string) {
  return string.match(reUnicode) || [];
}

/**
 * Converts `string` to an array.
 *
 * @private
 * @param {string} string The string to convert.
 * @returns {Array} Returns the converted array.
 */
function stringToArray(string) {
  return hasUnicode(string)
    ? unicodeToArray(string)
    : asciiToArray(string);
}

/**
 * Converts `value` to a string. An empty string is returned for `null`
 * and `undefined` values. The sign of `-0` is preserved.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Lang
 * @param {*} value The value to convert.
 * @returns {string} Returns the converted string.
 * @example
 *
 * _.toString(null);
 * // => ''
 *
 * _.toString(-0);
 * // => '-0'
 *
 * _.toString([1, 2, 3]);
 * // => '1,2,3'
 */
function toString(value) {
  return value == null ? '' : baseToString(value);
}

/** Used to match leading and trailing whitespace. */
var reTrim = /^\s+|\s+$/g;

/**
 * Removes leading and trailing whitespace or specified characters from `string`.
 *
 * @static
 * @memberOf _
 * @since 3.0.0
 * @category String
 * @param {string} [string=''] The string to trim.
 * @param {string} [chars=whitespace] The characters to trim.
 * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.
 * @returns {string} Returns the trimmed string.
 * @example
 *
 * _.trim('  abc  ');
 * // => 'abc'
 *
 * _.trim('-_-abc-_-', '_-');
 * // => 'abc'
 *
 * _.map(['  foo  ', '  bar  '], _.trim);
 * // => ['foo', 'bar']
 */
function trim(string, chars, guard) {
  string = toString(string);
  if (string && (guard || chars === undefined)) {
    return string.replace(reTrim, '');
  }
  if (!string || !(chars = baseToString(chars))) {
    return string;
  }
  var strSymbols = stringToArray(string),
      chrSymbols = stringToArray(chars),
      start = charsStartIndex(strSymbols, chrSymbols),
      end = charsEndIndex(strSymbols, chrSymbols) + 1;

  return castSlice(strSymbols, start, end).join('');
}

var FN_ARGS = /^(?:async\s+)?(function)?\s*[^\(]*\(\s*([^\)]*)\)/m;
var FN_ARG_SPLIT = /,/;
var FN_ARG = /(=.+)?(\s*)$/;
var STRIP_COMMENTS = /((\/\/.*$)|(\/\*[\s\S]*?\*\/))/mg;

function parseParams(func) {
    func = func.toString().replace(STRIP_COMMENTS, '');
    func = func.match(FN_ARGS)[2].replace(' ', '');
    func = func ? func.split(FN_ARG_SPLIT) : [];
    func = func.map(function (arg){
        return trim(arg.replace(FN_ARG, ''));
    });
    return func;
}

/**
 * A dependency-injected version of the [async.auto]{@link module:ControlFlow.auto} function. Dependent
 * tasks are specified as parameters to the function, after the usual callback
 * parameter, with the parameter names matching the names of the tasks it
 * depends on. This can provide even more readable task graphs which can be
 * easier to maintain.
 *
 * If a final callback is specified, the task results are similarly injected,
 * specified as named parameters after the initial error parameter.
 *
 * The autoInject function is purely syntactic sugar and its semantics are
 * otherwise equivalent to [async.auto]{@link module:ControlFlow.auto}.
 *
 * @name autoInject
 * @static
 * @memberOf module:ControlFlow
 * @method
 * @see [async.auto]{@link module:ControlFlow.auto}
 * @category Control Flow
 * @param {Object} tasks - An object, each of whose properties is an {@link AsyncFunction} of
 * the form 'func([dependencies...], callback). The object's key of a property
 * serves as the name of the task defined by that property, i.e. can be used
 * when specifying requirements for other tasks.
 * * The `callback` parameter is a `callback(err, result)` which must be called
 *   when finished, passing an `error` (which can be `null`) and the result of
 *   the function's execution. The remaining parameters name other tasks on
 *   which the task is dependent, and the results from those tasks are the
 *   arguments of those parameters.
 * @param {Function} [callback] - An optional callback which is called when all
 * the tasks have been completed. It receives the `err` argument if any `tasks`
 * pass an error to their callback, and a `results` object with any completed
 * task results, similar to `auto`.
 * @example
 *
 * //  The example from `auto` can be rewritten as follows:
 * async.autoInject({
 *     get_data: function(callback) {
 *         // async code to get some data
 *         callback(null, 'data', 'converted to array');
 *     },
 *     make_folder: function(callback) {
 *         // async code to create a directory to store a file in
 *         // this is run at the same time as getting the data
 *         callback(null, 'folder');
 *     },
 *     write_file: function(get_data, make_folder, callback) {
 *         // once there is some data and the directory exists,
 *         // write the data to a file in the directory
 *         callback(null, 'filename');
 *     },
 *     email_link: function(write_file, callback) {
 *         // once the file is written let's email a link to it...
 *         // write_file contains the filename returned by write_file.
 *         callback(null, {'file':write_file, 'email':'user@example.com'});
 *     }
 * }, function(err, results) {
 *     console.log('err = ', err);
 *     console.log('email_link = ', results.email_link);
 * });
 *
 * // If you are using a JS minifier that mangles parameter names, `autoInject`
 * // will not work with plain functions, since the parameter names will be
 * // collapsed to a single letter identifier.  To work around this, you can
 * // explicitly specify the names of the parameters your task function needs
 * // in an array, similar to Angular.js dependency injection.
 *
 * // This still has an advantage over plain `auto`, since the results a task
 * // depends on are still spread into arguments.
 * async.autoInject({
 *     //...
 *     write_file: ['get_data', 'make_folder', function(get_data, make_folder, callback) {
 *         callback(null, 'filename');
 *     }],
 *     email_link: ['write_file', function(write_file, callback) {
 *         callback(null, {'file':write_file, 'email':'user@example.com'});
 *     }]
 *     //...
 * }, function(err, results) {
 *     console.log('err = ', err);
 *     console.log('email_link = ', results.email_link);
 * });
 */
function autoInject(tasks, callback) {
    var newTasks = {};

    baseForOwn(tasks, function (taskFn, key) {
        var params;
        var fnIsAsync = isAsync(taskFn);
        var hasNoDeps =
            (!fnIsAsync && taskFn.length === 1) ||
            (fnIsAsync && taskFn.length === 0);

        if (isArray(taskFn)) {
            params = taskFn.slice(0, -1);
            taskFn = taskFn[taskFn.length - 1];

            newTasks[key] = params.concat(params.length > 0 ? newTask : taskFn);
        } else if (hasNoDeps) {
            // no dependencies, use the function as-is
            newTasks[key] = taskFn;
        } else {
            params = parseParams(taskFn);
            if (taskFn.length === 0 && !fnIsAsync && params.length === 0) {
                throw new Error("autoInject task functions require explicit parameters.");
            }

            // remove callback param
            if (!fnIsAsync) params.pop();

            newTasks[key] = params.concat(newTask);
        }

        function newTask(results, taskCb) {
            var newArgs = arrayMap(params, function (name) {
                return results[name];
            });
            newArgs.push(taskCb);
            wrapAsync(taskFn).apply(null, newArgs);
        }
    });

    auto(newTasks, callback);
}

// Simple doubly linked list (https://en.wikipedia.org/wiki/Doubly_linked_list) implementation
// used for queues. This implementation assumes that the node provided by the user can be modified
// to adjust the next and last properties. We implement only the minimal functionality
// for queue support.
function DLL() {
    this.head = this.tail = null;
    this.length = 0;
}

function setInitial(dll, node) {
    dll.length = 1;
    dll.head = dll.tail = node;
}

DLL.prototype.removeLink = function(node) {
    if (node.prev) node.prev.next = node.next;
    else this.head = node.next;
    if (node.next) node.next.prev = node.prev;
    else this.tail = node.prev;

    node.prev = node.next = null;
    this.length -= 1;
    return node;
};

DLL.prototype.empty = function () {
    while(this.head) this.shift();
    return this;
};

DLL.prototype.insertAfter = function(node, newNode) {
    newNode.prev = node;
    newNode.next = node.next;
    if (node.next) node.next.prev = newNode;
    else this.tail = newNode;
    node.next = newNode;
    this.length += 1;
};

DLL.prototype.insertBefore = function(node, newNode) {
    newNode.prev = node.prev;
    newNode.next = node;
    if (node.prev) node.prev.next = newNode;
    else this.head = newNode;
    node.prev = newNode;
    this.length += 1;
};

DLL.prototype.unshift = function(node) {
    if (this.head) this.insertBefore(this.head, node);
    else setInitial(this, node);
};

DLL.prototype.push = function(node) {
    if (this.tail) this.insertAfter(this.tail, node);
    else setInitial(this, node);
};

DLL.prototype.shift = function() {
    return this.head && this.removeLink(this.head);
};

DLL.prototype.pop = function() {
    return this.tail && this.removeLink(this.tail);
};

DLL.prototype.toArray = function () {
    var arr = Array(this.length);
    var curr = this.head;
    for(var idx = 0; idx < this.length; idx++) {
        arr[idx] = curr.data;
        curr = curr.next;
    }
    return arr;
};

DLL.prototype.remove = function (testFn) {
    var curr = this.head;
    while(!!curr) {
        var next = curr.next;
        if (testFn(curr)) {
            this.removeLink(curr);
        }
        curr = next;
    }
    return this;
};

function queue(worker, concurrency, payload) {
    if (concurrency == null) {
        concurrency = 1;
    }
    else if(concurrency === 0) {
        throw new Error('Concurrency must not be zero');
    }

    var _worker = wrapAsync(worker);
    var numRunning = 0;
    var workersList = [];

    var processingScheduled = false;
    function _insert(data, insertAtFront, callback) {
        if (callback != null && typeof callback !== 'function') {
            throw new Error('task callback must be a function');
        }
        q.started = true;
        if (!isArray(data)) {
            data = [data];
        }
        if (data.length === 0 && q.idle()) {
            // call drain immediately if there are no tasks
            return setImmediate$1(function() {
                q.drain();
            });
        }

        for (var i = 0, l = data.length; i < l; i++) {
            var item = {
                data: data[i],
                callback: callback || noop
            };

            if (insertAtFront) {
                q._tasks.unshift(item);
            } else {
                q._tasks.push(item);
            }
        }

        if (!processingScheduled) {
            processingScheduled = true;
            setImmediate$1(function() {
                processingScheduled = false;
                q.process();
            });
        }
    }

    function _next(tasks) {
        return function(err){
            numRunning -= 1;

            for (var i = 0, l = tasks.length; i < l; i++) {
                var task = tasks[i];

                var index = baseIndexOf(workersList, task, 0);
                if (index === 0) {
                    workersList.shift();
                } else if (index > 0) {
                    workersList.splice(index, 1);
                }

                task.callback.apply(task, arguments);

                if (err != null) {
                    q.error(err, task.data);
                }
            }

            if (numRunning <= (q.concurrency - q.buffer) ) {
                q.unsaturated();
            }

            if (q.idle()) {
                q.drain();
            }
            q.process();
        };
    }

    var isProcessing = false;
    var q = {
        _tasks: new DLL(),
        concurrency: concurrency,
        payload: payload,
        saturated: noop,
        unsaturated:noop,
        buffer: concurrency / 4,
        empty: noop,
        drain: noop,
        error: noop,
        started: false,
        paused: false,
        push: function (data, callback) {
            _insert(data, false, callback);
        },
        kill: function () {
            q.drain = noop;
            q._tasks.empty();
        },
        unshift: function (data, callback) {
            _insert(data, true, callback);
        },
        remove: function (testFn) {
            q._tasks.remove(testFn);
        },
        process: function () {
            // Avoid trying to start too many processing operations. This can occur
            // when callbacks resolve synchronously (#1267).
            if (isProcessing) {
                return;
            }
            isProcessing = true;
            while(!q.paused && numRunning < q.concurrency && q._tasks.length){
                var tasks = [], data = [];
                var l = q._tasks.length;
                if (q.payload) l = Math.min(l, q.payload);
                for (var i = 0; i < l; i++) {
                    var node = q._tasks.shift();
                    tasks.push(node);
                    workersList.push(node);
                    data.push(node.data);
                }

                numRunning += 1;

                if (q._tasks.length === 0) {
                    q.empty();
                }

                if (numRunning === q.concurrency) {
                    q.saturated();
                }

                var cb = onlyOnce(_next(tasks));
                _worker(data, cb);
            }
            isProcessing = false;
        },
        length: function () {
            return q._tasks.length;
        },
        running: function () {
            return numRunning;
        },
        workersList: function () {
            return workersList;
        },
        idle: function() {
            return q._tasks.length + numRunning === 0;
        },
        pause: function () {
            q.paused = true;
        },
        resume: function () {
            if (q.paused === false) { return; }
            q.paused = false;
            setImmediate$1(q.process);
        }
    };
    return q;
}

/**
 * A cargo of tasks for the worker function to complete. Cargo inherits all of
 * the same methods and event callbacks as [`queue`]{@link module:ControlFlow.queue}.
 * @typedef {Object} CargoObject
 * @memberOf module:ControlFlow
 * @property {Function} length - A function returning the number of items
 * waiting to be processed. Invoke like `cargo.length()`.
 * @property {number} payload - An `integer` for determining how many tasks
 * should be process per round. This property can be changed after a `cargo` is
 * created to alter the payload on-the-fly.
 * @property {Function} push - Adds `task` to the `queue`. The callback is
 * called once the `worker` has finished processing the task. Instead of a
 * single task, an array of `tasks` can be submitted. The respective callback is
 * used for every task in the list. Invoke like `cargo.push(task, [callback])`.
 * @property {Function} saturated - A callback that is called when the
 * `queue.length()` hits the concurrency and further tasks will be queued.
 * @property {Function} empty - A callback that is called when the last item
 * from the `queue` is given to a `worker`.
 * @property {Function} drain - A callback that is called when the last item
 * from the `queue` has returned from the `worker`.
 * @property {Function} idle - a function returning false if there are items
 * waiting or being processed, or true if not. Invoke like `cargo.idle()`.
 * @property {Function} pause - a function that pauses the processing of tasks
 * until `resume()` is called. Invoke like `cargo.pause()`.
 * @property {Function} resume - a function that resumes the processing of
 * queued tasks when the queue is paused. Invoke like `cargo.resume()`.
 * @property {Function} kill - a function that removes the `drain` callback and
 * empties remaining tasks from the queue forcing it to go idle. Invoke like `cargo.kill()`.
 */

/**
 * Creates a `cargo` object with the specified payload. Tasks added to the
 * cargo will be processed altogether (up to the `payload` limit). If the
 * `worker` is in progress, the task is queued until it becomes available. Once
 * the `worker` has completed some tasks, each callback of those tasks is
 * called. Check out [these](https://camo.githubusercontent.com/6bbd36f4cf5b35a0f11a96dcd2e97711ffc2fb37/68747470733a2f2f662e636c6f75642e6769746875622e636f6d2f6173736574732f313637363837312f36383130382f62626330636662302d356632392d313165322d393734662d3333393763363464633835382e676966) [animations](https://camo.githubusercontent.com/f4810e00e1c5f5f8addbe3e9f49064fd5d102699/68747470733a2f2f662e636c6f75642e6769746875622e636f6d2f6173736574732f313637363837312f36383130312f38346339323036362d356632392d313165322d383134662d3964336430323431336266642e676966)
 * for how `cargo` and `queue` work.
 *
 * While [`queue`]{@link module:ControlFlow.queue} passes only one task to one of a group of workers
 * at a time, cargo passes an array of tasks to a single worker, repeating
 * when the worker is finished.
 *
 * @name cargo
 * @static
 * @memberOf module:ControlFlow
 * @method
 * @see [async.queue]{@link module:ControlFlow.queue}
 * @category Control Flow
 * @param {AsyncFunction} worker - An asynchronous function for processing an array
 * of queued tasks. Invoked with `(tasks, callback)`.
 * @param {number} [payload=Infinity] - An optional `integer` for determining
 * how many tasks should be processed per round; if omitted, the default is
 * unlimited.
 * @returns {module:ControlFlow.CargoObject} A cargo object to manage the tasks. Callbacks can
 * attached as certain properties to listen for specific events during the
 * lifecycle of the cargo and inner queue.
 * @example
 *
 * // create a cargo object with payload 2
 * var cargo = async.cargo(function(tasks, callback) {
 *     for (var i=0; i<tasks.length; i++) {
 *         console.log('hello ' + tasks[i].name);
 *     }
 *     callback();
 * }, 2);
 *
 * // add some items
 * cargo.push({name: 'foo'}, function(err) {
 *     console.log('finished processing foo');
 * });
 * cargo.push({name: 'bar'}, function(err) {
 *     console.log('finished processing bar');
 * });
 * cargo.push({name: 'baz'}, function(err) {
 *     console.log('finished processing baz');
 * });
 */
function cargo(worker, payload) {
    return queue(worker, 1, payload);
}

/**
 * The same as [`eachOf`]{@link module:Collections.eachOf} but runs only a single async operation at a time.
 *
 * @name eachOfSeries
 * @static
 * @memberOf module:Collections
 * @method
 * @see [async.eachOf]{@link module:Collections.eachOf}
 * @alias forEachOfSeries
 * @category Collection
 * @param {Array|Iterable|Object} coll - A collection to iterate over.
 * @param {AsyncFunction} iteratee - An async function to apply to each item in
 * `coll`.
 * Invoked with (item, key, callback).
 * @param {Function} [callback] - A callback which is called when all `iteratee`
 * functions have finished, or an error occurs. Invoked with (err).
 */
var eachOfSeries = doLimit(eachOfLimit, 1);

/**
 * Reduces `coll` into a single value using an async `iteratee` to return each
 * successive step. `memo` is the initial state of the reduction. This function
 * only operates in series.
 *
 * For performance reasons, it may make sense to split a call to this function
 * into a parallel map, and then use the normal `Array.prototype.reduce` on the
 * results. This function is for situations where each step in the reduction
 * needs to be async; if you can get the data before reducing it, then it's
 * probably a good idea to do so.
 *
 * @name reduce
 * @static
 * @memberOf module:Collections
 * @method
 * @alias inject
 * @alias foldl
 * @category Collection
 * @param {Array|Iterable|Object} coll - A collection to iterate over.
 * @param {*} memo - The initial state of the reduction.
 * @param {AsyncFunction} iteratee - A function applied to each item in the
 * array to produce the next step in the reduction.
 * The `iteratee` should complete with the next state of the reduction.
 * If the iteratee complete with an error, the reduction is stopped and the
 * main `callback` is immediately called with the error.
 * Invoked with (memo, item, callback).
 * @param {Function} [callback] - A callback which is called after all the
 * `iteratee` functions have finished. Result is the reduced value. Invoked with
 * (err, result).
 * @example
 *
 * async.reduce([1,2,3], 0, function(memo, item, callback) {
 *     // pointless async:
 *     process.nextTick(function() {
 *         callback(null, memo + item)
 *     });
 * }, function(err, result) {
 *     // result is now equal to the last value of memo, which is 6
 * });
 */
function reduce(coll, memo, iteratee, callback) {
    callback = once(callback || noop);
    var _iteratee = wrapAsync(iteratee);
    eachOfSeries(coll, function(x, i, callback) {
        _iteratee(memo, x, function(err, v) {
            memo = v;
            callback(err);
        });
    }, function(err) {
        callback(err, memo);
    });
}

/**
 * Version of the compose function that is more natural to read. Each function
 * consumes the return value of the previous function. It is the equivalent of
 * [compose]{@link module:ControlFlow.compose} with the arguments reversed.
 *
 * Each function is executed with the `this` binding of the composed function.
 *
 * @name seq
 * @static
 * @memberOf module:ControlFlow
 * @method
 * @see [async.compose]{@link module:ControlFlow.compose}
 * @category Control Flow
 * @param {...AsyncFunction} functions - the asynchronous functions to compose
 * @returns {Function} a function that composes the `functions` in order
 * @example
 *
 * // Requires lodash (or underscore), express3 and dresende's orm2.
 * // Part of an app, that fetches cats of the logged user.
 * // This example uses `seq` function to avoid overnesting and error
 * // handling clutter.
 * app.get('/cats', function(request, response) {
 *     var User = request.models.User;
 *     async.seq(
 *         _.bind(User.get, User),  // 'User.get' has signature (id, callback(err, data))
 *         function(user, fn) {
 *             user.getCats(fn);      // 'getCats' has signature (callback(err, data))
 *         }
 *     )(req.session.user_id, function (err, cats) {
 *         if (err) {
 *             console.error(err);
 *             response.json({ status: 'error', message: err.message });
 *         } else {
 *             response.json({ status: 'ok', message: 'Cats found', data: cats });
 *         }
 *     });
 * });
 */
function seq(/*...functions*/) {
    var _functions = arrayMap(arguments, wrapAsync);
    return function(/*...args*/) {
        var args = slice(arguments);
        var that = this;

        var cb = args[args.length - 1];
        if (typeof cb == 'function') {
            args.pop();
        } else {
            cb = noop;
        }

        reduce(_functions, args, function(newargs, fn, cb) {
            fn.apply(that, newargs.concat(function(err/*, ...nextargs*/) {
                var nextargs = slice(arguments, 1);
                cb(err, nextargs);
            }));
        },
        function(err, results) {
            cb.apply(that, [err].concat(results));
        });
    };
}

/**
 * Creates a function which is a composition of the passed asynchronous
 * functions. Each function consumes the return value of the function that
 * follows. Composing functions `f()`, `g()`, and `h()` would produce the result
 * of `f(g(h()))`, only this version uses callbacks to obtain the return values.
 *
 * Each function is executed with the `this` binding of the composed function.
 *
 * @name compose
 * @static
 * @memberOf module:ControlFlow
 * @method
 * @category Control Flow
 * @param {...AsyncFunction} functions - the asynchronous functions to compose
 * @returns {Function} an asynchronous function that is the composed
 * asynchronous `functions`
 * @example
 *
 * function add1(n, callback) {
 *     setTimeout(function () {
 *         callback(null, n + 1);
 *     }, 10);
 * }
 *
 * function mul3(n, callback) {
 *     setTimeout(function () {
 *         callback(null, n * 3);
 *     }, 10);
 * }
 *
 * var add1mul3 = async.compose(mul3, add1);
 * add1mul3(4, function (err, result) {
 *     // result now equals 15
 * });
 */
var compose = function(/*...args*/) {
    return seq.apply(null, slice(arguments).reverse());
};

var _concat = Array.prototype.concat;

/**
 * The same as [`concat`]{@link module:Collections.concat} but runs a maximum of `limit` async operations at a time.
 *
 * @name concatLimit
 * @static
 * @memberOf module:Collections
 * @method
 * @see [async.concat]{@link module:Collections.concat}
 * @category Collection
 * @param {Array|Iterable|Object} coll - A collection to iterate over.
 * @param {number} limit - The maximum number of async operations at a time.
 * @param {AsyncFunction} iteratee - A function to apply to each item in `coll`,
 * which should use an array as its result. Invoked with (item, callback).
 * @param {Function} [callback] - A callback which is called after all the
 * `iteratee` functions have finished, or an error occurs. Results is an array
 * containing the concatenated results of the `iteratee` function. Invoked with
 * (err, results).
 */
var concatLimit = function(coll, limit, iteratee, callback) {
    callback = callback || noop;
    var _iteratee = wrapAsync(iteratee);
    mapLimit(coll, limit, function(val, callback) {
        _iteratee(val, function(err /*, ...args*/) {
            if (err) return callback(err);
            return callback(null, slice(arguments, 1));
        });
    }, function(err, mapResults) {
        var result = [];
        for (var i = 0; i < mapResults.length; i++) {
            if (mapResults[i]) {
                result = _concat.apply(result, mapResults[i]);
            }
        }

        return callback(err, result);
    });
};

/**
 * Applies `iteratee` to each item in `coll`, concatenating the results. Returns
 * the concatenated list. The `iteratee`s are called in parallel, and the
 * results are concatenated as they return. There is no guarantee that the
 * results array will be returned in the original order of `coll` passed to the
 * `iteratee` function.
 *
 * @name concat
 * @static
 * @memberOf module:Collections
 * @method
 * @category Collection
 * @param {Array|Iterable|Object} coll - A collection to iterate over.
 * @param {AsyncFunction} iteratee - A function to apply to each item in `coll`,
 * which should use an array as its result. Invoked with (item, callback).
 * @param {Function} [callback(err)] - A callback which is called after all the
 * `iteratee` functions have finished, or an error occurs. Results is an array
 * containing the concatenated results of the `iteratee` function. Invoked with
 * (err, results).
 * @example
 *
 * async.concat(['dir1','dir2','dir3'], fs.readdir, function(err, files) {
 *     // files is now a list of filenames that exist in the 3 directories
 * });
 */
var concat = doLimit(concatLimit, Infinity);

/**
 * The same as [`concat`]{@link module:Collections.concat} but runs only a single async operation at a time.
 *
 * @name concatSeries
 * @static
 * @memberOf module:Collections
 * @method
 * @see [async.concat]{@link module:Collections.concat}
 * @category Collection
 * @param {Array|Iterable|Object} coll - A collection to iterate over.
 * @param {AsyncFunction} iteratee - A function to apply to each item in `coll`.
 * The iteratee should complete with an array an array of results.
 * Invoked with (item, callback).
 * @param {Function} [callback(err)] - A callback which is called after all the
 * `iteratee` functions have finished, or an error occurs. Results is an array
 * containing the concatenated results of the `iteratee` function. Invoked with
 * (err, results).
 */
var concatSeries = doLimit(concatLimit, 1);

/**
 * Returns a function that when called, calls-back with the values provided.
 * Useful as the first function in a [`waterfall`]{@link module:ControlFlow.waterfall}, or for plugging values in to
 * [`auto`]{@link module:ControlFlow.auto}.
 *
 * @name constant
 * @static
 * @memberOf module:Utils
 * @method
 * @category Util
 * @param {...*} arguments... - Any number of arguments to automatically invoke
 * callback with.
 * @returns {AsyncFunction} Returns a function that when invoked, automatically
 * invokes the callback with the previous given arguments.
 * @example
 *
 * async.waterfall([
 *     async.constant(42),
 *     function (value, next) {
 *         // value === 42
 *     },
 *     //...
 * ], callback);
 *
 * async.waterfall([
 *     async.constant(filename, "utf8"),
 *     fs.readFile,
 *     function (fileData, next) {
 *         //...
 *     }
 *     //...
 * ], callback);
 *
 * async.auto({
 *     hostname: async.constant("https://server.net/"),
 *     port: findFreePort,
 *     launchServer: ["hostname", "port", function (options, cb) {
 *         startServer(options, cb);
 *     }],
 *     //...
 * }, callback);
 */
var constant = function(/*...values*/) {
    var values = slice(arguments);
    var args = [null].concat(values);
    return function (/*...ignoredArgs, callback*/) {
        var callback = arguments[arguments.length - 1];
        return callback.apply(this, args);
    };
};

/**
 * This method returns the first argument it receives.
 *
 * @static
 * @since 0.1.0
 * @memberOf _
 * @category Util
 * @param {*} value Any value.
 * @returns {*} Returns `value`.
 * @example
 *
 * var object = { 'a': 1 };
 *
 * console.log(_.identity(object) === object);
 * // => true
 */
function identity(value) {
  return value;
}

function _createTester(check, getResult) {
    return function(eachfn, arr, iteratee, cb) {
        cb = cb || noop;
        var testPassed = false;
        var testResult;
        eachfn(arr, function(value, _, callback) {
            iteratee(value, function(err, result) {
                if (err) {
                    callback(err);
                } else if (check(result) && !testResult) {
                    testPassed = true;
                    testResult = getResult(true, value);
                    callback(null, breakLoop);
                } else {
                    callback();
                }
            });
        }, function(err) {
            if (err) {
                cb(err);
            } else {
                cb(null, testPassed ? testResult : getResult(false));
            }
        });
    };
}

function _findGetResult(v, x) {
    return x;
}

/**
 * Returns the first value in `coll` that passes an async truth test. The
 * `iteratee` is applied in parallel, meaning the first iteratee to return
 * `true` will fire the detect `callback` with that result. That means the
 * result might not be the first item in the original `coll` (in terms of order)
 * that passes the test.

 * If order within the original `coll` is important, then look at
 * [`detectSeries`]{@link module:Collections.detectSeries}.
 *
 * @name detect
 * @static
 * @memberOf module:Collections
 * @method
 * @alias find
 * @category Collections
 * @param {Array|Iterable|Object} coll - A collection to iterate over.
 * @param {AsyncFunction} iteratee - A truth test to apply to each item in `coll`.
 * The iteratee must complete with a boolean value as its result.
 * Invoked with (item, callback).
 * @param {Function} [callback] - A callback which is called as soon as any
 * iteratee returns `true`, or after all the `iteratee` functions have finished.
 * Result will be the first item in the array that passes the truth test
 * (iteratee) or the value `undefined` if none passed. Invoked with
 * (err, result).
 * @example
 *
 * async.detect(['file1','file2','file3'], function(filePath, callback) {
 *     fs.access(filePath, function(err) {
 *         callback(null, !err)
 *     });
 * }, function(err, result) {
 *     // result now equals the first file in the list that exists
 * });
 */
var detect = doParallel(_createTester(identity, _findGetResult));

/**
 * The same as [`detect`]{@link module:Collections.detect} but runs a maximum of `limit` async operations at a
 * time.
 *
 * @name detectLimit
 * @static
 * @memberOf module:Collections
 * @method
 * @see [async.detect]{@link module:Collections.detect}
 * @alias findLimit
 * @category Collections
 * @param {Array|Iterable|Object} coll - A collection to iterate over.
 * @param {number} limit - The maximum number of async operations at a time.
 * @param {AsyncFunction} iteratee - A truth test to apply to each item in `coll`.
 * The iteratee must complete with a boolean value as its result.
 * Invoked with (item, callback).
 * @param {Function} [callback] - A callback which is called as soon as any
 * iteratee returns `true`, or after all the `iteratee` functions have finished.
 * Result will be the first item in the array that passes the truth test
 * (iteratee) or the value `undefined` if none passed. Invoked with
 * (err, result).
 */
var detectLimit = doParallelLimit(_createTester(identity, _findGetResult));

/**
 * The same as [`detect`]{@link module:Collections.detect} but runs only a single async operation at a time.
 *
 * @name detectSeries
 * @static
 * @memberOf module:Collections
 * @method
 * @see [async.detect]{@link module:Collections.detect}
 * @alias findSeries
 * @category Collections
 * @param {Array|Iterable|Object} coll - A collection to iterate over.
 * @param {AsyncFunction} iteratee - A truth test to apply to each item in `coll`.
 * The iteratee must complete with a boolean value as its result.
 * Invoked with (item, callback).
 * @param {Function} [callback] - A callback which is called as soon as any
 * iteratee returns `true`, or after all the `iteratee` functions have finished.
 * Result will be the first item in the array that passes the truth test
 * (iteratee) or the value `undefined` if none passed. Invoked with
 * (err, result).
 */
var detectSeries = doLimit(detectLimit, 1);

function consoleFunc(name) {
    return function (fn/*, ...args*/) {
        var args = slice(arguments, 1);
        args.push(function (err/*, ...args*/) {
            var args = slice(arguments, 1);
            if (typeof console === 'object') {
                if (err) {
                    if (console.error) {
                        console.error(err);
                    }
                } else if (console[name]) {
                    arrayEach(args, function (x) {
                        console[name](x);
                    });
                }
            }
        });
        wrapAsync(fn).apply(null, args);
    };
}

/**
 * Logs the result of an [`async` function]{@link AsyncFunction} to the
 * `console` using `console.dir` to display the properties of the resulting object.
 * Only works in Node.js or in browsers that support `console.dir` and
 * `console.error` (such as FF and Chrome).
 * If multiple arguments are returned from the async function,
 * `console.dir` is called on each argument in order.
 *
 * @name dir
 * @static
 * @memberOf module:Utils
 * @method
 * @category Util
 * @param {AsyncFunction} function - The function you want to eventually apply
 * all arguments to.
 * @param {...*} arguments... - Any number of arguments to apply to the function.
 * @example
 *
 * // in a module
 * var hello = function(name, callback) {
 *     setTimeout(function() {
 *         callback(null, {hello: name});
 *     }, 1000);
 * };
 *
 * // in the node repl
 * node> async.dir(hello, 'world');
 * {hello: 'world'}
 */
var dir = consoleFunc('dir');

/**
 * The post-check version of [`during`]{@link module:ControlFlow.during}. To reflect the difference in
 * the order of operations, the arguments `test` and `fn` are switched.
 *
 * Also a version of [`doWhilst`]{@link module:ControlFlow.doWhilst} with asynchronous `test` function.
 * @name doDuring
 * @static
 * @memberOf module:ControlFlow
 * @method
 * @see [async.during]{@link module:ControlFlow.during}
 * @category Control Flow
 * @param {AsyncFunction} fn - An async function which is called each time
 * `test` passes. Invoked with (callback).
 * @param {AsyncFunction} test - asynchronous truth test to perform before each
 * execution of `fn`. Invoked with (...args, callback), where `...args` are the
 * non-error args from the previous callback of `fn`.
 * @param {Function} [callback] - A callback which is called after the test
 * function has failed and repeated execution of `fn` has stopped. `callback`
 * will be passed an error if one occurred, otherwise `null`.
 */
function doDuring(fn, test, callback) {
    callback = onlyOnce(callback || noop);
    var _fn = wrapAsync(fn);
    var _test = wrapAsync(test);

    function next(err/*, ...args*/) {
        if (err) return callback(err);
        var args = slice(arguments, 1);
        args.push(check);
        _test.apply(this, args);
    }

    function check(err, truth) {
        if (err) return callback(err);
        if (!truth) return callback(null);
        _fn(next);
    }

    check(null, true);

}

/**
 * The post-check version of [`whilst`]{@link module:ControlFlow.whilst}. To reflect the difference in
 * the order of operations, the arguments `test` and `iteratee` are switched.
 *
 * `doWhilst` is to `whilst` as `do while` is to `while` in plain JavaScript.
 *
 * @name doWhilst
 * @static
 * @memberOf module:ControlFlow
 * @method
 * @see [async.whilst]{@link module:ControlFlow.whilst}
 * @category Control Flow
 * @param {AsyncFunction} iteratee - A function which is called each time `test`
 * passes. Invoked with (callback).
 * @param {Function} test - synchronous truth test to perform after each
 * execution of `iteratee`. Invoked with any non-error callback results of
 * `iteratee`.
 * @param {Function} [callback] - A callback which is called after the test
 * function has failed and repeated execution of `iteratee` has stopped.
 * `callback` will be passed an error and any arguments passed to the final
 * `iteratee`'s callback. Invoked with (err, [results]);
 */
function doWhilst(iteratee, test, callback) {
    callback = onlyOnce(callback || noop);
    var _iteratee = wrapAsync(iteratee);
    var next = function(err/*, ...args*/) {
        if (err) return callback(err);
        var args = slice(arguments, 1);
        if (test.apply(this, args)) return _iteratee(next);
        callback.apply(null, [null].concat(args));
    };
    _iteratee(next);
}

/**
 * Like ['doWhilst']{@link module:ControlFlow.doWhilst}, except the `test` is inverted. Note the
 * argument ordering differs from `until`.
 *
 * @name doUntil
 * @static
 * @memberOf module:ControlFlow
 * @method
 * @see [async.doWhilst]{@link module:ControlFlow.doWhilst}
 * @category Control Flow
 * @param {AsyncFunction} iteratee - An async function which is called each time
 * `test` fails. Invoked with (callback).
 * @param {Function} test - synchronous truth test to perform after each
 * execution of `iteratee`. Invoked with any non-error callback results of
 * `iteratee`.
 * @param {Function} [callback] - A callback which is called after the test
 * function has passed and repeated execution of `iteratee` has stopped. `callback`
 * will be passed an error and any arguments passed to the final `iteratee`'s
 * callback. Invoked with (err, [results]);
 */
function doUntil(iteratee, test, callback) {
    doWhilst(iteratee, function() {
        return !test.apply(this, arguments);
    }, callback);
}

/**
 * Like [`whilst`]{@link module:ControlFlow.whilst}, except the `test` is an asynchronous function that
 * is passed a callback in the form of `function (err, truth)`. If error is
 * passed to `test` or `fn`, the main callback is immediately called with the
 * value of the error.
 *
 * @name during
 * @static
 * @memberOf module:ControlFlow
 * @method
 * @see [async.whilst]{@link module:ControlFlow.whilst}
 * @category Control Flow
 * @param {AsyncFunction} test - asynchronous truth test to perform before each
 * execution of `fn`. Invoked with (callback).
 * @param {AsyncFunction} fn - An async function which is called each time
 * `test` passes. Invoked with (callback).
 * @param {Function} [callback] - A callback which is called after the test
 * function has failed and repeated execution of `fn` has stopped. `callback`
 * will be passed an error, if one occurred, otherwise `null`.
 * @example
 *
 * var count = 0;
 *
 * async.during(
 *     function (callback) {
 *         return callback(null, count < 5);
 *     },
 *     function (callback) {
 *         count++;
 *         setTimeout(callback, 1000);
 *     },
 *     function (err) {
 *         // 5 seconds have passed
 *     }
 * );
 */
function during(test, fn, callback) {
    callback = onlyOnce(callback || noop);
    var _fn = wrapAsync(fn);
    var _test = wrapAsync(test);

    function next(err) {
        if (err) return callback(err);
        _test(check);
    }

    function check(err, truth) {
        if (err) return callback(err);
        if (!truth) return callback(null);
        _fn(next);
    }

    _test(check);
}

function _withoutIndex(iteratee) {
    return function (value, index, callback) {
        return iteratee(value, callback);
    };
}

/**
 * Applies the function `iteratee` to each item in `coll`, in parallel.
 * The `iteratee` is called with an item from the list, and a callback for when
 * it has finished. If the `iteratee` passes an error to its `callback`, the
 * main `callback` (for the `each` function) is immediately called with the
 * error.
 *
 * Note, that since this function applies `iteratee` to each item in parallel,
 * there is no guarantee that the iteratee functions will complete in order.
 *
 * @name each
 * @static
 * @memberOf module:Collections
 * @method
 * @alias forEach
 * @category Collection
 * @param {Array|Iterable|Object} coll - A collection to iterate over.
 * @param {AsyncFunction} iteratee - An async function to apply to
 * each item in `coll`. Invoked with (item, callback).
 * The array index is not passed to the iteratee.
 * If you need the index, use `eachOf`.
 * @param {Function} [callback] - A callback which is called when all
 * `iteratee` functions have finished, or an error occurs. Invoked with (err).
 * @example
 *
 * // assuming openFiles is an array of file names and saveFile is a function
 * // to save the modified contents of that file:
 *
 * async.each(openFiles, saveFile, function(err){
 *   // if any of the saves produced an error, err would equal that error
 * });
 *
 * // assuming openFiles is an array of file names
 * async.each(openFiles, function(file, callback) {
 *
 *     // Perform operation on file here.
 *     console.log('Processing file ' + file);
 *
 *     if( file.length > 32 ) {
 *       console.log('This file name is too long');
 *       callback('File name too long');
 *     } else {
 *       // Do work to process file here
 *       console.log('File processed');
 *       callback();
 *     }
 * }, function(err) {
 *     // if any of the file processing produced an error, err would equal that error
 *     if( err ) {
 *       // One of the iterations produced an error.
 *       // All processing will now stop.
 *       console.log('A file failed to process');
 *     } else {
 *       console.log('All files have been processed successfully');
 *     }
 * });
 */
function eachLimit(coll, iteratee, callback) {
    eachOf(coll, _withoutIndex(wrapAsync(iteratee)), callback);
}

/**
 * The same as [`each`]{@link module:Collections.each} but runs a maximum of `limit` async operations at a time.
 *
 * @name eachLimit
 * @static
 * @memberOf module:Collections
 * @method
 * @see [async.each]{@link module:Collections.each}
 * @alias forEachLimit
 * @category Collection
 * @param {Array|Iterable|Object} coll - A collection to iterate over.
 * @param {number} limit - The maximum number of async operations at a time.
 * @param {AsyncFunction} iteratee - An async function to apply to each item in
 * `coll`.
 * The array index is not passed to the iteratee.
 * If you need the index, use `eachOfLimit`.
 * Invoked with (item, callback).
 * @param {Function} [callback] - A callback which is called when all
 * `iteratee` functions have finished, or an error occurs. Invoked with (err).
 */
function eachLimit$1(coll, limit, iteratee, callback) {
    _eachOfLimit(limit)(coll, _withoutIndex(wrapAsync(iteratee)), callback);
}

/**
 * The same as [`each`]{@link module:Collections.each} but runs only a single async operation at a time.
 *
 * @name eachSeries
 * @static
 * @memberOf module:Collections
 * @method
 * @see [async.each]{@link module:Collections.each}
 * @alias forEachSeries
 * @category Collection
 * @param {Array|Iterable|Object} coll - A collection to iterate over.
 * @param {AsyncFunction} iteratee - An async function to apply to each
 * item in `coll`.
 * The array index is not passed to the iteratee.
 * If you need the index, use `eachOfSeries`.
 * Invoked with (item, callback).
 * @param {Function} [callback] - A callback which is called when all
 * `iteratee` functions have finished, or an error occurs. Invoked with (err).
 */
var eachSeries = doLimit(eachLimit$1, 1);

/**
 * Wrap an async function and ensure it calls its callback on a later tick of
 * the event loop.  If the function already calls its callback on a next tick,
 * no extra deferral is added. This is useful for preventing stack overflows
 * (`RangeError: Maximum call stack size exceeded`) and generally keeping
 * [Zalgo](http://blog.izs.me/post/59142742143/designing-apis-for-asynchrony)
 * contained. ES2017 `async` functions are returned as-is -- they are immune
 * to Zalgo's corrupting influences, as they always resolve on a later tick.
 *
 * @name ensureAsync
 * @static
 * @memberOf module:Utils
 * @method
 * @category Util
 * @param {AsyncFunction} fn - an async function, one that expects a node-style
 * callback as its last argument.
 * @returns {AsyncFunction} Returns a wrapped function with the exact same call
 * signature as the function passed in.
 * @example
 *
 * function sometimesAsync(arg, callback) {
 *     if (cache[arg]) {
 *         return callback(null, cache[arg]); // this would be synchronous!!
 *     } else {
 *         doSomeIO(arg, callback); // this IO would be asynchronous
 *     }
 * }
 *
 * // this has a risk of stack overflows if many results are cached in a row
 * async.mapSeries(args, sometimesAsync, done);
 *
 * // this will defer sometimesAsync's callback if necessary,
 * // preventing stack overflows
 * async.mapSeries(args, async.ensureAsync(sometimesAsync), done);
 */
function ensureAsync(fn) {
    if (isAsync(fn)) return fn;
    return initialParams(function (args, callback) {
        var sync = true;
        args.push(function () {
            var innerArgs = arguments;
            if (sync) {
                setImmediate$1(function () {
                    callback.apply(null, innerArgs);
                });
            } else {
                callback.apply(null, innerArgs);
            }
        });
        fn.apply(this, args);
        sync = false;
    });
}

function notId(v) {
    return !v;
}

/**
 * Returns `true` if every element in `coll` satisfies an async test. If any
 * iteratee call returns `false`, the main `callback` is immediately called.
 *
 * @name every
 * @static
 * @memberOf module:Collections
 * @method
 * @alias all
 * @category Collection
 * @param {Array|Iterable|Object} coll - A collection to iterate over.
 * @param {AsyncFunction} iteratee - An async truth test to apply to each item
 * in the collection in parallel.
 * The iteratee must complete with a boolean result value.
 * Invoked with (item, callback).
 * @param {Function} [callback] - A callback which is called after all the
 * `iteratee` functions have finished. Result will be either `true` or `false`
 * depending on the values of the async tests. Invoked with (err, result).
 * @example
 *
 * async.every(['file1','file2','file3'], function(filePath, callback) {
 *     fs.access(filePath, function(err) {
 *         callback(null, !err)
 *     });
 * }, function(err, result) {
 *     // if result is true then every file exists
 * });
 */
var every = doParallel(_createTester(notId, notId));

/**
 * The same as [`every`]{@link module:Collections.every} but runs a maximum of `limit` async operations at a time.
 *
 * @name everyLimit
 * @static
 * @memberOf module:Collections
 * @method
 * @see [async.every]{@link module:Collections.every}
 * @alias allLimit
 * @category Collection
 * @param {Array|Iterable|Object} coll - A collection to iterate over.
 * @param {number} limit - The maximum number of async operations at a time.
 * @param {AsyncFunction} iteratee - An async truth test to apply to each item
 * in the collection in parallel.
 * The iteratee must complete with a boolean result value.
 * Invoked with (item, callback).
 * @param {Function} [callback] - A callback which is called after all the
 * `iteratee` functions have finished. Result will be either `true` or `false`
 * depending on the values of the async tests. Invoked with (err, result).
 */
var everyLimit = doParallelLimit(_createTester(notId, notId));

/**
 * The same as [`every`]{@link module:Collections.every} but runs only a single async operation at a time.
 *
 * @name everySeries
 * @static
 * @memberOf module:Collections
 * @method
 * @see [async.every]{@link module:Collections.every}
 * @alias allSeries
 * @category Collection
 * @param {Array|Iterable|Object} coll - A collection to iterate over.
 * @param {AsyncFunction} iteratee - An async truth test to apply to each item
 * in the collection in series.
 * The iteratee must complete with a boolean result value.
 * Invoked with (item, callback).
 * @param {Function} [callback] - A callback which is called after all the
 * `iteratee` functions have finished. Result will be either `true` or `false`
 * depending on the values of the async tests. Invoked with (err, result).
 */
var everySeries = doLimit(everyLimit, 1);

/**
 * The base implementation of `_.property` without support for deep paths.
 *
 * @private
 * @param {string} key The key of the property to get.
 * @returns {Function} Returns the new accessor function.
 */
function baseProperty(key) {
  return function(object) {
    return object == null ? undefined : object[key];
  };
}

function filterArray(eachfn, arr, iteratee, callback) {
    var truthValues = new Array(arr.length);
    eachfn(arr, function (x, index, callback) {
        iteratee(x, function (err, v) {
            truthValues[index] = !!v;
            callback(err);
        });
    }, function (err) {
        if (err) return callback(err);
        var results = [];
        for (var i = 0; i < arr.length; i++) {
            if (truthValues[i]) results.push(arr[i]);
        }
        callback(null, results);
    });
}

function filterGeneric(eachfn, coll, iteratee, callback) {
    var results = [];
    eachfn(coll, function (x, index, callback) {
        iteratee(x, function (err, v) {
            if (err) {
                callback(err);
            } else {
                if (v) {
                    results.push({index: index, value: x});
                }
                callback();
            }
        });
    }, function (err) {
        if (err) {
            callback(err);
        } else {
            callback(null, arrayMap(results.sort(function (a, b) {
                return a.index - b.index;
            }), baseProperty('value')));
        }
    });
}

function _filter(eachfn, coll, iteratee, callback) {
    var filter = isArrayLike(coll) ? filterArray : filterGeneric;
    filter(eachfn, coll, wrapAsync(iteratee), callback || noop);
}

/**
 * Returns a new array of all the values in `coll` which pass an async truth
 * test. This operation is performed in parallel, but the results array will be
 * in the same order as the original.
 *
 * @name filter
 * @static
 * @memberOf module:Collections
 * @method
 * @alias select
 * @category Collection
 * @param {Array|Iterable|Object} coll - A collection to iterate over.
 * @param {Function} iteratee - A truth test to apply to each item in `coll`.
 * The `iteratee` is passed a `callback(err, truthValue)`, which must be called
 * with a boolean argument once it has completed. Invoked with (item, callback).
 * @param {Function} [callback] - A callback which is called after all the
 * `iteratee` functions have finished. Invoked with (err, results).
 * @example
 *
 * async.filter(['file1','file2','file3'], function(filePath, callback) {
 *     fs.access(filePath, function(err) {
 *         callback(null, !err)
 *     });
 * }, function(err, results) {
 *     // results now equals an array of the existing files
 * });
 */
var filter = doParallel(_filter);

/**
 * The same as [`filter`]{@link module:Collections.filter} but runs a maximum of `limit` async operations at a
 * time.
 *
 * @name filterLimit
 * @static
 * @memberOf module:Collections
 * @method
 * @see [async.filter]{@link module:Collections.filter}
 * @alias selectLimit
 * @category Collection
 * @param {Array|Iterable|Object} coll - A collection to iterate over.
 * @param {number} limit - The maximum number of async operations at a time.
 * @param {Function} iteratee - A truth test to apply to each item in `coll`.
 * The `iteratee` is passed a `callback(err, truthValue)`, which must be called
 * with a boolean argument once it has completed. Invoked with (item, callback).
 * @param {Function} [callback] - A callback which is called after all the
 * `iteratee` functions have finished. Invoked with (err, results).
 */
var filterLimit = doParallelLimit(_filter);

/**
 * The same as [`filter`]{@link module:Collections.filter} but runs only a single async operation at a time.
 *
 * @name filterSeries
 * @static
 * @memberOf module:Collections
 * @method
 * @see [async.filter]{@link module:Collections.filter}
 * @alias selectSeries
 * @category Collection
 * @param {Array|Iterable|Object} coll - A collection to iterate over.
 * @param {Function} iteratee - A truth test to apply to each item in `coll`.
 * The `iteratee` is passed a `callback(err, truthValue)`, which must be called
 * with a boolean argument once it has completed. Invoked with (item, callback).
 * @param {Function} [callback] - A callback which is called after all the
 * `iteratee` functions have finished. Invoked with (err, results)
 */
var filterSeries = doLimit(filterLimit, 1);

/**
 * Calls the asynchronous function `fn` with a callback parameter that allows it
 * to call itself again, in series, indefinitely.

 * If an error is passed to the callback then `errback` is called with the
 * error, and execution stops, otherwise it will never be called.
 *
 * @name forever
 * @static
 * @memberOf module:ControlFlow
 * @method
 * @category Control Flow
 * @param {AsyncFunction} fn - an async function to call repeatedly.
 * Invoked with (next).
 * @param {Function} [errback] - when `fn` passes an error to it's callback,
 * this function will be called, and execution stops. Invoked with (err).
 * @example
 *
 * async.forever(
 *     function(next) {
 *         // next is suitable for passing to things that need a callback(err [, whatever]);
 *         // it will result in this function being called again.
 *     },
 *     function(err) {
 *         // if next is called with a value in its first parameter, it will appear
 *         // in here as 'err', and execution will stop.
 *     }
 * );
 */
function forever(fn, errback) {
    var done = onlyOnce(errback || noop);
    var task = wrapAsync(ensureAsync(fn));

    function next(err) {
        if (err) return done(err);
        task(next);
    }
    next();
}

/**
 * The same as [`groupBy`]{@link module:Collections.groupBy} but runs a maximum of `limit` async operations at a time.
 *
 * @name groupByLimit
 * @static
 * @memberOf module:Collections
 * @method
 * @see [async.groupBy]{@link module:Collections.groupBy}
 * @category Collection
 * @param {Array|Iterable|Object} coll - A collection to iterate over.
 * @param {number} limit - The maximum number of async operations at a time.
 * @param {AsyncFunction} iteratee - An async function to apply to each item in
 * `coll`.
 * The iteratee should complete with a `key` to group the value under.
 * Invoked with (value, callback).
 * @param {Function} [callback] - A callback which is called when all `iteratee`
 * functions have finished, or an error occurs. Result is an `Object` whoses
 * properties are arrays of values which returned the corresponding key.
 */
var groupByLimit = function(coll, limit, iteratee, callback) {
    callback = callback || noop;
    var _iteratee = wrapAsync(iteratee);
    mapLimit(coll, limit, function(val, callback) {
        _iteratee(val, function(err, key) {
            if (err) return callback(err);
            return callback(null, {key: key, val: val});
        });
    }, function(err, mapResults) {
        var result = {};
        // from MDN, handle object having an `hasOwnProperty` prop
        var hasOwnProperty = Object.prototype.hasOwnProperty;

        for (var i = 0; i < mapResults.length; i++) {
            if (mapResults[i]) {
                var key = mapResults[i].key;
                var val = mapResults[i].val;

                if (hasOwnProperty.call(result, key)) {
                    result[key].push(val);
                } else {
                    result[key] = [val];
                }
            }
        }

        return callback(err, result);
    });
};

/**
 * Returns a new object, where each value corresponds to an array of items, from
 * `coll`, that returned the corresponding key. That is, the keys of the object
 * correspond to the values passed to the `iteratee` callback.
 *
 * Note: Since this function applies the `iteratee` to each item in parallel,
 * there is no guarantee that the `iteratee` functions will complete in order.
 * However, the values for each key in the `result` will be in the same order as
 * the original `coll`. For Objects, the values will roughly be in the order of
 * the original Objects' keys (but this can vary across JavaScript engines).
 *
 * @name groupBy
 * @static
 * @memberOf module:Collections
 * @method
 * @category Collection
 * @param {Array|Iterable|Object} coll - A collection to iterate over.
 * @param {AsyncFunction} iteratee - An async function to apply to each item in
 * `coll`.
 * The iteratee should complete with a `key` to group the value under.
 * Invoked with (value, callback).
 * @param {Function} [callback] - A callback which is called when all `iteratee`
 * functions have finished, or an error occurs. Result is an `Object` whoses
 * properties are arrays of values which returned the corresponding key.
 * @example
 *
 * async.groupBy(['userId1', 'userId2', 'userId3'], function(userId, callback) {
 *     db.findById(userId, function(err, user) {
 *         if (err) return callback(err);
 *         return callback(null, user.age);
 *     });
 * }, function(err, result) {
 *     // result is object containing the userIds grouped by age
 *     // e.g. { 30: ['userId1', 'userId3'], 42: ['userId2']};
 * });
 */
var groupBy = doLimit(groupByLimit, Infinity);

/**
 * The same as [`groupBy`]{@link module:Collections.groupBy} but runs only a single async operation at a time.
 *
 * @name groupBySeries
 * @static
 * @memberOf module:Collections
 * @method
 * @see [async.groupBy]{@link module:Collections.groupBy}
 * @category Collection
 * @param {Array|Iterable|Object} coll - A collection to iterate over.
 * @param {number} limit - The maximum number of async operations at a time.
 * @param {AsyncFunction} iteratee - An async function to apply to each item in
 * `coll`.
 * The iteratee should complete with a `key` to group the value under.
 * Invoked with (value, callback).
 * @param {Function} [callback] - A callback which is called when all `iteratee`
 * functions have finished, or an error occurs. Result is an `Object` whoses
 * properties are arrays of values which returned the corresponding key.
 */
var groupBySeries = doLimit(groupByLimit, 1);

/**
 * Logs the result of an `async` function to the `console`. Only works in
 * Node.js or in browsers that support `console.log` and `console.error` (such
 * as FF and Chrome). If multiple arguments are returned from the async
 * function, `console.log` is called on each argument in order.
 *
 * @name log
 * @static
 * @memberOf module:Utils
 * @method
 * @category Util
 * @param {AsyncFunction} function - The function you want to eventually apply
 * all arguments to.
 * @param {...*} arguments... - Any number of arguments to apply to the function.
 * @example
 *
 * // in a module
 * var hello = function(name, callback) {
 *     setTimeout(function() {
 *         callback(null, 'hello ' + name);
 *     }, 1000);
 * };
 *
 * // in the node repl
 * node> async.log(hello, 'world');
 * 'hello world'
 */
var log = consoleFunc('log');

/**
 * The same as [`mapValues`]{@link module:Collections.mapValues} but runs a maximum of `limit` async operations at a
 * time.
 *
 * @name mapValuesLimit
 * @static
 * @memberOf module:Collections
 * @method
 * @see [async.mapValues]{@link module:Collections.mapValues}
 * @category Collection
 * @param {Object} obj - A collection to iterate over.
 * @param {number} limit - The maximum number of async operations at a time.
 * @param {AsyncFunction} iteratee - A function to apply to each value and key
 * in `coll`.
 * The iteratee should complete with the transformed value as its result.
 * Invoked with (value, key, callback).
 * @param {Function} [callback] - A callback which is called when all `iteratee`
 * functions have finished, or an error occurs. `result` is a new object consisting
 * of each key from `obj`, with each transformed value on the right-hand side.
 * Invoked with (err, result).
 */
function mapValuesLimit(obj, limit, iteratee, callback) {
    callback = once(callback || noop);
    var newObj = {};
    var _iteratee = wrapAsync(iteratee);
    eachOfLimit(obj, limit, function(val, key, next) {
        _iteratee(val, key, function (err, result) {
            if (err) return next(err);
            newObj[key] = result;
            next();
        });
    }, function (err) {
        callback(err, newObj);
    });
}

/**
 * A relative of [`map`]{@link module:Collections.map}, designed for use with objects.
 *
 * Produces a new Object by mapping each value of `obj` through the `iteratee`
 * function. The `iteratee` is called each `value` and `key` from `obj` and a
 * callback for when it has finished processing. Each of these callbacks takes
 * two arguments: an `error`, and the transformed item from `obj`. If `iteratee`
 * passes an error to its callback, the main `callback` (for the `mapValues`
 * function) is immediately called with the error.
 *
 * Note, the order of the keys in the result is not guaranteed.  The keys will
 * be roughly in the order they complete, (but this is very engine-specific)
 *
 * @name mapValues
 * @static
 * @memberOf module:Collections
 * @method
 * @category Collection
 * @param {Object} obj - A collection to iterate over.
 * @param {AsyncFunction} iteratee - A function to apply to each value and key
 * in `coll`.
 * The iteratee should complete with the transformed value as its result.
 * Invoked with (value, key, callback).
 * @param {Function} [callback] - A callback which is called when all `iteratee`
 * functions have finished, or an error occurs. `result` is a new object consisting
 * of each key from `obj`, with each transformed value on the right-hand side.
 * Invoked with (err, result).
 * @example
 *
 * async.mapValues({
 *     f1: 'file1',
 *     f2: 'file2',
 *     f3: 'file3'
 * }, function (file, key, callback) {
 *   fs.stat(file, callback);
 * }, function(err, result) {
 *     // result is now a map of stats for each file, e.g.
 *     // {
 *     //     f1: [stats for file1],
 *     //     f2: [stats for file2],
 *     //     f3: [stats for file3]
 *     // }
 * });
 */

var mapValues = doLimit(mapValuesLimit, Infinity);

/**
 * The same as [`mapValues`]{@link module:Collections.mapValues} but runs only a single async operation at a time.
 *
 * @name mapValuesSeries
 * @static
 * @memberOf module:Collections
 * @method
 * @see [async.mapValues]{@link module:Collections.mapValues}
 * @category Collection
 * @param {Object} obj - A collection to iterate over.
 * @param {AsyncFunction} iteratee - A function to apply to each value and key
 * in `coll`.
 * The iteratee should complete with the transformed value as its result.
 * Invoked with (value, key, callback).
 * @param {Function} [callback] - A callback which is called when all `iteratee`
 * functions have finished, or an error occurs. `result` is a new object consisting
 * of each key from `obj`, with each transformed value on the right-hand side.
 * Invoked with (err, result).
 */
var mapValuesSeries = doLimit(mapValuesLimit, 1);

function has(obj, key) {
    return key in obj;
}

/**
 * Caches the results of an async function. When creating a hash to store
 * function results against, the callback is omitted from the hash and an
 * optional hash function can be used.
 *
 * If no hash function is specified, the first argument is used as a hash key,
 * which may work reasonably if it is a string or a data type that converts to a
 * distinct string. Note that objects and arrays will not behave reasonably.
 * Neither will cases where the other arguments are significant. In such cases,
 * specify your own hash function.
 *
 * The cache of results is exposed as the `memo` property of the function
 * returned by `memoize`.
 *
 * @name memoize
 * @static
 * @memberOf module:Utils
 * @method
 * @category Util
 * @param {AsyncFunction} fn - The async function to proxy and cache results from.
 * @param {Function} hasher - An optional function for generating a custom hash
 * for storing results. It has all the arguments applied to it apart from the
 * callback, and must be synchronous.
 * @returns {AsyncFunction} a memoized version of `fn`
 * @example
 *
 * var slow_fn = function(name, callback) {
 *     // do something
 *     callback(null, result);
 * };
 * var fn = async.memoize(slow_fn);
 *
 * // fn can now be used as if it were slow_fn
 * fn('some name', function() {
 *     // callback
 * });
 */
function memoize(fn, hasher) {
    var memo = Object.create(null);
    var queues = Object.create(null);
    hasher = hasher || identity;
    var _fn = wrapAsync(fn);
    var memoized = initialParams(function memoized(args, callback) {
        var key = hasher.apply(null, args);
        if (has(memo, key)) {
            setImmediate$1(function() {
                callback.apply(null, memo[key]);
            });
        } else if (has(queues, key)) {
            queues[key].push(callback);
        } else {
            queues[key] = [callback];
            _fn.apply(null, args.concat(function(/*args*/) {
                var args = slice(arguments);
                memo[key] = args;
                var q = queues[key];
                delete queues[key];
                for (var i = 0, l = q.length; i < l; i++) {
                    q[i].apply(null, args);
                }
            }));
        }
    });
    memoized.memo = memo;
    memoized.unmemoized = fn;
    return memoized;
}

/**
 * Calls `callback` on a later loop around the event loop. In Node.js this just
 * calls `process.nextTicl`.  In the browser it will use `setImmediate` if
 * available, otherwise `setTimeout(callback, 0)`, which means other higher
 * priority events may precede the execution of `callback`.
 *
 * This is used internally for browser-compatibility purposes.
 *
 * @name nextTick
 * @static
 * @memberOf module:Utils
 * @method
 * @see [async.setImmediate]{@link module:Utils.setImmediate}
 * @category Util
 * @param {Function} callback - The function to call on a later loop around
 * the event loop. Invoked with (args...).
 * @param {...*} args... - any number of additional arguments to pass to the
 * callback on the next tick.
 * @example
 *
 * var call_order = [];
 * async.nextTick(function() {
 *     call_order.push('two');
 *     // call_order now equals ['one','two']
 * });
 * call_order.push('one');
 *
 * async.setImmediate(function (a, b, c) {
 *     // a, b, and c equal 1, 2, and 3
 * }, 1, 2, 3);
 */
var _defer$1;

if (hasNextTick) {
    _defer$1 = process.nextTick;
} else if (hasSetImmediate) {
    _defer$1 = setImmediate;
} else {
    _defer$1 = fallback;
}

var nextTick = wrap(_defer$1);

function _parallel(eachfn, tasks, callback) {
    callback = callback || noop;
    var results = isArrayLike(tasks) ? [] : {};

    eachfn(tasks, function (task, key, callback) {
        wrapAsync(task)(function (err, result) {
            if (arguments.length > 2) {
                result = slice(arguments, 1);
            }
            results[key] = result;
            callback(err);
        });
    }, function (err) {
        callback(err, results);
    });
}

/**
 * Run the `tasks` collection of functions in parallel, without waiting until
 * the previous function has completed. If any of the functions pass an error to
 * its callback, the main `callback` is immediately called with the value of the
 * error. Once the `tasks` have completed, the results are passed to the final
 * `callback` as an array.
 *
 * **Note:** `parallel` is about kicking-off I/O tasks in parallel, not about
 * parallel execution of code.  If your tasks do not use any timers or perform
 * any I/O, they will actually be executed in series.  Any synchronous setup
 * sections for each task will happen one after the other.  JavaScript remains
 * single-threaded.
 *
 * **Hint:** Use [`reflect`]{@link module:Utils.reflect} to continue the
 * execution of other tasks when a task fails.
 *
 * It is also possible to use an object instead of an array. Each property will
 * be run as a function and the results will be passed to the final `callback`
 * as an object instead of an array. This can be a more readable way of handling
 * results from {@link async.parallel}.
 *
 * @name parallel
 * @static
 * @memberOf module:ControlFlow
 * @method
 * @category Control Flow
 * @param {Array|Iterable|Object} tasks - A collection of
 * [async functions]{@link AsyncFunction} to run.
 * Each async function can complete with any number of optional `result` values.
 * @param {Function} [callback] - An optional callback to run once all the
 * functions have completed successfully. This function gets a results array
 * (or object) containing all the result arguments passed to the task callbacks.
 * Invoked with (err, results).
 *
 * @example
 * async.parallel([
 *     function(callback) {
 *         setTimeout(function() {
 *             callback(null, 'one');
 *         }, 200);
 *     },
 *     function(callback) {
 *         setTimeout(function() {
 *             callback(null, 'two');
 *         }, 100);
 *     }
 * ],
 * // optional callback
 * function(err, results) {
 *     // the results array will equal ['one','two'] even though
 *     // the second function had a shorter timeout.
 * });
 *
 * // an example using an object instead of an array
 * async.parallel({
 *     one: function(callback) {
 *         setTimeout(function() {
 *             callback(null, 1);
 *         }, 200);
 *     },
 *     two: function(callback) {
 *         setTimeout(function() {
 *             callback(null, 2);
 *         }, 100);
 *     }
 * }, function(err, results) {
 *     // results is now equals to: {one: 1, two: 2}
 * });
 */
function parallelLimit(tasks, callback) {
    _parallel(eachOf, tasks, callback);
}

/**
 * The same as [`parallel`]{@link module:ControlFlow.parallel} but runs a maximum of `limit` async operations at a
 * time.
 *
 * @name parallelLimit
 * @static
 * @memberOf module:ControlFlow
 * @method
 * @see [async.parallel]{@link module:ControlFlow.parallel}
 * @category Control Flow
 * @param {Array|Iterable|Object} tasks - A collection of
 * [async functions]{@link AsyncFunction} to run.
 * Each async function can complete with any number of optional `result` values.
 * @param {number} limit - The maximum number of async operations at a time.
 * @param {Function} [callback] - An optional callback to run once all the
 * functions have completed successfully. This function gets a results array
 * (or object) containing all the result arguments passed to the task callbacks.
 * Invoked with (err, results).
 */
function parallelLimit$1(tasks, limit, callback) {
    _parallel(_eachOfLimit(limit), tasks, callback);
}

/**
 * A queue of tasks for the worker function to complete.
 * @typedef {Object} QueueObject
 * @memberOf module:ControlFlow
 * @property {Function} length - a function returning the number of items
 * waiting to be processed. Invoke with `queue.length()`.
 * @property {boolean} started - a boolean indicating whether or not any
 * items have been pushed and processed by the queue.
 * @property {Function} running - a function returning the number of items
 * currently being processed. Invoke with `queue.running()`.
 * @property {Function} workersList - a function returning the array of items
 * currently being processed. Invoke with `queue.workersList()`.
 * @property {Function} idle - a function returning false if there are items
 * waiting or being processed, or true if not. Invoke with `queue.idle()`.
 * @property {number} concurrency - an integer for determining how many `worker`
 * functions should be run in parallel. This property can be changed after a
 * `queue` is created to alter the concurrency on-the-fly.
 * @property {Function} push - add a new task to the `queue`. Calls `callback`
 * once the `worker` has finished processing the task. Instead of a single task,
 * a `tasks` array can be submitted. The respective callback is used for every
 * task in the list. Invoke with `queue.push(task, [callback])`,
 * @property {Function} unshift - add a new task to the front of the `queue`.
 * Invoke with `queue.unshift(task, [callback])`.
 * @property {Function} remove - remove items from the queue that match a test
 * function.  The test function will be passed an object with a `data` property,
 * and a `priority` property, if this is a
 * [priorityQueue]{@link module:ControlFlow.priorityQueue} object.
 * Invoked with `queue.remove(testFn)`, where `testFn` is of the form
 * `function ({data, priority}) {}` and returns a Boolean.
 * @property {Function} saturated - a callback that is called when the number of
 * running workers hits the `concurrency` limit, and further tasks will be
 * queued.
 * @property {Function} unsaturated - a callback that is called when the number
 * of running workers is less than the `concurrency` & `buffer` limits, and
 * further tasks will not be queued.
 * @property {number} buffer - A minimum threshold buffer in order to say that
 * the `queue` is `unsaturated`.
 * @property {Function} empty - a callback that is called when the last item
 * from the `queue` is given to a `worker`.
 * @property {Function} drain - a callback that is called when the last item
 * from the `queue` has returned from the `worker`.
 * @property {Function} error - a callback that is called when a task errors.
 * Has the signature `function(error, task)`.
 * @property {boolean} paused - a boolean for determining whether the queue is
 * in a paused state.
 * @property {Function} pause - a function that pauses the processing of tasks
 * until `resume()` is called. Invoke with `queue.pause()`.
 * @property {Function} resume - a function that resumes the processing of
 * queued tasks when the queue is paused. Invoke with `queue.resume()`.
 * @property {Function} kill - a function that removes the `drain` callback and
 * empties remaining tasks from the queue forcing it to go idle. No more tasks
 * should be pushed to the queue after calling this function. Invoke with `queue.kill()`.
 */

/**
 * Creates a `queue` object with the specified `concurrency`. Tasks added to the
 * `queue` are processed in parallel (up to the `concurrency` limit). If all
 * `worker`s are in progress, the task is queued until one becomes available.
 * Once a `worker` completes a `task`, that `task`'s callback is called.
 *
 * @name queue
 * @static
 * @memberOf module:ControlFlow
 * @method
 * @category Control Flow
 * @param {AsyncFunction} worker - An async function for processing a queued task.
 * If you want to handle errors from an individual task, pass a callback to
 * `q.push()`. Invoked with (task, callback).
 * @param {number} [concurrency=1] - An `integer` for determining how many
 * `worker` functions should be run in parallel.  If omitted, the concurrency
 * defaults to `1`.  If the concurrency is `0`, an error is thrown.
 * @returns {module:ControlFlow.QueueObject} A queue object to manage the tasks. Callbacks can
 * attached as certain properties to listen for specific events during the
 * lifecycle of the queue.
 * @example
 *
 * // create a queue object with concurrency 2
 * var q = async.queue(function(task, callback) {
 *     console.log('hello ' + task.name);
 *     callback();
 * }, 2);
 *
 * // assign a callback
 * q.drain = function() {
 *     console.log('all items have been processed');
 * };
 *
 * // add some items to the queue
 * q.push({name: 'foo'}, function(err) {
 *     console.log('finished processing foo');
 * });
 * q.push({name: 'bar'}, function (err) {
 *     console.log('finished processing bar');
 * });
 *
 * // add some items to the queue (batch-wise)
 * q.push([{name: 'baz'},{name: 'bay'},{name: 'bax'}], function(err) {
 *     console.log('finished processing item');
 * });
 *
 * // add some items to the front of the queue
 * q.unshift({name: 'bar'}, function (err) {
 *     console.log('finished processing bar');
 * });
 */
var queue$1 = function (worker, concurrency) {
    var _worker = wrapAsync(worker);
    return queue(function (items, cb) {
        _worker(items[0], cb);
    }, concurrency, 1);
};

/**
 * The same as [async.queue]{@link module:ControlFlow.queue} only tasks are assigned a priority and
 * completed in ascending priority order.
 *
 * @name priorityQueue
 * @static
 * @memberOf module:ControlFlow
 * @method
 * @see [async.queue]{@link module:ControlFlow.queue}
 * @category Control Flow
 * @param {AsyncFunction} worker - An async function for processing a queued task.
 * If you want to handle errors from an individual task, pass a callback to
 * `q.push()`.
 * Invoked with (task, callback).
 * @param {number} concurrency - An `integer` for determining how many `worker`
 * functions should be run in parallel.  If omitted, the concurrency defaults to
 * `1`.  If the concurrency is `0`, an error is thrown.
 * @returns {module:ControlFlow.QueueObject} A priorityQueue object to manage the tasks. There are two
 * differences between `queue` and `priorityQueue` objects:
 * * `push(task, priority, [callback])` - `priority` should be a number. If an
 *   array of `tasks` is given, all tasks will be assigned the same priority.
 * * The `unshift` method was removed.
 */
var priorityQueue = function(worker, concurrency) {
    // Start with a normal queue
    var q = queue$1(worker, concurrency);

    // Override push to accept second parameter representing priority
    q.push = function(data, priority, callback) {
        if (callback == null) callback = noop;
        if (typeof callback !== 'function') {
            throw new Error('task callback must be a function');
        }
        q.started = true;
        if (!isArray(data)) {
            data = [data];
        }
        if (data.length === 0) {
            // call drain immediately if there are no tasks
            return setImmediate$1(function() {
                q.drain();
            });
        }

        priority = priority || 0;
        var nextNode = q._tasks.head;
        while (nextNode && priority >= nextNode.priority) {
            nextNode = nextNode.next;
        }

        for (var i = 0, l = data.length; i < l; i++) {
            var item = {
                data: data[i],
                priority: priority,
                callback: callback
            };

            if (nextNode) {
                q._tasks.insertBefore(nextNode, item);
            } else {
                q._tasks.push(item);
            }
        }
        setImmediate$1(q.process);
    };

    // Remove unshift function
    delete q.unshift;

    return q;
};

/**
 * Runs the `tasks` array of functions in parallel, without waiting until the
 * previous function has completed. Once any of the `tasks` complete or pass an
 * error to its callback, the main `callback` is immediately called. It's
 * equivalent to `Promise.race()`.
 *
 * @name race
 * @static
 * @memberOf module:ControlFlow
 * @method
 * @category Control Flow
 * @param {Array} tasks - An array containing [async functions]{@link AsyncFunction}
 * to run. Each function can complete with an optional `result` value.
 * @param {Function} callback - A callback to run once any of the functions have
 * completed. This function gets an error or result from the first function that
 * completed. Invoked with (err, result).
 * @returns undefined
 * @example
 *
 * async.race([
 *     function(callback) {
 *         setTimeout(function() {
 *             callback(null, 'one');
 *         }, 200);
 *     },
 *     function(callback) {
 *         setTimeout(function() {
 *             callback(null, 'two');
 *         }, 100);
 *     }
 * ],
 * // main callback
 * function(err, result) {
 *     // the result will be equal to 'two' as it finishes earlier
 * });
 */
function race(tasks, callback) {
    callback = once(callback || noop);
    if (!isArray(tasks)) return callback(new TypeError('First argument to race must be an array of functions'));
    if (!tasks.length) return callback();
    for (var i = 0, l = tasks.length; i < l; i++) {
        wrapAsync(tasks[i])(callback);
    }
}

/**
 * Same as [`reduce`]{@link module:Collections.reduce}, only operates on `array` in reverse order.
 *
 * @name reduceRight
 * @static
 * @memberOf module:Collections
 * @method
 * @see [async.reduce]{@link module:Collections.reduce}
 * @alias foldr
 * @category Collection
 * @param {Array} array - A collection to iterate over.
 * @param {*} memo - The initial state of the reduction.
 * @param {AsyncFunction} iteratee - A function applied to each item in the
 * array to produce the next step in the reduction.
 * The `iteratee` should complete with the next state of the reduction.
 * If the iteratee complete with an error, the reduction is stopped and the
 * main `callback` is immediately called with the error.
 * Invoked with (memo, item, callback).
 * @param {Function} [callback] - A callback which is called after all the
 * `iteratee` functions have finished. Result is the reduced value. Invoked with
 * (err, result).
 */
function reduceRight (array, memo, iteratee, callback) {
    var reversed = slice(array).reverse();
    reduce(reversed, memo, iteratee, callback);
}

/**
 * Wraps the async function in another function that always completes with a
 * result object, even when it errors.
 *
 * The result object has either the property `error` or `value`.
 *
 * @name reflect
 * @static
 * @memberOf module:Utils
 * @method
 * @category Util
 * @param {AsyncFunction} fn - The async function you want to wrap
 * @returns {Function} - A function that always passes null to it's callback as
 * the error. The second argument to the callback will be an `object` with
 * either an `error` or a `value` property.
 * @example
 *
 * async.parallel([
 *     async.reflect(function(callback) {
 *         // do some stuff ...
 *         callback(null, 'one');
 *     }),
 *     async.reflect(function(callback) {
 *         // do some more stuff but error ...
 *         callback('bad stuff happened');
 *     }),
 *     async.reflect(function(callback) {
 *         // do some more stuff ...
 *         callback(null, 'two');
 *     })
 * ],
 * // optional callback
 * function(err, results) {
 *     // values
 *     // results[0].value = 'one'
 *     // results[1].error = 'bad stuff happened'
 *     // results[2].value = 'two'
 * });
 */
function reflect(fn) {
    var _fn = wrapAsync(fn);
    return initialParams(function reflectOn(args, reflectCallback) {
        args.push(function callback(error, cbArg) {
            if (error) {
                reflectCallback(null, { error: error });
            } else {
                var value;
                if (arguments.length <= 2) {
                    value = cbArg;
                } else {
                    value = slice(arguments, 1);
                }
                reflectCallback(null, { value: value });
            }
        });

        return _fn.apply(this, args);
    });
}

/**
 * A helper function that wraps an array or an object of functions with `reflect`.
 *
 * @name reflectAll
 * @static
 * @memberOf module:Utils
 * @method
 * @see [async.reflect]{@link module:Utils.reflect}
 * @category Util
 * @param {Array|Object|Iterable} tasks - The collection of
 * [async functions]{@link AsyncFunction} to wrap in `async.reflect`.
 * @returns {Array} Returns an array of async functions, each wrapped in
 * `async.reflect`
 * @example
 *
 * let tasks = [
 *     function(callback) {
 *         setTimeout(function() {
 *             callback(null, 'one');
 *         }, 200);
 *     },
 *     function(callback) {
 *         // do some more stuff but error ...
 *         callback(new Error('bad stuff happened'));
 *     },
 *     function(callback) {
 *         setTimeout(function() {
 *             callback(null, 'two');
 *         }, 100);
 *     }
 * ];
 *
 * async.parallel(async.reflectAll(tasks),
 * // optional callback
 * function(err, results) {
 *     // values
 *     // results[0].value = 'one'
 *     // results[1].error = Error('bad stuff happened')
 *     // results[2].value = 'two'
 * });
 *
 * // an example using an object instead of an array
 * let tasks = {
 *     one: function(callback) {
 *         setTimeout(function() {
 *             callback(null, 'one');
 *         }, 200);
 *     },
 *     two: function(callback) {
 *         callback('two');
 *     },
 *     three: function(callback) {
 *         setTimeout(function() {
 *             callback(null, 'three');
 *         }, 100);
 *     }
 * };
 *
 * async.parallel(async.reflectAll(tasks),
 * // optional callback
 * function(err, results) {
 *     // values
 *     // results.one.value = 'one'
 *     // results.two.error = 'two'
 *     // results.three.value = 'three'
 * });
 */
function reflectAll(tasks) {
    var results;
    if (isArray(tasks)) {
        results = arrayMap(tasks, reflect);
    } else {
        results = {};
        baseForOwn(tasks, function(task, key) {
            results[key] = reflect.call(this, task);
        });
    }
    return results;
}

function reject$1(eachfn, arr, iteratee, callback) {
    _filter(eachfn, arr, function(value, cb) {
        iteratee(value, function(err, v) {
            cb(err, !v);
        });
    }, callback);
}

/**
 * The opposite of [`filter`]{@link module:Collections.filter}. Removes values that pass an `async` truth test.
 *
 * @name reject
 * @static
 * @memberOf module:Collections
 * @method
 * @see [async.filter]{@link module:Collections.filter}
 * @category Collection
 * @param {Array|Iterable|Object} coll - A collection to iterate over.
 * @param {Function} iteratee - An async truth test to apply to each item in
 * `coll`.
 * The should complete with a boolean value as its `result`.
 * Invoked with (item, callback).
 * @param {Function} [callback] - A callback which is called after all the
 * `iteratee` functions have finished. Invoked with (err, results).
 * @example
 *
 * async.reject(['file1','file2','file3'], function(filePath, callback) {
 *     fs.access(filePath, function(err) {
 *         callback(null, !err)
 *     });
 * }, function(err, results) {
 *     // results now equals an array of missing files
 *     createFiles(results);
 * });
 */
var reject = doParallel(reject$1);

/**
 * The same as [`reject`]{@link module:Collections.reject} but runs a maximum of `limit` async operations at a
 * time.
 *
 * @name rejectLimit
 * @static
 * @memberOf module:Collections
 * @method
 * @see [async.reject]{@link module:Collections.reject}
 * @category Collection
 * @param {Array|Iterable|Object} coll - A collection to iterate over.
 * @param {number} limit - The maximum number of async operations at a time.
 * @param {Function} iteratee - An async truth test to apply to each item in
 * `coll`.
 * The should complete with a boolean value as its `result`.
 * Invoked with (item, callback).
 * @param {Function} [callback] - A callback which is called after all the
 * `iteratee` functions have finished. Invoked with (err, results).
 */
var rejectLimit = doParallelLimit(reject$1);

/**
 * The same as [`reject`]{@link module:Collections.reject} but runs only a single async operation at a time.
 *
 * @name rejectSeries
 * @static
 * @memberOf module:Collections
 * @method
 * @see [async.reject]{@link module:Collections.reject}
 * @category Collection
 * @param {Array|Iterable|Object} coll - A collection to iterate over.
 * @param {Function} iteratee - An async truth test to apply to each item in
 * `coll`.
 * The should complete with a boolean value as its `result`.
 * Invoked with (item, callback).
 * @param {Function} [callback] - A callback which is called after all the
 * `iteratee` functions have finished. Invoked with (err, results).
 */
var rejectSeries = doLimit(rejectLimit, 1);

/**
 * Creates a function that returns `value`.
 *
 * @static
 * @memberOf _
 * @since 2.4.0
 * @category Util
 * @param {*} value The value to return from the new function.
 * @returns {Function} Returns the new constant function.
 * @example
 *
 * var objects = _.times(2, _.constant({ 'a': 1 }));
 *
 * console.log(objects);
 * // => [{ 'a': 1 }, { 'a': 1 }]
 *
 * console.log(objects[0] === objects[1]);
 * // => true
 */
function constant$1(value) {
  return function() {
    return value;
  };
}

/**
 * Attempts to get a successful response from `task` no more than `times` times
 * before returning an error. If the task is successful, the `callback` will be
 * passed the result of the successful task. If all attempts fail, the callback
 * will be passed the error and result (if any) of the final attempt.
 *
 * @name retry
 * @static
 * @memberOf module:ControlFlow
 * @method
 * @category Control Flow
 * @see [async.retryable]{@link module:ControlFlow.retryable}
 * @param {Object|number} [opts = {times: 5, interval: 0}| 5] - Can be either an
 * object with `times` and `interval` or a number.
 * * `times` - The number of attempts to make before giving up.  The default
 *   is `5`.
 * * `interval` - The time to wait between retries, in milliseconds.  The
 *   default is `0`. The interval may also be specified as a function of the
 *   retry count (see example).
 * * `errorFilter` - An optional synchronous function that is invoked on
 *   erroneous result. If it returns `true` the retry attempts will continue;
 *   if the function returns `false` the retry flow is aborted with the current
 *   attempt's error and result being returned to the final callback.
 *   Invoked with (err).
 * * If `opts` is a number, the number specifies the number of times to retry,
 *   with the default interval of `0`.
 * @param {AsyncFunction} task - An async function to retry.
 * Invoked with (callback).
 * @param {Function} [callback] - An optional callback which is called when the
 * task has succeeded, or after the final failed attempt. It receives the `err`
 * and `result` arguments of the last attempt at completing the `task`. Invoked
 * with (err, results).
 *
 * @example
 *
 * // The `retry` function can be used as a stand-alone control flow by passing
 * // a callback, as shown below:
 *
 * // try calling apiMethod 3 times
 * async.retry(3, apiMethod, function(err, result) {
 *     // do something with the result
 * });
 *
 * // try calling apiMethod 3 times, waiting 200 ms between each retry
 * async.retry({times: 3, interval: 200}, apiMethod, function(err, result) {
 *     // do something with the result
 * });
 *
 * // try calling apiMethod 10 times with exponential backoff
 * // (i.e. intervals of 100, 200, 400, 800, 1600, ... milliseconds)
 * async.retry({
 *   times: 10,
 *   interval: function(retryCount) {
 *     return 50 * Math.pow(2, retryCount);
 *   }
 * }, apiMethod, function(err, result) {
 *     // do something with the result
 * });
 *
 * // try calling apiMethod the default 5 times no delay between each retry
 * async.retry(apiMethod, function(err, result) {
 *     // do something with the result
 * });
 *
 * // try calling apiMethod only when error condition satisfies, all other
 * // errors will abort the retry control flow and return to final callback
 * async.retry({
 *   errorFilter: function(err) {
 *     return err.message === 'Temporary error'; // only retry on a specific error
 *   }
 * }, apiMethod, function(err, result) {
 *     // do something with the result
 * });
 *
 * // to retry individual methods that are not as reliable within other
 * // control flow functions, use the `retryable` wrapper:
 * async.auto({
 *     users: api.getUsers.bind(api),
 *     payments: async.retryable(3, api.getPayments.bind(api))
 * }, function(err, results) {
 *     // do something with the results
 * });
 *
 */
function retry(opts, task, callback) {
    var DEFAULT_TIMES = 5;
    var DEFAULT_INTERVAL = 0;

    var options = {
        times: DEFAULT_TIMES,
        intervalFunc: constant$1(DEFAULT_INTERVAL)
    };

    function parseTimes(acc, t) {
        if (typeof t === 'object') {
            acc.times = +t.times || DEFAULT_TIMES;

            acc.intervalFunc = typeof t.interval === 'function' ?
                t.interval :
                constant$1(+t.interval || DEFAULT_INTERVAL);

            acc.errorFilter = t.errorFilter;
        } else if (typeof t === 'number' || typeof t === 'string') {
            acc.times = +t || DEFAULT_TIMES;
        } else {
            throw new Error("Invalid arguments for async.retry");
        }
    }

    if (arguments.length < 3 && typeof opts === 'function') {
        callback = task || noop;
        task = opts;
    } else {
        parseTimes(options, opts);
        callback = callback || noop;
    }

    if (typeof task !== 'function') {
        throw new Error("Invalid arguments for async.retry");
    }

    var _task = wrapAsync(task);

    var attempt = 1;
    function retryAttempt() {
        _task(function(err) {
            if (err && attempt++ < options.times &&
                (typeof options.errorFilter != 'function' ||
                    options.errorFilter(err))) {
                setTimeout(retryAttempt, options.intervalFunc(attempt));
            } else {
                callback.apply(null, arguments);
            }
        });
    }

    retryAttempt();
}

/**
 * A close relative of [`retry`]{@link module:ControlFlow.retry}.  This method
 * wraps a task and makes it retryable, rather than immediately calling it
 * with retries.
 *
 * @name retryable
 * @static
 * @memberOf module:ControlFlow
 * @method
 * @see [async.retry]{@link module:ControlFlow.retry}
 * @category Control Flow
 * @param {Object|number} [opts = {times: 5, interval: 0}| 5] - optional
 * options, exactly the same as from `retry`
 * @param {AsyncFunction} task - the asynchronous function to wrap.
 * This function will be passed any arguments passed to the returned wrapper.
 * Invoked with (...args, callback).
 * @returns {AsyncFunction} The wrapped function, which when invoked, will
 * retry on an error, based on the parameters specified in `opts`.
 * This function will accept the same parameters as `task`.
 * @example
 *
 * async.auto({
 *     dep1: async.retryable(3, getFromFlakyService),
 *     process: ["dep1", async.retryable(3, function (results, cb) {
 *         maybeProcessData(results.dep1, cb);
 *     })]
 * }, callback);
 */
var retryable = function (opts, task) {
    if (!task) {
        task = opts;
        opts = null;
    }
    var _task = wrapAsync(task);
    return initialParams(function (args, callback) {
        function taskFn(cb) {
            _task.apply(null, args.concat(cb));
        }

        if (opts) retry(opts, taskFn, callback);
        else retry(taskFn, callback);

    });
};

/**
 * Run the functions in the `tasks` collection in series, each one running once
 * the previous function has completed. If any functions in the series pass an
 * error to its callback, no more functions are run, and `callback` is
 * immediately called with the value of the error. Otherwise, `callback`
 * receives an array of results when `tasks` have completed.
 *
 * It is also possible to use an object instead of an array. Each property will
 * be run as a function, and the results will be passed to the final `callback`
 * as an object instead of an array. This can be a more readable way of handling
 *  results from {@link async.series}.
 *
 * **Note** that while many implementations preserve the order of object
 * properties, the [ECMAScript Language Specification](http://www.ecma-international.org/ecma-262/5.1/#sec-8.6)
 * explicitly states that
 *
 * > The mechanics and order of enumerating the properties is not specified.
 *
 * So if you rely on the order in which your series of functions are executed,
 * and want this to work on all platforms, consider using an array.
 *
 * @name series
 * @static
 * @memberOf module:ControlFlow
 * @method
 * @category Control Flow
 * @param {Array|Iterable|Object} tasks - A collection containing
 * [async functions]{@link AsyncFunction} to run in series.
 * Each function can complete with any number of optional `result` values.
 * @param {Function} [callback] - An optional callback to run once all the
 * functions have completed. This function gets a results array (or object)
 * containing all the result arguments passed to the `task` callbacks. Invoked
 * with (err, result).
 * @example
 * async.series([
 *     function(callback) {
 *         // do some stuff ...
 *         callback(null, 'one');
 *     },
 *     function(callback) {
 *         // do some more stuff ...
 *         callback(null, 'two');
 *     }
 * ],
 * // optional callback
 * function(err, results) {
 *     // results is now equal to ['one', 'two']
 * });
 *
 * async.series({
 *     one: function(callback) {
 *         setTimeout(function() {
 *             callback(null, 1);
 *         }, 200);
 *     },
 *     two: function(callback){
 *         setTimeout(function() {
 *             callback(null, 2);
 *         }, 100);
 *     }
 * }, function(err, results) {
 *     // results is now equal to: {one: 1, two: 2}
 * });
 */
function series(tasks, callback) {
    _parallel(eachOfSeries, tasks, callback);
}

/**
 * Returns `true` if at least one element in the `coll` satisfies an async test.
 * If any iteratee call returns `true`, the main `callback` is immediately
 * called.
 *
 * @name some
 * @static
 * @memberOf module:Collections
 * @method
 * @alias any
 * @category Collection
 * @param {Array|Iterable|Object} coll - A collection to iterate over.
 * @param {AsyncFunction} iteratee - An async truth test to apply to each item
 * in the collections in parallel.
 * The iteratee should complete with a boolean `result` value.
 * Invoked with (item, callback).
 * @param {Function} [callback] - A callback which is called as soon as any
 * iteratee returns `true`, or after all the iteratee functions have finished.
 * Result will be either `true` or `false` depending on the values of the async
 * tests. Invoked with (err, result).
 * @example
 *
 * async.some(['file1','file2','file3'], function(filePath, callback) {
 *     fs.access(filePath, function(err) {
 *         callback(null, !err)
 *     });
 * }, function(err, result) {
 *     // if result is true then at least one of the files exists
 * });
 */
var some = doParallel(_createTester(Boolean, identity));

/**
 * The same as [`some`]{@link module:Collections.some} but runs a maximum of `limit` async operations at a time.
 *
 * @name someLimit
 * @static
 * @memberOf module:Collections
 * @method
 * @see [async.some]{@link module:Collections.some}
 * @alias anyLimit
 * @category Collection
 * @param {Array|Iterable|Object} coll - A collection to iterate over.
 * @param {number} limit - The maximum number of async operations at a time.
 * @param {AsyncFunction} iteratee - An async truth test to apply to each item
 * in the collections in parallel.
 * The iteratee should complete with a boolean `result` value.
 * Invoked with (item, callback).
 * @param {Function} [callback] - A callback which is called as soon as any
 * iteratee returns `true`, or after all the iteratee functions have finished.
 * Result will be either `true` or `false` depending on the values of the async
 * tests. Invoked with (err, result).
 */
var someLimit = doParallelLimit(_createTester(Boolean, identity));

/**
 * The same as [`some`]{@link module:Collections.some} but runs only a single async operation at a time.
 *
 * @name someSeries
 * @static
 * @memberOf module:Collections
 * @method
 * @see [async.some]{@link module:Collections.some}
 * @alias anySeries
 * @category Collection
 * @param {Array|Iterable|Object} coll - A collection to iterate over.
 * @param {AsyncFunction} iteratee - An async truth test to apply to each item
 * in the collections in series.
 * The iteratee should complete with a boolean `result` value.
 * Invoked with (item, callback).
 * @param {Function} [callback] - A callback which is called as soon as any
 * iteratee returns `true`, or after all the iteratee functions have finished.
 * Result will be either `true` or `false` depending on the values of the async
 * tests. Invoked with (err, result).
 */
var someSeries = doLimit(someLimit, 1);

/**
 * Sorts a list by the results of running each `coll` value through an async
 * `iteratee`.
 *
 * @name sortBy
 * @static
 * @memberOf module:Collections
 * @method
 * @category Collection
 * @param {Array|Iterable|Object} coll - A collection to iterate over.
 * @param {AsyncFunction} iteratee - An async function to apply to each item in
 * `coll`.
 * The iteratee should complete with a value to use as the sort criteria as
 * its `result`.
 * Invoked with (item, callback).
 * @param {Function} callback - A callback which is called after all the
 * `iteratee` functions have finished, or an error occurs. Results is the items
 * from the original `coll` sorted by the values returned by the `iteratee`
 * calls. Invoked with (err, results).
 * @example
 *
 * async.sortBy(['file1','file2','file3'], function(file, callback) {
 *     fs.stat(file, function(err, stats) {
 *         callback(err, stats.mtime);
 *     });
 * }, function(err, results) {
 *     // results is now the original array of files sorted by
 *     // modified date
 * });
 *
 * // By modifying the callback parameter the
 * // sorting order can be influenced:
 *
 * // ascending order
 * async.sortBy([1,9,3,5], function(x, callback) {
 *     callback(null, x);
 * }, function(err,result) {
 *     // result callback
 * });
 *
 * // descending order
 * async.sortBy([1,9,3,5], function(x, callback) {
 *     callback(null, x*-1);    //<- x*-1 instead of x, turns the order around
 * }, function(err,result) {
 *     // result callback
 * });
 */
function sortBy (coll, iteratee, callback) {
    var _iteratee = wrapAsync(iteratee);
    map(coll, function (x, callback) {
        _iteratee(x, function (err, criteria) {
            if (err) return callback(err);
            callback(null, {value: x, criteria: criteria});
        });
    }, function (err, results) {
        if (err) return callback(err);
        callback(null, arrayMap(results.sort(comparator), baseProperty('value')));
    });

    function comparator(left, right) {
        var a = left.criteria, b = right.criteria;
        return a < b ? -1 : a > b ? 1 : 0;
    }
}

/**
 * Sets a time limit on an asynchronous function. If the function does not call
 * its callback within the specified milliseconds, it will be called with a
 * timeout error. The code property for the error object will be `'ETIMEDOUT'`.
 *
 * @name timeout
 * @static
 * @memberOf module:Utils
 * @method
 * @category Util
 * @param {AsyncFunction} asyncFn - The async function to limit in time.
 * @param {number} milliseconds - The specified time limit.
 * @param {*} [info] - Any variable you want attached (`string`, `object`, etc)
 * to timeout Error for more information..
 * @returns {AsyncFunction} Returns a wrapped function that can be used with any
 * of the control flow functions.
 * Invoke this function with the same parameters as you would `asyncFunc`.
 * @example
 *
 * function myFunction(foo, callback) {
 *     doAsyncTask(foo, function(err, data) {
 *         // handle errors
 *         if (err) return callback(err);
 *
 *         // do some stuff ...
 *
 *         // return processed data
 *         return callback(null, data);
 *     });
 * }
 *
 * var wrapped = async.timeout(myFunction, 1000);
 *
 * // call `wrapped` as you would `myFunction`
 * wrapped({ bar: 'bar' }, function(err, data) {
 *     // if `myFunction` takes < 1000 ms to execute, `err`
 *     // and `data` will have their expected values
 *
 *     // else `err` will be an Error with the code 'ETIMEDOUT'
 * });
 */
function timeout(asyncFn, milliseconds, info) {
    var fn = wrapAsync(asyncFn);

    return initialParams(function (args, callback) {
        var timedOut = false;
        var timer;

        function timeoutCallback() {
            var name = asyncFn.name || 'anonymous';
            var error  = new Error('Callback function "' + name + '" timed out.');
            error.code = 'ETIMEDOUT';
            if (info) {
                error.info = info;
            }
            timedOut = true;
            callback(error);
        }

        args.push(function () {
            if (!timedOut) {
                callback.apply(null, arguments);
                clearTimeout(timer);
            }
        });

        // setup timer and call original function
        timer = setTimeout(timeoutCallback, milliseconds);
        fn.apply(null, args);
    });
}

/* Built-in method references for those with the same name as other `lodash` methods. */
var nativeCeil = Math.ceil;
var nativeMax = Math.max;

/**
 * The base implementation of `_.range` and `_.rangeRight` which doesn't
 * coerce arguments.
 *
 * @private
 * @param {number} start The start of the range.
 * @param {number} end The end of the range.
 * @param {number} step The value to increment or decrement by.
 * @param {boolean} [fromRight] Specify iterating from right to left.
 * @returns {Array} Returns the range of numbers.
 */
function baseRange(start, end, step, fromRight) {
  var index = -1,
      length = nativeMax(nativeCeil((end - start) / (step || 1)), 0),
      result = Array(length);

  while (length--) {
    result[fromRight ? length : ++index] = start;
    start += step;
  }
  return result;
}

/**
 * The same as [times]{@link module:ControlFlow.times} but runs a maximum of `limit` async operations at a
 * time.
 *
 * @name timesLimit
 * @static
 * @memberOf module:ControlFlow
 * @method
 * @see [async.times]{@link module:ControlFlow.times}
 * @category Control Flow
 * @param {number} count - The number of times to run the function.
 * @param {number} limit - The maximum number of async operations at a time.
 * @param {AsyncFunction} iteratee - The async function to call `n` times.
 * Invoked with the iteration index and a callback: (n, next).
 * @param {Function} callback - see [async.map]{@link module:Collections.map}.
 */
function timeLimit(count, limit, iteratee, callback) {
    var _iteratee = wrapAsync(iteratee);
    mapLimit(baseRange(0, count, 1), limit, _iteratee, callback);
}

/**
 * Calls the `iteratee` function `n` times, and accumulates results in the same
 * manner you would use with [map]{@link module:Collections.map}.
 *
 * @name times
 * @static
 * @memberOf module:ControlFlow
 * @method
 * @see [async.map]{@link module:Collections.map}
 * @category Control Flow
 * @param {number} n - The number of times to run the function.
 * @param {AsyncFunction} iteratee - The async function to call `n` times.
 * Invoked with the iteration index and a callback: (n, next).
 * @param {Function} callback - see {@link module:Collections.map}.
 * @example
 *
 * // Pretend this is some complicated async factory
 * var createUser = function(id, callback) {
 *     callback(null, {
 *         id: 'user' + id
 *     });
 * };
 *
 * // generate 5 users
 * async.times(5, function(n, next) {
 *     createUser(n, function(err, user) {
 *         next(err, user);
 *     });
 * }, function(err, users) {
 *     // we should now have 5 users
 * });
 */
var times = doLimit(timeLimit, Infinity);

/**
 * The same as [times]{@link module:ControlFlow.times} but runs only a single async operation at a time.
 *
 * @name timesSeries
 * @static
 * @memberOf module:ControlFlow
 * @method
 * @see [async.times]{@link module:ControlFlow.times}
 * @category Control Flow
 * @param {number} n - The number of times to run the function.
 * @param {AsyncFunction} iteratee - The async function to call `n` times.
 * Invoked with the iteration index and a callback: (n, next).
 * @param {Function} callback - see {@link module:Collections.map}.
 */
var timesSeries = doLimit(timeLimit, 1);

/**
 * A relative of `reduce`.  Takes an Object or Array, and iterates over each
 * element in series, each step potentially mutating an `accumulator` value.
 * The type of the accumulator defaults to the type of collection passed in.
 *
 * @name transform
 * @static
 * @memberOf module:Collections
 * @method
 * @category Collection
 * @param {Array|Iterable|Object} coll - A collection to iterate over.
 * @param {*} [accumulator] - The initial state of the transform.  If omitted,
 * it will default to an empty Object or Array, depending on the type of `coll`
 * @param {AsyncFunction} iteratee - A function applied to each item in the
 * collection that potentially modifies the accumulator.
 * Invoked with (accumulator, item, key, callback).
 * @param {Function} [callback] - A callback which is called after all the
 * `iteratee` functions have finished. Result is the transformed accumulator.
 * Invoked with (err, result).
 * @example
 *
 * async.transform([1,2,3], function(acc, item, index, callback) {
 *     // pointless async:
 *     process.nextTick(function() {
 *         acc.push(item * 2)
 *         callback(null)
 *     });
 * }, function(err, result) {
 *     // result is now equal to [2, 4, 6]
 * });
 *
 * @example
 *
 * async.transform({a: 1, b: 2, c: 3}, function (obj, val, key, callback) {
 *     setImmediate(function () {
 *         obj[key] = val * 2;
 *         callback();
 *     })
 * }, function (err, result) {
 *     // result is equal to {a: 2, b: 4, c: 6}
 * })
 */
function transform (coll, accumulator, iteratee, callback) {
    if (arguments.length <= 3) {
        callback = iteratee;
        iteratee = accumulator;
        accumulator = isArray(coll) ? [] : {};
    }
    callback = once(callback || noop);
    var _iteratee = wrapAsync(iteratee);

    eachOf(coll, function(v, k, cb) {
        _iteratee(accumulator, v, k, cb);
    }, function(err) {
        callback(err, accumulator);
    });
}

/**
 * It runs each task in series but stops whenever any of the functions were
 * successful. If one of the tasks were successful, the `callback` will be
 * passed the result of the successful task. If all tasks fail, the callback
 * will be passed the error and result (if any) of the final attempt.
 *
 * @name tryEach
 * @static
 * @memberOf module:ControlFlow
 * @method
 * @category Control Flow
 * @param {Array|Iterable|Object} tasks - A collection containing functions to
 * run, each function is passed a `callback(err, result)` it must call on
 * completion with an error `err` (which can be `null`) and an optional `result`
 * value.
 * @param {Function} [callback] - An optional callback which is called when one
 * of the tasks has succeeded, or all have failed. It receives the `err` and
 * `result` arguments of the last attempt at completing the `task`. Invoked with
 * (err, results).
 * @example
 * async.tryEach([
 *     function getDataFromFirstWebsite(callback) {
 *         // Try getting the data from the first website
 *         callback(err, data);
 *     },
 *     function getDataFromSecondWebsite(callback) {
 *         // First website failed,
 *         // Try getting the data from the backup website
 *         callback(err, data);
 *     }
 * ],
 * // optional callback
 * function(err, results) {
 *     Now do something with the data.
 * });
 *
 */
function tryEach(tasks, callback) {
    var error = null;
    var result;
    callback = callback || noop;
    eachSeries(tasks, function(task, callback) {
        wrapAsync(task)(function (err, res/*, ...args*/) {
            if (arguments.length > 2) {
                result = slice(arguments, 1);
            } else {
                result = res;
            }
            error = err;
            callback(!err);
        });
    }, function () {
        callback(error, result);
    });
}

/**
 * Undoes a [memoize]{@link module:Utils.memoize}d function, reverting it to the original,
 * unmemoized form. Handy for testing.
 *
 * @name unmemoize
 * @static
 * @memberOf module:Utils
 * @method
 * @see [async.memoize]{@link module:Utils.memoize}
 * @category Util
 * @param {AsyncFunction} fn - the memoized function
 * @returns {AsyncFunction} a function that calls the original unmemoized function
 */
function unmemoize(fn) {
    return function () {
        return (fn.unmemoized || fn).apply(null, arguments);
    };
}

/**
 * Repeatedly call `iteratee`, while `test` returns `true`. Calls `callback` when
 * stopped, or an error occurs.
 *
 * @name whilst
 * @static
 * @memberOf module:ControlFlow
 * @method
 * @category Control Flow
 * @param {Function} test - synchronous truth test to perform before each
 * execution of `iteratee`. Invoked with ().
 * @param {AsyncFunction} iteratee - An async function which is called each time
 * `test` passes. Invoked with (callback).
 * @param {Function} [callback] - A callback which is called after the test
 * function has failed and repeated execution of `iteratee` has stopped. `callback`
 * will be passed an error and any arguments passed to the final `iteratee`'s
 * callback. Invoked with (err, [results]);
 * @returns undefined
 * @example
 *
 * var count = 0;
 * async.whilst(
 *     function() { return count < 5; },
 *     function(callback) {
 *         count++;
 *         setTimeout(function() {
 *             callback(null, count);
 *         }, 1000);
 *     },
 *     function (err, n) {
 *         // 5 seconds have passed, n = 5
 *     }
 * );
 */
function whilst(test, iteratee, callback) {
    callback = onlyOnce(callback || noop);
    var _iteratee = wrapAsync(iteratee);
    if (!test()) return callback(null);
    var next = function(err/*, ...args*/) {
        if (err) return callback(err);
        if (test()) return _iteratee(next);
        var args = slice(arguments, 1);
        callback.apply(null, [null].concat(args));
    };
    _iteratee(next);
}

/**
 * Repeatedly call `iteratee` until `test` returns `true`. Calls `callback` when
 * stopped, or an error occurs. `callback` will be passed an error and any
 * arguments passed to the final `iteratee`'s callback.
 *
 * The inverse of [whilst]{@link module:ControlFlow.whilst}.
 *
 * @name until
 * @static
 * @memberOf module:ControlFlow
 * @method
 * @see [async.whilst]{@link module:ControlFlow.whilst}
 * @category Control Flow
 * @param {Function} test - synchronous truth test to perform before each
 * execution of `iteratee`. Invoked with ().
 * @param {AsyncFunction} iteratee - An async function which is called each time
 * `test` fails. Invoked with (callback).
 * @param {Function} [callback] - A callback which is called after the test
 * function has passed and repeated execution of `iteratee` has stopped. `callback`
 * will be passed an error and any arguments passed to the final `iteratee`'s
 * callback. Invoked with (err, [results]);
 */
function until(test, iteratee, callback) {
    whilst(function() {
        return !test.apply(this, arguments);
    }, iteratee, callback);
}

/**
 * Runs the `tasks` array of functions in series, each passing their results to
 * the next in the array. However, if any of the `tasks` pass an error to their
 * own callback, the next function is not executed, and the main `callback` is
 * immediately called with the error.
 *
 * @name waterfall
 * @static
 * @memberOf module:ControlFlow
 * @method
 * @category Control Flow
 * @param {Array} tasks - An array of [async functions]{@link AsyncFunction}
 * to run.
 * Each function should complete with any number of `result` values.
 * The `result` values will be passed as arguments, in order, to the next task.
 * @param {Function} [callback] - An optional callback to run once all the
 * functions have completed. This will be passed the results of the last task's
 * callback. Invoked with (err, [results]).
 * @returns undefined
 * @example
 *
 * async.waterfall([
 *     function(callback) {
 *         callback(null, 'one', 'two');
 *     },
 *     function(arg1, arg2, callback) {
 *         // arg1 now equals 'one' and arg2 now equals 'two'
 *         callback(null, 'three');
 *     },
 *     function(arg1, callback) {
 *         // arg1 now equals 'three'
 *         callback(null, 'done');
 *     }
 * ], function (err, result) {
 *     // result now equals 'done'
 * });
 *
 * // Or, with named functions:
 * async.waterfall([
 *     myFirstFunction,
 *     mySecondFunction,
 *     myLastFunction,
 * ], function (err, result) {
 *     // result now equals 'done'
 * });
 * function myFirstFunction(callback) {
 *     callback(null, 'one', 'two');
 * }
 * function mySecondFunction(arg1, arg2, callback) {
 *     // arg1 now equals 'one' and arg2 now equals 'two'
 *     callback(null, 'three');
 * }
 * function myLastFunction(arg1, callback) {
 *     // arg1 now equals 'three'
 *     callback(null, 'done');
 * }
 */
var waterfall = function(tasks, callback) {
    callback = once(callback || noop);
    if (!isArray(tasks)) return callback(new Error('First argument to waterfall must be an array of functions'));
    if (!tasks.length) return callback();
    var taskIndex = 0;

    function nextTask(args) {
        var task = wrapAsync(tasks[taskIndex++]);
        args.push(onlyOnce(next));
        task.apply(null, args);
    }

    function next(err/*, ...args*/) {
        if (err || taskIndex === tasks.length) {
            return callback.apply(null, arguments);
        }
        nextTask(slice(arguments, 1));
    }

    nextTask([]);
};

/**
 * An "async function" in the context of Async is an asynchronous function with
 * a variable number of parameters, with the final parameter being a callback.
 * (`function (arg1, arg2, ..., callback) {}`)
 * The final callback is of the form `callback(err, results...)`, which must be
 * called once the function is completed.  The callback should be called with a
 * Error as its first argument to signal that an error occurred.
 * Otherwise, if no error occurred, it should be called with `null` as the first
 * argument, and any additional `result` arguments that may apply, to signal
 * successful completion.
 * The callback must be called exactly once, ideally on a later tick of the
 * JavaScript event loop.
 *
 * This type of function is also referred to as a "Node-style async function",
 * or a "continuation passing-style function" (CPS). Most of the methods of this
 * library are themselves CPS/Node-style async functions, or functions that
 * return CPS/Node-style async functions.
 *
 * Wherever we accept a Node-style async function, we also directly accept an
 * [ES2017 `async` function]{@link https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function}.
 * In this case, the `async` function will not be passed a final callback
 * argument, and any thrown error will be used as the `err` argument of the
 * implicit callback, and the return value will be used as the `result` value.
 * (i.e. a `rejected` of the returned Promise becomes the `err` callback
 * argument, and a `resolved` value becomes the `result`.)
 *
 * Note, due to JavaScript limitations, we can only detect native `async`
 * functions and not transpilied implementations.
 * Your environment must have `async`/`await` support for this to work.
 * (e.g. Node > v7.6, or a recent version of a modern browser).
 * If you are using `async` functions through a transpiler (e.g. Babel), you
 * must still wrap the function with [asyncify]{@link module:Utils.asyncify},
 * because the `async function` will be compiled to an ordinary function that
 * returns a promise.
 *
 * @typedef {Function} AsyncFunction
 * @static
 */

/**
 * Async is a utility module which provides straight-forward, powerful functions
 * for working with asynchronous JavaScript. Although originally designed for
 * use with [Node.js](http://nodejs.org) and installable via
 * `npm install --save async`, it can also be used directly in the browser.
 * @module async
 * @see AsyncFunction
 */


/**
 * A collection of `async` functions for manipulating collections, such as
 * arrays and objects.
 * @module Collections
 */

/**
 * A collection of `async` functions for controlling the flow through a script.
 * @module ControlFlow
 */

/**
 * A collection of `async` utility functions.
 * @module Utils
 */

var index = {
    apply: apply,
    applyEach: applyEach,
    applyEachSeries: applyEachSeries,
    asyncify: asyncify,
    auto: auto,
    autoInject: autoInject,
    cargo: cargo,
    compose: compose,
    concat: concat,
    concatLimit: concatLimit,
    concatSeries: concatSeries,
    constant: constant,
    detect: detect,
    detectLimit: detectLimit,
    detectSeries: detectSeries,
    dir: dir,
    doDuring: doDuring,
    doUntil: doUntil,
    doWhilst: doWhilst,
    during: during,
    each: eachLimit,
    eachLimit: eachLimit$1,
    eachOf: eachOf,
    eachOfLimit: eachOfLimit,
    eachOfSeries: eachOfSeries,
    eachSeries: eachSeries,
    ensureAsync: ensureAsync,
    every: every,
    everyLimit: everyLimit,
    everySeries: everySeries,
    filter: filter,
    filterLimit: filterLimit,
    filterSeries: filterSeries,
    forever: forever,
    groupBy: groupBy,
    groupByLimit: groupByLimit,
    groupBySeries: groupBySeries,
    log: log,
    map: map,
    mapLimit: mapLimit,
    mapSeries: mapSeries,
    mapValues: mapValues,
    mapValuesLimit: mapValuesLimit,
    mapValuesSeries: mapValuesSeries,
    memoize: memoize,
    nextTick: nextTick,
    parallel: parallelLimit,
    parallelLimit: parallelLimit$1,
    priorityQueue: priorityQueue,
    queue: queue$1,
    race: race,
    reduce: reduce,
    reduceRight: reduceRight,
    reflect: reflect,
    reflectAll: reflectAll,
    reject: reject,
    rejectLimit: rejectLimit,
    rejectSeries: rejectSeries,
    retry: retry,
    retryable: retryable,
    seq: seq,
    series: series,
    setImmediate: setImmediate$1,
    some: some,
    someLimit: someLimit,
    someSeries: someSeries,
    sortBy: sortBy,
    timeout: timeout,
    times: times,
    timesLimit: timeLimit,
    timesSeries: timesSeries,
    transform: transform,
    tryEach: tryEach,
    unmemoize: unmemoize,
    until: until,
    waterfall: waterfall,
    whilst: whilst,

    // aliases
    all: every,
    allLimit: everyLimit,
    allSeries: everySeries,
    any: some,
    anyLimit: someLimit,
    anySeries: someSeries,
    find: detect,
    findLimit: detectLimit,
    findSeries: detectSeries,
    forEach: eachLimit,
    forEachSeries: eachSeries,
    forEachLimit: eachLimit$1,
    forEachOf: eachOf,
    forEachOfSeries: eachOfSeries,
    forEachOfLimit: eachOfLimit,
    inject: reduce,
    foldl: reduce,
    foldr: reduceRight,
    select: filter,
    selectLimit: filterLimit,
    selectSeries: filterSeries,
    wrapSync: asyncify
};

exports['default'] = index;
exports.apply = apply;
exports.applyEach = applyEach;
exports.applyEachSeries = applyEachSeries;
exports.asyncify = asyncify;
exports.auto = auto;
exports.autoInject = autoInject;
exports.cargo = cargo;
exports.compose = compose;
exports.concat = concat;
exports.concatLimit = concatLimit;
exports.concatSeries = concatSeries;
exports.constant = constant;
exports.detect = detect;
exports.detectLimit = detectLimit;
exports.detectSeries = detectSeries;
exports.dir = dir;
exports.doDuring = doDuring;
exports.doUntil = doUntil;
exports.doWhilst = doWhilst;
exports.during = during;
exports.each = eachLimit;
exports.eachLimit = eachLimit$1;
exports.eachOf = eachOf;
exports.eachOfLimit = eachOfLimit;
exports.eachOfSeries = eachOfSeries;
exports.eachSeries = eachSeries;
exports.ensureAsync = ensureAsync;
exports.every = every;
exports.everyLimit = everyLimit;
exports.everySeries = everySeries;
exports.filter = filter;
exports.filterLimit = filterLimit;
exports.filterSeries = filterSeries;
exports.forever = forever;
exports.groupBy = groupBy;
exports.groupByLimit = groupByLimit;
exports.groupBySeries = groupBySeries;
exports.log = log;
exports.map = map;
exports.mapLimit = mapLimit;
exports.mapSeries = mapSeries;
exports.mapValues = mapValues;
exports.mapValuesLimit = mapValuesLimit;
exports.mapValuesSeries = mapValuesSeries;
exports.memoize = memoize;
exports.nextTick = nextTick;
exports.parallel = parallelLimit;
exports.parallelLimit = parallelLimit$1;
exports.priorityQueue = priorityQueue;
exports.queue = queue$1;
exports.race = race;
exports.reduce = reduce;
exports.reduceRight = reduceRight;
exports.reflect = reflect;
exports.reflectAll = reflectAll;
exports.reject = reject;
exports.rejectLimit = rejectLimit;
exports.rejectSeries = rejectSeries;
exports.retry = retry;
exports.retryable = retryable;
exports.seq = seq;
exports.series = series;
exports.setImmediate = setImmediate$1;
exports.some = some;
exports.someLimit = someLimit;
exports.someSeries = someSeries;
exports.sortBy = sortBy;
exports.timeout = timeout;
exports.times = times;
exports.timesLimit = timeLimit;
exports.timesSeries = timesSeries;
exports.transform = transform;
exports.tryEach = tryEach;
exports.unmemoize = unmemoize;
exports.until = until;
exports.waterfall = waterfall;
exports.whilst = whilst;
exports.all = every;
exports.allLimit = everyLimit;
exports.allSeries = everySeries;
exports.any = some;
exports.anyLimit = someLimit;
exports.anySeries = someSeries;
exports.find = detect;
exports.findLimit = detectLimit;
exports.findSeries = detectSeries;
exports.forEach = eachLimit;
exports.forEachSeries = eachSeries;
exports.forEachLimit = eachLimit$1;
exports.forEachOf = eachOf;
exports.forEachOfSeries = eachOfSeries;
exports.forEachOfLimit = eachOfLimit;
exports.inject = reduce;
exports.foldl = reduce;
exports.foldr = reduceRight;
exports.select = filter;
exports.selectLimit = filterLimit;
exports.selectSeries = filterSeries;
exports.wrapSync = asyncify;

Object.defineProperty(exports, '__esModule', { value: true });

})));

/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(260).setImmediate, __webpack_require__(98), __webpack_require__(45), __webpack_require__(64)(module)))

/***/ }),
/* 98 */
/***/ (function(module, exports) {

// shim for using process in browser
var process = module.exports = {};

// cached from whatever global is present so that test runners that stub it
// don't break things.  But we need to wrap it in a try catch in case it is
// wrapped in strict mode code which doesn't define any globals.  It's inside a
// function because try/catches deoptimize in certain engines.

var cachedSetTimeout;
var cachedClearTimeout;

function defaultSetTimout() {
    throw new Error('setTimeout has not been defined');
}
function defaultClearTimeout () {
    throw new Error('clearTimeout has not been defined');
}
(function () {
    try {
        if (typeof setTimeout === 'function') {
            cachedSetTimeout = setTimeout;
        } else {
            cachedSetTimeout = defaultSetTimout;
        }
    } catch (e) {
        cachedSetTimeout = defaultSetTimout;
    }
    try {
        if (typeof clearTimeout === 'function') {
            cachedClearTimeout = clearTimeout;
        } else {
            cachedClearTimeout = defaultClearTimeout;
        }
    } catch (e) {
        cachedClearTimeout = defaultClearTimeout;
    }
} ())
function runTimeout(fun) {
    if (cachedSetTimeout === setTimeout) {
        //normal enviroments in sane situations
        return setTimeout(fun, 0);
    }
    // if setTimeout wasn't available but was latter defined
    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {
        cachedSetTimeout = setTimeout;
        return setTimeout(fun, 0);
    }
    try {
        // when when somebody has screwed with setTimeout but no I.E. maddness
        return cachedSetTimeout(fun, 0);
    } catch(e){
        try {
            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally
            return cachedSetTimeout.call(null, fun, 0);
        } catch(e){
            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error
            return cachedSetTimeout.call(this, fun, 0);
        }
    }


}
function runClearTimeout(marker) {
    if (cachedClearTimeout === clearTimeout) {
        //normal enviroments in sane situations
        return clearTimeout(marker);
    }
    // if clearTimeout wasn't available but was latter defined
    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {
        cachedClearTimeout = clearTimeout;
        return clearTimeout(marker);
    }
    try {
        // when when somebody has screwed with setTimeout but no I.E. maddness
        return cachedClearTimeout(marker);
    } catch (e){
        try {
            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally
            return cachedClearTimeout.call(null, marker);
        } catch (e){
            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.
            // Some versions of I.E. have different rules for clearTimeout vs setTimeout
            return cachedClearTimeout.call(this, marker);
        }
    }



}
var queue = [];
var draining = false;
var currentQueue;
var queueIndex = -1;

function cleanUpNextTick() {
    if (!draining || !currentQueue) {
        return;
    }
    draining = false;
    if (currentQueue.length) {
        queue = currentQueue.concat(queue);
    } else {
        queueIndex = -1;
    }
    if (queue.length) {
        drainQueue();
    }
}

function drainQueue() {
    if (draining) {
        return;
    }
    var timeout = runTimeout(cleanUpNextTick);
    draining = true;

    var len = queue.length;
    while(len) {
        currentQueue = queue;
        queue = [];
        while (++queueIndex < len) {
            if (currentQueue) {
                currentQueue[queueIndex].run();
            }
        }
        queueIndex = -1;
        len = queue.length;
    }
    currentQueue = null;
    draining = false;
    runClearTimeout(timeout);
}

process.nextTick = function (fun) {
    var args = new Array(arguments.length - 1);
    if (arguments.length > 1) {
        for (var i = 1; i < arguments.length; i++) {
            args[i - 1] = arguments[i];
        }
    }
    queue.push(new Item(fun, args));
    if (queue.length === 1 && !draining) {
        runTimeout(drainQueue);
    }
};

// v8 likes predictible objects
function Item(fun, array) {
    this.fun = fun;
    this.array = array;
}
Item.prototype.run = function () {
    this.fun.apply(null, this.array);
};
process.title = 'browser';
process.browser = true;
process.env = {};
process.argv = [];
process.version = ''; // empty string to avoid regexp issues
process.versions = {};

function noop() {}

process.on = noop;
process.addListener = noop;
process.once = noop;
process.off = noop;
process.removeListener = noop;
process.removeAllListeners = noop;
process.emit = noop;
process.prependListener = noop;
process.prependOnceListener = noop;

process.listeners = function (name) { return [] }

process.binding = function (name) {
    throw new Error('process.binding is not supported');
};

process.cwd = function () { return '/' };
process.chdir = function (dir) {
    throw new Error('process.chdir is not supported');
};
process.umask = function() { return 0; };


/***/ }),
/* 99 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {

_PropValuation.$inject = ["$state", "$timeout", "$rootScope", "$stateParams", "AOTCService", "$scope", "ValuationService", "UtilService", "PetitionerFormulae"];
module.exports = {PropValuation: _PropValuation, inputFocusFunction: _inputFocusFunction};
var async = __webpack_require__(97);
//angular.module('AOTC')
//    .directive('inputFocusFunction', _inputFocusFunction
//    )
//    .controller('PropValuation',_PropValuation );
function _PropValuation($state, $timeout, $rootScope, $stateParams, AOTCService, $scope, ValuationService, UtilService, PetitionerFormulae) {
    ////console.log("PropValuation controller", $stateParams);

    var vm = this;

    vm.calculateMRPetitioner = calculateMRPetitioner;
    vm.calculateERandVacPetitioner = calculateERandVacPetitioner;
    vm.calculateExpensesPetitioner = calculateExpensesPetitioner;
    vm.calculateNOIPetitioner = calculateNOIPetitioner;
    vm.calculateBCRPetitioner = calculateBCRPetitioner;
    vm.calculateMRAssessor = calculateMRAssessor;
    vm.calculateERandVacAssessor = calculateERandVacAssessor;
    vm.calculateExpensesAssessor = calculateExpensesAssessor;
    vm.calculateNOIAssessor = calculateNOIAssessor;
    vm.calculateBCRAssessor = calculateBCRAssessor;
    vm.calculateExpensesAssessorSF = calculateExpensesAssessorSF;

    vm.selectedValuationYear = selectedValuationYear;
    vm.calculateDeductAndCapex = calculateDeductAndCapex;
    vm.petitionerModalSelected = petitionerModalSelected;
    vm.assessorModalOneSelected = assessorModalOneSelected;
    vm.selectedValuationYearModal = selectedValuationYearModal;
    vm.getAllValuationForms = getAllValuationForms;
    // vm.viewForm = viewForm;

    //for calculating values on input ng-blur
    vm.calculateMRInput = calculateMRInput;
    vm.calculateERandVacInput = calculateERandVacInput;
    vm.calculateExpensesInput = calculateExpensesInput;
    vm.calculateExpensesSFInput = calculateExpensesSFInput;
    vm.calculateNOIInput = calculateNOIInput;
    vm.calculateBCRInput = calculateBCRInput;
    // end

    vm.ToggleLabelInputs = ToggleLabelInputs; //assessor heading th so that switch auto to manual dont have modeel drop down
    vm.addPetitionerEvidence = addPetitionerEvidence; //OPEN MODEL(myModalEvidence) TO SELECT EVIDENCES
    vm.sortBy = sortBy;
    vm.useModalValues = useModalValues;


    //===============================   variables ======================== //
    vm.currentForm = null;
    vm.formId = null;
    vm.formStatus = false;
    vm.noFormsFound = false;
    vm.isReplace = false;
    vm.alreadyExists = false;
    vm.formName = "";
    vm.formsList = [];
    vm.forms = false;
    vm.createNew = false;
    vm.yardiIEData = {};
    vm.mriIEData = {};
    vm.yearOfData = '';
    vm.showYear = false;
    vm.petitionerModalOne = {};
    vm.petitionerModalTwo = {};
    vm.petitionerModalThree = {};
    vm.assessorModalOne = {};
    vm.assessorModalTwo = {};
    vm.assessorModalThree = {};
    vm.selectedEvidences = [];
    vm.attachFileSelection = 0;
    vm.MREvidences = [];
    vm.VacancyEvidences = [];
    vm.ExpEvidences = [];
    vm.ExpPSFEvidences = [];
    vm.OIEvidences = [];
    vm.BCREvidences = [];
    vm.ETREvidences = [];
    vm.FreeRentEvidences = [];
    vm.LeasingEvidences = [];
    vm.TenantImprovementEvidences = [];
    vm.LostRentEvidences = [];
    vm.AddBackEvidences = [];
    vm.CapexEvidences = [];
    vm.DeductionEvidences = [];

    vm.allEvidenceFiles = [];
    vm.selectedEvidences = [];
    vm.buttonAOTCLabel = 'Hide AOTC Column';
    vm.buttonYearLabel = 'Hide Year Column ';

    vm.sortKey = '';
    vm.sortKeySelected = '';
    vm.sortBySelected = sortBySelected;

    vm.searchWordAllFile = '';
    vm.searchWordSelectedFile = '';


    vm.yearChecked = true;
    vm.recomendationChecked = true;
    vm.buttonAOTCLabelToggle = true;

    //gives sorted array which have to be shown in all files
    //gives sorted array which have to be shown in all files

    vm.valuationYear = 'selected'; // selected so that dropdown shows select year label by default
    vm.valuationData = {};
    vm.modalSelected = true;
    vm.hideBeforeSelection = true; //hide all tables
    vm.disableExpenseFieldsPer = false;
    vm.disableExpenseFieldsSF = false;
    vm.toggleLabelInputs = true;
    vm.useValuesSelection = 0; // 1 assessor 2 petitioner



    function resetFormVariables(){
        vm.deductAndCapex = {
            freeRent: '',
            leasingCommision: '',
            tenantImprovement: '',
            lostRent: '',
            exessRent: '',
            capex: '',
            TDA: '',
            VDC: '',
            VDL: ''
        };

        vm.valuationPropertyData = {
            SFLPetitioner: 0,
            MRPetitioner: '',
            ARPetitioner: 0,
            GPRPetitioner: 0,
            VacancyPerPetitioner: '',
            VacancyDolarPetitioner: 0,
            ERPetitioner: 0,
            expensePerPetitioner: '',
            expenseDolarPetitioner: 0,
            expensePerSFPetitioner: '',
            otherIncomePetitioner: '',
            NOIPetitioner: 0,
            BCRPetitioner: '',
            ETRPetitioner: '',
            OCRPetitioner: 0,
            VDCPetitioner: 0,
            VPSFPetitioner: 0
        };

        vm.assessorValuationData = {
            SFLPetitioner: 0,
            MRPetitioner: '',
            ARPetitioner: 0,
            GPRPetitioner: 0,
            VacancyPerPetitioner: '',
            VacancyDolarPetitioner: 0,
            ERPetitioner: 0,
            expensePerPetitioner: '',
            expenseDolarPetitioner: 0,
            expensePerSFPetitioner: '',
            otherIncomePetitioner: '',
            NOIPetitioner: 0,
            BCRPetitioner: '',
            ETRPetitioner: '',
            OCRPetitioner: 0,
            VDCPetitioner: 0,
            VPSFPetitioner: 0
        };

        vm.modalAssessorValues = {
            SFLPetitioner: 0,
            MRPetitioner: '',
            ARPetitioner: 0,
            GPRPetitioner: 0,
            VacancyPerPetitioner: '',
            VacancyDolarPetitioner: 0,
            ERPetitioner: 0,
            expensePerPetitioner: '',
            expenseDolarPetitioner: 0,
            expensePerSFPetitioner: '',
            otherIncomePetitioner: '',
            NOIPetitioner: 0,
            BCRPetitioner: '',
            ETRPetitioner: '',
            OCRPetitioner: 0,
            VDCPetitioner: 0,
            VPSFPetitioner: 0
        };

        vm.modalPetitionerValues = {
            SFLPetitioner: 0,
            MRPetitioner: '',
            ARPetitioner: 0,
            GPRPetitioner: 0,
            VacancyPerPetitioner: '',
            VacancyDolarPetitioner: 0,
            ERPetitioner: 0,
            expensePerPetitioner: '',
            expenseDolarPetitioner: 0,
            expensePerSFPetitioner: '',
            otherIncomePetitioner: '',
            NOIPetitioner: 0,
            BCRPetitioner: '',
            ETRPetitioner: '',
            OCRPetitioner: 0,
            VDCPetitioner: 0,
            VPSFPetitioner: 0
        };

        vm.attachNotes =
            [
                {
                    text: ''
                }, {
                    text: ''
                }, {
                    text: ''
                }, {
                    text: ''
                }, {
                    text: ''
                }, {
                    text: ''
                }, {
                    text: ''
                }, {
                    text: ''
                }, {
                    text: ''
                }, {
                    text: ''
                }, {
                    text: ''
                }, {
                    text: ''
                }, {
                    text: ''
                }, {
                    text: ''
                }, {
                    text: ''
                }
            ];
    }

    resetFormVariables();

    function getModalsAndConsolidatedData(){
        //get drop-down modals of petitioner and assessor
        vm.assessorModalData = [];

        ValuationService.getPetitionerModalsData()
            .then(function(result) {
                // ////console.log(result);
                vm.assessorModalData = result.data.result[0].models;
            }, function(err) {
                ////console.log(err);
            });

        //get yardi Mri Data
        getConsolidatedData(function(err, succ) {
            ////console.log('getConsolidatedData Server Data : ')
        });
    }

    //===============================   get property from local Storage======================== //
    // $stateParams.messageFrom = 'scenario';
    // $stateParams.messageFrom = 'scenario';


    vm.property = JSON.parse(localStorage.getItem('propertyDetails'));
    vm.propertyId = JSON.parse(localStorage.getItem('propertyId'));
    vm.selectedScenario = JSON.parse(localStorage.getItem('selectedScenario'));

    if (vm.selectedScenario) {
        ////console.log('111111111111111111111111111111111');

        vm.hideBeforeSelection = false;
        vm.createNew = false;
        vm.formName = localStorage.getItem('formName');

        vm.valuationPropertyData.SFLPetitioner = vm.selectedScenario.petitionerLeasableSF;
        vm.valuationPropertyData.MRPetitioner = vm.selectedScenario.petitionerMarketRentSF;
        vm.valuationPropertyData.ARPetitioner = vm.selectedScenario.petitionerAnnualRent;
        vm.valuationPropertyData.GPRPetitioner = vm.selectedScenario.petitionerGPR;
        vm.valuationPropertyData.VacancyPerPetitioner = vm.selectedScenario.petitionerVacancyPercentage;
        vm.valuationPropertyData.VacancyDolarPetitioner = vm.selectedScenario.petitionerVacancy;
        vm.valuationPropertyData.ERPetitioner = vm.selectedScenario.petitionerEffectiveRent;
        vm.valuationPropertyData.expensePerPetitioner = vm.selectedScenario.petitionerExpensePercentage;
        vm.valuationPropertyData.expenseDolarPetitioner = vm.selectedScenario.petitionerExpense;
        vm.valuationPropertyData.expensePerSFPetitioner = vm.selectedScenario.petitionerExpenseSF;
        vm.valuationPropertyData.otherIncomePetitioner = vm.selectedScenario.petitionerOI;
        vm.valuationPropertyData.NOIPetitioner = vm.selectedScenario.NOI;
        vm.valuationPropertyData.BCRPetitioner = vm.selectedScenario.BCR;
        vm.valuationPropertyData.ETRPetitioner = vm.selectedScenario.petitionerETR;
        vm.valuationPropertyData.OCRPetitioner = vm.selectedScenario.petitionerOCR;
        vm.valuationPropertyData.VDCPetitioner = vm.selectedScenario.petitionerVDC;
        vm.valuationPropertyData.VPSFPetitioner = vm.selectedScenario.assessedValueSF;


        getModalsAndConsolidatedData();
        localStorage.removeItem('selectedScenario');


    } else if ($stateParams.messageFrom == 'scenario') {
        ////console.log('2222222222222222222222222222');
        vm.formName = localStorage.getItem('formName');

        vm.hideBeforeSelection = false;
        vm.createNew = false;
        vm.formId = localStorage.getItem('formId');
        ValuationService.getFormById()
            .then(function(result) {
                ////console.log(result.data);
                useForm(result.data.result[0], function(err, succ) {
                    ////console.log('getFormById Server Data : ', result.data)
                })
            }, function(err) {
                ////console.log(result);
            });

        getModalsAndConsolidatedData();


    } else {
        ////console.log('333333333');


        vm.hideBeforeSelection = true;
        // vm.createNew = true;

        setTimeout(function() {
            $("#myModal").modal('toggle');
        }, 200);
    }
    //==========================================Methods========================================= //
    //================================   GETTING ALL EVIDENCE FILES ======================== //
    getAllEvidenceFiles();

    function getAllEvidenceFiles() {

        vm.allEvidenceFiles = [];

        $("#preloader").css("display", "block");
        var url = '/valuation/get-evidence-files';
        var _data = {propId: parseInt(localStorage.getItem('propertyId'))};
        ////console.log(url)

        AOTCService.postDataToServer(url, _data)
            .then(function(result) {

                var serverData = result.data;
                ////console.log('All Evidences Receieved Server Data');
                ////console.log(serverData);

                if (serverData.success) {

                    vm.allEvidenceFiles = serverData.result[0].evidences;
                    //by default sort By date
                    // sortBy('createdDate');
                    localStorage.removeItem('evidenceFilesAtServer');
                    localStorage.setItem('evidenceFilesAtServer', angular.toJson(vm.allEvidenceFiles));

                    for (var i = 0; i < vm.allEvidenceFiles.length; i++) {
                        var evidFile = vm.allEvidenceFiles[i];

                        for (var k = 0; k < vm.selectedEvidences.length; k++) {
                            var selectedEvid = vm.selectedEvidences[k];
                            if (selectedEvid._id == evidFile._id) {

                                vm.allEvidenceFiles.splice(i, 1);
                                i = i - 1;

                            }

                        }

                    }

                }

                $("#preloader").css("display", "none");


            }, function(result) {
                //some error
                ////console.log(result);
                $("#preloader").css("display", "none");

            });
    }

    function getAllValuationForms() {
        vm.createNew = true;
        // ////console.log(vm.propertyId);
        // ////console.log(vm.valuationYear);
        localStorage.setItem('valuationYear', vm.valuationYear);
        // localStorage.removeItem('formId');
        var formData = {
            "propId": vm.propertyId,
            "valuationYear": parseInt(localStorage.getItem('valuationYear'))
        };
        $("#preloader").css("display", "block");
        var url = "/valuation/get-forms-by-propertyId";
        ValuationService.getValuationForms(url, formData)
            .then(function(result) {
                ////console.log('getValuationForms serverData:');
                ////console.log(result);
                vm.formsList = result.data.result;
                // if (vm.formsList.length > 0) {
                //     vm.forms = true;
                // } else {
                //     vm.noFormsFound = true;
                // }
                $("#preloader").css("display", "none");
                $("#myModal").modal('hide');

                // localStorage.removeItem('formName');


            });
    }


    vm.appeal = function() {
        var url = "/valuation/appeal";
        ////console.log(vm.formId);
        var formData = {
            propId:parseInt(localStorage.getItem('propertyId')),
            formId: vm.formId
        };
        ValuationService.appeal(url, formData)
            .then(function(result) {
                ////console.log(result);
                $("#preloader").css("display", "none");
                $("#myAppealModal").modal('hide');

            });
    }

    vm.deleteForm = function() {
        vm.formId = vm.currentForm.valuationForm._id;
        var url = "/valuation/delete-valuation-form";
        ////console.log(vm.formId);
        var formData = {
            formId: vm.formId
        }
        ValuationService.deleteForm(url, formData)
            .then(function(result) {
                ////console.log(result);
                vm.hideBeforeSelection = true;
                $("#myDeleteModal").modal('hide');
                vm.formStatus = false;
                getAllValuationForms();
                $("#preloader").css("display", "none");

            });
    }

    vm.openDeleteModal = function(forms) {
        if(forms == "inside"){
            ////console.log("inside");
            vm.currentForm = JSON.parse(localStorage.getItem('selectedValuationForm'));
        }
        else{
            vm.currentForm = forms;
        }
        ////console.log('openModal')
        $timeout(function() {
            $('#myDeleteModal').modal('toggle');

        }, 100);
    }

    vm.saveForm = function() {
        $("#preloader").css("display", "block");
        localStorage.setItem('formName', vm.formName);

        getModalsAndConsolidatedData();
        var MRids = getEvidencePropertyIds(vm.MREvidences);
        var Vacids = getEvidencePropertyIds(vm.VacancyEvidences);
        var Expids = getEvidencePropertyIds(vm.ExpEvidences);
        var ExpSFids = getEvidencePropertyIds(vm.ExpPSFEvidences);
        var OIids = getEvidencePropertyIds(vm.OIEvidences);
        var BCRids = getEvidencePropertyIds(vm.BCREvidences);
        var ETRids = getEvidencePropertyIds(vm.ETREvidences);
        var Rentids = getEvidencePropertyIds(vm.FreeRentEvidences);
        var leaseids = getEvidencePropertyIds(vm.LeasingEvidences);
        var tenantids = getEvidencePropertyIds(vm.TenantImprovementEvidences);
        var lostids = getEvidencePropertyIds(vm.LostRentEvidences);
        var AddBackids = getEvidencePropertyIds(vm.AddBackEvidences);
        var Capexids = getEvidencePropertyIds(vm.CapexEvidences);
        var Deductionids = getEvidencePropertyIds(vm.DeductionEvidences);

        var jsonFormat = {
            propId: vm.propertyId,
            valuationYear: parseInt(localStorage.getItem('valuationYear')),
            name: vm.formName,
            status: vm.formStatus,
            valuationData: {
                marketRentPerSF: [vm.assessorValuationData.MRPetitioner, vm.valuationPropertyData.MRPetitioner.toString()],
                marketRentPerSFEvidence: MRids,
                marketRentPerSFNote: vm.attachNotes[1].text,

                vacancyPercentage: [vm.assessorValuationData.VacancyPerPetitioner, vm.valuationPropertyData.VacancyPerPetitioner.toString()],
                vacancyPercentageEvidence: Vacids,
                vacancyPercentageNote: vm.attachNotes[2].text,

                expensePercentage: [vm.assessorValuationData.expensePerPetitioner, vm.valuationPropertyData.expensePerPetitioner.toString()],
                expensePercentageEvidence: Expids,
                expensePercentageNote: vm.attachNotes[3].text,

                expensePerSF: [vm.assessorValuationData.expensePerSFPetitioner, vm.valuationPropertyData.expensePerSFPetitioner.toString()],
                expensePerSFEvidence: ExpSFids,
                expensePerSFNote: vm.attachNotes[4].text,

                otherIncome: [vm.assessorValuationData.otherIncomePetitioner, vm.valuationPropertyData.otherIncomePetitioner.toString()],
                otherIncomeEvidence: OIids,
                otherIncomeNote: vm.attachNotes[5].text,

                baseCapRate: [vm.assessorValuationData.BCRPetitioner, vm.valuationPropertyData.BCRPetitioner.toString()],
                baseCapRateEvidence: BCRids,
                baseCapRateNote: vm.attachNotes[6].text,

                effectiveTaxRate: [vm.assessorValuationData.ETRPetitioner, vm.valuationPropertyData.ETRPetitioner.toString()],
                effectiveTaxRateEvidence: ETRids,
                effectiveTaxRateNote: vm.attachNotes[7].text,

                freeRent: vm.deductAndCapex.freeRent.toString(),
                freeRentEvidence: Rentids,
                freeRentNote: vm.attachNotes[8].text,

                leasingCommission: vm.deductAndCapex.leasingCommision.toString(),
                leasingCommissionEvidence: leaseids,
                leasingCommissionNote: vm.attachNotes[9].text,

                tenantsImprovements: vm.deductAndCapex.tenantImprovement.toString(),
                tenantsImprovementsEvidence: tenantids,
                tenantsImprovementsNote: vm.attachNotes[10].text,

                lostRent: vm.deductAndCapex.lostRent.toString(),
                lostRentEvidence: lostids,
                lostRentNote: vm.attachNotes[11].text,

                addBackExcessRent: vm.deductAndCapex.exessRent.toString(),
                addBackExcessRentEvidence: AddBackids,
                addBackExcessRentNote: vm.attachNotes[12].text,

                capEx: vm.deductAndCapex.capex.toString(),
                capExEvidence: Capexids,
                capExNote: vm.attachNotes[13].text,

                totalDeductionsAddtions: vm.deductAndCapex.TDA.toString(),
                totalDeductionsAddtionsEvidence: Deductionids,
                totalDeductionsAddtionsNote: vm.attachNotes[14].text,
            }
        };

        if (vm.isReplace === '1') {
            ////console.log(jsonFormat);
            var url = '/valuation/replace-valuation-form';
            ValuationService.replaceValuationForm(url, jsonFormat)
                .then(function(result) {
                    ////console.log("Server Data : valuation/replace-form\n", result);
                    var serverData = result.data;
                    $("#preloader").css("display", "none");

                    if (serverData.success) {
                        getAllValuationForms();
                        vm.hideBeforeSelection = true;
                        vm.createNew = true;
                        $("#mySaveModal").modal('hide');
                        $scope.$emit('success', serverData.message);
                    } else {
                        getAllValuationForms();
                        vm.hideBeforeSelection = true;
                        vm.createNew = true;
                        $("#mySaveModal").modal('hide');
                        $scope.$emit('error', serverData.message);
                    }
                    getAllEvidenceFiles();
                }, function(error) {
                    $("#preloader").css("display", "none");
                    $("#error_linking").fadeIn(1500).delay(500).fadeOut(500);
                    ////console.log(error);
                });
        } else {
            var url = '/valuation/save-form';
            ValuationService.postDataToServer(url, jsonFormat)
                .then(function(result) {
                    ////console.log("Server Data : valuation/save-form\n", result);
                    var serverData = result.data;
                    ////console.log('save form response', serverData)
                    $("#preloader").css("display", "none");

                    if (serverData.success) {
                        localStorage.setItem('selectedValuationForm', angular.toJson(serverData.result[0]));
                        localStorage.setItem('formId', serverData.result[0].valuationForm._id);
                        ////console.log("aaaaaaaaaaaaaaaaa", localStorage.getItem('formId'));
                        vm.noFormsFound = false;
                        getAllValuationForms();
                        vm.hideBeforeSelection = true;
                        vm.createNew = true;
                        $("#mySaveModal").modal('hide');
                        vm.createNew = false;
                        vm.hideBeforeSelection = false;
                        $scope.$emit('success', serverData.message);
                    } else {
                        vm.alreadyExists = true;
                    }
                    getAllEvidenceFiles();
                }, function(error) {
                    $("#preloader").css("display", "none");
                    $("#error_linking").fadeIn(1500).delay(500).fadeOut(500);
                    ////console.log(error);
                });
        }
    }


    vm.replaceForm = function() {
        $("#preloader").css("display", "block");
        localStorage.setItem('formName', vm.formName);
        ////console.log("status", vm.formStatus);
        var MRids = getEvidencePropertyIds(vm.MREvidences);
        var Vacids = getEvidencePropertyIds(vm.VacancyEvidences);
        var Expids = getEvidencePropertyIds(vm.ExpEvidences);
        var ExpSFids = getEvidencePropertyIds(vm.ExpPSFEvidences);
        var OIids = getEvidencePropertyIds(vm.OIEvidences);
        var BCRids = getEvidencePropertyIds(vm.BCREvidences);
        var ETRids = getEvidencePropertyIds(vm.ETREvidences);
        var Rentids = getEvidencePropertyIds(vm.FreeRentEvidences);
        var leaseids = getEvidencePropertyIds(vm.LeasingEvidences);
        var tenantids = getEvidencePropertyIds(vm.TenantImprovementEvidences);
        var lostids = getEvidencePropertyIds(vm.LostRentEvidences);
        var AddBackids = getEvidencePropertyIds(vm.AddBackEvidences);
        var Capexids = getEvidencePropertyIds(vm.CapexEvidences);
        var Deductionids = getEvidencePropertyIds(vm.DeductionEvidences);

        var jsonFormat = {
            propId: vm.propertyId,
            valuationYear: parseInt(localStorage.getItem('valuationYear')),
            name: vm.formName,
            status: vm.formStatus,
            valuationData: {
                marketRentPerSF: [vm.assessorValuationData.MRPetitioner, vm.valuationPropertyData.MRPetitioner.toString()],
                marketRentPerSFEvidence: MRids,
                marketRentPerSFNote: vm.attachNotes[1].text,

                vacancyPercentage: [vm.assessorValuationData.VacancyPerPetitioner, vm.valuationPropertyData.VacancyPerPetitioner.toString()],
                vacancyPercentageEvidence: Vacids,
                vacancyPercentageNote: vm.attachNotes[2].text,

                expensePercentage: [vm.assessorValuationData.expensePerPetitioner, vm.valuationPropertyData.expensePerPetitioner.toString()],
                expensePercentageEvidence: Expids,
                expensePercentageNote: vm.attachNotes[3].text,

                expensePerSF: [vm.assessorValuationData.expensePerSFPetitioner, vm.valuationPropertyData.expensePerSFPetitioner.toString()],
                expensePerSFEvidence: ExpSFids,
                expensePerSFNote: vm.attachNotes[4].text,

                otherIncome: [vm.assessorValuationData.otherIncomePetitioner, vm.valuationPropertyData.otherIncomePetitioner.toString()],
                otherIncomeEvidence: OIids,
                otherIncomeNote: vm.attachNotes[5].text,

                baseCapRate: [vm.assessorValuationData.BCRPetitioner, vm.valuationPropertyData.BCRPetitioner.toString()],
                baseCapRateEvidence: BCRids,
                baseCapRateNote: vm.attachNotes[6].text,

                effectiveTaxRate: [vm.assessorValuationData.ETRPetitioner, vm.valuationPropertyData.ETRPetitioner.toString()],
                effectiveTaxRateEvidence: ETRids,
                effectiveTaxRateNote: vm.attachNotes[7].text,

                freeRent: vm.deductAndCapex.freeRent.toString(),
                freeRentEvidence: Rentids,
                freeRentNote: vm.attachNotes[8].text,

                leasingCommission: vm.deductAndCapex.leasingCommision.toString(),
                leasingCommissionEvidence: leaseids,
                leasingCommissionNote: vm.attachNotes[9].text,

                tenantsImprovements: vm.deductAndCapex.tenantImprovement.toString(),
                tenantsImprovementsEvidence: tenantids,
                tenantsImprovementsNote: vm.attachNotes[10].text,

                lostRent: vm.deductAndCapex.lostRent.toString(),
                lostRentEvidence: lostids,
                lostRentNote: vm.attachNotes[11].text,

                addBackExcessRent: vm.deductAndCapex.exessRent.toString(),
                addBackExcessRentEvidence: AddBackids,
                addBackExcessRentNote: vm.attachNotes[12].text,

                capEx: vm.deductAndCapex.capex.toString(),
                capExEvidence: Capexids,
                capExNote: vm.attachNotes[13].text,

                totalDeductionsAddtions: vm.deductAndCapex.TDA.toString(),
                totalDeductionsAddtionsEvidence: Deductionids,
                totalDeductionsAddtionsNote: vm.attachNotes[14].text,
            }
        };

        // if (vm.isReplace === '1') {
        ////console.log(jsonFormat);
        var url = '/valuation/replace-valuation-form';
        ValuationService.replaceValuationForm(url, jsonFormat)
            .then(function(result) {
                ////console.log("Server Data : valuation/replace-form\n", result);
                var serverData = result.data;
                $("#preloader").css("display", "none");

                if (serverData.success) {
                    getAllValuationForms();
                    vm.hideBeforeSelection = true;
                    vm.createNew = true;
                    resetFormVariables();
                    $("#myUpdateModal").modal('hide');
                    $scope.$emit('success', serverData.message);
                } else {
                    getAllValuationForms();
                    vm.hideBeforeSelection = true;
                    vm.createNew = true;
                    resetFormVariables();
                    $("#myUpdateModal").modal('hide');
                    $scope.$emit('error', serverData.message);
                }
                getAllEvidenceFiles();
            }, function(error) {
                $("#preloader").css("display", "none");
                $("#error_linking").fadeIn(1500).delay(500).fadeOut(500);
                ////console.log(error);
            });
        // }
    }

    //==============================choose valuation year from modal=============================//

    function selectedValuationYearModal() {
        $("#myModal").modal('hide');
        selectedValuationYear();
    }

    function selectedValuationYear() {
        vm.createNew = false;
        vm.forms = false;
        $("#preloader").css("display", "block");

        async.series([
            function(callback) {
                getValuationData(callback);
            },
            function(callback) {
                getConsolidatedData(callback);
            }
        ], function(err, results) {
            $("#preloader").css("display", "none");
        });
    }


    function getValuationData(callback) {
        vm.showYear = false;
        var metaData = {
            propertyId: vm.propertyId,
            year: vm.valuationYear
        };
        // ////console.log(metaData);
        ValuationService.getEvaluationData(metaData)
            .then(function(result) {
                ////console.log('---------------------------Server Data : getValuationData----------------');
                ////console.log(result);
                var serverData = result.data;
                try{
                    if (serverData.success) {

                        vm.hideBeforeSelection = false;
                        vm.showYear = serverData.result.differentData;
                        vm.yearOfData = serverData.result.year;
                        vm.valuationData = result.data;
    
                        var totalSF = vm.valuationData.result.data.totalSF[1];
    
                        vm.valuationPropertyData.SFLPetitioner = totalSF;
                        vm.assessorValuationData.SFLPetitioner = totalSF;
                        vm.modalAssessorValues.SFLPetitioner = totalSF;
                        vm.modalPetitionerValues.SFLPetitioner = totalSF;
    
    
                        // getPetitionerModalsData();
    
                    } else {
    
    
                        vm.hideBeforeSelection = false;
                        vm.valuationPropertyData.SFLPetitioner = 253;
                        vm.assessorValuationData.SFLPetitioner = 253;
                        vm.modalAssessorValues.SFLPetitioner = 253;
                        vm.modalPetitionerValues.SFLPetitioner = 253;
    
                    }
                }
                catch(_e){
                    vm.hideBeforeSelection = false;
                    vm.valuationPropertyData.SFLPetitioner = 253;
                    vm.assessorValuationData.SFLPetitioner = 253;
                    vm.modalAssessorValues.SFLPetitioner = 253;
                    vm.modalPetitionerValues.SFLPetitioner = 253;
                }
                
                callback();

            }, function(error) {
                callback();
                ////console.log('getEvaluationData error', error);
            });
    }

    function getConsolidatedData(callback) {
        vm.mriShow = true;
        vm.yardiShow = true;
        vm.showYear = false;
        vm.valuationYear = localStorage.getItem('valuationYear');
        var metaData = {
            year: parseInt(localStorage.getItem('valuationYear')),
            propId: parseInt(localStorage.getItem('propertyId')),
        };
        ////console.log(metaData);
        ValuationService.getConsolidatedData(metaData)
            .then(function(result) {
                ////console.log('---------------------------Server Data : getConsolidatedData----------------');
                ////console.log(result);

                if (result.data.success) {
                    var serverData = result.data;
                    try{
                        vm.yardiIEData = serverData.result.yardiIEData;
                        vm.yardiIEYear = vm.yardiIEData[vm.yardiIEData.length - 1];
                        vm.mriIEData = serverData.result.mriIEData;
                        vm.mriIEYear = vm.mriIEData[vm.mriIEData.length - 1];
    
                        if (vm.mriIEData.length == 0) {
                            vm.mriShow = false;
                        } else if (vm.yardiIEData.length == 0) {
                            vm.yardiShow = false;
                        }
                    }
                    catch(_e){
                        vm.mriShow = false;
                        vm.yardiShow = false;
                    }
                    
                } else {
                    ////console.log("dalse")
                    vm.mriShow = false;
                    vm.yardiShow = false;
                }
                // ////console.log(vm.yardiIEData);
                // ////console.log(vm.mriIEData);
                callback();
            }, function(error) {
                callback();
                ////console.log('getConsolidatedData error', error);
            });
    }

    //==============================choose valuation year from modal=============================//



    //================================= valuation dropdown modal selection start =====================================//

    function useModalValues() {

        if (vm.useValuesSelection == 1) {
            // parseFloat(expensesSF).toFixed(0);
            vm.assessorValuationData.SFLPetitioner = parseFloat(vm.modalAssessorValues.SFLPetitioner).toFixed(0);
            vm.assessorValuationData.MRPetitioner = parseFloat(vm.modalAssessorValues.MRPetitioner).toFixed(0);
            vm.assessorValuationData.ARPetitioner = parseFloat(vm.modalAssessorValues.ARPetitioner).toFixed(0);
            vm.assessorValuationData.GPRPetitioner = parseFloat(vm.modalAssessorValues.GPRPetitioner).toFixed(0);
            vm.assessorValuationData.VacancyPerPetitioner = parseFloat(vm.modalAssessorValues.VacancyPerPetitioner).toFixed(0);
            vm.assessorValuationData.VacancyDolarPetitioner = parseFloat(vm.modalAssessorValues.VacancyDolarPetitioner).toFixed(0);
            vm.assessorValuationData.ERPetitioner = parseFloat(vm.modalAssessorValues.ERPetitioner).toFixed(0);
            vm.assessorValuationData.expensePerPetitioner = parseFloat(vm.modalAssessorValues.expensePerPetitioner).toFixed(0);
            vm.assessorValuationData.expenseDolarPetitioner = parseFloat(vm.modalAssessorValues.expenseDolarPetitioner).toFixed(0);
            vm.assessorValuationData.expensePerSFPetitioner = parseFloat(vm.modalAssessorValues.expensePerSFPetitioner).toFixed(0);
            vm.assessorValuationData.otherIncomePetitioner = parseFloat(vm.modalAssessorValues.otherIncomePetitioner).toFixed(0);
            vm.assessorValuationData.NOIPetitioner = parseFloat(vm.modalAssessorValues.NOIPetitioner).toFixed(0);
            vm.assessorValuationData.BCRPetitioner = parseFloat(vm.modalAssessorValues.BCRPetitioner).toFixed(0);
            vm.assessorValuationData.ETRPetitioner = parseFloat(vm.modalAssessorValues.ETRPetitioner).toFixed(0);
            vm.assessorValuationData.OCRPetitioner = parseFloat(vm.modalAssessorValues.OCRPetitioner).toFixed(0);
            vm.assessorValuationData.VDCPetitioner = parseFloat(vm.modalAssessorValues.VDCPetitioner).toFixed(0);
            vm.assessorValuationData.VPSFPetitioner = parseFloat(vm.modalAssessorValues.VPSFPetitioner).toFixed(0);

        }

        if (vm.useValuesSelection == 2) {

            vm.valuationPropertyData.SFLPetitioner = parseFloat(vm.modalPetitionerValues.SFLPetitioner).toFixed(0);
            vm.valuationPropertyData.MRPetitioner = parseFloat(vm.modalPetitionerValues.MRPetitioner).toFixed(0);
            vm.valuationPropertyData.ARPetitioner = parseFloat(vm.modalPetitionerValues.ARPetitioner).toFixed(0);
            vm.valuationPropertyData.GPRPetitioner = parseFloat(vm.modalPetitionerValues.GPRPetitioner).toFixed(0);
            vm.valuationPropertyData.VacancyPerPetitioner = parseFloat(vm.modalPetitionerValues.VacancyPerPetitioner).toFixed(0);
            vm.valuationPropertyData.VacancyDolarPetitioner = parseFloat(vm.modalPetitionerValues.VacancyDolarPetitioner).toFixed(0);
            vm.valuationPropertyData.ERPetitioner = parseFloat(vm.modalPetitionerValues.ERPetitioner).toFixed(0);
            vm.valuationPropertyData.expensePerPetitioner = parseFloat(vm.modalPetitionerValues.expensePerPetitioner).toFixed(0);
            vm.valuationPropertyData.expenseDolarPetitioner = parseFloat(vm.modalPetitionerValues.expenseDolarPetitioner).toFixed(0);
            vm.valuationPropertyData.expensePerSFPetitioner = parseFloat(vm.modalPetitionerValues.expensePerSFPetitioner).toFixed(0);
            vm.valuationPropertyData.otherIncomePetitioner = parseFloat(vm.modalPetitionerValues.otherIncomePetitioner).toFixed(0);
            vm.valuationPropertyData.NOIPetitioner = parseFloat(vm.modalPetitionerValues.NOIPetitioner).toFixed(0);
            vm.valuationPropertyData.BCRPetitioner = parseFloat(vm.modalPetitionerValues.BCRPetitioner).toFixed(0);
            vm.valuationPropertyData.ETRPetitioner = parseFloat(vm.modalPetitionerValues.ETRPetitioner).toFixed(0);
            vm.valuationPropertyData.OCRPetitioner = parseFloat(vm.modalPetitionerValues.OCRPetitioner).toFixed(0);
            vm.valuationPropertyData.VDCPetitioner = parseFloat(vm.modalPetitionerValues.VDCPetitioner).toFixed(0);
            vm.valuationPropertyData.VPSFPetitioner = parseFloat(vm.modalPetitionerValues.VPSFPetitioner).toFixed(0);

        }
    }


    function petitionerModalSelected(selectedModal) {
        $scope.showBoxTwo  = true;

        $(this).toggleClass("active");
        vm.modalSelected = false;

        vm.useValuesSelection = 2;
        vm.modalPetitionerValues.SFLPetitioner = selectedModal.petitionerLeasableSF;
        vm.modalPetitionerValues.MRPetitioner = selectedModal.petitionerMarketRentSF;
        vm.modalPetitionerValues.ARPetitioner = selectedModal.petitionerAnnualRent;
        vm.modalPetitionerValues.GPRPetitioner = selectedModal.petitionerGPR;
        vm.modalPetitionerValues.VacancyPerPetitioner = selectedModal.petitionerVacancyPercentage;
        vm.modalPetitionerValues.VacancyDolarPetitioner = selectedModal.petitionerVacancy;
        vm.modalPetitionerValues.ERPetitioner = selectedModal.petitionerEffectiveRent;
        vm.modalPetitionerValues.expensePerPetitioner = selectedModal.petitionerExpensePercentage;
        vm.modalPetitionerValues.expenseDolarPetitioner = selectedModal.petitionerExpense;
        vm.modalPetitionerValues.expensePerSFPetitioner = selectedModal.petitionerExpenseSF;
        vm.modalPetitionerValues.otherIncomePetitioner = selectedModal.petitionerOI;
        vm.modalPetitionerValues.NOIPetitioner = selectedModal.NOI;
        vm.modalPetitionerValues.BCRPetitioner = selectedModal.BCR;
        vm.modalPetitionerValues.ETRPetitioner = selectedModal.petitionerETR;
        vm.modalPetitionerValues.OCRPetitioner = selectedModal.petitionerOCR;
        vm.modalPetitionerValues.VDCPetitioner = selectedModal.petitionerVDC;
        vm.modalPetitionerValues.VPSFPetitioner = selectedModal.assessedValueSF;

    }

    function assessorModalOneSelected(selectedModal) {
        vm.useValuesSelection = 1;
        $scope.showBoxOne = true;
        //$(".box-one").slideToggle(600);
        $(this).toggleClass("active");
        vm.modalSelected = false;


        vm.modalAssessorValues.SFLPetitioner = selectedModal.petitionerLeasableSF;
        vm.modalAssessorValues.MRPetitioner = selectedModal.petitionerMarketRentSF;
        vm.modalAssessorValues.ARPetitioner = selectedModal.petitionerAnnualRent;
        vm.modalAssessorValues.GPRPetitioner = selectedModal.petitionerGPR;
        vm.modalAssessorValues.VacancyPerPetitioner = selectedModal.petitionerVacancyPercentage;
        vm.modalAssessorValues.VacancyDolarPetitioner = selectedModal.petitionerVacancy;
        vm.modalAssessorValues.ERPetitioner = selectedModal.petitionerEffectiveRent;
        vm.modalAssessorValues.expensePerPetitioner = selectedModal.petitionerExpensePercentage;
        vm.modalAssessorValues.expenseDolarPetitioner = selectedModal.petitionerExpense;
        vm.modalAssessorValues.expensePerSFPetitioner = selectedModal.petitionerExpenseSF;
        vm.modalAssessorValues.otherIncomePetitioner = selectedModal.petitionerOI;
        vm.modalAssessorValues.NOIPetitioner = selectedModal.NOI;
        vm.modalAssessorValues.BCRPetitioner = selectedModal.BCR;
        vm.modalAssessorValues.ETRPetitioner = selectedModal.petitionerETR;
        vm.modalAssessorValues.OCRPetitioner = selectedModal.petitionerOCR;
        vm.modalAssessorValues.VDCPetitioner = selectedModal.petitionerVDC;
        vm.modalAssessorValues.VPSFPetitioner = selectedModal.assessedValueSF;


        // only show modal values

        // vm.modalAssessorValues.MRPetitioner = vm.assessorModalOne.marketRentPerSqFt;
        // calculateMRAssessor();

        // vm.modalAssessorValues.VacancyPerPetitioner = vm.assessorModalOne.vancancyPercentage;
        // calculateERandVacAssessor();

        // vm.modalAssessorValues.expensePerPetitioner = vm.assessorModalOne.expensePercentage;
        // calculateExpensesAssessor();

        // //depends on above
        // // vm.valuationPropertyData.expensePerSFPetitioner = vm.petitionerModalOne.expensesPerSF;
        // // calculateExpensesPetitionerSF();
        // vm.modalAssessorValues.otherIncomePetitioner = vm.assessorModalOne.otherIncome;
        // calculateNOIAssessor();

        // vm.modalAssessorValues.BCRPetitioner = vm.assessorModalOne.baseCapRate;
        // vm.modalAssessorValues.ETRPetitioner = vm.assessorModalOne.effectiveTaxRate;

    }

    //================================== valuation dropdown modal selection end =====================================//

    function getEvidencePropertyIds(Linkedproperties) {
        var propIds = [];

        for (var i = 0; i < Linkedproperties.length; i++) {
            var property = Linkedproperties[i];
            propIds.push(property._id);
        }

        ////console.log(propIds);
        return propIds;

    }
    //attach evidences
    $scope.fileUploaded = function() {
        vm.FileNames = [];
        var files = document.getElementById('file-1').files;
        vm.evidenceFiles = files;
        for (var i = 0; i < files.length; i++) {
            vm.FileNames.push({
                name: files[i].name,
                description: '',
                uploadStatus: true
            });
        }
        if (vm.FileNames.length > 0)
            $('#myModalquestion').modal('toggle');
    }

    //save file call. after attached evidences against input field upload files callback
    vm.uploadEvidenceFile = function() {
        ////console.log('uploadEvidenceFiles function');

        if (vm.evidenceFiles) {
            $("#preloader").css("display", "block");
            var url = '/otherFiles/uploadOtherFiles?propId=' + vm.propertyId;
            var desc = '';
            for (var i = 0; i < vm.FileNames.length; i++) {
                if (i + 1 == vm.FileNames.length) {
                    desc += vm.FileNames[i].description;
                } else {
                    desc += vm.FileNames[i].description + ',';
                }
            }
            AOTCService.uploadFilesWithDescription(url, vm.evidenceFiles, desc)
                .then(function(result) {
                    ////console.log(result);
                    var serverData = result.data;
                    if (serverData.success == true) {
                        $("#preloader").css("display", "none");
                        $scope.$emit('success', serverData.message);
                        getAllEvidenceFiles();

                    } else {
                        $("#preloader").css("display", "none");
                        $(".dangerr").fadeIn(1500).delay(500).fadeOut(500);
                    }

                }, function(result) {
                    ////console.log(result);
                    $("#preloader").css("display", "none");
                });
        }
    }



    //####START========================================================= Evidences Modal ==============================================================//

    vm.sortedAndSearchedEvidences = sortedAndSearchedEvidences;
    vm.sortedAndSearchedSelectedEvidences = sortedAndSearchedSelectedEvidences;

    function sortedAndSearchedEvidences() {

        var searchItem = vm.searchWordAllFile.toLowerCase();

        if (searchItem.length > 0) {

            var filtered = [];
            for (var i = 0; i < vm.allEvidenceFiles.length; i++) {
                var object = vm.allEvidenceFiles[i];

                var type = object.properties.type ? object.properties.type[1].toLowerCase() : 'Not Specified';
                var fileName = object.properties.fileName ? object.properties.fileName[1].toLowerCase() : 'Not Specified';
                var createdDate = object.properties.createdDate ? object.properties.createdDate[1].toLowerCase() : 'Not Specified';


                if (type.indexOf(searchItem) > -1 ||
                    fileName.indexOf(searchItem) > -1 ||
                    createdDate.indexOf(searchItem) > -1
                    // object.properties.description.toLowerCase().indexOf(searchItem) > -1
                ) {
                    filtered.push(object);
                }
            }

            return filtered;

        } else {
            // ////console.log('return all evidence\n', vm.allEvidenceFiles);
            return vm.allEvidenceFiles;

        }
    }

    function sortedAndSearchedSelectedEvidences() {

        var searchItem = vm.searchWordSelectedFile.toLowerCase();

        if (searchItem.length > 0) {
            var filtered = [];
            for (var i = 0; i < vm.selectedEvidences.length; i++) {
                var object = vm.selectedEvidences[i];

                var type = object.properties.type ? object.properties.type[1].toLowerCase() : 'Not Specified';
                var fileName = object.properties.fileName ? object.properties.fileName[1].toLowerCase() : 'Not Specified';
                var createdDate = object.properties.createdDate ? object.properties.createdDate[1].toLowerCase() : 'Not Specified';

                if (type.indexOf(searchItem) > -1 ||
                    fileName.indexOf(searchItem) > -1 ||
                    createdDate.indexOf(searchItem) > -1
                    // object.properties.description.toLowerCase().indexOf(searchItem) > -1
                ) {
                    filtered.push(object);
                }
            }
            return filtered;
        } else {
            // ////console.log('----------------------------already selectedEvidences');
            // ////console.log(vm.selectedEvidences);
            return vm.selectedEvidences;
        }
    }



    //upon sort click
    function sortBy(sort) {

        restoreAllEvidence();
        vm.sortKey = sort;
        // ////console.log(vm.sortKey);
        ////console.log(vm.allEvidenceFiles);

        if (sort == 'fileName') {
            vm.allEvidenceFiles = PetitionerFormulae.sortArrayByKey(vm.allEvidenceFiles, vm.sortKey);
        } else {
            vm.allEvidenceFiles = PetitionerFormulae.sortByKey(vm.allEvidenceFiles, vm.sortKey);

        }
        sortedAndSearchedEvidences();

    }

    function sortBySelected(sort) { //in progress
        //send selected index so that I have again list of all selectedEvidences
        addPetitionerEvidence(vm.attachFileSelection);

        // restoreAllEvidence();
        vm.sortKeySelected = sort;

        ////console.log(vm.sortKeySelected);
        ////console.log(vm.attachFileSelection);

        if (sort == 'fileName') {
            vm.selectedEvidences = PetitionerFormulae.sortArrayByKey(vm.selectedEvidences, vm.sortKeySelected);
        } else {
            vm.selectedEvidences = PetitionerFormulae.sortByKey(vm.selectedEvidences, vm.sortKeySelected);
        }

        sortedAndSearchedSelectedEvidences();
    }

    function restoreAllEvidence() {
        var propEvidence = localStorage.getItem('evidenceFilesAtServer');
        vm.allEvidenceFiles = JSON.parse(propEvidence);
        //by default sort By date
        // sortBy('createdDate');

        for (var i = 0; i < vm.allEvidenceFiles.length; i++) {
            var evidFile = vm.allEvidenceFiles[i];
            for (var k = 0; k < vm.selectedEvidences.length; k++) {
                var selectedEvid = vm.selectedEvidences[k];
                if (selectedEvid._id == evidFile._id) {
                    vm.allEvidenceFiles.splice(i, 1);
                    i = i - 1;
                }
            }
        }
    }

    function ToggleLabelInputs() {
        vm.toggleLabelInputs = !vm.toggleLabelInputs;
    }

    // MOVE TO SELECTED LIST//
    vm.addToSelectedFiles = function(evidence) {

        if (vm.attachFileSelection == 1) //MR
        {
            ////console.log(vm.attachFileSelection);
            vm.MREvidences.push(evidence);

        } else if (vm.attachFileSelection == 2) //Vac %
        {
            ////console.log(vm.attachFileSelection);
            vm.VacancyEvidences.push(evidence);

        } else if (vm.attachFileSelection == 3) //Exp %
        {
            ////console.log(vm.attachFileSelection);
            vm.ExpEvidences.push(evidence);

        } else if (vm.attachFileSelection == 4) //Exp per SF %
        {
            ////console.log(vm.attachFileSelection);
            vm.ExpPSFEvidences.push(evidence);

        } else if (vm.attachFileSelection == 5) //OI
        {
            ////console.log(vm.attachFileSelection);
            vm.OIEvidences.push(evidence);

        } else if (vm.attachFileSelection == 6) //BCR
        {
            ////console.log(vm.attachFileSelection);
            vm.BCREvidences.push(evidence);

        } else if (vm.attachFileSelection == 7) //ETR
        {
            ////console.log(vm.attachFileSelection);
            vm.ETREvidences.push(evidence);

        } else if (vm.attachFileSelection == 8) //ETR
        {
            ////console.log(vm.attachFileSelection);
            vm.FreeRentEvidences.push(evidence);

        } else if (vm.attachFileSelection == 9) //ETR
        {
            ////console.log(vm.attachFileSelection);
            vm.LeasingEvidences.push(evidence);

        } else if (vm.attachFileSelection == 10) //ETR
        {
            ////console.log(vm.attachFileSelection);
            vm.TenantImprovementEvidences.push(evidence);

        } else if (vm.attachFileSelection == 11) //ETR
        {
            ////console.log(vm.attachFileSelection);
            vm.LostRentEvidences.push(evidence);

        } else if (vm.attachFileSelection == 12) //ETR
        {
            ////console.log(vm.attachFileSelection);
            vm.AddBackEvidences.push(evidence);

        } else if (vm.attachFileSelection == 13) //ETR
        {
            ////console.log(vm.attachFileSelection);
            vm.CapexEvidences.push(evidence);

        } else if (vm.attachFileSelection == 14) //ETR
        {
            ////console.log(vm.attachFileSelection);
            vm.DeductionEvidences.push(evidence);

        }


        for (var i = 0; i < vm.allEvidenceFiles.length; i++) {
            var allEvidence = vm.allEvidenceFiles[i]
            if (allEvidence._id == evidence._id) {
                vm.allEvidenceFiles.splice(i, 1);
                i = i - 1;
            }

        }

    }

    //MOVE TO ALL EVIDENCE LIST  FROM SELECTED//
    vm.removeFromSelectedFiles = function(evidence) {

        for (var i = 0; i < vm.selectedEvidences.length; i++) {
            var allEvidence = vm.selectedEvidences[i]

            if (allEvidence._id == evidence._id) {
                ////console.log('true')
                vm.selectedEvidences.splice(i, 1);
                vm.allEvidenceFiles.push(evidence);
            }

        }
    }

    //======================= on input click => OPEN MODEL(myModalEvidence) TO SELECT EVIDENCES ================= //
    function addPetitionerEvidence(selection) {

        vm.attachFileSelection = selection;
        vm.selectedEvidences = [];

        if (vm.attachFileSelection == 1) //MR
        {
            ////console.log(vm.attachFileSelection);
            // ////console.log(vm.MREvidences.length);
            vm.selectedEvidences = vm.MREvidences;

        } else if (vm.attachFileSelection == 2) //Vac %
        {
            ////console.log(vm.attachFileSelection);
            vm.selectedEvidences = vm.VacancyEvidences;

        } else if (vm.attachFileSelection == 3) //Exp %
        {
            vm.selectedEvidences = vm.ExpEvidences;
        } else if (vm.attachFileSelection == 4) //Exp per SF %
        {
            vm.selectedEvidences = vm.ExpPSFEvidences;
        } else if (vm.attachFileSelection == 5) //OI
        {
            vm.selectedEvidences = vm.OIEvidences;
        } else if (vm.attachFileSelection == 6) //BCR
        {
            vm.selectedEvidences = vm.BCREvidences;
        } else if (vm.attachFileSelection == 7) //ETR
        {
            vm.selectedEvidences = vm.ETREvidences;
        } else if (vm.attachFileSelection == 8) //MR
        {
            vm.selectedEvidences = vm.FreeRentEvidences;
        } else if (vm.attachFileSelection == 9) //Vac %
        {
            vm.selectedEvidences = vm.LeasingEvidences;
        } else if (vm.attachFileSelection == 10) //Exp %
        {
            vm.selectedEvidences = vm.TenantImprovementEvidences;
        } else if (vm.attachFileSelection == 11) //Exp per SF %
        {
            vm.selectedEvidences = vm.LostRentEvidences;
        } else if (vm.attachFileSelection == 12) //OI
        {
            vm.selectedEvidences = vm.AddBackEvidences;
        } else if (vm.attachFileSelection == 13) //BCR
        {
            vm.selectedEvidences = vm.CapexEvidences;
        } else if (vm.attachFileSelection == 14) //ETR
        {
            vm.selectedEvidences = vm.DeductionEvidences;
        }
        // ////console.log(vm.attachNotes);
        var propEvidence = localStorage.getItem('evidenceFilesAtServer');
        vm.allEvidenceFiles = JSON.parse(propEvidence);
        //by default sort By date



        //delete already things
        for (var i = 0; i < vm.allEvidenceFiles.length; i++) {
            var evidFile = vm.allEvidenceFiles[i];
            for (var k = 0; k < vm.selectedEvidences.length; k++) {
                var selectedEvid = vm.selectedEvidences[k];

                if (selectedEvid._id == evidFile._id) {
                    vm.allEvidenceFiles.splice(i, 1);
                    i = i - 1;
                }
            }
        }


        sortBy('createdDate');
        PetitionerFormulae.sortByKey(vm.selectedEvidences, 'createdDate')

        //show modal #myModalEvidence
        $('#myModalEvidence').modal('show');

    }

    function getEvidencePropertyById(id) {
        var evidenceProp = {};
        // ////console.log('finding id ', id);

        for (var i = 0; i < vm.allEvidenceFiles.length; i++) {
            var property = vm.allEvidenceFiles[i];
            // ////console.log('property id ', property);
            if (property._id == id) {
                evidenceProp = property;
                break;
            }
        }

        return evidenceProp;

    }

    function retirieveSelectedEvidences() {
        var form = JSON.parse(localStorage.getItem('selectedValuationForm'));

        // ////console.log('######################SELECTED FORM###############');
        vm.selectedEvidences = [];
        restoreAllEvidence();

        vm.MREvidences = [];
        vm.ExpPSFEvidences = [];
        vm.OIEvidences = [];
        vm.BCREvidences = [];
        vm.ETREvidences = [];
        vm.FreeRentEvidences = [];
        vm.LeasingEvidences = [];
        vm.TenantImprovementEvidences = [];
        vm.LostRentEvidences = [];
        vm.AddBackEvidences = [];
        vm.CapexEvidences = [];
        vm.DeductionEvidences = [];
        vm.VacancyEvidences = [];
        vm.ExpEvidences = [];

        // ////console.log(form);
        // ////console.log(vm.selectedEvidences);
        // ////console.log(vm.allEvidenceFiles);



        for (var i = 0; i < form.valuationForm.properties.marketRentPerSFEvidence.length; i++) {
            var id = form.valuationForm.properties.marketRentPerSFEvidence[i];
            var evidence = getEvidencePropertyById(id);
            if (evidence) {
                vm.MREvidences.push(evidence);
            }
        }


        for (var i = 0; i < form.valuationForm.properties.vacancyPercentageEvidence.length; i++) {
            var id = form.valuationForm.properties.vacancyPercentageEvidence[i];
            var evidence = getEvidencePropertyById(id);
            if (evidence) {
                vm.VacancyEvidences.push(evidence);
            }

        }

        for (var i = 0; i < form.valuationForm.properties.expensePercentageEvidence.length; i++) {
            var id = form.valuationForm.properties.expensePercentageEvidence[i];
            var evidence = getEvidencePropertyById(id);
            if (evidence) {
                vm.ExpEvidences.push(evidence);
            }

        }

        for (var i = 0; i < form.valuationForm.properties.expensePerSFEvidence.length; i++) {
            var id = form.valuationForm.properties.expensePerSFEvidence[i];
            var evidence = getEvidencePropertyById(id);
            if (evidence) {
                vm.ExpPSFEvidences.push(evidence);
            }

        }


        for (var i = 0; i < form.valuationForm.properties.otherIncomeEvidence.length; i++) {
            var id = form.valuationForm.properties.otherIncomeEvidence[i];
            var evidence = getEvidencePropertyById(id);
            if (evidence) {
                vm.OIEvidences.push(evidence);
            }
        }

        for (var i = 0; i < form.valuationForm.properties.baseCapRateEvidence.length; i++) {
            var id = form.valuationForm.properties.baseCapRateEvidence[i];
            var evidence = getEvidencePropertyById(id);
            if (evidence) {
                vm.BCREvidences.push(evidence);
            }
        }

        for (var i = 0; i < form.valuationForm.properties.effectiveTaxRateEvidence.length; i++) {
            var id = form.valuationForm.properties.effectiveTaxRateEvidence[i];
            var evidence = getEvidencePropertyById(id);
            if (evidence) {
                vm.ETREvidences.push(evidence);
            }
        }

        for (var i = 0; i < form.valuationForm.properties.freeRentEvidence.length; i++) {
            var id = form.valuationForm.properties.freeRentEvidence[i];
            var evidence = getEvidencePropertyById(id);
            if (evidence) {
                vm.FreeRentEvidences.push(evidence);
            }
        }

        for (var i = 0; i < form.valuationForm.properties.leasingCommissionEvidence.length; i++) {
            var id = form.valuationForm.properties.leasingCommissionEvidence[i];
            var evidence = getEvidencePropertyById(id);
            if (evidence) {
                vm.LeasingEvidences.push(evidence);
            }
        }

        for (var i = 0; i < form.valuationForm.properties.tenantsImprovementsEvidence.length; i++) {
            var id = form.valuationForm.properties.tenantsImprovementsEvidence[i];
            var evidence = getEvidencePropertyById(id);
            if (evidence) {
                vm.TenantImprovementEvidences.push(evidence);
            }
        }

        for (var i = 0; i < form.valuationForm.properties.lostRentEvidence.length; i++) {
            var id = form.valuationForm.properties.lostRentEvidence[i];
            var evidence = getEvidencePropertyById(id);
            if (evidence) {
                vm.LostRentEvidences.push(evidence);
            }
        }

        for (var i = 0; i < form.valuationForm.properties.addBackExcessRentEvidence.length; i++) {
            var id = form.valuationForm.properties.addBackExcessRentEvidence[i];
            var evidence = getEvidencePropertyById(id);
            if (evidence) {
                vm.AddBackEvidences.push(evidence);
            }
        }


        for (var i = 0; i < form.valuationForm.properties.capExEvidence.length; i++) {
            var id = form.valuationForm.properties.capExEvidence[i];
            var evidence = getEvidencePropertyById(id);
            if (evidence) {
                vm.CapexEvidences.push(evidence);
            }
        }

        for (var i = 0; i < form.valuationForm.properties.totalDeductionsAddtionsEvidence.length; i++) {
            var id = form.valuationForm.properties.totalDeductionsAddtionsEvidence[i];
            var evidence = getEvidencePropertyById(id);
            if (evidence) {
                vm.DeductionEvidences.push(evidence);
            }
        }

    }



    //####END========================================================= Evidences Modal ==============================================================//


    vm.viewParticularForm = function(form) {
        // vm.currentForm = forms;
        vm.createNew = false;
        vm.formName = form.name;
        localStorage.setItem('formName', vm.formName);
        // ////console.log(form);
        localStorage.getItem('selectedValuationForm');
        $("#preloader").css("display", "block");

        async.series([
            function(callback) {
                getValuationData(callback);
            },
            function(callback) {
                getConsolidatedData(callback);
            },
            function(callback) {
                useForm(form, callback)
            },
            function(callback) {
                vm.assessorModalData = [];
                ValuationService.getPetitionerModalsData()
                    .then(function(result) {
                        ////console.log('getPetitionerModalsData Server Data');
                        ////console.log(result);
                        vm.assessorModalData = result.data.result[0].models;
                        callback();
                    }, function(err) {
                        ////console.log(err);

                    });
            }

        ], function(err, results) {
            $("#preloader").css("display", "none");
        });
    }

    function useForm(form, callback) {

        localStorage.setItem('formId', form.valuationForm._id);
        localStorage.setItem('selectedValuationForm', angular.toJson(form));
        retirieveSelectedEvidences();
        vm.createNew = false;
        vm.formId = form.valuationForm._id;
        var data = form.valuationForm.properties;

        vm.valuationPropertyData.SFLPetitioner = 253;


        vm.valuationPropertyData.MRPetitioner = data.marketRentPerSF[1];
        vm.valuationPropertyData.ARPetitioner = PetitionerFormulae.Petitioner.annualRent(
            vm.valuationPropertyData.SFLPetitioner,
            vm.valuationPropertyData.MRPetitioner);
        vm.valuationPropertyData.GPRPetitioner = vm.valuationPropertyData.ARPetitioner;
        vm.valuationPropertyData.VacancyPerPetitioner = data.vacancyPercentage[1];
        vm.valuationPropertyData.VacancyDolarPetitioner = PetitionerFormulae.Petitioner.vacancy(
            vm.valuationPropertyData.GPRPetitioner,
            (vm.valuationPropertyData.VacancyPerPetitioner / 100));
        vm.valuationPropertyData.ERPetitioner = PetitionerFormulae.Petitioner.effectiveRent(
            vm.valuationPropertyData.ARPetitioner,
            (vm.valuationPropertyData.VacancyDolarPetitioner / 100));
        vm.valuationPropertyData.expensePerPetitioner = data.expensePercentage[1];
        vm.valuationPropertyData.expenseDolarPetitioner = PetitionerFormulae.Petitioner.expenses(
            vm.valuationPropertyData.ERPetitioner,
            (vm.valuationPropertyData.expensePerPetitioner / 100));
        vm.valuationPropertyData.expensePerSFPetitioner = data.expensePerSF[1];
        vm.valuationPropertyData.otherIncomePetitioner = data.otherIncome[1];
        vm.valuationPropertyData.NOIPetitioner = PetitionerFormulae.Petitioner.netOperatingIncome(
            vm.valuationPropertyData.ERPetitioner,
            vm.valuationPropertyData.expenseDolarPetitioner);
        vm.valuationPropertyData.BCRPetitioner = data.baseCapRate[1];
        vm.valuationPropertyData.ETRPetitioner = data.effectiveTaxRate[1];
        vm.valuationPropertyData.OCRPetitioner = PetitionerFormulae.Petitioner.overAllCapRate(
            parseInt(vm.valuationPropertyData.BCRPetitioner),
            parseInt(vm.valuationPropertyData.ETRPetitioner));
        vm.valuationPropertyData.VDCPetitioner = PetitionerFormulae.Petitioner.valueDirectCap(
            vm.valuationPropertyData.OCRPetitioner,
            vm.valuationPropertyData.NOIPetitioner);
        vm.valuationPropertyData.VPSFPetitioner = PetitionerFormulae.Petitioner.valuePerSqFt(
            vm.valuationPropertyData.VDCPetitioner,
            vm.valuationPropertyData.SFLPetitioner);


        vm.assessorValuationData.MRPetitioner = data.marketRentPerSF[0];
        vm.assessorValuationData.ARPetitioner = PetitionerFormulae.Petitioner.annualRent(
            vm.assessorValuationData.SFLPetitioner,
            vm.assessorValuationData.MRPetitioner);
        vm.assessorValuationData.GPRPetitioner = vm.assessorValuationData.ARPetitioner;
        vm.assessorValuationData.VacancyPerPetitioner = data.vacancyPercentage[0];
        vm.assessorValuationData.VacancyDolarPetitioner = PetitionerFormulae.Petitioner.vacancy(
            vm.assessorValuationData.GPRPetitioner,
            (vm.assessorValuationData.VacancyPerPetitioner / 100));
        vm.assessorValuationData.ERPetitioner = PetitionerFormulae.Petitioner.effectiveRent(
            vm.assessorValuationData.ARPetitioner,
            (vm.assessorValuationData.VacancyDolarPetitioner / 100));
        vm.assessorValuationData.expensePerPetitioner = data.expensePercentage[0];
        vm.assessorValuationData.expenseDolarPetitioner = PetitionerFormulae.Petitioner.expenses(
            vm.assessorValuationData.ERPetitioner,
            (vm.assessorValuationData.expensePerPetitioner / 100));
        vm.assessorValuationData.expensePerSFPetitioner = data.expensePerSF[0];
        vm.assessorValuationData.otherIncomePetitioner = data.otherIncome[0];
        vm.assessorValuationData.NOIPetitioner = PetitionerFormulae.Petitioner.netOperatingIncome(
            vm.assessorValuationData.ERPetitioner,
            vm.assessorValuationData.expenseDolarPetitioner);
        vm.assessorValuationData.BCRPetitioner = data.baseCapRate[0];
        vm.assessorValuationData.ETRPetitioner = data.effectiveTaxRate[0];
        vm.assessorValuationData.OCRPetitioner = PetitionerFormulae.Petitioner.overAllCapRate(
            parseInt(vm.assessorValuationData.BCRPetitioner),
            parseInt(vm.assessorValuationData.ETRPetitioner));
        vm.assessorValuationData.VDCPetitioner = PetitionerFormulae.Petitioner.valueDirectCap(
            vm.assessorValuationData.OCRPetitioner,
            vm.assessorValuationData.NOIPetitioner);
        vm.assessorValuationData.VPSFPetitioner = PetitionerFormulae.Petitioner.valuePerSqFt(
            vm.assessorValuationData.VDCPetitioner,
            vm.assessorValuationData.SFLPetitioner);

        vm.deductAndCapex.freeRent = data.freeRent;
        vm.deductAndCapex.leasingCommision = data.leasingCommission;
        vm.deductAndCapex.tenantImprovement = data.tenantsImprovements;
        vm.deductAndCapex.lostRent = data.lostRent;
        vm.deductAndCapex.exessRent = data.addBackExcessRent;
        vm.deductAndCapex.capex = data.capEx;
        vm.deductAndCapex.TDA = data.totalDeductionsAddtions;
        vm.deductAndCapex.VDC = PetitionerFormulae.Petitioner.vdcPostDeduction(
            vm.valuationPropertyData.VDCPetitioner,
            vm.deductAndCapex.TDA);
        vm.deductAndCapex.VDL = PetitionerFormulae.Petitioner.vdcPostDeductionPerSF(
            vm.deductAndCapex.VDC,
            vm.valuationPropertyData.SFLPetitioner);

        vm.valuationPropertyData.OCRPetitioner = vm.valuationPropertyData.OCRPetitioner ? vm.valuationPropertyData.OCRPetitioner : 0;
        vm.valuationPropertyData.VDCPetitioner = vm.valuationPropertyData.VDCPetitioner ? vm.valuationPropertyData.VDCPetitioner : 0;
        vm.valuationPropertyData.VPSFPetitioner = vm.valuationPropertyData.VPSFPetitioner ? vm.valuationPropertyData.VPSFPetitioner : 0;

        vm.assessorValuationData.OCRPetitioner = vm.assessorValuationData.OCRPetitioner ? vm.assessorValuationData.OCRPetitioner : 0;
        vm.assessorValuationData.VDCPetitioner = vm.assessorValuationData.VDCPetitioner ? vm.assessorValuationData.VDCPetitioner : 0;
        vm.assessorValuationData.VPSFPetitioner = vm.assessorValuationData.VPSFPetitioner ? vm.assessorValuationData.VPSFPetitioner : 0;



        callback();
    }

    vm.replace = function(val) {

        if (val === 1) {
            vm.isReplace = true;
        } else {;
            vm.isReplace = false;
        }
    }

    vm.save = function() {
        ////console.log("working");
        vm.alreadyExists = false;
        vm.isReplace = false;
    }

    vm.cancel = cancel;

    function cancel() {
        vm.alreadyExists = false;
        vm.isReplace = false;
        resetFormVariables();
        vm.hideBeforeSelection = true;
        vm.createNew = true;
    }


    vm.redirectToWorkspace = function(form) {
        // ////console.log(form);
        localStorage.setItem('formId', form.valuationForm._id);
        localStorage.setItem('formName', form.name);
        localStorage.setItem('selectedValuationForm', angular.toJson(form));

        $state.go('ScenarioOne');
    }




    //====================================================================================================================================//


    function calculateMRPetitioner() {
        // ////console.log(vm.modalPetitionerValues.MRPetitioner);
        // vm.valuationPropertyData.SFLPetitioner;
        var annualRent = PetitionerFormulae.Petitioner.annualRent(
            vm.modalPetitionerValues.SFLPetitioner,
            vm.modalPetitionerValues.MRPetitioner);


        vm.modalPetitionerValues.ARPetitioner = annualRent;
        vm.modalPetitionerValues.GPRPetitioner = annualRent;


    }


    function calculateMRInput(valuationObject) {

        // ////console.log(valuationObject.MRPetitioner);
        // vm.valuationPropertyData.SFLPetitioner;
        var annualRent = PetitionerFormulae.Petitioner.annualRent(
            valuationObject.SFLPetitioner,
            valuationObject.MRPetitioner);


        valuationObject.ARPetitioner = annualRent;
        valuationObject.GPRPetitioner = annualRent;

    }

    function calculateERandVacInput(valuationObject) {
        // ////console.log(valuationObject.VacancyPerPetitioner);
        var percentage = valuationObject.VacancyPerPetitioner / 100;

        // vm.valuationPropertyData.SFLPetitioner;
        var vacancyDolar = PetitionerFormulae.Petitioner.vacancy(
            valuationObject.GPRPetitioner,
            percentage);


        var ER = PetitionerFormulae.Petitioner.effectiveRent(
            valuationObject.ARPetitioner,
            percentage);


        valuationObject.VacancyDolarPetitioner = vacancyDolar;
        valuationObject.ERPetitioner = ER;

    }

    function calculateExpensesInput(valuationObject) {
        // ////console.log('toggle');

        // ////console.log(valuationObject.expensePerPetitioner);
        // ////console.log(valuationObject.ERPetitioner);

        if (valuationObject.expensePerPetitioner) {
            //disable SF field
            vm.disableExpenseFieldsPer = false;
            vm.disableExpenseFieldsSF = true;

            var percentage = valuationObject.expensePerPetitioner / 100;

            // vm.valuationPropertyData.SFLPetitioner;
            var expenses = PetitionerFormulae.Petitioner.expenses(
                valuationObject.ERPetitioner,
                percentage);

            //Hamzah
            var expensesSF = PetitionerFormulae.Petitioner.expensesPerSf(
                expenses,
                valuationObject.SFLPetitioner);

            // ////console.log(expenses);
            // ////console.log(expensesSF);


            valuationObject.expenseDolarPetitioner = expenses;
            valuationObject.expensePerSFPetitioner = parseFloat(expensesSF).toFixed(0);
            // vm.valuationPropertyData.expensePerSFPetitioner = 34;
        } else {
            // ////console.log('enable all');
            vm.disableExpenseFieldsPer = false;
            vm.disableExpenseFieldsSF = false;
        }

    }

    function calculateExpensesSFInput(valuationObject) {

        if (valuationObject.expensePerSFPetitioner) {
            //disable SF field
            vm.disableExpenseFieldsPer = true;
            vm.disableExpenseFieldsSF = false;
            // vm.valuationPropertyData.SFLPetitioner;
            var expensesDolar = PetitionerFormulae.Petitioner.expensesDolar(
                valuationObject.SFLPetitioner, valuationObject.expensePerSFPetitioner);
            var expensesPerc = PetitionerFormulae.Petitioner.expensesPercentage(
                expensesDolar,
                valuationObject.ERPetitioner);


            valuationObject.expensePerPetitioner = expensesPerc;
            valuationObject.expenseDolarPetitioner = expensesDolar;

        } else {

            vm.disableExpenseFieldsPer = false;
            vm.disableExpenseFieldsSF = false;
        }

    }

    function calculateNOIInput(valuationObject) {

        var NOI = PetitionerFormulae.Petitioner.netOperatingIncome(
            valuationObject.ERPetitioner,
            valuationObject.expenseDolarPetitioner);

        valuationObject.NOIPetitioner = NOI;

    }

    function calculateBCRInput(valuationObject) {
        // ////console.log(vm.valuationPropertyData.ETRPetitioner);
        // ////console.log(vm.valuationPropertyData.ETRPetitioner.toString().length);
        if (valuationObject.ETRPetitioner.toString().length > 0) {

            // ////console.log(vm.valuationPropertyData.BCRPetitioner);
            // ////console.log(vm.valuationPropertyData.ETRPetitioner);

            var OCR = PetitionerFormulae.Petitioner.overAllCapRate(
                parseInt(valuationObject.BCRPetitioner),
                parseInt(valuationObject.ETRPetitioner));

            var VDC = PetitionerFormulae.Petitioner.valueDirectCap(
                OCR,
                valuationObject.NOIPetitioner);

            var ValueSQFT = PetitionerFormulae.Petitioner.valuePerSqFt(
                VDC,
                valuationObject.SFLPetitioner);

            valuationObject.OCRPetitioner = OCR;
            valuationObject.VDCPetitioner = VDC;
            valuationObject.VPSFPetitioner = ValueSQFT;
        }

    }


    function calculateERandVacPetitioner() {
        var percentage = vm.modalPetitionerValues.VacancyPerPetitioner / 100;

        // vm.valuationPropertyData.SFLPetitioner;
        var vacancyDolar = PetitionerFormulae.Petitioner.vacancy(
            vm.modalPetitionerValues.GPRPetitioner,
            percentage);


        var ER = PetitionerFormulae.Petitioner.effectiveRent(
            vm.modalPetitionerValues.ARPetitioner,
            percentage);


        vm.modalPetitionerValues.VacancyDolarPetitioner = vacancyDolar;
        vm.modalPetitionerValues.ERPetitioner = ER;

    }


    function calculateExpensesPetitioner() {

        if (vm.modalPetitionerValues.expensePerPetitioner.toString().length > 0) {
            //disable SF field
            vm.disableExpenseFieldsPer = false;
            vm.disableExpenseFieldsSF = true;

            var percentage = vm.modalPetitionerValues.expensePerPetitioner / 100;

            var expenses = PetitionerFormulae.Petitioner.expenses(
                vm.modalPetitionerValues.ERPetitioner,
                percentage);

            var expensesSF = PetitionerFormulae.Petitioner.expensesPerSf(
                expenses,
                vm.modalPetitionerValues.SFLPetitioner);

            vm.modalPetitionerValues.expenseDolarPetitioner = expenses;
            vm.modalPetitionerValues.expensePerSFPetitioner = parseFloat(expensesSF).toFixed(0);
            // vm.valuationPropertyData.expensePerSFPetitioner = 34;
        } else {
            vm.disableExpenseFieldsPer = false;
            vm.disableExpenseFieldsSF = false;
        }

    }

    function calculateExpensesPetitionerSF() {

        if (vm.modalPetitionerValues.expensePerSFPetitioner.length > 0) {

            vm.disableExpenseFieldsPer = true;
            vm.disableExpenseFieldsSF = false;

            var expensesDolar = PetitionerFormulae.Petitioner.expensesDolar(
                vm.modalPetitionerValues.SFLPetitioner, vm.modalPetitionerValues.expensePerSFPetitioner);

            var expensesPerc = PetitionerFormulae.Petitioner.expensesPercentage(
                expensesDolar,
                vm.modalPetitionerValues.ERPetitioner);

            vm.modalPetitionerValues.expensePerPetitioner = expensesPerc;
            vm.modalPetitionerValues.expenseDolarPetitioner = expensesDolar;

        } else {
            vm.disableExpenseFieldsPer = false;
            vm.disableExpenseFieldsSF = false;
        }
    }

    function calculateNOIPetitioner() {

        var NOI = PetitionerFormulae.Petitioner.netOperatingIncome(
            vm.modalPetitionerValues.ERPetitioner,
            vm.modalPetitionerValues.expenseDolarPetitioner);

        vm.modalPetitionerValues.NOIPetitioner = NOI;
    }

    function calculateBCRPetitioner() {
        if (vm.modalPetitionerValues.ETRPetitioner.toString().length > 0) {
            var OCR = PetitionerFormulae.Petitioner.overAllCapRate(
                parseInt(vm.modalPetitionerValues.BCRPetitioner),
                parseInt(vm.modalPetitionerValues.ETRPetitioner));

            var VDC = PetitionerFormulae.Petitioner.valueDirectCap(
                OCR,
                vm.modalPetitionerValues.NOIPetitioner);

            var ValueSQFT = PetitionerFormulae.Petitioner.valuePerSqFt(
                VDC,
                vm.modalPetitionerValues.SFLPetitioner);

            vm.modalPetitionerValues.OCRPetitioner = OCR;
            vm.modalPetitionerValues.VDCPetitioner = VDC;
            vm.modalPetitionerValues.VPSFPetitioner = ValueSQFT;
        }
    }

    function calculateMRAssessor() {

        var annualRent = PetitionerFormulae.Petitioner.annualRent(
            vm.modalAssessorValues.SFLPetitioner,
            vm.modalAssessorValues.MRPetitioner);

        vm.modalAssessorValues.ARPetitioner = annualRent;
        vm.modalAssessorValues.GPRPetitioner = annualRent;
    }

    function calculateERandVacAssessor() {
        var percentage = vm.modalAssessorValues.VacancyPerPetitioner / 100;
        // vm.valuationPropertyData.SFLPetitioner;
        var vacancyDolar = PetitionerFormulae.Petitioner.vacancy(
            vm.modalAssessorValues.GPRPetitioner,
            percentage);
        var ER = PetitionerFormulae.Petitioner.effectiveRent(
            vm.modalAssessorValues.ARPetitioner,
            percentage);
        vm.modalAssessorValues.VacancyDolarPetitioner = vacancyDolar;
        vm.modalAssessorValues.ERPetitioner = ER;
    }

    function calculateExpensesAssessor() {

        if (vm.modalAssessorValues.expensePerPetitioner.toString().length > 0) {
            vm.disableExpenseFieldsPer = false;
            vm.disableExpenseFieldsSF = true;
            var percentage = vm.modalAssessorValues.expensePerPetitioner / 100;
            // vm.valuationPropertyData.SFLPetitioner;
            var expenses = PetitionerFormulae.Petitioner.expenses(
                vm.modalAssessorValues.ERPetitioner,
                percentage);

            var expensesSF = PetitionerFormulae.Petitioner.expensesPerSf(
                expenses,
                vm.modalAssessorValues.SFLPetitioner);

            vm.modalAssessorValues.expenseDolarPetitioner = expenses;
            vm.modalAssessorValues.expensePerSFPetitioner = parseFloat(expensesSF).toFixed(0);
        } else {
            vm.disableExpenseFieldsPer = false;
            vm.disableExpenseFieldsSF = false;
        }
    }

    function calculateExpensesAssessorSF() {

        if (vm.assessorValuationData.expensePerSFPetitioner.length > 0) {
            vm.disableExpenseFieldsPer = true;
            vm.disableExpenseFieldsSF = false;

            var expensesDolar = PetitionerFormulae.Petitioner.expensesDolar(
                vm.assessorValuationData.SFLPetitioner, vm.assessorValuationData.expensePerSFPetitioner);

            var expensesPerc = PetitionerFormulae.Petitioner.expensesPercentage(
                expensesDolar,
                vm.assessorValuationData.ERPetitioner);
            vm.assessorValuationData.expensePerPetitioner = expensesPerc;
            vm.assessorValuationData.expenseDolarPetitioner = expensesDolar;

        } else {
            vm.disableExpenseFieldsPer = false;
            vm.disableExpenseFieldsSF = false;
        }
    }

    function calculateNOIAssessor() {
        var NOI = PetitionerFormulae.Petitioner.netOperatingIncome(
            vm.modalAssessorValues.ERPetitioner,
            vm.modalAssessorValues.expenseDolarPetitioner);

        vm.modalAssessorValues.NOIPetitioner = NOI;
    }

    function calculateBCRAssessor() {
        if (vm.modalAssessorValues.ETRPetitioner.toString().length > 0) {

            var OCR = PetitionerFormulae.Petitioner.overAllCapRate(
                parseInt(vm.modalAssessorValues.BCRPetitioner),
                parseInt(vm.modalAssessorValues.ETRPetitioner));

            var VDC = PetitionerFormulae.Petitioner.valueDirectCap(
                OCR,
                vm.modalAssessorValues.NOIPetitioner);

            var ValueSQFT = PetitionerFormulae.Petitioner.valuePerSqFt(
                VDC,
                vm.modalAssessorValues.SFLPetitioner);
            vm.modalAssessorValues.OCRPetitioner = OCR;
            vm.modalAssessorValues.VDCPetitioner = VDC;
            vm.modalAssessorValues.VPSFPetitioner = ValueSQFT;
        }

    }

    function calculateDeductAndCapex() {
        var vdcPostDeduction = PetitionerFormulae.Petitioner.vdcPostDeduction(
            vm.valuationPropertyData.VDCPetitioner,
            vm.deductAndCapex.TDA);


        var vdcPostDeductionSF = PetitionerFormulae.Petitioner.vdcPostDeductionPerSF(
            vdcPostDeduction,
            vm.valuationPropertyData.SFLPetitioner);


        vm.deductAndCapex.VDC = vdcPostDeduction;
        vm.deductAndCapex.VDL = vdcPostDeductionSF;

    }


    //=================================== Modals and Use values button hide show start ==========================//
    var boxOneActive = false;
    var boxTwoActive = false;

    $(document).mouseup(function(e) {
        boxOneActive = false;
        var popup = $(".box-one");
         
        if (!$('.box-one').is(e.target) && !popup.is(e.target) && popup.has(e.target).length == 0) {
            $scope.showBoxOne = false;
        } else {
            boxOneActive = true;
        }
    });

    $(document).mouseup(function(e) {
        boxTwoActive = false;
        var popup = $(".box-two");
        if (!$('.box-two').is(e.target) && !popup.is(e.target) && popup.has(e.target).length == 0) {
            $scope.showBoxTwo = false;
        } else {
            boxTwoActive = true;
        }

        if (!boxOneActive && !boxTwoActive) {
            vm.modalSelected = true;
        }

        $scope.$apply();

    });


    $(document).on('click', '.dropdown-menu', function(e) {
        if ($(this).hasClass('keep-open-on-click')) {
            e.stopPropagation();
        }
    });





    vm.numberFormatter = function(val, roundedVal) {
        var result = UtilService.numberFormatterValuation(val, roundedVal);
        return result
    };


    //===================formats of petitioner and assessor start ===========================//

    $("#for-1").click(function() {
        $(" .format1 ").show("slow");

        $(" .format2 ").hide("slow");
        $(" .format3").hide("slow");
    });

    $("#for-2").click(function() {
        $(" .format2 ").show("slow");

        $(" .format1 ").hide("slow");
        $(" .format3 ").hide("slow");
    });

    $("#for-3").click(function() {
        $(" .format3 ").show("slow");

        $(" .format2 ").hide("slow");
        $(" .format1 ").hide("slow");
    });


    $(".btn-formats").click(function(e) {
        $(this).addClass("btn-formats-active").siblings().removeClass("btn-formats-active");
    });

    //============================END========================//


    $(".toggle-btn").click(function(e) {
        $(this).addClass("toggle-btn-active").siblings().removeClass("toggle-btn-active");
    });



    $scope.$on("$destroy", function handler() {
        $('#myModal').modal('hide');
        $('body').removeClass('modal-open');
        $('.modal-backdrop').remove();

    });



    vm.showHideYear = function() {
        $timeout(function() {
            vm.yearChecked = !vm.yearChecked;
        }, 100);

        // $('#tableone td:nth-child(3)').toggle();
        // $('#tableone th:nth-child(3)').toggle();
    }

    vm.showHideAOTC = function() {
        // ////console.log('showHideClick');
        $timeout(function() {
            vm.recomendationChecked = !vm.recomendationChecked;
        }, 100);

        // $('#tableone td:nth-child(5)').toggle();
        // $('#tableone th:nth-child(5)').toggle();
    }

    vm.exportToPDF = function(){
        $("#preloader").css("display", "block");
            var pdf = new jsPDF('p', 'pt', 'a1');
            // source can be HTML-formatted string, or a reference
            // to an actual DOM element from which the text will be scraped.
            var source = $('#exportdiv')[0];
          
            // we support special element handlers. Register them with jQuery-style 
            // ID selector for either ID or node name. ("#iAmID", "div", "span" etc.)
            // There is no support for any other type of selectors 
            // (class, of compound) at this time.
             var specialElementHandlers = {
              // element with id of "bypass" - jQuery style selector
              '#bypassme': function(element, renderer) {
                // true = "handled elsewhere, bypass text extraction"
                return true
              }
            };
            var margins = {
              top: 20,
              bottom: 20,
              left: 20,
              width: 2000
            };
            // all coords and widths are in jsPDF instance's declared units
            // 'inches' in this case
            pdf.fromHTML(
              source, // HTML string or DOM elem ref.
              margins.left, // x coord
              margins.top, { // y coord
                'width': margins.width, // max width of content on PDF
                'elementHandlers': specialElementHandlers
              },
          
              function(dispose) {
                // dispose: object with X, Y of the last line add to the PDF 
                //          this allow the insertion of new lines after html
                var dateObj = new Date();
                    var timeString = dateObj.getHours() + '' + dateObj.getMinutes() + '';
                
                    var year = dateObj.getFullYear();
                    var month = dateObj.getMonth() + 1; // Jan is 0, dec is 11
                    var day = dateObj.getDate();
                    var dateString = 'Valuation-' + year + '-' + month + '-' + day+ '-'+timeString;

                var _file  = pdf.output('blob');

                var url = '/valuation/createAppealPackage?propId='+
                parseInt(localStorage.getItem('propertyId'))+
                '&year='+ vm.valuationYear+
                '&formId='+localStorage.getItem('formId');
                
                //var defer = $q.defer();
                AOTCService.uploadFiles(url, [_file]).
                then(function (response) {
                    // defer.resolve(result);
                    //downloadPDF(response);
                    getPDFfromServer(response);
                    $("#preloader").css("display", "none");
                }, function (err) {
                    $("#preloader").css("display", "none");
                    
                    //  defer.reject(err);
                });
                
                //return defer.promise;
               
              }, margins);
    
          
    };

    function getPDFfromServer(_res){
        try{
            // var url = '/users/downloadAppealPackage?path='+_res.result;
            var downloadLink      = document.createElement('a');
            downloadLink.target   = '_blank';
            var _prefix = location.protocol + '//' + location.host;        
            // create an object URL from the Blob
            var URL = window.URL || window.webkitURL;
            var downloadUrl = _prefix+'/users/downloadAppealPackage?path='+_res.data.result;
          
            // set object URL as the anchor's href
            downloadLink.href = downloadUrl;
          
            // append the anchor to document body
            document.body.appendChild(downloadLink);
          
            // fire a click event on the anchor
            downloadLink.click();
          
            // cleanup: remove element and revoke object URL
            document.body.removeChild(downloadLink);
            URL.revokeObjectURL(downloadUrl);
        }
        catch(_e){}

    };

}
function _inputFocusFunction() {
    'use strict';
    return {
        restrict: 'A',
        link: function(scope, element, attr) {
            // Parse the attribute to accomodate assignment to an object
            var parseObj = attr.inputFocusFunction.split('.');
            var attachTo = scope;
            for (var i = 0; i < parseObj.length - 1; i++) {
                attachTo = attachTo[parseObj[i]];
            }
            // assign it to a function that focuses on the decorated element
            attachTo[parseObj[parseObj.length - 1]] = function() {
                element[0].focus();
            };
        }
    };
}
/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 100 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {


_Properties.$inject = ["UtilService", "$anchorScroll", "$stateParams", "$state", "DTOptionsBuilder", "DTColumnDefBuilder", "$location", "$scope", "__env", "$log", "AOTCService", "$timeout"];
_upload.$inject = ["$http"];
module.exports = {Properties: _Properties, upload: _upload};

//angular.module('AOTC')
//    .directive('upload', ['$http',
//        _upload
//    ])

//    .controller('Properties', _Properties
//    );
function _upload($http) {
    return {
        restrict: 'E',
        replace: true,
        scope: {},
        require: '?ngModel',
        template: '<div class="asset-upload">Drag here to upload</div>',
        link: function (scope, element, attrs, ngModel) {

            // Code goes here
            element.on('dragover', function (e) {
                e.preventDefault();
                e.stopPropagation();
            });
            element.on('dragenter', function (e) {
                e.preventDefault();
                e.stopPropagation();
            });

            element.on('drop', function (e) {
                e.preventDefault();
                e.stopPropagation();

                ////console.log(e.originalEvent.dataTransfer.files);
                // if (e.originalEvent.dataTransfer) {
                //     if (e.originalEvent.dataTransfer.files.length > 0) {
                //         upload(e.originalEvent.dataTransfer.files);
                //     }
                // }
                //      for (var i = 0, f; f = files[i]; i++) {
                //     var reader = new FileReader();
                //     reader.readAsArrayBuffer(f);

                //     reader.onload = (function(theFile) {
                //         return function(e) {
                //             var newFile = { name : theFile.name,
                //                 type : theFile.type,
                //                 size : theFile.size,
                //                 lastModifiedDate : theFile.lastModifiedDate
                //             }

                //             scope.addfile(newFile);
                //         };
                //     })(f);
                // }
                return false;
            });
        }
    };
}
function _Properties(UtilService, $anchorScroll, $stateParams, $state, DTOptionsBuilder, DTColumnDefBuilder, $location, $scope, __env, $log, AOTCService, $timeout) {
    // ////console.log("Properties controller", $stateParams);
    var vm = this;

    //=========Variables
    vm.dtOptions = DTOptionsBuilder.newOptions()
        .withOption('lengthMenu', [
            [20, 50, 100, -1],
            [20, 50, 100, "All"]
        ])
        .withOption('order', [
            [2, 'asc']
        ])
        .withDisplayLength(20);

    vm.dtColumnDefs = [
        DTColumnDefBuilder.newColumnDef(0).notSortable(),
        DTColumnDefBuilder.newColumnDef(1).notSortable()
    ];
    var userIdls = localStorage.getItem("userId");
    var isAllDataMapped = true;
    var targetDataFields = "";
    var mapping = {};
    var result = [];
    vm.old = $location.hash();

    //=========Attributes

    vm.showTableRelatedDivs = false;
    vm.showFileUploadFields = true;
    vm.mappingNeeded = false;
    vm.checkAll = 0;
    vm.data = 'none';
    vm.myFile = "";
    vm.fileName = "";
    vm.myFile = [];
    vm.propertiesToBeRegistered = [];
    vm.onlyFileName = "";

    //========= Data Mapping page redirected to this logic

    if ($stateParams) {

        if ($stateParams.message == "from data mapping") {

            // ////console.log($stateParams.mappedData);
            vm.showFileUploadFields = false;
            mapping = $stateParams.mappedData.mapping;
            result = $stateParams.mappedData.result;

            $timeout(function() {
                vm.propertiesToBeRegistered = [];

                vm.onlyFileName = localStorage.getItem("onlyFileName");
                vm.propertiesToBeRegistered = result;
                vm.fileName = localStorage.getItem("propertyFileName");
                vm.showTableRelatedDivs = true;
                vm.checkAll = 1;

                // ////console.log(vm.fileName);
                // ////console.log("==> updated propertiesToBeRegistered");
                // ////console.log(vm.propertiesToBeRegistered);
            }, 100);
        }
    }

    //=========Behaviour
    vm.toggleCheckAll = toggleCheckAll;
    vm.toggleState = toggleState;
    vm.SavePropertiesList = SavePropertiesList;
       

    $scope.fileUploaded = function() {
        //-----Properties Attribute END-----
        $scope.$digest();
        var myfiles = {};
        myfiles = document.getElementById('file-1').files;
        if (myfiles.length > 0) {
            $("#preloader").css("display", "block");
            var file = myfiles[0];
            vm.onlyFileName = file.name;
            localStorage.setItem("onlyFileName", vm.onlyFileName);
            var furl = '/properties/uploadPropertyFiles';

            AOTCService.uploadFiles(furl, myfiles)
                .then(function(result) {
                    // ////console.log(result);
                    if (result.data.success) {

                        var receivedData = result.data.result;
                        localStorage.removeItem("targetDataFields");
                        localStorage.setItem("targetDataFields", angular.toJson(receivedData.targetDataFields));

                        if (receivedData.isAllDataMapped) {
                            $timeout(function() {

                                localStorage.removeItem("mapData");
                                localStorage.setItem("propertyFileName", receivedData.fileName);
                                localStorage.setItem("mapData", angular.toJson(receivedData.mapping));
                                vm.checkAll = 1;
                                vm.showTableRelatedDivs = true;
                                vm.propertiesToBeRegistered = receivedData.result;

                            }, 100);

                            $location.hash(vm.old);
                            $location.hash("data");

                            $anchorScroll();
                              
                        } else {

                            // ////console.log('redirect to mapp page=>>')
                            localStorage.removeItem("mapData");
                            localStorage.setItem("propertyFileName", receivedData.fileName);
                            localStorage.setItem("mapData", angular.toJson(receivedData.mapping));
                            $state.go("map_data");

                        }

                        UtilService.clearFile();

                    } else {
                        // ////console.log('corrupt file')
                        //show popoup that unable to upload 
                        // $("div.dangerr").fadeIn(1500).delay(500).fadeOut(500);
                        var msg = result.data.message;
                        $scope.$emit('danger', msg);
                        UtilService.clearFile();
                    }
                    $("#preloader").css("display", "none");
                }, function(result) {

                    $("#preloader").css("display", "none");
                    // ////console.log(result);
                });

        }

    }

    vm.MapData = function() {
        // ////console.log('MapData redirect to mapp page=>>')
        localStorage.removeItem("mapData")
        localStorage.setItem("mapData", angular.toJson(mapping));
        $state.go("map_data");
    }

    function SavePropertiesList() {

        $("#preloader").css("display", "block");
        // var now = new Date;
        // var utc_timestamp = Date.UTC(now.getUTCFullYear(), now.getUTCMonth(), now.getUTCDate(),
        //     now.getUTCHours(), now.getUTCMinutes(), now.getUTCSeconds(), now.getUTCMilliseconds());

        var selectedPropertiesList = [];

        for (var i = 0; i < vm.propertiesToBeRegistered.length; i++) {
            var obj = vm.propertiesToBeRegistered[i];
            // ////console.log(obj.state)
            if (obj.state == 1) {
                delete obj.state;
                obj.orgFileName = vm.fileName;
                selectedPropertiesList.push(obj);

            }
        }

        var payLoad = {
            properties: selectedPropertiesList,
            mapping: mapping
        };

        // ////console.log(payLoad);
        var url = '/properties/addPropertiesList';

        AOTCService.postDataToServer(url, payLoad)
            .then(function(result) {

                // ////console.log(result);
                $("#preloader").css("display", "none");
                // $state.go('Registered');
                // $("div.success").fadeIn(1500).delay(500).fadeOut(500);
                if (result.data.success) {
                    $state.go('PropertyList.private_property_list', { propertyListMessage: 'Data saved' });
                } else {
                    ////console.log(result)
                }


            }, function(result) {
                //some error
                $("#preloader").css("display", "none");

                ////console.log(result);
            });
    }

    //////////////////////////////////////ui manipulation////////////////////////////////////////
    function toggleCheckAll() {
        $timeout(function() {

            vm.checkAll = +!vm.checkAll;
            if (vm.checkAll) {
                setDataState(vm.propertiesToBeRegistered, 1);

            } else {
                setDataState(vm.propertiesToBeRegistered, 0);

            }
        }, 100);
        // ////console.log(vm.checkAll);
    }

    function setDataState(users, state) {

        for (var i = 0; i < users.length; i++) {
            users[i].state = state;
        }
    }

    function toggleState(user) {
        user.state = +!user.state;
        vm.checkAll = 0; //future change this one
        //if all user have this state stateof th will be that one also
    }
}


/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 101 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {

_Signup.$inject = ["AOTCService", "$state", "$q"];
_pwCheck.$inject = [];
module.exports = {
    Signup: _Signup,
    pwCheck: _pwCheck
};

//angular.module('AOTC')
//    .directive('pwCheck', [_pwCheck])
//    .controller('Signup', _Signup);

function _Signup(AOTCService, $state, $q) {
    ////console.log("Signup controller");
    var vm = this;


    vm.signupData = {
        name: "", //done
        lastName: "", //done
        middleName: "", //done
        company: "", //done
        designation: "designation", //done
        street1: "", //done
        street2: "", //done
        city: "", //done
        state: "Select State", //done
        zipCode: "", //done
        phone1: "", //done
        phone2: "",
        phone3: "",
        email1: "", //done
        email2: "",
        email3: "",
        username: "", //done
        password: "", //done
        securityQ1: "Select Question", //done
        securityA1: "", //done
        securityQ2: "Select Question", //done
        securityA2: "", //done
        securityQ3: "Select Question", //done
        securityA3: "", //done
        customerType: "Paying",
        role: "Admin" //done
    };

    var getUserRoles = function () {
        //send data with service
        var url = '/users/getUserRoles';
        $("#preloader").css("display", "block");

        var multiplePromises = {
                getUserRoles: AOTCService.getDataFromServer('/users/getUserRoles'),
                getUSstates: AOTCService.getDataFromServer('/users/getUSstates')
            };

        $q.all(multiplePromises).then(function successCallback(response) {
            $("#preloader").css("display", "none");
            try {
                vm.rolesList = response.getUserRoles.data.result[0].role;
            } catch (_e) {}
            try {
                vm.uSstates = response.getUSstates.data.result;
            } catch (_e) {} 

        }, function errorCallback() {
            $("#preloader").css("display", "none");

        });

        // AOTCService.getDataFromServer(url)
        //     .then(function (response) {
        //         $("#preloader").css("display", "none");
        //         try {
        //             vm.rolesList = response.data.result[0].role;
        //         } catch (_e) {}

        //     });

    }();

    vm.clickSignUp = function () {

        $("#preloader").css("display", "block");
        //send data with service
        var url = '/users/addSingleUserNonRef';

        if (vm.signupData.securityQ1 == "Select Question") {
            vm.signupData.securityQ1 = "";
        }
        if (vm.signupData.securityQ2 == "Select Question") {
            vm.signupData.securityQ2 = "";
        }
        if (vm.signupData.securityQ3 == "Select Question") {
            vm.signupData.securityQ3 = "";
        }



        if (vm.signupData.password == vm.signupData.passwordConfirm) {

            delete vm.signupData.passwordConfirm;
            ////console.log(vm.signupData);

            AOTCService.postDataToServer(url, vm.signupData)
                .then(function (result) {

                    ////console.log(result);

                    vm.signupData = {
                        name: "", //done
                        lastName: "", //done
                        middleName: "", //done
                        company: "", //done
                        designation: "designation", //done
                        street1: "", //done
                        street2: "", //done
                        city: "", //done
                        state: "Select State", //done
                        zipCode: "", //done
                        phone1: "", //done
                        phone2: "",
                        phone3: "",
                        email1: "", //done
                        email2: "",
                        email3: "",
                        username: "", //done
                        password: "", //done
                        securityQ1: "Select Question", //done
                        securityA1: "", //done
                        securityQ2: "Select Question", //done
                        securityA2: "", //done
                        securityQ3: "Select Question", //done
                        securityA3: "", //done
                        customerType: "Paying",
                        role: "Admin"
                    };

                    $("#preloader").css("display", "none");

                    $state.go('main');

                    // $("div.success").fadeIn(1500).delay(500).fadeOut(1500,function(){
                    //     $state.go('main');

                    // });




                }, function (result) {
                    //some error
                    $("#preloader").css("display", "none");

                    ////console.log(result);
                });
        }


    };
    angular.element(document).ready(function () {
        $("#btnlogin").click(function (e) {
            e.preventDefault();
        });
    });
}

function _pwCheck() {
    return {
        require: 'ngModel',
        link: function (scope, elem, attrs, ctrl) {
            var firstPassword = '#' + attrs.pwCheck;
            elem.add(firstPassword).on('keyup', function () {
                scope.$apply(function () {
                    var v = elem.val() === $(firstPassword).val();
                    ////console.log(v);
                    ////console.log(elem.val());
                    ////console.log(firstPassword);
                    ctrl.$setValidity('pwmatch', v);
                });
            });
        }
    }
}
/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 102 */,
/* 103 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {

//angular.module('AOTC')
//    .service('ReportService',_ReportService);

//.factory('Excel',  _Excel);
_ReportService.$inject = ["$q", "AOTCService"];
_Excel.$inject = ["$window"];
module.exports = { ReportService: _ReportService, Excel: _Excel };

function _ReportService($q, AOTCService) {

    function getSurveyReports(id) {
        var url='/surveys/getSurveyReport?id=' + id
        var deferred = $q.defer();

        AOTCService.getDataFromServer(url)
            .then(function(result) {
                deferred.resolve(result);

            }, function(result) {
                deferred.reject(result);
            });
        return deferred.promise;

    };

    return {
        getSurveyReports: getSurveyReports,
    };
};




function _Excel($window){
    var uri='data:application/vnd.ms-excel;base64,',
        template='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>{table}</table></body></html>',
        base64=function(s){return $window.btoa(unescape(encodeURIComponent(s)));},

        format=function(s,c){return s.replace(/{(\w+)}/g,function(m,p){return c[p];})};
    return {
        tableToExcel:function(tableId,worksheetName){
            var table=$(tableId),
                ctx={worksheet:worksheetName,table:table.html()},
                href=uri+base64(format(template,ctx));
            //console.log(ctx)
            //console.log(template)

            return href;
        }
    };
}

/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 104 */,
/* 105 */,
/* 106 */,
/* 107 */,
/* 108 */,
/* 109 */,
/* 110 */,
/* 111 */,
/* 112 */,
/* 113 */,
/* 114 */,
/* 115 */,
/* 116 */,
/* 117 */,
/* 118 */,
/* 119 */,
/* 120 */,
/* 121 */,
/* 122 */,
/* 123 */,
/* 124 */,
/* 125 */,
/* 126 */,
/* 127 */,
/* 128 */,
/* 129 */,
/* 130 */,
/* 131 */,
/* 132 */,
/* 133 */,
/* 134 */,
/* 135 */,
/* 136 */,
/* 137 */,
/* 138 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";



__webpack_require__(139);
__webpack_require__(140);
//require('../assets/css/font-awesome.min.css');
__webpack_require__(141);
//require('../assets/css/main2.css');
__webpack_require__(142);
__webpack_require__(143);
//require('../assets/css/datatables.min.css');
//require('../assets/css/responsive.dataTables.min.css');
//require('../assets/css/jquery.dataTables.min.css');
//require('../assets/css/dataTables.jqueryui.min.css');
//require('../assets/css/buttons.jqueryui.min.css');
//require('../assets/css/buttons.dataTables.min.css');
__webpack_require__(144);
__webpack_require__(145);
__webpack_require__(146);
__webpack_require__(147);





var __env = {};
if (window) {
    Object.assign(__env, window.__env);
    console.log(window.__env)
}
/**************************************************************************
 * Define Angular application
 *************************************************************************/
var ngModule = angular.module('AOTC', [
    'ckeditor',
    'ui.bootstrap',
    //'ui.utils.masks',
    __webpack_require__(148),
    'ui.router',
    'agGrid',
    // 'dragularModule',
    'datatables',
    'datatables.buttons',
    'datatables.columnfilter',
    'uiGmapgoogle-maps',
    'rzModule',
    'angular-spinkit',
    'ng.deviceDetector',
    'ngFileUpload',
    'xeditable',
    'dndLists',
    'angularjs-dropdown-multiselect',
    'ui.toggle',
    'ckeditor'
]);
// ngModule.config(['deviceDetectorProvider', function(deviceDetectorProvider) {
//   deviceDetectorProvider.addCustom("Custom_UA_Entry", {or:["\\bChrome\\b","\\bFirefox\\b","\\bSafari\\b"]});
//   }]);

ngModule.run(['$rootScope', '$uibModalStack', 'AOTCPermissions', 'AOTCAuth', '$location','$state', 'AOTCService','$timeout',
    function ($rootScope, $uibModalStack, AOTCPermissions, AOTCAuth, $location, $state, AOTCService, $timeout) {
        // close the opened modal on location change.
        //set permissions
        var _token = localStorage.getItem('token') || null;
        var _perms = {
            timeline: true,
            contracts: true,
            surveys: true,
            properties: true,
            taskmanager: true,
            uploadProperties: true,
            publicData: true,
            newsFeed: true,
            createContract: true,
            masterSlave: true
        };
        ///set permissions
        try{
            var userResult = JSON.parse(localStorage.getItem('userJson')) || undefined;
            if(userResult) AOTCPermissions.setPermissions(userResult.roles, 'permissionMainObj'); 
            AOTCPermissions.setPermissions(userResult.userData, 'userObj');
        }
        catch(_e){}

        //set token
        if (_token) AOTCAuth.setToken(_token);
        $rootScope.$on('$locationChangeStart', function ($event, newUrl, oldUrl) {
            var openedModal = $uibModalStack.getTop();

            if (openedModal) {
                if (!!$event.preventDefault) {
                    $event.preventDefault();
                }
                if (!!$event.stopPropagation) {
                    $event.stopPropagation();
                }
                $uibModalStack.dismiss(openedModal.key);
            }
        });

        $rootScope.$on('$stateChangeStart', function ($event, newUrl) {
            var permission = newUrl.permission;
            if (permission) {
                var permissionStatus = AOTCPermissions.hasPermission(permission.permissionKey, permission.permissionObj);
                if (!permissionStatus)
                {
                    $state.go(permission.altState);
                    $event.preventDefault();
                    
                    //$location.path(permission.altRoute);
                }
                    
            }
        });
      
    }
]);

ngModule.run(['editableOptions', function (editableOptions) {
    editableOptions.theme = 'bs3';
}]);
/**************************************************************************
 * Configure logging
 *************************************************************************/

function disableLogging($logProvider) {
    $logProvider.debugEnabled(__env.enableDebug);
}

disableLogging.$inject = ['$logProvider'];

ngModule.config(disableLogging);

//=========================================================================


ngModule.config(["$locationProvider", "$stateProvider", "$urlRouterProvider", "uiGmapGoogleMapApiProvider", 
function ($locationProvider, $stateProvider, $urlRouterProvider, uiGmapGoogleMapApiProvider) {
    $stateProvider
        // .state('BrowserOptimizing', {
        //     url: '/browser-optimization',
        //     templateUrl: 'modules/BrowserOptimizing/browser-optimizing.html',
        //     controller: 'BrowserOptimizing',
        //     controllerAs: 'BrowserOptimizing'
        // })


        .state('BrowserOptimizing', {
            url: '/browser-optimization',
            templateUrl: 'modules/BrowserOptimizing/browser-optimizing.html',
            controller: 'BrowserOptimizing',
            controllerAs: 'BrowserOptimizing'
        })

        .state('login', {
            url: '/login',
            templateUrl: 'modules/login/login.html',
            controller: 'login',
            controllerAs: 'login'
        })
        .state('signup', {
            url: '/signup',
            templateUrl: 'modules/signup/signup.html',
            controller: 'Signup',
            controllerAs: 'Signup'

        })
        .state('main', {
            url: '/main',
            templateUrl: 'modules/main/main.html',
            controller: 'main',
            controllerAs: 'main'

        })




        //====================== User Module Start===============//
        .state('Registered', {
            url: '/users',
            templateUrl: 'modules/UserModule/SingleRegistration/registered.html',
            controller: 'Registered',
            controllerAs: 'Registered',
            params: {
                messageFrom: null
            }
        })
        .state('UserRegistrations', {
            url: '/user-registrations',
            templateUrl: 'modules/UserModule/MultipleRegistration/user_registration.html',
            controller: 'UserRegistration',
            controllerAs: 'UserRegistration'

        })

        //==================== User Module End -----------------
        //==================== Task Manager ==================//
        .state('TaskManager', {
            url: '/task-manager',
            templateUrl: 'modules/TaskManager/task-manager.html',
            controller: 'TaskManagerCtrl',
            controllerAs: 'TaskManagerCtrl',
            params: {
                messageFrom: null,
                message: null
            },
            permission: {
                permissionKey: 'taskManager',
                permissionObj: 'permissionMainObj',
                altRoute: '/main',
                altState: 'main'
            }  
        })
        //==================== Task Manager End ==================//



        // .state('PropertyList', {
        //     url: '/property-list',
        //     templateUrl: 'modules/PropertyModule/property-list/property-list.html',
        //     controller: 'PropertyListCtrl',
        //     controllerAs: 'PropertyListCtrl'
        // })
        .state('PropertyList', {
            url: '/all-property-list',
            templateUrl: 'modules/PropertyModule/property-list/tabs-viewer/tabs-viewer.html',
            controller: 'TabsViewerCtrl',
            controllerAs: 'TabsViewerCtrl',
            permission: {
                permissionKey: 'properties',
                permissionObj: 'permissionMainObj',
                altRoute: '/main',
                altState: 'main'
            } 
        })
        .state('PropertyList.private_property_list', {
            url: '/private-properties',
            templateUrl: 'modules/PropertyModule/property-list/tabs/pri-property-list/property-list.html',
            controller: 'PropertyListCtrl',
            controllerAs: 'PropertyListCtrl',

        })
        .state('PropertyList.pub_property_list', {
            url: '/public-properties',
            templateUrl: 'modules/PropertyModule/property-list/tabs/public-property-list/public-property.html',
            controller: 'PublicPropertyCtrl',
            controllerAs: 'PublicPropertyCtrl',

        })




        //====================== Properties Start===============//

        .state('PropertiesData', {
            url: '/upload-properties',
            templateUrl: 'modules/PropertyModule/UploadProperties/upload_properties.html',
            controller: 'Properties',
            controllerAs: 'Properties',
            params: {
                mappedData: null,
                message: null
            }
        })

        //====================== Sensitivity Testing Start===============//
        .state('ScenarioOne', {
            url: '/workspace-view-one',
            templateUrl: 'modules/PropertyModule/property-workspace/ScenarioOne/Sensitivity/sensitivity.html',
            controller: 'SensitivityOne',
            controllerAs: 'SensitivityOne',
            permission: {
                permissionKey: 'editValuationWorkspace',
                permissionObj: 'permissionPerPropertyObj',
                altRoute: '/workspace-view-one-readonly',
                altState: 'ScenarioOneReadonly'
            }
        })
        .state('ScenarioOneReadonly', {
            url: '/workspace-view-one-readonly',
            templateUrl: 'modules/PropertyModule/property-workspace/ScenarioOne/Sensitivity/sensitivity-readonly.html',
            controller: 'SensitivityOne',
            controllerAs: 'SensitivityOne',

        })
        .state('SensitivityThree', {
            url: '/workspace-view-two',
            templateUrl: 'modules/PropertyModule/property-workspace/ScenarioThree/Sensitivity/sensitivity.html',
            controller: 'SensitivityThree',
            controllerAs: 'SensitivityThree',
            permission: {
                permissionKey: 'editValuationWorkspace',
                permissionObj: 'permissionPerPropertyObj',
                altRoute: '/workspace-view-two-readonly',
                altState: 'SensitivityThreeReadonly'
            }
        })
        .state('SensitivityThreeReadonly', {
            url: '/workspace-view-two-readonly',
            templateUrl: 'modules/PropertyModule/property-workspace/ScenarioThree/Sensitivity/sensitivity-readonly.html',
            controller: 'SensitivityThree',
            controllerAs: 'SensitivityThree'
        })


        //====================== Sensitivity Testing End===============//
        .state('propertyValuation', {
            url: '/property-valuation',
            templateUrl: 'modules/PropertyModule/property-valuation/property-valuation.html',
            controller: 'PropValuation',
            controllerAs: 'PropValuation',
            permission: {
                permissionKey: 'editValuationForm',
                permissionObj: 'permissionPerPropertyObj',
                altRoute: '/property-valuation-readonly',
                altState: 'propertyValuationReadonly'
            },
            params: {
                property: null,
                messageFrom: null
            }
        })
        .state('propertyValuationReadonly', {
            url: '/property-valuation-readonly',
            templateUrl: 'modules/PropertyModule/property-valuation/property-valuation.html',
            controller: 'PropValuation',
            controllerAs: 'PropValuation',
            params: {
                property: null,
                messageFrom: null
            }
        })
        .state('propertyAssignment', {
            url: '/property-assignment',
            templateUrl: 'modules/PropertyModule/PropertyAssignment/property-assignment.html',
            controller: 'PropAssignment',
            controllerAs: '$ctrl',
            permission: {
                permissionKey: 'assignProperty',
                permissionObj: 'permissionPerPropertyObj',
                altRoute: '/private-properties',
                altState: 'PropertyList.private_property_list'
            }, 
            params: {
                property: null
            }
        })
        .state('assignedUsersList', {
            url: '/assigned-users-list',
            templateUrl: 'modules/PropertyModule/PropertyAssignment/AssignedUsers/assigned-users-list.template.html',
            controller: 'AssignedUsersListCtrl',
            controllerAs: '$ctrl',
            permission: {
                permissionKey: 'assignProperty',
                permissionObj: 'permissionPerPropertyObj',
                altRoute: '/private-properties',
                altState: 'PropertyList.private_property_list'
            }, 
            params: {
                property: null
            }
        })          
        .state('propertyWorkspace', {
            url: '/property-workspace',
            templateUrl: 'modules/PropertyModule/property-workspace/property-workspace.html',
            controller: 'PropWorkspace',
            controllerAs: 'PropWorkspace',
            params: {
                property: null
            }
        })

        .state('listProperties', {
            url: '/properties_list',
            templateUrl: 'modules/PropertyModule/PropertyDetails/property_details.html',
            controller: 'PropList',
            controllerAs: 'PropList',
            params: {
                propertyListMessage: null,
                messageFrom: null
            }
        })
        .state('taxBill', {
            url: '/upload-tax-bill',
            templateUrl: 'modules/PropertyModule/IE_RR_Module/ManualUpload/TaxBill/taxBill.html',
            controller: 'taxBill',
            controllerAs: 'taxBill',
            params: {
                propertyListMessage: null,
                messageFrom: null
            }
        })
        .state('unlinkedProperties', {
            url: '/unlinkedProperties',
            templateUrl: 'modules/PropertyModule/IE_RR_Module/unlinkedProperties/unlinkedPropertiesViewer.html',
            controller: 'unlinkedProperties',
            controllerAs: 'unlinkedProperties',
        })
        .state('unlinkedProperties.corruptFiles', {
            url: '/corrupt-files',
            templateUrl: 'modules/PropertyModule/IE_RR_Module/unlinkedProperties/tabs/corrupt/corrupt.html',
            controller: 'corruptFiles',
            controllerAs: 'corruptFiles'
        })
        .state('unlinkedProperties.unlinkedFiles', {
            url: '/unlinked-files',
            templateUrl: 'modules/PropertyModule/IE_RR_Module/unlinkedProperties/tabs/unlinked/unlinked.html',
            controller: 'unlinkedFiles',
            controllerAs: 'unlinkedFiles'
        })
        .state('unlinkedProperties.unparsedFiles', {
            url: '/unparsed-files',
            templateUrl: 'modules/PropertyModule/IE_RR_Module/unlinkedProperties/tabs/unparsed/unparsed.html',
            controller: 'unparsedFiles',
            controllerAs: 'unparsedFiles'
        })



        .state('uploadIERR', {
            url: '/uploadIERR',
            templateUrl: 'modules/PropertyModule/IE_RR_Module/SingleUpload/uploadIERR.html',
            controller: 'uploadIERR',
            controllerAs: 'uploadIERR',
            params: {
                property: null
            }
        })
        .state('updateIERR', {
            url: '/update-IERR/:id',
            templateUrl: 'modules/PropertyModule/IE_RR_Module/Update_IE_RR/update_IE_RR.html',
            controller: 'updateIERR',
            controllerAs: 'updateIERR',
            params: {
                property: null
            }
        })
        .state('manualIE', {
            url: '/manual-upload-income-expense',
            templateUrl: 'modules/PropertyModule/IE_RR_Module/ManualUpload/IE/manualIE.html',
            controller: 'manualIE',
            controllerAs: 'manualIE',
            params: {
                property: null
            }
        })
        .state('manualRR', {
            url: '/manual-upload-rent-roll',
            templateUrl: 'modules/PropertyModule/IE_RR_Module/ManualUpload/RR/manualRR.html',
            controller: 'manualRR',
            controllerAs: 'manualRR',
            params: {
                property: null
            }
        })
        //====================== TABS IE&RR Properties Start===============//
        .state('viewIERR', {
            url: '/viewIERR',
            templateUrl: 'modules/PropertyModule/IE_RR_Module/View_IE_RR/viewIERR/viewIERR.html',
            controller: 'viewIERR',
            controllerAs: 'viewIERR',
            params: {
                property: null
            }
        })
        // .state('viewIERR.property_details', {
        //     url: '/property_details',
        //     templateUrl: 'modules/PropertyModule/IE_RR_Module/View_IE_RR/tabs/property_details/property_details.html',
        //     controller: 'property_details',
        //     controllerAs: 'property_details',
        //     params: {
        //         property: null
        //     }
        // })
        .state('viewIERR.propertyDetailsTab', {
            url: '/property-details-tab',
            templateUrl: 'modules/PropertyModule/IE_RR_Module/View_IE_RR/tabs/propertyDetails/propertyDetails.html',
            controller: 'PropertyDetailsTab',
            controllerAs: 'PropertyDetailsTab',
            params: {
                property: null
            }
        })
        .state('viewIERR.public_property_tab', {
            url: '/public_property_tab',
            templateUrl: 'modules/PropertyModule/IE_RR_Module/View_IE_RR/tabs/public_property_details/publicPropertyDetailsTab.html',
            controller: 'PublicPropertyDetailsForProperty',
            controllerAs: 'PublicPropertyDetailsTab'
        }) 
        .state('viewIERR.income_expense', {
            url: '/income_expense',
            templateUrl: 'modules/PropertyModule/IE_RR_Module/View_IE_RR/tabs/income_expense/income_expense.html',
            controller: 'income_expense',
            controllerAs: 'income_expense',
            params: {
                property: null
            }
        })
        .state('viewIERR.rent_role', {
            url: '/rent_roll',
            templateUrl: 'modules/PropertyModule/IE_RR_Module/View_IE_RR/tabs/rent_role/rent_role.html',
            controller: 'rent_role',
            controllerAs: 'rent_role',
            params: {
                property: null
            }
        })
        .state('viewIERR.other_files', {
            url: '/other_files',
            templateUrl: 'modules/PropertyModule/IE_RR_Module/View_IE_RR/tabs/other_files/other_files.html',
            controller: 'other_files',
            controllerAs: 'other_files',
            params: {
                property: null
            }
        })
        .state('viewIERR.tax_bills', {
            url: '/tax_bills',
            templateUrl: 'modules/PropertyModule/IE_RR_Module/View_IE_RR/tabs/tax_bills/tax_bills.html',
            controller: 'tax_bills',
            controllerAs: 'tax_bills',
            params: {
                property: null
            }
        })
        .state('multipleUploadIERR', {
            url: '/multipleUploadIERR',
            templateUrl: 'modules/PropertyModule/IE_RR_Module/multipleUpload/multipleUploadIERR.html',
            controller: 'multipleUploadIERR',
            controllerAs: 'multipleUploadIERR'
        })
        .state('map_data', {
            url: '/data-mapping',
            templateUrl: 'modules/PropertyModule/UploadProperties/map_data/map_data.html',
            controller: 'Map',
            controllerAs: 'Map',
            params: {
                parsedProperty: null
            }
        })

        //========================Comparable Module =======================//
        .state('comparableSelection', {
            url: '/comparable-selection',
            templateUrl: 'modules/ComparableModule/SalesComparable/ComparableSelection/ComparableSelection.html',
            controller: 'ComparableSelection',
            controllerAs: 'ComparableSelection'
        })

        .state('comparableProperties', {
            url: '/comparable-properties',
            templateUrl: 'modules/ComparableModule/SalesComparable/ComparableProperties/ComparableProperties.html',
            controller: 'ComparableProperties',
            controllerAs: 'ComparableProperties'
        })

        .state('publicPropertyDetailsTab', {
            url: '/public-property-details',
            templateUrl: 'modules/PropertyModule/IE_RR_Module/View_IE_RR/tabs/public_property_details/publicPropertyDetails.html',
            controller: 'PublicPropertyDetailsTab',
            controllerAs: 'PublicPropertyDetailsTab',
            params: {
                property: null
            }
        })

        .state('selectedComparable', {
            url: '/selected-properties-comparable',
            templateUrl: 'modules/ComparableModule/SalesComparable/SelectedComparables/SelectedComparables.html',
            controller: 'SelectedComparable',
            controllerAs: 'SelectedComparable'
        })


        //========================AJ Module =======================//
        .state('viewAJData', {
            url: '/viewAJData',
            templateUrl: 'modules/AJModules/ViewAJData/viewAJData.html',
            controller: 'viewAJData',
            controllerAs: 'viewAJData'
        })
        .state('viewAJForm', {
            url: '/viewAJForm',
            templateUrl: 'modules/AJModules/ViewAJForm/viewAJForm.html',
            controller: 'viewAJForm',
            controllerAs: 'viewAJForm',
            params: {
                AJData: null
            }
        })
        .state('addSurvey', {
            url: '/addSurvey',
            templateUrl: 'modules/AJModules/AddSurvey/addSurvey.html',
            controller: 'addSurvey',
            controllerAs: 'addSurvey'
        })
        .state('addSurveyDemo', {
            url: '/addSurveyDemo',
            templateUrl: 'modules/AJModules/AddSurveyDemo/addSurveyDemo.html',
            controller: 'addSurveyDemo',
            controllerAs: 'addSurveyDemo'
        })
        .state('createComparablesForm', {
            url: '/create-comparables',
            templateUrl: 'modules/ComparableModule/SalesComparable/ComparableForm/comparableForm.html',
            controller: 'CreateComparablesForm',
            controllerAs: 'CreateComparablesForm',
            params: {
                property: null
            }
        })

        .state('createPrincipalForm', {
            url: '/create-comparable-princpal',
            templateUrl: 'modules/ComparableModule/SalesComparable/PrincipalForm/principalForm.html',
            controller: 'CreatePrincipalForm',
            controllerAs: 'CreatePrincipalForm',
            params: {
                property: null
            }
        })


        .state('AddQuestion', {
            url: '/question',
            templateUrl: 'modules/SurveyModule/Wizards/AddQuestion/add-question.html',
            controller: 'AddQuestionCtrl',
            controllerAs: 'AddQuestionCtrl',
            params: {
                property: null
            }
        })


        //========================Survey Module =======================//
        .state('Survey', {
            url: '/surveys',
            templateUrl: 'modules/SurveyModule/WizardsViewer/WizardsViewer.html',
            controller: 'WizardsViewerCtrl',
            controllerAs: 'WizardsViewerCtrl'
        })

        .state('SurveyList', {
            url: '/survey-list',
            templateUrl: 'modules/SurveyModule/SurveyList/survey-list.html',
            controller: 'SurveyList',
            controllerAs: 'SurveyList',
            permission: {
                permissionKey: 'surveys',
                permissionObj: 'permissionMainObj',
                altRoute: '/main',
                altState: 'main'
            }             
        })

        .state('FillSurvey', {
            url: '/fill-survey/:id',
            templateUrl: 'modules/SurveyModule/FillSurvey/fill-survey.html',
            controller: 'FillSurvey',
            controllerAs: 'FillSurvey'
        })

        .state('SubmissionList', {
            url: '/submission-list/:id',
            templateUrl: 'modules/SurveyModule/SubmissionList/submission-list.html',
            controller: 'SubmissionList',
            controllerAs: 'SubmissionList'
        })

        .state('SurveySubmissions', {
            url: '/survey-submission/:id/:surveyId',
            templateUrl: 'modules/SurveyModule/SurveySubmissions/surveySubmissions.html',
            controller: 'SurveySubmissions',
            controllerAs: 'SurveySubmissions'
        })

        .state('TaxAppeal', {
            url: '/appeal',
            templateUrl: 'modules/PropertyModule/taxAppeal/tax-appeal.html',
            controller: 'TaxAppeal',
            controllerAs: 'TaxAppeal'
        })

        //Daniyal: to be tested (made by Kumail)
        // .state('contractWizard', {
        //     url: '/contracts',
        //     templateUrl: 'modules/ContractModule/contract-wizard/contract-wizard.html',
        //     controller: 'ContractWizardCtrl',
        //     controllerAs: 'ContractWizardCtrl',
        //     params: {
        //         property: null
        //     }
        // })

        .state('Contract', {
            url: '/contract-builder',
            templateUrl: 'modules/ContractModule/tabs-viewer/tabs-viewer.html',
            controller: 'Contract',
            controllerAs: 'Contract'
        })
        .state('ViewContract', {
            url: '/contract-builder/:id',
            templateUrl: 'modules/ContractModule/tabs-viewer/tabs-viewer.html',
            controller: 'Contract',
            controllerAs: 'Contract'
        })


        // .state('SampleCalculation', {
        //     url: '/sample-calculation',
        //     templateUrl: 'modules/ContractModule/SampleCalculation/sample-calculation.html',
        //     controller: 'SampleCalculation',
        //     controllerAs: 'SampleCalculation'
        // })


        .state('SavedContractList', {
            url: '/saved-contract-list',
            templateUrl: 'modules/ContractModule/SavedContractList/saved-contract-list.html',
            controller: 'SavedContractList',
            controllerAs: 'SavedContractList',
            permission: {
                permissionKey: 'contracts',
                permissionObj: 'permissionMainObj',
                altRoute: '/main',
                altState: 'main'
            }             
        })

        .state('SectionSettings', {
            url: '/section-settings',
            templateUrl: 'modules/SurveyModule/Wizards/sectionSettings/sectionSettings.component.html',
            controller: 'sectionSettingsCtrl',
            controllerAs: 'sectionSettingsCtrl'
        })

        .state('EditSurvey', {
            url: '/edit-survey/:id',
            templateUrl: 'modules/SurveyModule/EditSurvey/editSurveyWizard/editSurveyWizard.component.html',
            controller: 'editSurveyCtrl',
            controllerAs: 'editSurveyCtrl'
        })

        .state('InvoiceList', {
            url: '/invoice-list/:id',
            templateUrl: 'modules/ContractModule/InvoiceList/invoice-list.html',
            controller: 'InvoiceList',
            controllerAs: 'InvoiceList'
        })

        .state('NewInvoice', {
            url: '/new-invoice/:id',
            templateUrl: 'modules/ContractModule/NewInvoice/new-invoice.html',
            controller: 'NewInvoice',
            controllerAs: '$ctrl'
        })

        .state('Reports', {
            url: '/view-reports/:id',
            templateUrl: 'modules/Reports/view-reports/view-reports.component.html',
            controller: 'ViewReportsCtrl',
            controllerAs: 'ViewReportsCtrl'


        })
        //========================Appeal Module =======================//
        .state('Appeal', {
            url: '/appeal',
            templateUrl: 'modules/Appeal/Form/form.template.html',
            //controller: 'WizardsViewerCtrl',
            //controllerAs: '$ctrl'
        })
        .state('TimelineGraphical', {
            url: '/timeline-graphical',
            templateUrl: 'modules/Appeal/TimelineGraphical/timeline-graphical.template.html',
            controller: 'timelineGraphicalCtrl',
            controllerAs: '$ctrl',
            permission: {
                permissionKey: 'timeline',
                permissionObj: 'permissionMainObj',
                altRoute: '/main',
                altState: 'main'
            } 
            //params: { jurisdiction: null }
        })
        .state('inventory', {
            url: '/inventory',
            templateUrl: 'modules/UserModule/Inventory/inventory.html',
            controller: 'InventoryCtrl',
            controllerAs: 'InventoryCtrl'
        })
        //========================User Rights =======================//
        .state('user-rights', {
            url: '/user-rights',
            templateUrl: 'modules/UserModule/UserRights/user-roles-list.template.html',
            controller: 'UserRolesListCtrl',
            controllerAs: '$ctrl'
        });






    $urlRouterProvider.otherwise('/login');

    // $locationProvider.html5Mode({
    //          enabled: true,
    //          requireBase: true
    //   });

    //uiGmapGoogleMapApiProvider.configure({
    //    key: 'AIzaSyA3YdzkKmJMsp2dAR0PtBXtiI77yiFN4tw', //AIzaSyAASFxjnvu4kn471TvbAj9SQVlrXDn0fos
    //    v: '3.20', //defaults to latest 3.X anyhow
    //    libraries: 'weather,geometry,visualization'
    //});


}]);


/**************************************************************************
 * Make environment available in Angular
 *************************************************************************/

ngModule.constant('__env', __env);

function logEnvironment($log, __env) {
    $log.debug('Environment variables:');
    $log.debug(__env);
}
ngModule.run(["$log", "__env", logEnvironment]);

//agGrid.initialiseAgGridWithAngular1(angular);

__webpack_require__(93);
__webpack_require__(201);
__webpack_require__(207);
__webpack_require__(210);
__webpack_require__(223);
__webpack_require__(238);
__webpack_require__(239);
__webpack_require__(241);
__webpack_require__(243);
__webpack_require__(246);
__webpack_require__(285);
__webpack_require__(286);
__webpack_require__(311);
__webpack_require__(314);
__webpack_require__(319);
__webpack_require__(327);
__webpack_require__(330);
__webpack_require__(332);
__webpack_require__(334);

/***/ }),
/* 139 */
/***/ (function(module, exports) {

// removed by extract-text-webpack-plugin

/***/ }),
/* 140 */
/***/ (function(module, exports) {

// removed by extract-text-webpack-plugin

/***/ }),
/* 141 */
/***/ (function(module, exports) {

// removed by extract-text-webpack-plugin

/***/ }),
/* 142 */
/***/ (function(module, exports) {

// removed by extract-text-webpack-plugin

/***/ }),
/* 143 */
/***/ (function(module, exports) {

// removed by extract-text-webpack-plugin

/***/ }),
/* 144 */
/***/ (function(module, exports) {

// removed by extract-text-webpack-plugin

/***/ }),
/* 145 */
/***/ (function(module, exports) {

// removed by extract-text-webpack-plugin

/***/ }),
/* 146 */
/***/ (function(module, exports) {

// removed by extract-text-webpack-plugin

/***/ }),
/* 147 */
/***/ (function(module, exports) {

// removed by extract-text-webpack-plugin

/***/ }),
/* 148 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var moduleName = __webpack_require__(149);

module.exports = moduleName;


/***/ }),
/* 149 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


module.exports = angular.module('ui.utils.masks', [
	__webpack_require__(150),
	__webpack_require__(184),
	__webpack_require__(194),
	__webpack_require__(196),
	__webpack_require__(198)
]).name;


/***/ }),
/* 150 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var m = angular.module('ui.utils.masks.global', [])
	.directive('uiCreditCardMask', __webpack_require__(151))
	.directive('uiDateMask', __webpack_require__(152))
	.directive('uiMoneyMask', __webpack_require__(179))
	.directive('uiNumberMask', __webpack_require__(180))
	.directive('uiPercentageMask', __webpack_require__(181))
	.directive('uiScientificNotationMask', __webpack_require__(182))
	.directive('uiTimeMask', __webpack_require__(183));

module.exports = m.name;


/***/ }),
/* 151 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var StringMask = __webpack_require__(10);
var maskFactory = __webpack_require__(15);

var ccSize = 16;

var ccMask = new StringMask('0000 0000 0000 0000');

module.exports = maskFactory({
	clearValue: function(rawValue) {
		return rawValue.toString().replace(/[^0-9]/g, '').slice(0, ccSize);
	},
	format: function(cleanValue) {
		var formatedValue;

		formatedValue = ccMask.apply(cleanValue) || '';

		return formatedValue.trim().replace(/[^0-9]$/, '');
	},
	validations: {
		creditCard: function(value) {
			var valueLength = value && value.toString().length;
			return valueLength === ccSize;
		}
	}
});


/***/ }),
/* 152 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var formatDate = __webpack_require__(153);
var parseDate = __webpack_require__(169);
var isValidDate = __webpack_require__(87);
var StringMask = __webpack_require__(10);

function isISODateString(date) {
	return /^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}\.[0-9]{3}([-+][0-9]{2}:[0-9]{2}|Z)$/
		.test(date.toString());
}

function DateMaskDirective($locale) {
	var dateFormatMapByLocale = {
		'pt-br': 'DD/MM/YYYY',
		'ru': 'DD.MM.YYYY'
	};

	var dateFormat = dateFormatMapByLocale[$locale.id] || 'YYYY-MM-DD';

	return {
		restrict: 'A',
		require: 'ngModel',
		link: function(scope, element, attrs, ctrl) {
			attrs.parse = attrs.parse || 'true';

			dateFormat = attrs.uiDateMask || dateFormat;

			var dateMask = new StringMask(dateFormat.replace(/[YMD]/g,'0'));

			function formatter(value) {
				if (ctrl.$isEmpty(value)) {
					return null;
				}

				var cleanValue = value;
				if (typeof value === 'object' || isISODateString(value)) {
					cleanValue = formatDate(value, dateFormat);
				}

				cleanValue = cleanValue.replace(/[^0-9]/g, '');
				var formatedValue = dateMask.apply(cleanValue) || '';

				return formatedValue.trim().replace(/[^0-9]$/, '');
			}

			ctrl.$formatters.push(formatter);

			ctrl.$parsers.push(function parser(value) {
				if (ctrl.$isEmpty(value)) {
					return value;
				}

				var formatedValue = formatter(value);

				if (ctrl.$viewValue !== formatedValue) {
					ctrl.$setViewValue(formatedValue);
					ctrl.$render();
				}

				return attrs.parse === 'false'
					? formatedValue
					: parseDate(formatedValue, dateFormat, new Date());
			});

			ctrl.$validators.date =	function validator(modelValue, viewValue) {
				if (ctrl.$isEmpty(modelValue)) {
					return true;
				}

				return isValidDate(parseDate(viewValue, dateFormat, new Date())) && viewValue.length === dateFormat.length;
			};
		}
	};
}
DateMaskDirective.$inject = ['$locale'];

module.exports = DateMaskDirective;


/***/ }),
/* 153 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = format;

var _index = __webpack_require__(13);

var _index2 = _interopRequireDefault(_index);

var _index3 = __webpack_require__(87);

var _index4 = _interopRequireDefault(_index3);

var _index5 = __webpack_require__(88);

var _index6 = _interopRequireDefault(_index5);

var _index7 = __webpack_require__(166);

var _index8 = _interopRequireDefault(_index7);

var _index9 = __webpack_require__(91);

var _index10 = _interopRequireDefault(_index9);

var _index11 = __webpack_require__(168);

var _index12 = _interopRequireDefault(_index11);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var longFormattingTokensRegExp = /(\[[^[]*])|(\\)?(LTS|LT|LLLL|LLL|LL|L|llll|lll|ll|l)/g;
var defaultFormattingTokensRegExp = /(\[[^[]*])|(\\)?(x|ss|s|mm|m|hh|h|do|dddd|ddd|dd|d|aa|a|ZZ|Z|YYYY|YY|X|Wo|WW|W|SSS|SS|S|Qo|Q|Mo|MMMM|MMM|MM|M|HH|H|GGGG|GG|E|Do|DDDo|DDDD|DDD|DD|D|A|.)/g;

/**
 * @name format
 * @category Common Helpers
 * @summary Format the date.
 *
 * @description
 * Return the formatted date string in the given format.
 *
 * Accepted tokens:
 * | Unit                    | Token | Result examples                  |
 * |-------------------------|-------|----------------------------------|
 * | Month                   | M     | 1, 2, ..., 12                    |
 * |                         | Mo    | 1st, 2nd, ..., 12th              |
 * |                         | MM    | 01, 02, ..., 12                  |
 * |                         | MMM   | Jan, Feb, ..., Dec               |
 * |                         | MMMM  | January, February, ..., December |
 * | Quarter                 | Q     | 1, 2, 3, 4                       |
 * |                         | Qo    | 1st, 2nd, 3rd, 4th               |
 * | Day of month            | D     | 1, 2, ..., 31                    |
 * |                         | Do    | 1st, 2nd, ..., 31st              |
 * |                         | DD    | 01, 02, ..., 31                  |
 * | Day of year             | DDD   | 1, 2, ..., 366                   |
 * |                         | DDDo  | 1st, 2nd, ..., 366th             |
 * |                         | DDDD  | 001, 002, ..., 366               |
 * | Day of week             | d     | 0, 1, ..., 6                     |
 * |                         | do    | 0th, 1st, ..., 6th               |
 * |                         | dd    | Su, Mo, ..., Sa                  |
 * |                         | ddd   | Sun, Mon, ..., Sat               |
 * |                         | dddd  | Sunday, Monday, ..., Saturday    |
 * | Day of ISO week         | E     | 1, 2, ..., 7                     |
 * | ISO week                | W     | 1, 2, ..., 53                    |
 * |                         | Wo    | 1st, 2nd, ..., 53rd              |
 * |                         | WW    | 01, 02, ..., 53                  |
 * | Year                    | YY    | 00, 01, ..., 99                  |
 * |                         | YYYY  | 1900, 1901, ..., 2099            |
 * | ISO week-numbering year | GG    | 00, 01, ..., 99                  |
 * |                         | GGGG  | 1900, 1901, ..., 2099            |
 * | AM/PM                   | A     | AM, PM                           |
 * |                         | a     | am, pm                           |
 * |                         | aa    | a.m., p.m.                       |
 * | Hour                    | H     | 0, 1, ... 23                     |
 * |                         | HH    | 00, 01, ... 23                   |
 * |                         | h     | 1, 2, ..., 12                    |
 * |                         | hh    | 01, 02, ..., 12                  |
 * | Minute                  | m     | 0, 1, ..., 59                    |
 * |                         | mm    | 00, 01, ..., 59                  |
 * | Second                  | s     | 0, 1, ..., 59                    |
 * |                         | ss    | 00, 01, ..., 59                  |
 * | 1/10 of second          | S     | 0, 1, ..., 9                     |
 * | 1/100 of second         | SS    | 00, 01, ..., 99                  |
 * | Millisecond             | SSS   | 000, 001, ..., 999               |
 * | Timezone                | Z     | -01:00, +00:00, ... +12:00       |
 * |                         | ZZ    | -0100, +0000, ..., +1200         |
 * | Seconds timestamp       | X     | 512969520                        |
 * | Milliseconds timestamp  | x     | 512969520900                     |
 * | Long format             | LT    | 05:30 a.m.                       |
 * |                         | LTS   | 05:30:15 a.m.                    |
 * |                         | L     | 07/02/1995                       |
 * |                         | l     | 7/2/1995                         |
 * |                         | LL    | July 2 1995                      |
 * |                         | ll    | Jul 2 1995                       |
 * |                         | LLL   | July 2 1995 05:30 a.m.           |
 * |                         | lll   | Jul 2 1995 05:30 a.m.            |
 * |                         | LLLL  | Sunday, July 2 1995 05:30 a.m.   |
 * |                         | llll  | Sun, Jul 2 1995 05:30 a.m.       |
 *
 * The characters wrapped in square brackets are escaped.
 *
 * The result may vary by locale.
 *
 * @param {Date|String|Number} date - the original date
 * @param {String} format - the string of tokens
 * @param {Options} [options] - the object with options. See [Options]{@link https://date-fns.org/docs/Options}
 * @param {0|1|2} [options.additionalDigits=2] - passed to `toDate`. See [toDate]{@link https://date-fns.org/docs/toDate}
 * @param {Locale} [options.locale=defaultLocale] - the locale object. See [Locale]{@link https://date-fns.org/docs/Locale}
 * @returns {String} the formatted date string
 * @throws {TypeError} 2 arguments required
 * @throws {RangeError} `options.additionalDigits` must be 0, 1 or 2
 * @throws {RangeError} `options.locale` must contain `localize` property
 * @throws {RangeError} `options.locale` must contain `formatLong` property
 *
 * @example
 * // Represent 11 February 2014 in middle-endian format:
 * var result = format(
 *   new Date(2014, 1, 11),
 *   'MM/DD/YYYY'
 * )
 * //=> '02/11/2014'
 *
 * @example
 * // Represent 2 July 2014 in Esperanto:
 * import { eoLocale } from 'date-fns/locale/eo'
 * var result = format(
 *   new Date(2014, 6, 2),
 *   'Do [de] MMMM YYYY',
 *   {locale: eoLocale}
 * )
 * //=> '2-a de julio 2014'
 */
function format(dirtyDate, dirtyFormatStr, dirtyOptions) {
  if (arguments.length < 2) {
    throw new TypeError('2 arguments required, but only ' + arguments.length + ' present');
  }

  var formatStr = String(dirtyFormatStr);
  var options = dirtyOptions || {};

  var locale = options.locale || _index6.default;

  if (!locale.localize) {
    throw new RangeError('locale must contain localize property');
  }

  if (!locale.formatLong) {
    throw new RangeError('locale must contain formatLong property');
  }

  var localeFormatters = locale.formatters || {};
  var formattingTokensRegExp = locale.formattingTokensRegExp || defaultFormattingTokensRegExp;
  var formatLong = locale.formatLong;

  var originalDate = (0, _index2.default)(dirtyDate, options);

  if (!(0, _index4.default)(originalDate, options)) {
    return 'Invalid Date';
  }

  // Convert the date in system timezone to the same date in UTC+00:00 timezone.
  // This ensures that when UTC functions will be implemented, locales will be compatible with them.
  // See an issue about UTC functions: https://github.com/date-fns/date-fns/issues/376
  var timezoneOffset = originalDate.getTimezoneOffset();
  var utcDate = (0, _index12.default)(originalDate, -timezoneOffset, options);

  var formatterOptions = (0, _index10.default)(options);
  formatterOptions.locale = locale;
  formatterOptions.formatters = _index8.default;

  // When UTC functions will be implemented, options._originalDate will likely be a part of public API.
  // Right now, please don't use it in locales. If you have to use an original date,
  // please restore it from `date`, adding a timezone offset to it.
  formatterOptions._originalDate = originalDate;

  var result = formatStr.replace(longFormattingTokensRegExp, function (substring) {
    if (substring[0] === '[') {
      return substring;
    }

    if (substring[0] === '\\') {
      return cleanEscapedString(substring);
    }

    return formatLong(substring);
  }).replace(formattingTokensRegExp, function (substring) {
    var formatter = localeFormatters[substring] || _index8.default[substring];

    if (formatter) {
      return formatter(utcDate, formatterOptions);
    } else {
      return cleanEscapedString(substring);
    }
  });

  return result;
}

function cleanEscapedString(input) {
  if (input.match(/\[[\s\S]/)) {
    return input.replace(/^\[|]$/g, '');
  }
  return input.replace(/\\/g, '');
}
module.exports = exports['default'];

/***/ }),
/* 154 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = formatDistance;
var formatDistanceLocale = {
  lessThanXSeconds: {
    one: 'less than a second',
    other: 'less than {{count}} seconds'
  },

  xSeconds: {
    one: '1 second',
    other: '{{count}} seconds'
  },

  halfAMinute: 'half a minute',

  lessThanXMinutes: {
    one: 'less than a minute',
    other: 'less than {{count}} minutes'
  },

  xMinutes: {
    one: '1 minute',
    other: '{{count}} minutes'
  },

  aboutXHours: {
    one: 'about 1 hour',
    other: 'about {{count}} hours'
  },

  xHours: {
    one: '1 hour',
    other: '{{count}} hours'
  },

  xDays: {
    one: '1 day',
    other: '{{count}} days'
  },

  aboutXMonths: {
    one: 'about 1 month',
    other: 'about {{count}} months'
  },

  xMonths: {
    one: '1 month',
    other: '{{count}} months'
  },

  aboutXYears: {
    one: 'about 1 year',
    other: 'about {{count}} years'
  },

  xYears: {
    one: '1 year',
    other: '{{count}} years'
  },

  overXYears: {
    one: 'over 1 year',
    other: 'over {{count}} years'
  },

  almostXYears: {
    one: 'almost 1 year',
    other: 'almost {{count}} years'
  }
};

function formatDistance(token, count, options) {
  options = options || {};

  var result;
  if (typeof formatDistanceLocale[token] === 'string') {
    result = formatDistanceLocale[token];
  } else if (count === 1) {
    result = formatDistanceLocale[token].one;
  } else {
    result = formatDistanceLocale[token].other.replace('{{count}}', count);
  }

  if (options.addSuffix) {
    if (options.comparison > 0) {
      return 'in ' + result;
    } else {
      return result + ' ago';
    }
  }

  return result;
}
module.exports = exports['default'];

/***/ }),
/* 155 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});

var _index = __webpack_require__(156);

var _index2 = _interopRequireDefault(_index);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var formatLong = (0, _index2.default)({
  LT: 'h:mm aa',
  LTS: 'h:mm:ss aa',
  L: 'MM/DD/YYYY',
  LL: 'MMMM D YYYY',
  LLL: 'MMMM D YYYY h:mm aa',
  LLLL: 'dddd, MMMM D YYYY h:mm aa'
});

exports.default = formatLong;
module.exports = exports['default'];

/***/ }),
/* 156 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = buildFormatLongFn;
var tokensToBeShortedPattern = /MMMM|MM|DD|dddd/g;

function buildShortLongFormat(format) {
  return format.replace(tokensToBeShortedPattern, function (token) {
    return token.slice(1);
  });
}

/**
 * @name buildFormatLongFn
 * @category Locale Helpers
 * @summary Build `formatLong` property for locale used by `format`, `formatRelative` and `parse` functions.
 *
 * @description
 * Build `formatLong` property for locale used by `format`, `formatRelative` and `parse` functions.
 * Returns a function which takes one of the following tokens as the argument:
 * `'LTS'`, `'LT'`, `'L'`, `'LL'`, `'LLL'`, `'l'`, `'ll'`, `'lll'`, `'llll'`
 * and returns a long format string written as `format` token strings.
 * See [format]{@link https://date-fns.org/docs/format}
 *
 * `'l'`, `'ll'`, `'lll'` and `'llll'` formats are built automatically
 * by shortening some of the tokens from corresponding unshortened formats
 * (e.g., if `LL` is `'MMMM DD YYYY'` then `ll` will be `MMM D YYYY`)
 *
 * @param {Object} obj - the object with long formats written as `format` token strings
 * @param {String} obj.LT - time format: hours and minutes
 * @param {String} obj.LTS - time format: hours, minutes and seconds
 * @param {String} obj.L - short date format: numeric day, month and year
 * @param {String} [obj.l] - short date format: numeric day, month and year (shortened)
 * @param {String} obj.LL - long date format: day, month in words, and year
 * @param {String} [obj.ll] - long date format: day, month in words, and year (shortened)
 * @param {String} obj.LLL - long date and time format
 * @param {String} [obj.lll] - long date and time format (shortened)
 * @param {String} obj.LLLL - long date, time and weekday format
 * @param {String} [obj.llll] - long date, time and weekday format (shortened)
 * @returns {Function} `formatLong` property of the locale
 *
 * @example
 * // For `en-US` locale:
 * locale.formatLong = buildFormatLongFn({
 *   LT: 'h:mm aa',
 *   LTS: 'h:mm:ss aa',
 *   L: 'MM/DD/YYYY',
 *   LL: 'MMMM D YYYY',
 *   LLL: 'MMMM D YYYY h:mm aa',
 *   LLLL: 'dddd, MMMM D YYYY h:mm aa'
 * })
 */
function buildFormatLongFn(obj) {
  var formatLongLocale = {
    LTS: obj.LTS,
    LT: obj.LT,
    L: obj.L,
    LL: obj.LL,
    LLL: obj.LLL,
    LLLL: obj.LLLL,
    l: obj.l || buildShortLongFormat(obj.L),
    ll: obj.ll || buildShortLongFormat(obj.LL),
    lll: obj.lll || buildShortLongFormat(obj.LLL),
    llll: obj.llll || buildShortLongFormat(obj.LLLL)
  };

  return function (token) {
    return formatLongLocale[token];
  };
}
module.exports = exports["default"];

/***/ }),
/* 157 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = formatRelative;
var formatRelativeLocale = {
  lastWeek: '[last] dddd [at] LT',
  yesterday: '[yesterday at] LT',
  today: '[today at] LT',
  tomorrow: '[tomorrow at] LT',
  nextWeek: 'dddd [at] LT',
  other: 'L'
};

function formatRelative(token, date, baseDate, options) {
  return formatRelativeLocale[token];
}
module.exports = exports['default'];

/***/ }),
/* 158 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});

var _index = __webpack_require__(159);

var _index2 = _interopRequireDefault(_index);

var _index3 = __webpack_require__(160);

var _index4 = _interopRequireDefault(_index3);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

// Note: in English, the names of days of the week and months are capitalized.
// If you are making a new locale based on this one, check if the same is true for the language you're working on.
// Generally, formatted dates should look like they are in the middle of a sentence,
// e.g. in Spanish language the weekdays and months should be in the lowercase.
var weekdayValues = {
  narrow: ['Su', 'Mo', 'Tu', 'We', 'Th', 'Fr', 'Sa'],
  short: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],
  long: ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday']
};

var monthValues = {
  short: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
  long: ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December']
};

// `timeOfDay` is used to designate which part of the day it is, when used with 12-hour clock.
// Use the system which is used the most commonly in the locale.
// For example, if the country doesn't use a.m./p.m., you can use `night`/`morning`/`afternoon`/`evening`:
//
//   var timeOfDayValues = {
//     any: ['in the night', 'in the morning', 'in the afternoon', 'in the evening']
//   }
//
// And later:
//
//   var localize = {
//     // The callback takes the hours as the argument and returns the array index
//     timeOfDay: buildLocalizeFn(timeOfDayValues, 'any', function (hours) {
//       if (hours >= 17) {
//         return 3
//       } else if (hours >= 12) {
//         return 2
//       } else if (hours >= 4) {
//         return 1
//       } else {
//         return 0
//       }
//     }),
//     timesOfDay: buildLocalizeArrayFn(timeOfDayValues, 'any')
//   }
var timeOfDayValues = {
  uppercase: ['AM', 'PM'],
  lowercase: ['am', 'pm'],
  long: ['a.m.', 'p.m.']
};

function ordinalNumber(dirtyNumber, dirtyOptions) {
  var number = Number(dirtyNumber);

  // If ordinal numbers depend on context, for example,
  // if they are different for different grammatical genders,
  // use `options.unit`:
  //
  //   var options = dirtyOptions || {}
  //   var unit = String(options.unit)
  //
  // where `unit` can be 'month', 'quarter', 'week', 'isoWeek', 'dayOfYear',
  // 'dayOfMonth' or 'dayOfWeek'

  var rem100 = number % 100;
  if (rem100 > 20 || rem100 < 10) {
    switch (rem100 % 10) {
      case 1:
        return number + 'st';
      case 2:
        return number + 'nd';
      case 3:
        return number + 'rd';
    }
  }
  return number + 'th';
}

var localize = {
  ordinalNumber: ordinalNumber,
  weekday: (0, _index2.default)(weekdayValues, 'long'),
  weekdays: (0, _index4.default)(weekdayValues, 'long'),
  month: (0, _index2.default)(monthValues, 'long'),
  months: (0, _index4.default)(monthValues, 'long'),
  timeOfDay: (0, _index2.default)(timeOfDayValues, 'long', function (hours) {
    return hours / 12 >= 1 ? 1 : 0;
  }),
  timesOfDay: (0, _index4.default)(timeOfDayValues, 'long')
};

exports.default = localize;
module.exports = exports['default'];

/***/ }),
/* 159 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = buildLocalizeFn;
/**
 * @name buildLocalizeFn
 * @category Locale Helpers
 * @summary Build `localize.weekday`, `localize.month` and `localize.timeOfDay` properties for the locale.
 *
 * @description
 * Build `localize.weekday`, `localize.month` and `localize.timeOfDay` properties for the locale
 * used by `format` function.
 * If no `type` is supplied to the options of the resulting function, `defaultType` will be used (see example).
 *
 * `localize.weekday` function takes the weekday index as argument (0 - Sunday).
 * `localize.month` takes the month index (0 - January).
 * `localize.timeOfDay` takes the hours. Use `indexCallback` to convert them to an array index (see example).
 *
 * @param {Object} values - the object with arrays of values
 * @param {String} defaultType - the default type for the localize function
 * @param {Function} [indexCallback] - the callback which takes the resulting function argument
 *   and converts it into value array index
 * @returns {Function} the resulting function
 *
 * @example
 * var timeOfDayValues = {
 *   uppercase: ['AM', 'PM'],
 *   lowercase: ['am', 'pm'],
 *   long: ['a.m.', 'p.m.']
 * }
 * locale.localize.timeOfDay = buildLocalizeFn(timeOfDayValues, 'long', function (hours) {
 *   // 0 is a.m. array index, 1 is p.m. array index
 *   return (hours / 12) >= 1 ? 1 : 0
 * })
 * locale.localize.timeOfDay(16, {type: 'uppercase'}) //=> 'PM'
 * locale.localize.timeOfDay(5) //=> 'a.m.'
 */
function buildLocalizeFn(values, defaultType, indexCallback) {
  return function (dirtyIndex, dirtyOptions) {
    var options = dirtyOptions || {};
    var type = options.type ? String(options.type) : defaultType;
    var valuesArray = values[type] || values[defaultType];
    var index = indexCallback ? indexCallback(Number(dirtyIndex)) : Number(dirtyIndex);
    return valuesArray[index];
  };
}
module.exports = exports["default"];

/***/ }),
/* 160 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = buildLocalizeArrayFn;
/**
 * @name buildLocalizeArrayFn
 * @category Locale Helpers
 * @summary Build `localize.weekdays`, `localize.months` and `localize.timesOfDay` properties for the locale.
 *
 * @description
 * Build `localize.weekdays`, `localize.months` and `localize.timesOfDay` properties for the locale.
 * If no `type` is supplied to the options of the resulting function, `defaultType` will be used (see example).
 *
 * @param {Object} values - the object with arrays of values
 * @param {String} defaultType - the default type for the localize function
 * @returns {Function} the resulting function
 *
 * @example
 * var weekdayValues = {
 *   narrow: ['Su', 'Mo', 'Tu', 'We', 'Th', 'Fr', 'Sa'],
 *   short: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],
 *   long: ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday']
 * }
 * locale.localize.weekdays = buildLocalizeArrayFn(weekdayValues, 'long')
 * locale.localize.weekdays({type: 'narrow'}) //=> ['Su', 'Mo', ...]
 * locale.localize.weekdays() //=> ['Sunday', 'Monday', ...]
 */
function buildLocalizeArrayFn(values, defaultType) {
  return function (dirtyOptions) {
    var options = dirtyOptions || {};
    var type = options.type ? String(options.type) : defaultType;
    return values[type] || values[defaultType];
  };
}
module.exports = exports["default"];

/***/ }),
/* 161 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});

var _index = __webpack_require__(162);

var _index2 = _interopRequireDefault(_index);

var _index3 = __webpack_require__(163);

var _index4 = _interopRequireDefault(_index3);

var _index5 = __webpack_require__(164);

var _index6 = _interopRequireDefault(_index5);

var _index7 = __webpack_require__(165);

var _index8 = _interopRequireDefault(_index7);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var matchOrdinalNumbersPattern = /^(\d+)(th|st|nd|rd)?/i;

var matchWeekdaysPatterns = {
  narrow: /^(su|mo|tu|we|th|fr|sa)/i,
  short: /^(sun|mon|tue|wed|thu|fri|sat)/i,
  long: /^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i
};

var parseWeekdayPatterns = {
  any: [/^su/i, /^m/i, /^tu/i, /^w/i, /^th/i, /^f/i, /^sa/i]
};

var matchMonthsPatterns = {
  short: /^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,
  long: /^(january|february|march|april|may|june|july|august|september|october|november|december)/i
};

var parseMonthPatterns = {
  any: [/^ja/i, /^f/i, /^mar/i, /^ap/i, /^may/i, /^jun/i, /^jul/i, /^au/i, /^s/i, /^o/i, /^n/i, /^d/i]
};

// `timeOfDay` is used to designate which part of the day it is, when used with 12-hour clock.
// Use the system which is used the most commonly in the locale.
// For example, if the country doesn't use a.m./p.m., you can use `night`/`morning`/`afternoon`/`evening`:
//
//   var matchTimesOfDayPatterns = {
//     long: /^((in the)? (night|morning|afternoon|evening?))/i
//   }
//
//   var parseTimeOfDayPatterns = {
//     any: [/(night|morning)/i, /(afternoon|evening)/i]
//   }
var matchTimesOfDayPatterns = {
  short: /^(am|pm)/i,
  long: /^([ap]\.?\s?m\.?)/i
};

var parseTimeOfDayPatterns = {
  any: [/^a/i, /^p/i]
};

var match = {
  ordinalNumbers: (0, _index6.default)(matchOrdinalNumbersPattern),
  ordinalNumber: _index8.default,
  weekdays: (0, _index2.default)(matchWeekdaysPatterns, 'long'),
  weekday: (0, _index4.default)(parseWeekdayPatterns, 'any'),
  months: (0, _index2.default)(matchMonthsPatterns, 'long'),
  month: (0, _index4.default)(parseMonthPatterns, 'any'),
  timesOfDay: (0, _index2.default)(matchTimesOfDayPatterns, 'long'),
  timeOfDay: (0, _index4.default)(parseTimeOfDayPatterns, 'any')
};

exports.default = match;
module.exports = exports['default'];

/***/ }),
/* 162 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = buildMatchFn;
/**
 * @name buildMatchFn
 * @category Locale Helpers
 * @summary Build `match.weekdays`, `match.months` and `match.timesOfDay` properties for the locale.
 *
 * @description
 * Build `match.weekdays`, `match.months` and `match.timesOfDay` properties for the locale used by `parse` function.
 * If no `type` is supplied to the options of the resulting function, `defaultType` will be used (see example).
 * The result of the match function will be passed into corresponding parser function
 * (`match.weekday`, `match.month` or `match.timeOfDay` respectively. See `buildParseFn`).
 *
 * @param {Object} values - the object with RegExps
 * @param {String} defaultType - the default type for the match function
 * @returns {Function} the resulting function
 *
 * @example
 * var matchWeekdaysPatterns = {
 *   narrow: /^(su|mo|tu|we|th|fr|sa)/i,
 *   short: /^(sun|mon|tue|wed|thu|fri|sat)/i,
 *   long: /^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i
 * }
 * locale.match.weekdays = buildMatchFn(matchWeekdaysPatterns, 'long')
 * locale.match.weekdays('Sunday', {type: 'narrow'}) //=> ['Su', 'Su', ...]
 * locale.match.weekdays('Sunday') //=> ['Sunday', 'Sunday', ...]
 */
function buildMatchFn(patterns, defaultType) {
  return function (dirtyString, dirtyOptions) {
    var options = dirtyOptions || {};
    var type = options.type ? String(options.type) : defaultType;
    var pattern = patterns[type] || patterns[defaultType];
    var string = String(dirtyString);
    return string.match(pattern);
  };
}
module.exports = exports["default"];

/***/ }),
/* 163 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = buildParseFn;
/**
 * @name buildParseFn
 * @category Locale Helpers
 * @summary Build `match.weekday`, `match.month` and `match.timeOfDay` properties for the locale.
 *
 * @description
 * Build `match.weekday`, `match.month` and `match.timeOfDay` properties for the locale used by `parse` function.
 * The argument of the resulting function is the result of the corresponding match function
 * (`match.weekdays`, `match.months` or `match.timesOfDay` respectively. See `buildMatchFn`).
 *
 * @param {Object} values - the object with arrays of RegExps
 * @param {String} defaultType - the default type for the parser function
 * @returns {Function} the resulting function
 *
 * @example
 * var parseWeekdayPatterns = {
 *   any: [/^su/i, /^m/i, /^tu/i, /^w/i, /^th/i, /^f/i, /^sa/i]
 * }
 * locale.match.weekday = buildParseFn(matchWeekdaysPatterns, 'long')
 * var matchResult = locale.match.weekdays('Friday')
 * locale.match.weekday(matchResult) //=> 5
 */
function buildParseFn(patterns, defaultType) {
  return function (matchResult, dirtyOptions) {
    var options = dirtyOptions || {};
    var type = options.type ? String(options.type) : defaultType;
    var patternsArray = patterns[type] || patterns[defaultType];
    var string = matchResult[1];

    return patternsArray.findIndex(function (pattern) {
      return pattern.test(string);
    });
  };
}
module.exports = exports["default"];

/***/ }),
/* 164 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = buildMatchPatternFn;
/**
 * @name buildMatchPatternFn
 * @category Locale Helpers
 * @summary Build match function from a single RegExp.
 *
 * @description
 * Build match function from a single RegExp.
 * Usually used for building `match.ordinalNumbers` property of the locale.
 *
 * @param {Object} pattern - the RegExp
 * @returns {Function} the resulting function
 *
 * @example
 * locale.match.ordinalNumbers = buildMatchPatternFn(/^(\d+)(th|st|nd|rd)?/i)
 * locale.match.ordinalNumbers('3rd') //=> ['3rd', '3', 'rd', ...]
 */
function buildMatchPatternFn(pattern) {
  return function (dirtyString) {
    var string = String(dirtyString);
    return string.match(pattern);
  };
}
module.exports = exports["default"];

/***/ }),
/* 165 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = parseDecimal;
/**
 * @name parseDecimal
 * @category Locale Helpers
 * @summary Parses the match result into decimal number.
 *
 * @description
 * Parses the match result into decimal number.
 * Uses the string matched with the first set of parentheses of match RegExp.
 *
 * @param {Array} matchResult - the object returned by matching function
 * @returns {Number} the parsed value
 *
 * @example
 * locale.match = {
 *   ordinalNumbers: (dirtyString) {
 *     return String(dirtyString).match(/^(\d+)(th|st|nd|rd)?/i)
 *   },
 *   ordinalNumber: parseDecimal
 * }
 */
function parseDecimal(matchResult) {
  return parseInt(matchResult[1], 10);
}
module.exports = exports["default"];

/***/ }),
/* 166 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});

var _index = __webpack_require__(167);

var _index2 = _interopRequireDefault(_index);

var _index3 = __webpack_require__(89);

var _index4 = _interopRequireDefault(_index3);

var _index5 = __webpack_require__(90);

var _index6 = _interopRequireDefault(_index5);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var formatters = {
  // Month: 1, 2, ..., 12
  'M': function M(date) {
    return date.getUTCMonth() + 1;
  },

  // Month: 1st, 2nd, ..., 12th
  'Mo': function Mo(date, options) {
    var month = date.getUTCMonth() + 1;
    return options.locale.localize.ordinalNumber(month, { unit: 'month' });
  },

  // Month: 01, 02, ..., 12
  'MM': function MM(date) {
    return addLeadingZeros(date.getUTCMonth() + 1, 2);
  },

  // Month: Jan, Feb, ..., Dec
  'MMM': function MMM(date, options) {
    return options.locale.localize.month(date.getUTCMonth(), { type: 'short' });
  },

  // Month: January, February, ..., December
  'MMMM': function MMMM(date, options) {
    return options.locale.localize.month(date.getUTCMonth(), { type: 'long' });
  },

  // Quarter: 1, 2, 3, 4
  'Q': function Q(date) {
    return Math.ceil((date.getUTCMonth() + 1) / 3);
  },

  // Quarter: 1st, 2nd, 3rd, 4th
  'Qo': function Qo(date, options) {
    var quarter = Math.ceil((date.getUTCMonth() + 1) / 3);
    return options.locale.localize.ordinalNumber(quarter, { unit: 'quarter' });
  },

  // Day of month: 1, 2, ..., 31
  'D': function D(date) {
    return date.getUTCDate();
  },

  // Day of month: 1st, 2nd, ..., 31st
  'Do': function Do(date, options) {
    return options.locale.localize.ordinalNumber(date.getUTCDate(), { unit: 'dayOfMonth' });
  },

  // Day of month: 01, 02, ..., 31
  'DD': function DD(date) {
    return addLeadingZeros(date.getUTCDate(), 2);
  },

  // Day of year: 1, 2, ..., 366
  'DDD': function DDD(date) {
    return (0, _index2.default)(date);
  },

  // Day of year: 1st, 2nd, ..., 366th
  'DDDo': function DDDo(date, options) {
    return options.locale.localize.ordinalNumber((0, _index2.default)(date), { unit: 'dayOfYear' });
  },

  // Day of year: 001, 002, ..., 366
  'DDDD': function DDDD(date) {
    return addLeadingZeros((0, _index2.default)(date), 3);
  },

  // Day of week: Su, Mo, ..., Sa
  'dd': function dd(date, options) {
    return options.locale.localize.weekday(date.getUTCDay(), { type: 'narrow' });
  },

  // Day of week: Sun, Mon, ..., Sat
  'ddd': function ddd(date, options) {
    return options.locale.localize.weekday(date.getUTCDay(), { type: 'short' });
  },

  // Day of week: Sunday, Monday, ..., Saturday
  'dddd': function dddd(date, options) {
    return options.locale.localize.weekday(date.getUTCDay(), { type: 'long' });
  },

  // Day of week: 0, 1, ..., 6
  'd': function d(date) {
    return date.getUTCDay();
  },

  // Day of week: 0th, 1st, 2nd, ..., 6th
  'do': function _do(date, options) {
    return options.locale.localize.ordinalNumber(date.getUTCDay(), { unit: 'dayOfWeek' });
  },

  // Day of ISO week: 1, 2, ..., 7
  'E': function E(date) {
    return date.getUTCDay() || 7;
  },

  // ISO week: 1, 2, ..., 53
  'W': function W(date) {
    return (0, _index4.default)(date);
  },

  // ISO week: 1st, 2nd, ..., 53th
  'Wo': function Wo(date, options) {
    return options.locale.localize.ordinalNumber((0, _index4.default)(date), { unit: 'isoWeek' });
  },

  // ISO week: 01, 02, ..., 53
  'WW': function WW(date) {
    return addLeadingZeros((0, _index4.default)(date), 2);
  },

  // Year: 00, 01, ..., 99
  'YY': function YY(date) {
    return addLeadingZeros(date.getUTCFullYear(), 4).substr(2);
  },

  // Year: 1900, 1901, ..., 2099
  'YYYY': function YYYY(date) {
    return addLeadingZeros(date.getUTCFullYear(), 4);
  },

  // ISO week-numbering year: 00, 01, ..., 99
  'GG': function GG(date) {
    return String((0, _index6.default)(date)).substr(2);
  },

  // ISO week-numbering year: 1900, 1901, ..., 2099
  'GGGG': function GGGG(date) {
    return (0, _index6.default)(date);
  },

  // Hour: 0, 1, ... 23
  'H': function H(date) {
    return date.getUTCHours();
  },

  // Hour: 00, 01, ..., 23
  'HH': function HH(date) {
    return addLeadingZeros(date.getUTCHours(), 2);
  },

  // Hour: 1, 2, ..., 12
  'h': function h(date) {
    var hours = date.getUTCHours();
    if (hours === 0) {
      return 12;
    } else if (hours > 12) {
      return hours % 12;
    } else {
      return hours;
    }
  },

  // Hour: 01, 02, ..., 12
  'hh': function hh(date) {
    return addLeadingZeros(formatters['h'](date), 2);
  },

  // Minute: 0, 1, ..., 59
  'm': function m(date) {
    return date.getUTCMinutes();
  },

  // Minute: 00, 01, ..., 59
  'mm': function mm(date) {
    return addLeadingZeros(date.getUTCMinutes(), 2);
  },

  // Second: 0, 1, ..., 59
  's': function s(date) {
    return date.getUTCSeconds();
  },

  // Second: 00, 01, ..., 59
  'ss': function ss(date) {
    return addLeadingZeros(date.getUTCSeconds(), 2);
  },

  // 1/10 of second: 0, 1, ..., 9
  'S': function S(date) {
    return Math.floor(date.getUTCMilliseconds() / 100);
  },

  // 1/100 of second: 00, 01, ..., 99
  'SS': function SS(date) {
    return addLeadingZeros(Math.floor(date.getUTCMilliseconds() / 10), 2);
  },

  // Millisecond: 000, 001, ..., 999
  'SSS': function SSS(date) {
    return addLeadingZeros(date.getUTCMilliseconds(), 3);
  },

  // Timezone: -01:00, +00:00, ... +12:00
  'Z': function Z(date, options) {
    var originalDate = options._originalDate || date;
    return formatTimezone(originalDate.getTimezoneOffset(), ':');
  },

  // Timezone: -0100, +0000, ... +1200
  'ZZ': function ZZ(date, options) {
    var originalDate = options._originalDate || date;
    return formatTimezone(originalDate.getTimezoneOffset());
  },

  // Seconds timestamp: 512969520
  'X': function X(date, options) {
    var originalDate = options._originalDate || date;
    return Math.floor(originalDate.getTime() / 1000);
  },

  // Milliseconds timestamp: 512969520900
  'x': function x(date, options) {
    var originalDate = options._originalDate || date;
    return originalDate.getTime();
  },

  // AM, PM
  'A': function A(date, options) {
    return options.locale.localize.timeOfDay(date.getUTCHours(), { type: 'uppercase' });
  },

  // am, pm
  'a': function a(date, options) {
    return options.locale.localize.timeOfDay(date.getUTCHours(), { type: 'lowercase' });
  },

  // a.m., p.m.
  'aa': function aa(date, options) {
    return options.locale.localize.timeOfDay(date.getUTCHours(), { type: 'long' });
  }
};

function formatTimezone(offset, delimeter) {
  delimeter = delimeter || '';
  var sign = offset > 0 ? '-' : '+';
  var absOffset = Math.abs(offset);
  var hours = Math.floor(absOffset / 60);
  var minutes = absOffset % 60;
  return sign + addLeadingZeros(hours, 2) + delimeter + addLeadingZeros(minutes, 2);
}

function addLeadingZeros(number, targetLength) {
  var output = Math.abs(number).toString();
  while (output.length < targetLength) {
    output = '0' + output;
  }
  return output;
}

exports.default = formatters;
module.exports = exports['default'];

/***/ }),
/* 167 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = getUTCDayOfYear;

var _index = __webpack_require__(13);

var _index2 = _interopRequireDefault(_index);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var MILLISECONDS_IN_DAY = 86400000;

// This function will be a part of public API when UTC function will be implemented.
// See issue: https://github.com/date-fns/date-fns/issues/376
function getUTCDayOfYear(dirtyDate, dirtyOptions) {
  var date = (0, _index2.default)(dirtyDate, dirtyOptions);
  var timestamp = date.getTime();
  date.setUTCMonth(0, 1);
  date.setUTCHours(0, 0, 0, 0);
  var startOfYearTimestamp = date.getTime();
  var difference = timestamp - startOfYearTimestamp;
  return Math.floor(difference / MILLISECONDS_IN_DAY) + 1;
}
module.exports = exports['default'];

/***/ }),
/* 168 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = addUTCMinutes;

var _index = __webpack_require__(13);

var _index2 = _interopRequireDefault(_index);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

// This function will be a part of public API when UTC function will be implemented.
// See issue: https://github.com/date-fns/date-fns/issues/376
function addUTCMinutes(dirtyDate, dirtyAmount, dirtyOptions) {
  var date = (0, _index2.default)(dirtyDate, dirtyOptions);
  var amount = Number(dirtyAmount);
  date.setUTCMinutes(date.getUTCMinutes() + amount);
  return date;
}
module.exports = exports['default'];

/***/ }),
/* 169 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = parse;

var _index = __webpack_require__(13);

var _index2 = _interopRequireDefault(_index);

var _index3 = __webpack_require__(170);

var _index4 = _interopRequireDefault(_index3);

var _index5 = __webpack_require__(88);

var _index6 = _interopRequireDefault(_index5);

var _index7 = __webpack_require__(173);

var _index8 = _interopRequireDefault(_index7);

var _index9 = __webpack_require__(174);

var _index10 = _interopRequireDefault(_index9);

var _index11 = __webpack_require__(91);

var _index12 = _interopRequireDefault(_index11);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var TIMEZONE_UNIT_PRIORITY = 110;
var MILLISECONDS_IN_MINUTE = 60000;

var longFormattingTokensRegExp = /(\[[^[]*])|(\\)?(LTS|LT|LLLL|LLL|LL|L|llll|lll|ll|l)/g;
var defaultParsingTokensRegExp = /(\[[^[]*])|(\\)?(x|ss|s|mm|m|hh|h|do|dddd|ddd|dd|d|aa|a|ZZ|Z|YYYY|YY|X|Wo|WW|W|SSS|SS|S|Qo|Q|Mo|MMMM|MMM|MM|M|HH|H|GGGG|GG|E|Do|DDDo|DDDD|DDD|DD|D|A|.)/g;

/**
 * @name parse
 * @category Common Helpers
 * @summary Parse the date.
 *
 * @description
 * Return the date parsed from string using the given format.
 *
 * Accepted format tokens:
 * | Unit                    | Priority | Token | Input examples                   |
 * |-------------------------|----------|-------|----------------------------------|
 * | Year                    | 10       | YY    | 00, 01, ..., 99                  |
 * |                         |          | YYYY  | 1900, 1901, ..., 2099            |
 * | ISO week-numbering year | 10       | GG    | 00, 01, ..., 99                  |
 * |                         |          | GGGG  | 1900, 1901, ..., 2099            |
 * | Quarter                 | 20       | Q     | 1, 2, 3, 4                       |
 * |                         |          | Qo    | 1st, 2nd, 3rd, 4th               |
 * | Month                   | 30       | M     | 1, 2, ..., 12                    |
 * |                         |          | Mo    | 1st, 2nd, ..., 12th              |
 * |                         |          | MM    | 01, 02, ..., 12                  |
 * |                         |          | MMM   | Jan, Feb, ..., Dec               |
 * |                         |          | MMMM  | January, February, ..., December |
 * | ISO week                | 40       | W     | 1, 2, ..., 53                    |
 * |                         |          | Wo    | 1st, 2nd, ..., 53rd              |
 * |                         |          | WW    | 01, 02, ..., 53                  |
 * | Day of week             | 50       | d     | 0, 1, ..., 6                     |
 * |                         |          | do    | 0th, 1st, ..., 6th               |
 * |                         |          | dd    | Su, Mo, ..., Sa                  |
 * |                         |          | ddd   | Sun, Mon, ..., Sat               |
 * |                         |          | dddd  | Sunday, Monday, ..., Saturday    |
 * | Day of ISO week         | 50       | E     | 1, 2, ..., 7                     |
 * | Day of month            | 50       | D     | 1, 2, ..., 31                    |
 * |                         |          | Do    | 1st, 2nd, ..., 31st              |
 * |                         |          | DD    | 01, 02, ..., 31                  |
 * | Day of year             | 50       | DDD   | 1, 2, ..., 366                   |
 * |                         |          | DDDo  | 1st, 2nd, ..., 366th             |
 * |                         |          | DDDD  | 001, 002, ..., 366               |
 * | Time of day             | 60       | A     | AM, PM                           |
 * |                         |          | a     | am, pm                           |
 * |                         |          | aa    | a.m., p.m.                       |
 * | Hour                    | 70       | H     | 0, 1, ... 23                     |
 * |                         |          | HH    | 00, 01, ... 23                   |
 * | Time of day hour        | 70       | h     | 1, 2, ..., 12                    |
 * |                         |          | hh    | 01, 02, ..., 12                  |
 * | Minute                  | 80       | m     | 0, 1, ..., 59                    |
 * |                         |          | mm    | 00, 01, ..., 59                  |
 * | Second                  | 90       | s     | 0, 1, ..., 59                    |
 * |                         |          | ss    | 00, 01, ..., 59                  |
 * | 1/10 of second          | 100      | S     | 0, 1, ..., 9                     |
 * | 1/100 of second         | 100      | SS    | 00, 01, ..., 99                  |
 * | Millisecond             | 100      | SSS   | 000, 001, ..., 999               |
 * | Timezone                | 110      | Z     | -01:00, +00:00, ... +12:00       |
 * |                         |          | ZZ    | -0100, +0000, ..., +1200         |
 * | Seconds timestamp       | 120      | X     | 512969520                        |
 * | Milliseconds timestamp  | 120      | x     | 512969520900                     |
 *
 * Values will be assigned to the date in the ascending order of its unit's priority.
 * Units of an equal priority overwrite each other in the order of appearance.
 *
 * If no values of higher priority are parsed (e.g. when parsing string 'January 1st' without a year),
 * the values will be taken from 3rd argument `baseDate` which works as a context of parsing.
 *
 * `baseDate` must be passed for correct work of the function.
 * If you're not sure which `baseDate` to supply, create a new instance of Date:
 * `parse('02/11/2014', 'MM/DD/YYYY', new Date())`
 * In this case parsing will be done in the context of the current date.
 * If `baseDate` is `Invalid Date` or a value not convertible to valid `Date`,
 * then `Invalid Date` will be returned.
 *
 * Also, `parse` unfolds long formats like those in [format]{@link https://date-fns.org/docs/format}:
 * | Token | Input examples                 |
 * |-------|--------------------------------|
 * | LT    | 05:30 a.m.                     |
 * | LTS   | 05:30:15 a.m.                  |
 * | L     | 07/02/1995                     |
 * | l     | 7/2/1995                       |
 * | LL    | July 2 1995                    |
 * | ll    | Jul 2 1995                     |
 * | LLL   | July 2 1995 05:30 a.m.         |
 * | lll   | Jul 2 1995 05:30 a.m.          |
 * | LLLL  | Sunday, July 2 1995 05:30 a.m. |
 * | llll  | Sun, Jul 2 1995 05:30 a.m.     |
 *
 * The characters wrapped in square brackets in the format string are escaped.
 *
 * The result may vary by locale.
 *
 * If `formatString` matches with `dateString` but does not provides tokens, `baseDate` will be returned.
 *
 * If parsing failed, `Invalid Date` will be returned.
 * Invalid Date is a Date, whose time value is NaN.
 * Time value of Date: http://es5.github.io/#x15.9.1.1
 *
 * @param {String} dateString - the string to parse
 * @param {String} formatString - the string of tokens
 * @param {Date|String|Number} baseDate - the date to took the missing higher priority values from
 * @param {Options} [options] - the object with options. See [Options]{@link https://date-fns.org/docs/Options}
 * @param {0|1|2} [options.additionalDigits=2] - passed to `toDate`. See [toDate]{@link https://date-fns.org/docs/toDate}
 * @param {Locale} [options.locale=defaultLocale] - the locale object. See [Locale]{@link https://date-fns.org/docs/Locale}
 * @param {0|1|2|3|4|5|6} [options.weekStartsOn=0] - the index of the first day of the week (0 - Sunday)
 * @returns {Date} the parsed date
 * @throws {TypeError} 3 arguments required
 * @throws {RangeError} `options.additionalDigits` must be 0, 1 or 2
 * @throws {RangeError} `options.weekStartsOn` must be between 0 and 6
 * @throws {RangeError} `options.locale` must contain `match` property
 * @throws {RangeError} `options.locale` must contain `formatLong` property
 *
 * @example
 * // Parse 11 February 2014 from middle-endian format:
 * var result = parse(
 *   '02/11/2014',
 *   'MM/DD/YYYY',
 *   new Date()
 * )
 * //=> Tue Feb 11 2014 00:00:00
 *
 * @example
 * // Parse 28th of February in English locale in the context of 2010 year:
 * import eoLocale from 'date-fns/locale/eo'
 * var result = parse(
 *   '28-a de februaro',
 *   'Do [de] MMMM',
 *   new Date(2010, 0, 1)
 *   {locale: eoLocale}
 * )
 * //=> Sun Feb 28 2010 00:00:00
 */
function parse(dirtyDateString, dirtyFormatString, dirtyBaseDate, dirtyOptions) {
  if (arguments.length < 3) {
    throw new TypeError('3 arguments required, but only ' + arguments.length + ' present');
  }

  var dateString = String(dirtyDateString);
  var options = dirtyOptions || {};

  var weekStartsOn = options.weekStartsOn === undefined ? 0 : Number(options.weekStartsOn);

  // Test if weekStartsOn is between 0 and 6 _and_ is not NaN
  if (!(weekStartsOn >= 0 && weekStartsOn <= 6)) {
    throw new RangeError('weekStartsOn must be between 0 and 6 inclusively');
  }

  var locale = options.locale || _index6.default;
  var localeParsers = locale.parsers || {};
  var localeUnits = locale.units || {};

  if (!locale.match) {
    throw new RangeError('locale must contain match property');
  }

  if (!locale.formatLong) {
    throw new RangeError('locale must contain formatLong property');
  }

  var formatString = String(dirtyFormatString).replace(longFormattingTokensRegExp, function (substring) {
    if (substring[0] === '[') {
      return substring;
    }

    if (substring[0] === '\\') {
      return cleanEscapedString(substring);
    }

    return locale.formatLong(substring);
  });

  if (formatString === '') {
    if (dateString === '') {
      return (0, _index2.default)(dirtyBaseDate, options);
    } else {
      return new Date(NaN);
    }
  }

  var subFnOptions = (0, _index12.default)(options);
  subFnOptions.locale = locale;

  var tokens = formatString.match(locale.parsingTokensRegExp || defaultParsingTokensRegExp);
  var tokensLength = tokens.length;

  // If timezone isn't specified, it will be set to the system timezone
  var setters = [{
    priority: TIMEZONE_UNIT_PRIORITY,
    set: dateToSystemTimezone,
    index: 0
  }];

  var i;
  for (i = 0; i < tokensLength; i++) {
    var token = tokens[i];
    var parser = localeParsers[token] || _index8.default[token];
    if (parser) {
      var matchResult;

      if (parser.match instanceof RegExp) {
        matchResult = parser.match.exec(dateString);
      } else {
        matchResult = parser.match(dateString, subFnOptions);
      }

      if (!matchResult) {
        return new Date(NaN);
      }

      var unitName = parser.unit;
      var unit = localeUnits[unitName] || _index10.default[unitName];

      setters.push({
        priority: unit.priority,
        set: unit.set,
        value: parser.parse(matchResult, subFnOptions),
        index: setters.length
      });

      var substring = matchResult[0];
      dateString = dateString.slice(substring.length);
    } else {
      var head = tokens[i].match(/^\[.*]$/) ? tokens[i].replace(/^\[|]$/g, '') : tokens[i];
      if (dateString.indexOf(head) === 0) {
        dateString = dateString.slice(head.length);
      } else {
        return new Date(NaN);
      }
    }
  }

  var uniquePrioritySetters = setters.map(function (setter) {
    return setter.priority;
  }).sort(function (a, b) {
    return a - b;
  }).filter(function (priority, index, array) {
    return array.indexOf(priority) === index;
  }).map(function (priority) {
    return setters.filter(function (setter) {
      return setter.priority === priority;
    }).reverse();
  }).map(function (setterArray) {
    return setterArray[0];
  });

  var date = (0, _index2.default)(dirtyBaseDate, options);

  if (isNaN(date)) {
    return new Date(NaN);
  }

  // Convert the date in system timezone to the same date in UTC+00:00 timezone.
  // This ensures that when UTC functions will be implemented, locales will be compatible with them.
  // See an issue about UTC functions: https://github.com/date-fns/date-fns/issues/37
  var utcDate = (0, _index4.default)(date, date.getTimezoneOffset());

  var dateValues = { date: utcDate };

  var settersLength = uniquePrioritySetters.length;
  for (i = 0; i < settersLength; i++) {
    var setter = uniquePrioritySetters[i];
    dateValues = setter.set(dateValues, setter.value, subFnOptions);
  }

  return dateValues.date;
}

function dateToSystemTimezone(dateValues) {
  var date = dateValues.date;
  var time = date.getTime();

  // Get the system timezone offset at (moment of time - offset)
  var offset = date.getTimezoneOffset();

  // Get the system timezone offset at the exact moment of time
  offset = new Date(time + offset * MILLISECONDS_IN_MINUTE).getTimezoneOffset();

  // Convert date in timezone "UTC+00:00" to the system timezone
  dateValues.date = new Date(time + offset * MILLISECONDS_IN_MINUTE);

  return dateValues;
}

function cleanEscapedString(input) {
  if (input.match(/\[[\s\S]/)) {
    return input.replace(/^\[|]$/g, '');
  }
  return input.replace(/\\/g, '');
}
module.exports = exports['default'];

/***/ }),
/* 170 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = subMinutes;

var _index = __webpack_require__(171);

var _index2 = _interopRequireDefault(_index);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

/**
 * @name subMinutes
 * @category Minute Helpers
 * @summary Subtract the specified number of minutes from the given date.
 *
 * @description
 * Subtract the specified number of minutes from the given date.
 *
 * @param {Date|String|Number} date - the date to be changed
 * @param {Number} amount - the amount of minutes to be subtracted
 * @param {Options} [options] - the object with options. See [Options]{@link https://date-fns.org/docs/Options}
 * @param {0|1|2} [options.additionalDigits=2] - passed to `toDate`. See [toDate]{@link https://date-fns.org/docs/toDate}
 * @returns {Date} the new date with the mintues subtracted
 * @throws {TypeError} 2 arguments required
 * @throws {RangeError} `options.additionalDigits` must be 0, 1 or 2
 *
 * @example
 * // Subtract 30 minutes from 10 July 2014 12:00:00:
 * var result = subMinutes(new Date(2014, 6, 10, 12, 0), 30)
 * //=> Thu Jul 10 2014 11:30:00
 */
function subMinutes(dirtyDate, dirtyAmount, dirtyOptions) {
  if (arguments.length < 2) {
    throw new TypeError('2 arguments required, but only ' + arguments.length + ' present');
  }

  var amount = Number(dirtyAmount);
  return (0, _index2.default)(dirtyDate, -amount, dirtyOptions);
}
module.exports = exports['default'];

/***/ }),
/* 171 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = addMinutes;

var _index = __webpack_require__(172);

var _index2 = _interopRequireDefault(_index);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var MILLISECONDS_IN_MINUTE = 60000;

/**
 * @name addMinutes
 * @category Minute Helpers
 * @summary Add the specified number of minutes to the given date.
 *
 * @description
 * Add the specified number of minutes to the given date.
 *
 * @param {Date|String|Number} date - the date to be changed
 * @param {Number} amount - the amount of minutes to be added
 * @param {Options} [options] - the object with options. See [Options]{@link https://date-fns.org/docs/Options}
 * @param {0|1|2} [options.additionalDigits=2] - passed to `toDate`. See [toDate]{@link https://date-fns.org/docs/toDate}
 * @returns {Date} the new date with the minutes added
 * @throws {TypeError} 2 arguments required
 * @throws {RangeError} `options.additionalDigits` must be 0, 1 or 2
 *
 * @example
 * // Add 30 minutes to 10 July 2014 12:00:00:
 * var result = addMinutes(new Date(2014, 6, 10, 12, 0), 30)
 * //=> Thu Jul 10 2014 12:30:00
 */
function addMinutes(dirtyDate, dirtyAmount, dirtyOptions) {
  if (arguments.length < 2) {
    throw new TypeError('2 arguments required, but only ' + arguments.length + ' present');
  }

  var amount = Number(dirtyAmount);
  return (0, _index2.default)(dirtyDate, amount * MILLISECONDS_IN_MINUTE, dirtyOptions);
}
module.exports = exports['default'];

/***/ }),
/* 172 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = addMilliseconds;

var _index = __webpack_require__(13);

var _index2 = _interopRequireDefault(_index);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

/**
 * @name addMilliseconds
 * @category Millisecond Helpers
 * @summary Add the specified number of milliseconds to the given date.
 *
 * @description
 * Add the specified number of milliseconds to the given date.
 *
 * @param {Date|String|Number} date - the date to be changed
 * @param {Number} amount - the amount of milliseconds to be added
 * @param {Options} [options] - the object with options. See [Options]{@link https://date-fns.org/docs/Options}
 * @param {0|1|2} [options.additionalDigits=2] - passed to `toDate`. See [toDate]{@link https://date-fns.org/docs/toDate}
 * @returns {Date} the new date with the milliseconds added
 * @throws {TypeError} 2 arguments required
 * @throws {RangeError} `options.additionalDigits` must be 0, 1 or 2
 *
 * @example
 * // Add 750 milliseconds to 10 July 2014 12:45:30.000:
 * var result = addMilliseconds(new Date(2014, 6, 10, 12, 45, 30, 0), 750)
 * //=> Thu Jul 10 2014 12:45:30.750
 */
function addMilliseconds(dirtyDate, dirtyAmount, dirtyOptions) {
  if (arguments.length < 2) {
    throw new TypeError('2 arguments required, but only ' + arguments.length + ' present');
  }

  var timestamp = (0, _index2.default)(dirtyDate, dirtyOptions).getTime();
  var amount = Number(dirtyAmount);
  return new Date(timestamp + amount);
}
module.exports = exports['default'];

/***/ }),
/* 173 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});
var patterns = {
  'M': /^(1[0-2]|0?\d)/, // 0 to 12
  'D': /^(3[0-1]|[0-2]?\d)/, // 0 to 31
  'DDD': /^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/, // 0 to 366
  'W': /^(5[0-3]|[0-4]?\d)/, // 0 to 53
  'YYYY': /^(\d{1,4})/, // 0 to 9999
  'H': /^(2[0-3]|[0-1]?\d)/, // 0 to 23
  'm': /^([0-5]?\d)/, // 0 to 59
  'Z': /^([+-])(\d{2}):(\d{2})/,
  'ZZ': /^([+-])(\d{2})(\d{2})/,
  singleDigit: /^(\d)/,
  twoDigits: /^(\d{2})/,
  threeDigits: /^(\d{3})/,
  fourDigits: /^(\d{4})/,
  anyDigits: /^(\d+)/
};

function parseDecimal(matchResult) {
  return parseInt(matchResult[1], 10);
}

var parsers = {
  // Year: 00, 01, ..., 99
  'YY': {
    unit: 'twoDigitYear',
    match: patterns.twoDigits,
    parse: function parse(matchResult) {
      return parseDecimal(matchResult);
    }
  },

  // Year: 1900, 1901, ..., 2099
  'YYYY': {
    unit: 'year',
    match: patterns.YYYY,
    parse: parseDecimal
  },

  // ISO week-numbering year: 00, 01, ..., 99
  'GG': {
    unit: 'isoYear',
    match: patterns.twoDigits,
    parse: function parse(matchResult) {
      return parseDecimal(matchResult) + 1900;
    }
  },

  // ISO week-numbering year: 1900, 1901, ..., 2099
  'GGGG': {
    unit: 'isoYear',
    match: patterns.YYYY,
    parse: parseDecimal
  },

  // Quarter: 1, 2, 3, 4
  'Q': {
    unit: 'quarter',
    match: patterns.singleDigit,
    parse: parseDecimal
  },

  // Ordinal quarter
  'Qo': {
    unit: 'quarter',
    match: function match(string, options) {
      return options.locale.match.ordinalNumbers(string, { unit: 'quarter' });
    },
    parse: function parse(matchResult, options) {
      return options.locale.match.ordinalNumber(matchResult, { unit: 'quarter' });
    }
  },

  // Month: 1, 2, ..., 12
  'M': {
    unit: 'month',
    match: patterns.M,
    parse: function parse(matchResult) {
      return parseDecimal(matchResult) - 1;
    }
  },

  // Ordinal month
  'Mo': {
    unit: 'month',
    match: function match(string, options) {
      return options.locale.match.ordinalNumbers(string, { unit: 'month' });
    },
    parse: function parse(matchResult, options) {
      return options.locale.match.ordinalNumber(matchResult, { unit: 'month' }) - 1;
    }
  },

  // Month: 01, 02, ..., 12
  'MM': {
    unit: 'month',
    match: patterns.twoDigits,
    parse: function parse(matchResult) {
      return parseDecimal(matchResult) - 1;
    }
  },

  // Month: Jan, Feb, ..., Dec
  'MMM': {
    unit: 'month',
    match: function match(string, options) {
      return options.locale.match.months(string, { type: 'short' });
    },
    parse: function parse(matchResult, options) {
      return options.locale.match.month(matchResult, { type: 'short' });
    }
  },

  // Month: January, February, ..., December
  'MMMM': {
    unit: 'month',
    match: function match(string, options) {
      return options.locale.match.months(string, { type: 'long' }) || options.locale.match.months(string, { type: 'short' });
    },
    parse: function parse(matchResult, options) {
      var parseResult = options.locale.match.month(matchResult, { type: 'long' });

      if (parseResult == null) {
        parseResult = options.locale.match.month(matchResult, { type: 'short' });
      }

      return parseResult;
    }
  },

  // ISO week: 1, 2, ..., 53
  'W': {
    unit: 'isoWeek',
    match: patterns.W,
    parse: parseDecimal
  },

  // Ordinal ISO week
  'Wo': {
    unit: 'isoWeek',
    match: function match(string, options) {
      return options.locale.match.ordinalNumbers(string, { unit: 'isoWeek' });
    },
    parse: function parse(matchResult, options) {
      return options.locale.match.ordinalNumber(matchResult, { unit: 'isoWeek' });
    }
  },

  // ISO week: 01, 02, ..., 53
  'WW': {
    unit: 'isoWeek',
    match: patterns.twoDigits,
    parse: parseDecimal
  },

  // Day of week: 0, 1, ..., 6
  'd': {
    unit: 'dayOfWeek',
    match: patterns.singleDigit,
    parse: parseDecimal
  },

  // Ordinal day of week
  'do': {
    unit: 'dayOfWeek',
    match: function match(string, options) {
      return options.locale.match.ordinalNumbers(string, { unit: 'dayOfWeek' });
    },
    parse: function parse(matchResult, options) {
      return options.locale.match.ordinalNumber(matchResult, { unit: 'dayOfWeek' });
    }
  },

  // Day of week: Su, Mo, ..., Sa
  'dd': {
    unit: 'dayOfWeek',
    match: function match(string, options) {
      return options.locale.match.weekdays(string, { type: 'narrow' });
    },
    parse: function parse(matchResult, options) {
      return options.locale.match.weekday(matchResult, { type: 'narrow' });
    }
  },

  // Day of week: Sun, Mon, ..., Sat
  'ddd': {
    unit: 'dayOfWeek',
    match: function match(string, options) {
      return options.locale.match.weekdays(string, { type: 'short' }) || options.locale.match.weekdays(string, { type: 'narrow' });
    },
    parse: function parse(matchResult, options) {
      var parseResult = options.locale.match.weekday(matchResult, { type: 'short' });

      if (parseResult == null) {
        parseResult = options.locale.match.weekday(matchResult, { type: 'narrow' });
      }

      return parseResult;
    }
  },

  // Day of week: Sunday, Monday, ..., Saturday
  'dddd': {
    unit: 'dayOfWeek',
    match: function match(string, options) {
      return options.locale.match.weekdays(string, { type: 'long' }) || options.locale.match.weekdays(string, { type: 'short' }) || options.locale.match.weekdays(string, { type: 'narrow' });
    },
    parse: function parse(matchResult, options) {
      var parseResult = options.locale.match.weekday(matchResult, { type: 'long' });

      if (parseResult == null) {
        parseResult = options.locale.match.weekday(matchResult, { type: 'short' });

        if (parseResult == null) {
          parseResult = options.locale.match.weekday(matchResult, { type: 'narrow' });
        }
      }

      return parseResult;
    }
  },

  // Day of ISO week: 1, 2, ..., 7
  'E': {
    unit: 'dayOfISOWeek',
    match: patterns.singleDigit,
    parse: function parse(matchResult) {
      return parseDecimal(matchResult);
    }
  },

  // Day of month: 1, 2, ..., 31
  'D': {
    unit: 'dayOfMonth',
    match: patterns.D,
    parse: parseDecimal
  },

  // Ordinal day of month
  'Do': {
    unit: 'dayOfMonth',
    match: function match(string, options) {
      return options.locale.match.ordinalNumbers(string, { unit: 'dayOfMonth' });
    },
    parse: function parse(matchResult, options) {
      return options.locale.match.ordinalNumber(matchResult, { unit: 'dayOfMonth' });
    }
  },

  // Day of month: 01, 02, ..., 31
  'DD': {
    unit: 'dayOfMonth',
    match: patterns.twoDigits,
    parse: parseDecimal
  },

  // Day of year: 1, 2, ..., 366
  'DDD': {
    unit: 'dayOfYear',
    match: patterns.DDD,
    parse: parseDecimal
  },

  // Ordinal day of year
  'DDDo': {
    unit: 'dayOfYear',
    match: function match(string, options) {
      return options.locale.match.ordinalNumbers(string, { unit: 'dayOfYear' });
    },
    parse: function parse(matchResult, options) {
      return options.locale.match.ordinalNumber(matchResult, { unit: 'dayOfYear' });
    }
  },

  // Day of year: 001, 002, ..., 366
  'DDDD': {
    unit: 'dayOfYear',
    match: patterns.threeDigits,
    parse: parseDecimal
  },

  // AM, PM
  'A': {
    unit: 'timeOfDay',
    match: function match(string, options) {
      return options.locale.match.timesOfDay(string, { type: 'short' });
    },
    parse: function parse(matchResult, options) {
      return options.locale.match.timeOfDay(matchResult, { type: 'short' });
    }
  },

  // a.m., p.m.
  'aa': {
    unit: 'timeOfDay',
    match: function match(string, options) {
      return options.locale.match.timesOfDay(string, { type: 'long' }) || options.locale.match.timesOfDay(string, { type: 'short' });
    },
    parse: function parse(matchResult, options) {
      var parseResult = options.locale.match.timeOfDay(matchResult, { type: 'long' });

      if (parseResult == null) {
        parseResult = options.locale.match.timeOfDay(matchResult, { type: 'short' });
      }

      return parseResult;
    }
  },

  // Hour: 0, 1, ... 23
  'H': {
    unit: 'hours',
    match: patterns.H,
    parse: parseDecimal
  },

  // Hour: 00, 01, ..., 23
  'HH': {
    unit: 'hours',
    match: patterns.twoDigits,
    parse: parseDecimal
  },

  // Hour: 1, 2, ..., 12
  'h': {
    unit: 'timeOfDayHours',
    match: patterns.M,
    parse: parseDecimal
  },

  // Hour: 01, 02, ..., 12
  'hh': {
    unit: 'timeOfDayHours',
    match: patterns.twoDigits,
    parse: parseDecimal
  },

  // Minute: 0, 1, ..., 59
  'm': {
    unit: 'minutes',
    match: patterns.m,
    parse: parseDecimal
  },

  // Minute: 00, 01, ..., 59
  'mm': {
    unit: 'minutes',
    match: patterns.twoDigits,
    parse: parseDecimal
  },

  // Second: 0, 1, ..., 59
  's': {
    unit: 'seconds',
    match: patterns.m,
    parse: parseDecimal
  },

  // Second: 00, 01, ..., 59
  'ss': {
    unit: 'seconds',
    match: patterns.twoDigits,
    parse: parseDecimal
  },

  // 1/10 of second: 0, 1, ..., 9
  'S': {
    unit: 'milliseconds',
    match: patterns.singleDigit,
    parse: function parse(matchResult) {
      return parseDecimal(matchResult) * 100;
    }
  },

  // 1/100 of second: 00, 01, ..., 99
  'SS': {
    unit: 'milliseconds',
    match: patterns.twoDigits,
    parse: function parse(matchResult) {
      return parseDecimal(matchResult) * 10;
    }
  },

  // Millisecond: 000, 001, ..., 999
  'SSS': {
    unit: 'milliseconds',
    match: patterns.threeDigits,
    parse: parseDecimal
  },

  // Timezone: -01:00, +00:00, ... +12:00
  'Z': {
    unit: 'timezone',
    match: patterns.Z,
    parse: function parse(matchResult) {
      var sign = matchResult[1];
      var hours = parseInt(matchResult[2], 10);
      var minutes = parseInt(matchResult[3], 10);
      var absoluteOffset = hours * 60 + minutes;
      return sign === '+' ? absoluteOffset : -absoluteOffset;
    }
  },

  // Timezone: -0100, +0000, ... +1200
  'ZZ': {
    unit: 'timezone',
    match: patterns.ZZ,
    parse: function parse(matchResult) {
      var sign = matchResult[1];
      var hours = parseInt(matchResult[2], 10);
      var minutes = parseInt(matchResult[3], 10);
      var absoluteOffset = hours * 60 + minutes;
      return sign === '+' ? absoluteOffset : -absoluteOffset;
    }
  },

  // Seconds timestamp: 512969520
  'X': {
    unit: 'timestamp',
    match: patterns.anyDigits,
    parse: function parse(matchResult) {
      return parseDecimal(matchResult) * 1000;
    }
  },

  // Milliseconds timestamp: 512969520900
  'x': {
    unit: 'timestamp',
    match: patterns.anyDigits,
    parse: parseDecimal
  }
};

parsers['a'] = parsers['A'];

exports.default = parsers;
module.exports = exports['default'];

/***/ }),
/* 174 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});

var _index = __webpack_require__(175);

var _index2 = _interopRequireDefault(_index);

var _index3 = __webpack_require__(176);

var _index4 = _interopRequireDefault(_index3);

var _index5 = __webpack_require__(177);

var _index6 = _interopRequireDefault(_index5);

var _index7 = __webpack_require__(178);

var _index8 = _interopRequireDefault(_index7);

var _index9 = __webpack_require__(43);

var _index10 = _interopRequireDefault(_index9);

var _index11 = __webpack_require__(60);

var _index12 = _interopRequireDefault(_index11);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var MILLISECONDS_IN_MINUTE = 60000;

function setTimeOfDay(hours, timeOfDay) {
  var isAM = timeOfDay === 0;

  if (isAM) {
    if (hours === 12) {
      return 0;
    }
  } else {
    if (hours !== 12) {
      return 12 + hours;
    }
  }

  return hours;
}

var units = {
  twoDigitYear: {
    priority: 10,
    set: function set(dateValues, value) {
      var century = Math.floor(dateValues.date.getUTCFullYear() / 100);
      var year = century * 100 + value;
      dateValues.date.setUTCFullYear(year, 0, 1);
      dateValues.date.setUTCHours(0, 0, 0, 0);
      return dateValues;
    }
  },

  year: {
    priority: 10,
    set: function set(dateValues, value) {
      dateValues.date.setUTCFullYear(value, 0, 1);
      dateValues.date.setUTCHours(0, 0, 0, 0);
      return dateValues;
    }
  },

  isoYear: {
    priority: 10,
    set: function set(dateValues, value, options) {
      dateValues.date = (0, _index12.default)((0, _index8.default)(dateValues.date, value, options), options);
      return dateValues;
    }
  },

  quarter: {
    priority: 20,
    set: function set(dateValues, value) {
      dateValues.date.setUTCMonth((value - 1) * 3, 1);
      dateValues.date.setUTCHours(0, 0, 0, 0);
      return dateValues;
    }
  },

  month: {
    priority: 30,
    set: function set(dateValues, value) {
      dateValues.date.setUTCMonth(value, 1);
      dateValues.date.setUTCHours(0, 0, 0, 0);
      return dateValues;
    }
  },

  isoWeek: {
    priority: 40,
    set: function set(dateValues, value, options) {
      dateValues.date = (0, _index10.default)((0, _index6.default)(dateValues.date, value, options), options);
      return dateValues;
    }
  },

  dayOfWeek: {
    priority: 50,
    set: function set(dateValues, value, options) {
      dateValues.date = (0, _index2.default)(dateValues.date, value, options);
      dateValues.date.setUTCHours(0, 0, 0, 0);
      return dateValues;
    }
  },

  dayOfISOWeek: {
    priority: 50,
    set: function set(dateValues, value, options) {
      dateValues.date = (0, _index4.default)(dateValues.date, value, options);
      dateValues.date.setUTCHours(0, 0, 0, 0);
      return dateValues;
    }
  },

  dayOfMonth: {
    priority: 50,
    set: function set(dateValues, value) {
      dateValues.date.setUTCDate(value);
      dateValues.date.setUTCHours(0, 0, 0, 0);
      return dateValues;
    }
  },

  dayOfYear: {
    priority: 50,
    set: function set(dateValues, value) {
      dateValues.date.setUTCMonth(0, value);
      dateValues.date.setUTCHours(0, 0, 0, 0);
      return dateValues;
    }
  },

  timeOfDay: {
    priority: 60,
    set: function set(dateValues, value, options) {
      dateValues.timeOfDay = value;
      return dateValues;
    }
  },

  hours: {
    priority: 70,
    set: function set(dateValues, value, options) {
      dateValues.date.setUTCHours(value, 0, 0, 0);
      return dateValues;
    }
  },

  timeOfDayHours: {
    priority: 70,
    set: function set(dateValues, value, options) {
      var timeOfDay = dateValues.timeOfDay;
      if (timeOfDay != null) {
        value = setTimeOfDay(value, timeOfDay);
      }
      dateValues.date.setUTCHours(value, 0, 0, 0);
      return dateValues;
    }
  },

  minutes: {
    priority: 80,
    set: function set(dateValues, value) {
      dateValues.date.setUTCMinutes(value, 0, 0);
      return dateValues;
    }
  },

  seconds: {
    priority: 90,
    set: function set(dateValues, value) {
      dateValues.date.setUTCSeconds(value, 0);
      return dateValues;
    }
  },

  milliseconds: {
    priority: 100,
    set: function set(dateValues, value) {
      dateValues.date.setUTCMilliseconds(value);
      return dateValues;
    }
  },

  timezone: {
    priority: 110,
    set: function set(dateValues, value) {
      dateValues.date = new Date(dateValues.date.getTime() - value * MILLISECONDS_IN_MINUTE);
      return dateValues;
    }
  },

  timestamp: {
    priority: 120,
    set: function set(dateValues, value) {
      dateValues.date = new Date(value);
      return dateValues;
    }
  }
};

exports.default = units;
module.exports = exports['default'];

/***/ }),
/* 175 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = setUTCDay;

var _index = __webpack_require__(13);

var _index2 = _interopRequireDefault(_index);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

// This function will be a part of public API when UTC function will be implemented.
// See issue: https://github.com/date-fns/date-fns/issues/376
function setUTCDay(dirtyDate, dirtyDay, dirtyOptions) {
  var options = dirtyOptions || {};
  var locale = options.locale;
  var localeWeekStartsOn = locale && locale.options && locale.options.weekStartsOn;
  var defaultWeekStartsOn = localeWeekStartsOn === undefined ? 0 : Number(localeWeekStartsOn);
  var weekStartsOn = options.weekStartsOn === undefined ? defaultWeekStartsOn : Number(options.weekStartsOn);

  // Test if weekStartsOn is between 0 and 6 _and_ is not NaN
  if (!(weekStartsOn >= 0 && weekStartsOn <= 6)) {
    throw new RangeError('weekStartsOn must be between 0 and 6 inclusively');
  }

  var date = (0, _index2.default)(dirtyDate, dirtyOptions);
  var day = Number(dirtyDay);

  var currentDay = date.getUTCDay();

  var remainder = day % 7;
  var dayIndex = (remainder + 7) % 7;

  var diff = (dayIndex < weekStartsOn ? 7 : 0) + day - currentDay;

  date.setUTCDate(date.getUTCDate() + diff);
  return date;
}
module.exports = exports['default'];

/***/ }),
/* 176 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = setUTCISODay;

var _index = __webpack_require__(13);

var _index2 = _interopRequireDefault(_index);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

// This function will be a part of public API when UTC function will be implemented.
// See issue: https://github.com/date-fns/date-fns/issues/376
function setUTCISODay(dirtyDate, dirtyDay, dirtyOptions) {
  var day = Number(dirtyDay);

  if (day % 7 === 0) {
    day = day - 7;
  }

  var weekStartsOn = 1;
  var date = (0, _index2.default)(dirtyDate, dirtyOptions);
  var currentDay = date.getUTCDay();

  var remainder = day % 7;
  var dayIndex = (remainder + 7) % 7;

  var diff = (dayIndex < weekStartsOn ? 7 : 0) + day - currentDay;

  date.setUTCDate(date.getUTCDate() + diff);
  return date;
}
module.exports = exports['default'];

/***/ }),
/* 177 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = setUTCISOWeek;

var _index = __webpack_require__(13);

var _index2 = _interopRequireDefault(_index);

var _index3 = __webpack_require__(89);

var _index4 = _interopRequireDefault(_index3);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

// This function will be a part of public API when UTC function will be implemented.
// See issue: https://github.com/date-fns/date-fns/issues/376
function setUTCISOWeek(dirtyDate, dirtyISOWeek, dirtyOptions) {
  var date = (0, _index2.default)(dirtyDate, dirtyOptions);
  var isoWeek = Number(dirtyISOWeek);
  var diff = (0, _index4.default)(date, dirtyOptions) - isoWeek;
  date.setUTCDate(date.getUTCDate() - diff * 7);
  return date;
}
module.exports = exports['default'];

/***/ }),
/* 178 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = setUTCISOWeekYear;

var _index = __webpack_require__(13);

var _index2 = _interopRequireDefault(_index);

var _index3 = __webpack_require__(60);

var _index4 = _interopRequireDefault(_index3);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var MILLISECONDS_IN_DAY = 86400000;

// This function will be a part of public API when UTC function will be implemented.
// See issue: https://github.com/date-fns/date-fns/issues/376
function setUTCISOWeekYear(dirtyDate, dirtyISOYear, dirtyOptions) {
  var date = (0, _index2.default)(dirtyDate, dirtyOptions);
  var isoYear = Number(dirtyISOYear);
  var dateStartOfYear = (0, _index4.default)(date, dirtyOptions);
  var diff = Math.floor((date.getTime() - dateStartOfYear.getTime()) / MILLISECONDS_IN_DAY);
  var fourthOfJanuary = new Date(0);
  fourthOfJanuary.setUTCFullYear(isoYear, 0, 4);
  fourthOfJanuary.setUTCHours(0, 0, 0, 0);
  date = (0, _index4.default)(fourthOfJanuary, dirtyOptions);
  date.setUTCDate(date.getUTCDate() + diff);
  return date;
}
module.exports = exports['default'];

/***/ }),
/* 179 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var StringMask = __webpack_require__(10);
var validators = __webpack_require__(61);
var PreFormatters = __webpack_require__(62);

function MoneyMaskDirective($locale, $parse) {
	return {
		restrict: 'A',
		require: 'ngModel',
		link: function(scope, element, attrs, ctrl) {
			var decimalDelimiter = $locale.NUMBER_FORMATS.DECIMAL_SEP,
				thousandsDelimiter = $locale.NUMBER_FORMATS.GROUP_SEP,
				currencySym = $locale.NUMBER_FORMATS.CURRENCY_SYM,
				symbolSeparation = ' ',
				decimals = $parse(attrs.uiMoneyMask)(scope),
				backspacePressed = false;

			element.bind('keydown keypress', function(event) {
				backspacePressed = event.which === 8;
			});

			function maskFactory(decimals) {
				var decimalsPattern = decimals > 0 ? decimalDelimiter + new Array(decimals + 1).join('0') : '';
				var maskPattern =  '#' + thousandsDelimiter + '##0' + decimalsPattern;
				if (angular.isDefined(attrs.uiCurrencyAfter)) {
					maskPattern += symbolSeparation;
				} else {
					maskPattern =  symbolSeparation + maskPattern;
				}
				return new StringMask(maskPattern, {reverse: true});
			}

			if (angular.isDefined(attrs.uiDecimalDelimiter)) {
				decimalDelimiter = attrs.uiDecimalDelimiter;
			}

			if (angular.isDefined(attrs.uiThousandsDelimiter)) {
				thousandsDelimiter = attrs.uiThousandsDelimiter;
			}

			if (angular.isDefined(attrs.uiHideGroupSep)) {
				thousandsDelimiter = '';
			}

			if (angular.isDefined(attrs.uiHideSpace)) {
				symbolSeparation = '';
			}

			if (angular.isDefined(attrs.currencySymbol)) {
				currencySym = attrs.currencySymbol;
				if (attrs.currencySymbol.length === 0) {
					symbolSeparation = '';
				}
			}

			if (isNaN(decimals)) {
				decimals = 2;
			}
			decimals = parseInt(decimals);
			var moneyMask = maskFactory(decimals);

			function formatter(value) {
				if (ctrl.$isEmpty(value)) {
					return value;
				}
				if (angular.isDefined(attrs.uiIntegerModel)) {
						value = value / Math.pow(10, decimals);
				}
				var prefix = (angular.isDefined(attrs.uiNegativeNumber) && value < 0) ? '-' : '';
				var valueToFormat = PreFormatters.prepareNumberToFormatter(value, decimals);
				if (angular.isDefined(attrs.uiCurrencyAfter)) {
					return prefix + moneyMask.apply(valueToFormat) + currencySym;
				}
				return prefix + currencySym + moneyMask.apply(valueToFormat);
			}

			function parser(value) {
				if (ctrl.$isEmpty(value)) {
					return null;
				}

				var actualNumber = value.replace(/[^\d]+/g,''), formatedValue;
				actualNumber = actualNumber.replace(/^[0]+([1-9])/,'$1');
				actualNumber = actualNumber || '0';

				if (backspacePressed && angular.isDefined(attrs.uiCurrencyAfter) && actualNumber !== 0) {
					actualNumber = actualNumber.substring(0, actualNumber.length - 1);
					backspacePressed = false;
				}

				if (angular.isDefined(attrs.uiCurrencyAfter)) {
					formatedValue = moneyMask.apply(actualNumber) + currencySym;
				} else {
					formatedValue = currencySym + moneyMask.apply(actualNumber);
				}

				if (angular.isDefined(attrs.uiNegativeNumber)) {
					var isNegative = (value[0] === '-'),
						needsToInvertSign = (value.slice(-1) === '-');

					//only apply the minus sign if it is negative or(exclusive)
					//needs to be negative and the number is different from zero
					if (needsToInvertSign ^ isNegative && !!actualNumber) {
						actualNumber *= -1;
						formatedValue = '-' + formatedValue;
					}
				}

				if (value !== formatedValue) {
					ctrl.$setViewValue(formatedValue);
					ctrl.$render();
				}

				var retValue = parseInt(formatedValue.replace(/[^\d\-]+/g,''));
				if (!isNaN(retValue)) {
						if (!angular.isDefined(attrs.uiIntegerModel)) {
								retValue = retValue / Math.pow(10, decimals);
						}
						return retValue;
				} else {
						return null;
				}
			}

			ctrl.$formatters.push(formatter);
			ctrl.$parsers.push(parser);

			if (attrs.uiMoneyMask) {
				scope.$watch(attrs.uiMoneyMask, function(_decimals) {
					decimals = isNaN(_decimals) ? 2 : _decimals;
					decimals = parseInt(decimals);
					moneyMask = maskFactory(decimals);

					parser(ctrl.$viewValue);
				});
			}

			if (attrs.currency) {
				scope.$watch(attrs.currency, function(_currency) {
					currencySym = _currency;
					moneyMask = maskFactory(decimals);
					parser(ctrl.$viewValue);
				});
			}

			if (attrs.min) {
				var minVal;

				ctrl.$validators.min = function(modelValue) {
					return validators.minNumber(ctrl, modelValue, minVal);
				};

				scope.$watch(attrs.min, function(value) {
					minVal = value;
					ctrl.$validate();
				});
			}

			if (attrs.max) {
				var maxVal;

				ctrl.$validators.max = function(modelValue) {
					return validators.maxNumber(ctrl, modelValue, maxVal);
				};

				scope.$watch(attrs.max, function(value) {
					maxVal = value;
					ctrl.$validate();
				});
			}
		}
	};
}
MoneyMaskDirective.$inject = ['$locale', '$parse'];

module.exports = MoneyMaskDirective;


/***/ }),
/* 180 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var validators = __webpack_require__(61);
var NumberMasks = __webpack_require__(92);
var PreFormatters = __webpack_require__(62);

function NumberMaskDirective($locale, $parse) {
	return {
		restrict: 'A',
		require: 'ngModel',
		link: function(scope, element, attrs, ctrl) {
			var decimalDelimiter = $locale.NUMBER_FORMATS.DECIMAL_SEP,
				thousandsDelimiter = $locale.NUMBER_FORMATS.GROUP_SEP,
				decimals = $parse(attrs.uiNumberMask)(scope);

			if (angular.isDefined(attrs.uiHideGroupSep)) {
				thousandsDelimiter = '';
			}

			if (isNaN(decimals)) {
				decimals = 2;
			}

			var viewMask = NumberMasks.viewMask(decimals, decimalDelimiter, thousandsDelimiter),
				modelMask = NumberMasks.modelMask(decimals);

			function parser(value) {
				if (ctrl.$isEmpty(value)) {
					return null;
				}

				var valueToFormat = PreFormatters.clearDelimitersAndLeadingZeros(value) || '0';
				var formatedValue = viewMask.apply(valueToFormat);
				var actualNumber = parseFloat(modelMask.apply(valueToFormat));

				if (angular.isDefined(attrs.uiNegativeNumber)) {
					var isNegative = (value[0] === '-'),
						needsToInvertSign = (value.slice(-1) === '-');

					//only apply the minus sign if it is negative or(exclusive) or the first character
					//needs to be negative and the number is different from zero
					if ((needsToInvertSign ^ isNegative) || value === '-') {
						actualNumber *= -1;
						formatedValue = '-' + ((actualNumber !== 0) ? formatedValue : '');
					}
				}

				if (ctrl.$viewValue !== formatedValue) {
					ctrl.$setViewValue(formatedValue);
					ctrl.$render();
				}

				return actualNumber;
			}

			function formatter(value) {
				if (ctrl.$isEmpty(value)) {
					return value;
				}

				var prefix = (angular.isDefined(attrs.uiNegativeNumber) && value < 0) ? '-' : '';
				var valueToFormat = PreFormatters.prepareNumberToFormatter(value, decimals);
				return prefix + viewMask.apply(valueToFormat);
			}

			function clearViewValueIfMinusSign() {
				if (ctrl.$viewValue === '-') {
					ctrl.$setViewValue('');
					ctrl.$render();
				}
			}

			element.on('blur', clearViewValueIfMinusSign);

			ctrl.$formatters.push(formatter);
			ctrl.$parsers.push(parser);

			if (attrs.uiNumberMask) {
				scope.$watch(attrs.uiNumberMask, function(_decimals) {
					decimals = isNaN(_decimals) ? 2 : _decimals;
					viewMask = NumberMasks.viewMask(decimals, decimalDelimiter, thousandsDelimiter);
					modelMask = NumberMasks.modelMask(decimals);

					parser(ctrl.$viewValue);
				});
			}

			if (attrs.min) {
				var minVal;

				ctrl.$validators.min = function(modelValue) {
					return validators.minNumber(ctrl, modelValue, minVal);
				};

				scope.$watch(attrs.min, function(value) {
					minVal = value;
					ctrl.$validate();
				});
			}

			if (attrs.max) {
				var maxVal;

				ctrl.$validators.max = function(modelValue) {
					return validators.maxNumber(ctrl, modelValue, maxVal);
				};

				scope.$watch(attrs.max, function(value) {
					maxVal = value;
					ctrl.$validate();
				});
			}
		}
	};
}
NumberMaskDirective.$inject = ['$locale', '$parse'];

module.exports = NumberMaskDirective;


/***/ }),
/* 181 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var validators = __webpack_require__(61);
var NumberMasks = __webpack_require__(92);
var PreFormatters = __webpack_require__(62);

function preparePercentageToFormatter(value, decimals, modelMultiplier) {
	return PreFormatters.clearDelimitersAndLeadingZeros((parseFloat(value)*modelMultiplier).toFixed(decimals));
}

function PercentageMaskDirective($locale) {
	return {
		restrict: 'A',
		require: 'ngModel',
		link: function(scope, element, attrs, ctrl) {
			var decimalDelimiter = $locale.NUMBER_FORMATS.DECIMAL_SEP;

			var backspacePressed = false;
			element.bind('keydown keypress', function(event) {
				backspacePressed = event.which === 8;
			});

			var thousandsDelimiter = $locale.NUMBER_FORMATS.GROUP_SEP;
			if (angular.isDefined(attrs.uiHideGroupSep)) {
				thousandsDelimiter = '';
			}

			var percentageSymbol = ' %';
			if (angular.isDefined(attrs.uiHidePercentageSign)) {
				percentageSymbol = '';
			} else if (angular.isDefined(attrs.uiHideSpace)) {
				percentageSymbol = '%';
			}

			var decimals = parseInt(attrs.uiPercentageMask);
			if (isNaN(decimals)) {
				decimals = 2;
			}

			var modelValue = {
				multiplier : 100,
				decimalMask: 2
			};
			if (angular.isDefined(attrs.uiPercentageValue)) {
				modelValue.multiplier  = 1;
				modelValue.decimalMask = 0;
			}

			var numberDecimals = decimals + modelValue.decimalMask;
			var viewMask = NumberMasks.viewMask(decimals, decimalDelimiter, thousandsDelimiter),
				modelMask = NumberMasks.modelMask(numberDecimals);

			function formatter(value) {
				if (ctrl.$isEmpty(value)) {
					return value;
				}
				var prefix = (angular.isDefined(attrs.uiNegativeNumber) && value < 0) ? '-' : '';
				var valueToFormat = preparePercentageToFormatter(value, decimals, modelValue.multiplier);
				var formatedValue = prefix + viewMask.apply(valueToFormat) + percentageSymbol;

				return formatedValue;
			}

			function parser(value) {
				if (ctrl.$isEmpty(value)) {
					return null;
				}

				var valueToFormat = PreFormatters.clearDelimitersAndLeadingZeros(value) || '0';
				if (percentageSymbol !== '' && value.length > 1 && value.indexOf('%') === -1) {
					valueToFormat = valueToFormat.slice(0, valueToFormat.length - 1);
				}

				if (backspacePressed && value.length === 1 && value !== '%') {
					valueToFormat = '0';
				}

				var formatedValue = viewMask.apply(valueToFormat) + percentageSymbol;
				var actualNumber = parseFloat(modelMask.apply(valueToFormat));

				if (angular.isDefined(attrs.uiNegativeNumber)) {
					var isNegative = (value[0] === '-'),
						needsToInvertSign = (value.slice(-1) === '-');

					//only apply the minus sign if it is negative or(exclusive) or the first character
					//needs to be negative and the number is different from zero
					if ((needsToInvertSign ^ isNegative) || value === '-') {
						actualNumber *= -1;
						formatedValue = '-' + ((actualNumber !== 0) ? formatedValue : '');
					}
				}

				if (ctrl.$viewValue !== formatedValue) {
					ctrl.$setViewValue(formatedValue);
					ctrl.$render();
				}

				return actualNumber;
			}

			ctrl.$formatters.push(formatter);
			ctrl.$parsers.push(parser);

			if (attrs.uiPercentageMask) {
				scope.$watch(attrs.uiPercentageMask, function(_decimals) {
					decimals = isNaN(_decimals) ? 2 : _decimals;

					numberDecimals = decimals + modelValue.decimalMask;
					viewMask = NumberMasks.viewMask(decimals, decimalDelimiter, thousandsDelimiter);
					modelMask = NumberMasks.modelMask(numberDecimals);

					parser(formatter(ctrl.$modelValue));
				});
			}

			if (attrs.min) {
				var minVal;

				ctrl.$validators.min = function(modelValue) {
					return validators.minNumber(ctrl, modelValue, minVal);
				};

				scope.$watch(attrs.min, function(value) {
					minVal = value;
					ctrl.$validate();
				});
			}

			if (attrs.max) {
				var maxVal;

				ctrl.$validators.max = function(modelValue) {
					return validators.maxNumber(ctrl, modelValue, maxVal);
				};

				scope.$watch(attrs.max, function(value) {
					maxVal = value;
					ctrl.$validate();
				});
			}
		}
	};
}
PercentageMaskDirective.$inject = ['$locale'];

module.exports = PercentageMaskDirective;


/***/ }),
/* 182 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var StringMask = __webpack_require__(10);

function ScientificNotationMaskDirective($locale, $parse) {
	var decimalDelimiter = $locale.NUMBER_FORMATS.DECIMAL_SEP,
		defaultPrecision = 2;

	function significandMaskBuilder(decimals) {
		var mask = '0';

		if (decimals > 0) {
			mask += decimalDelimiter;
			for (var i = 0; i < decimals; i++) {
				mask += '0';
			}
		}

		return new StringMask(mask, {
			reverse: true
		});
	}

	return {
		restrict: 'A',
		require: 'ngModel',
		link: function(scope, element, attrs, ctrl) {
			var decimals = $parse(attrs.uiScientificNotationMask)(scope);

			if (isNaN(decimals)) {
				decimals = defaultPrecision;
			}

			var significandMask = significandMaskBuilder(decimals);

			function splitNumber(value) {
				var stringValue = value.toString(),
					splittedNumber = stringValue.match(/(-?[0-9]*)[\.]?([0-9]*)?[Ee]?([\+-]?[0-9]*)?/);

				return {
					integerPartOfSignificand: splittedNumber[1],
					decimalPartOfSignificand: splittedNumber[2],
					exponent: splittedNumber[3] | 0
				};
			}

			function formatter(value) {
				if (ctrl.$isEmpty(value)) {
					return value;
				}

				if (typeof value === 'number') {
					value = value.toExponential(decimals);
				} else {
					value = value.toString().replace(decimalDelimiter, '.');
				}

				var formattedValue, exponent;
				var splittedNumber = splitNumber(value);

				var integerPartOfSignificand = splittedNumber.integerPartOfSignificand || 0;
				var numberToFormat = integerPartOfSignificand.toString();
				if (angular.isDefined(splittedNumber.decimalPartOfSignificand)) {
					numberToFormat += splittedNumber.decimalPartOfSignificand;
				}

				var needsNormalization =
					(integerPartOfSignificand >= 1 || integerPartOfSignificand <= -1) &&
					(
						(angular.isDefined(splittedNumber.decimalPartOfSignificand) &&
						splittedNumber.decimalPartOfSignificand.length > decimals) ||
						(decimals === 0 && numberToFormat.length >= 2)
					);

				if (needsNormalization) {
					exponent = numberToFormat.slice(decimals + 1, numberToFormat.length);
					numberToFormat = numberToFormat.slice(0, decimals + 1);
				}

				formattedValue = significandMask.apply(numberToFormat);

				if (splittedNumber.exponent !== 0) {
					exponent = splittedNumber.exponent;
				}

				if (angular.isDefined(exponent)) {
					formattedValue += 'e' + exponent;
				}

				var prefix = (angular.isDefined(attrs.uiNegativeNumber) && value[0] === '-') ? '-' : '';

				return prefix + formattedValue;
			}

			function parser(value) {
				if (ctrl.$isEmpty(value)) {
					return value;
				}

				var isExponentNegative = /e-/.test(value);
				var cleanValue = value.replace('e-', 'e');
				var viewValue = formatter(cleanValue);

				var needsToInvertSign = (value.slice(-1) === '-');

				if (needsToInvertSign ^ isExponentNegative) {
					viewValue = viewValue.replace(/(e[-]?)/, 'e-');
				}

				if (needsToInvertSign && isExponentNegative) {
					viewValue = viewValue[0] !== '-' ? ('-' + viewValue) : viewValue.replace(/^(-)/,'');
				}

				var modelValue = parseFloat(viewValue.replace(decimalDelimiter, '.'));

				if (ctrl.$viewValue !== viewValue) {
					ctrl.$setViewValue(viewValue);
					ctrl.$render();
				}

				return modelValue;
			}

			ctrl.$formatters.push(formatter);
			ctrl.$parsers.push(parser);

			ctrl.$validators.max = function validator(value) {
				return ctrl.$isEmpty(value) || value < Number.MAX_VALUE;
			};
		}
	};
}
ScientificNotationMaskDirective.$inject = ['$locale', '$parse'];

module.exports = ScientificNotationMaskDirective;


/***/ }),
/* 183 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var StringMask = __webpack_require__(10);

module.exports = function TimeMaskDirective() {
	return {
		restrict: 'A',
		require: 'ngModel',
		link: function(scope, element, attrs, ctrl) {
			var timeFormat = '00:00:00';

			if (angular.isDefined(attrs.uiTimeMask) && attrs.uiTimeMask === 'short') {
				timeFormat = '00:00';
			}

			var formattedValueLength = timeFormat.length;
			var unformattedValueLength = timeFormat.replace(':', '').length;
			var timeMask = new StringMask(timeFormat);

			function formatter(value) {
				if (ctrl.$isEmpty(value)) {
					return value;
				}

				var cleanValue = value.replace(/[^0-9]/g, '').slice(0, unformattedValueLength) || '';
				return (timeMask.apply(cleanValue) || '').replace(/[^0-9]$/, '');
			}

			ctrl.$formatters.push(formatter);

			ctrl.$parsers.push(function parser(value) {
				if (ctrl.$isEmpty(value)) {
					return value;
				}

				var viewValue = formatter(value);
				var modelValue = viewValue;

				if (ctrl.$viewValue !== viewValue) {
					ctrl.$setViewValue(viewValue);
					ctrl.$render();
				}

				return modelValue;
			});

			ctrl.$validators.time = function(modelValue) {
				if (ctrl.$isEmpty(modelValue)) {
					return true;
				}

				var splittedValue = modelValue.toString().split(/:/).filter(function(v) {
					return !!v;
				});

				var hours = parseInt(splittedValue[0]),
					minutes = parseInt(splittedValue[1]),
					seconds = parseInt(splittedValue[2] || 0);

				return modelValue.toString().length === formattedValueLength &&
					hours < 24 && minutes < 60 && seconds < 60;
			};
		}
	};
};


/***/ }),
/* 184 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var m = angular.module('ui.utils.masks.br', [])
	.directive('uiBrBoletoBancarioMask', __webpack_require__(185))
	.directive('uiBrCarPlateMask', __webpack_require__(186))
	.directive('uiBrCepMask', __webpack_require__(187))
	.directive('uiBrCnpjMask', __webpack_require__(188))
	.directive('uiBrCpfMask', __webpack_require__(189))
	.directive('uiBrCpfcnpjMask', __webpack_require__(190))
	.directive('uiBrIeMask', __webpack_require__(191))
	.directive('uiNfeAccessKeyMask', __webpack_require__(192))
	.directive('uiBrPhoneNumberMask', __webpack_require__(193));

module.exports = m.name;


/***/ }),
/* 185 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var StringMask = __webpack_require__(10);
var maskFactory = __webpack_require__(15);

var boletoBancarioMask = new StringMask('00000.00000 00000.000000 00000.000000 0 00000000000000');

module.exports = maskFactory({
	clearValue: function(rawValue) {
		return rawValue.replace(/[^0-9]/g, '').slice(0, 47);
	},
	format: function(cleanValue) {
		if (cleanValue.length === 0) {
			return cleanValue;
		}

		return boletoBancarioMask.apply(cleanValue).replace(/[^0-9]$/, '');
	},
	validations: {
		brBoletoBancario: function(value) {
			return value.length === 47;
		}
	}
});


/***/ }),
/* 186 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var StringMask = __webpack_require__(10);
var maskFactory = __webpack_require__(15);

var carPlateMask = new StringMask('UUU-0000');

module.exports = maskFactory({
	clearValue: function(rawValue) {
		return rawValue.replace(/[^a-zA-Z0-9]/g, '').slice(0, 7);
	},
	format: function(cleanValue) {
		return (carPlateMask.apply(cleanValue) || '').replace(/[^a-zA-Z0-9]$/, '');
	},
	validations: {
		carPlate: function(value) {
			return value.length === 7;
		}
	}
});


/***/ }),
/* 187 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var StringMask = __webpack_require__(10);
var maskFactory = __webpack_require__(15);

var cepMask = new StringMask('00000-000');

module.exports = maskFactory({
	clearValue: function(rawValue) {
		return rawValue.toString().replace(/[^0-9]/g, '').slice(0, 8);
	},
	format: function(cleanValue) {
		return (cepMask.apply(cleanValue) || '').replace(/[^0-9]$/, '');
	},
	validations: {
		cep: function(value) {
			return value.toString().trim().length === 8;
		}
	}
});


/***/ }),
/* 188 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var StringMask = __webpack_require__(10);
var BrV = __webpack_require__(44);

var maskFactory = __webpack_require__(15);

var cnpjPattern = new StringMask('00.000.000\/0000-00');

module.exports = maskFactory({
	clearValue: function(rawValue) {
		return rawValue.replace(/[^\d]/g, '').slice(0, 14);
	},
	format: function(cleanValue) {
		return (cnpjPattern.apply(cleanValue) || '').trim().replace(/[^0-9]$/, '');
	},
	validations: {
		cnpj: function(value) {
			return BrV.cnpj.validate(value);
		}
	}
});


/***/ }),
/* 189 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var StringMask = __webpack_require__(10);
var BrV = __webpack_require__(44);

var maskFactory = __webpack_require__(15);

var cpfPattern = new StringMask('000.000.000-00');

module.exports = maskFactory({
	clearValue: function(rawValue) {
		return rawValue.replace(/[^\d]/g, '').slice(0, 11);
	},
	format: function(cleanValue) {
		return (cpfPattern.apply(cleanValue) || '').trim().replace(/[^0-9]$/, '');
	},
	validations: {
		cpf: function(value) {
			return BrV.cpf.validate(value);
		}
	}
});


/***/ }),
/* 190 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var StringMask = __webpack_require__(10);
var BrV = __webpack_require__(44);
var maskFactory = __webpack_require__(15);

var cnpjPattern = new StringMask('00.000.000\/0000-00');
var cpfPattern = new StringMask('000.000.000-00');

module.exports = maskFactory({
	clearValue: function(rawValue) {
		return rawValue.replace(/[^\d]/g, '').slice(0, 14);
	},
	format: function(cleanValue) {
		var formatedValue;

		if (cleanValue.length > 11) {
			formatedValue = cnpjPattern.apply(cleanValue);
		} else {
			formatedValue = cpfPattern.apply(cleanValue) || '';
		}

		return formatedValue.trim().replace(/[^0-9]$/, '');
	},
	validations: {
		cpf: function(value) {
			return value.length > 11 || BrV.cpf.validate(value);
		},
		cnpj: function(value) {
			return value.length <= 11 || BrV.cnpj.validate(value);
		}
	}
});


/***/ }),
/* 191 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var StringMask = __webpack_require__(10);
var BrV = __webpack_require__(44);

var ieMasks = {
	'AC': [{mask: new StringMask('00.000.000/000-00')}],
	'AL': [{mask: new StringMask('000000000')}],
	'AM': [{mask: new StringMask('00.000.000-0')}],
	'AP': [{mask: new StringMask('000000000')}],
	'BA': [{chars: 8, mask: new StringMask('000000-00')}, {mask: new StringMask('0000000-00')}],
	'CE': [{mask: new StringMask('00000000-0')}],
	'DF': [{mask: new StringMask('00000000000-00')}],
	'ES': [{mask: new StringMask('00000000-0')}],
	'GO': [{mask: new StringMask('00.000.000-0')}],
	'MA': [{mask: new StringMask('000000000')}],
	'MG': [{mask: new StringMask('000.000.000/0000')}],
	'MS': [{mask: new StringMask('000000000')}],
	'MT': [{mask: new StringMask('0000000000-0')}],
	'PA': [{mask: new StringMask('00-000000-0')}],
	'PB': [{mask: new StringMask('00000000-0')}],
	'PE': [{chars: 9, mask: new StringMask('0000000-00')}, {mask: new StringMask('00.0.000.0000000-0')}],
	'PI': [{mask: new StringMask('000000000')}],
	'PR': [{mask: new StringMask('000.00000-00')}],
	'RJ': [{mask: new StringMask('00.000.00-0')}],
	'RN': [{chars: 9, mask: new StringMask('00.000.000-0')}, {mask: new StringMask('00.0.000.000-0')}],
	'RO': [{mask: new StringMask('0000000000000-0')}],
	'RR': [{mask: new StringMask('00000000-0')}],
	'RS': [{mask: new StringMask('000/0000000')}],
	'SC': [{mask: new StringMask('000.000.000')}],
	'SE': [{mask: new StringMask('00000000-0')}],
	'SP': [{mask: new StringMask('000.000.000.000')}, {mask: new StringMask('-00000000.0/000')}],
	'TO': [{mask: new StringMask('00000000000')}]
};

function BrIeMaskDirective($parse) {
	function clearValue(value) {
		if (!value) {
			return value;
		}

		return value.replace(/[^0-9]/g, '');
	}

	function getMask(uf, value) {
		if (!uf || !ieMasks[uf]) {
			return;
		}

		if (uf === 'SP' && /^P/i.test(value)) {
			return ieMasks.SP[1].mask;
		}

		var masks = ieMasks[uf];
		var i = 0;
		while (masks[i].chars && masks[i].chars < clearValue(value).length && i < masks.length - 1) {
			i++;
		}

		return masks[i].mask;
	}

	function applyIEMask(value, uf) {
		var mask = getMask(uf, value);

		if (!mask) {
			return value;
		}

		var processed = mask.process(clearValue(value));
		var formatedValue = processed.result || '';
		formatedValue = formatedValue.trim().replace(/[^0-9]$/, '');

		if (uf === 'SP' && /^p/i.test(value)) {
			return 'P' + formatedValue;
		}

		return formatedValue;
	}

	return {
		restrict: 'A',
		require: 'ngModel',
		link: function(scope, element, attrs, ctrl) {
			var state = ($parse(attrs.uiBrIeMask)(scope) || '').toUpperCase();

			function formatter(value) {
				if (ctrl.$isEmpty(value)) {
					return value;
				}

				return applyIEMask(value, state);
			}

			function parser(value) {
				if (ctrl.$isEmpty(value)) {
					return value;
				}

				var formatedValue = applyIEMask(value, state);
				var actualValue = clearValue(formatedValue);

				if (ctrl.$viewValue !== formatedValue) {
					ctrl.$setViewValue(formatedValue);
					ctrl.$render();
				}

				if (state && state.toUpperCase() === 'SP' && /^p/i.test(value)) {
					return 'P' + actualValue;
				}

				return actualValue;
			}

			ctrl.$formatters.push(formatter);
			ctrl.$parsers.push(parser);

			ctrl.$validators.ie = function validator(modelValue) {
				return ctrl.$isEmpty(modelValue) || BrV.ie(state).validate(modelValue);
			};

			scope.$watch(attrs.uiBrIeMask, function(newState) {
				state = (newState || '').toUpperCase();

				parser(ctrl.$viewValue);
				ctrl.$validate();
			});
		}
	};
}
BrIeMaskDirective.$inject = ['$parse'];

module.exports = BrIeMaskDirective;


/***/ }),
/* 192 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var StringMask = __webpack_require__(10);

var maskFactory = __webpack_require__(15);

var nfeAccessKeyMask = new StringMask('0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000');

module.exports = maskFactory({
	clearValue: function(rawValue) {
		return rawValue.replace(/[^0-9]/g, '').slice(0, 44);
	},
	format: function(cleanValue) {
		return (nfeAccessKeyMask.apply(cleanValue) || '').replace(/[^0-9]$/, '');
	},
	validations: {
		nfeAccessKey: function(value) {
			return value.length === 44;
		}
	}
});


/***/ }),
/* 193 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var StringMask = __webpack_require__(10);

var maskFactory = __webpack_require__(15);

/**
 * FIXME: all numbers will have 9 digits after 2016.
 * see http://portal.embratel.com.br/embratel/9-digito/
 */
var phoneMask8D = {
		countryCode : new StringMask('+00 (00) 0000-0000'),   //with country code
		areaCode    : new StringMask('(00) 0000-0000'),       //with area code
		simple      : new StringMask('0000-0000')             //without area code
	}, phoneMask9D = {
		countryCode : new StringMask('+00 (00) 00000-0000'), //with country code
		areaCode    : new StringMask('(00) 00000-0000'),     //with area code
		simple      : new StringMask('00000-0000')           //without area code
	}, phoneMask0800 = {
		countryCode : null,                                   //N/A
		areaCode    : null,                                   //N/A
		simple      : new StringMask('0000-000-0000')         //N/A, so it's "simple"
	};

module.exports = maskFactory({
	clearValue: function(rawValue) {
		return rawValue.toString().replace(/[^0-9]/g, '').slice(0, 13);
	},
	format: function(cleanValue) {
		var formattedValue;

		if (cleanValue.indexOf('0800') === 0) {
			formattedValue = phoneMask0800.simple.apply(cleanValue);
		} else if (cleanValue.length < 9) {
			formattedValue = phoneMask8D.simple.apply(cleanValue) || '';
		} else if (cleanValue.length < 10) {
			formattedValue = phoneMask9D.simple.apply(cleanValue);
		} else if (cleanValue.length < 11) {
			formattedValue = phoneMask8D.areaCode.apply(cleanValue);
		} else if (cleanValue.length < 12) {
			formattedValue = phoneMask9D.areaCode.apply(cleanValue);
		} else if (cleanValue.length < 13) {
			formattedValue = phoneMask8D.countryCode.apply(cleanValue);
		} else {
			formattedValue = phoneMask9D.countryCode.apply(cleanValue);
		}

		return formattedValue.trim().replace(/[^0-9]$/, '');
	},
	getModelValue: function(formattedValue, originalModelType) {
		var cleanValue = this.clearValue(formattedValue);
		return originalModelType === 'number' ? parseInt(cleanValue) : cleanValue;
	},
	validations: {
		brPhoneNumber: function(value) {
			var valueLength = value && value.toString().length;

			//8- 8D without AC
			//9- 9D without AC
			//10- 8D with AC
			//11- 9D with AC and 0800
			//12- 8D with AC plus CC
			//13- 9D with AC plus CC
			return valueLength >= 8 && valueLength <= 13;
		}
	}
});


/***/ }),
/* 194 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var m = angular.module('ui.utils.masks.ch', [])
	.directive('uiChPhoneNumberMask', __webpack_require__(195));

module.exports = m.name;


/***/ }),
/* 195 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var StringMask = __webpack_require__(10);

var maskFactory = __webpack_require__(15);

var phoneMask = new StringMask('+00 00 000 00 00');

module.exports = maskFactory({
	clearValue: function(rawValue) {
		return rawValue.toString().replace(/[^0-9]/g, '').slice(0, 11);
	},
	format: function(cleanValue) {
		var formatedValue;

		formatedValue = phoneMask.apply(cleanValue) || '';

		return formatedValue.trim().replace(/[^0-9]$/, '');
	},
	validations: {
		chPhoneNumber: function(value) {
			var valueLength = value && value.toString().length;
			return valueLength === 11;
		}
	}
});


/***/ }),
/* 196 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var m = angular.module('ui.utils.masks.fr', [])
	.directive('uiFrPhoneNumberMask', __webpack_require__(197));

module.exports = m.name;


/***/ }),
/* 197 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var StringMask = __webpack_require__(10);
var maskFactory = __webpack_require__(15);

var phoneMaskFR = new StringMask('00 00 00 00 00');

module.exports = maskFactory({
	clearValue: function(rawValue) {
		return rawValue.toString().replace(/[^0-9]/g, '').slice(0, 10);
	},
	format: function(cleanValue) {
		var formattedValue;

		formattedValue = phoneMaskFR.apply(cleanValue) || '';

		return formattedValue.trim().replace(/[^0-9]$/, '');
	},
	validations: {
		frPhoneNumber: function(value) {
			var valueLength = value && value.toString().length;
			return valueLength === 10;
		}
	}
});


/***/ }),
/* 198 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var m = angular.module('ui.utils.masks.us', [])
	.directive('uiUsPhoneNumberMask', __webpack_require__(199));

module.exports = m.name;


/***/ }),
/* 199 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var StringMask = __webpack_require__(10);
var maskFactory = __webpack_require__(15);

var phoneMaskUS = new StringMask('(000) 000-0000'),
	phoneMaskINTL = new StringMask('+00-00-000-000000');

module.exports = maskFactory({
	clearValue: function(rawValue) {
		return rawValue.toString().replace(/[^0-9]/g, '');
	},
	format: function(cleanValue) {
		var formattedValue;

		if (cleanValue.length < 11) {
			formattedValue = phoneMaskUS.apply(cleanValue) || '';
		} else {
			formattedValue = phoneMaskINTL.apply(cleanValue);
		}

		return formattedValue.trim().replace(/[^0-9]$/, '');
	},
	validations: {
		usPhoneNumber: function(value) {
			return value && value.toString().length > 9;
		}
	}
});


/***/ }),
/* 200 */,
/* 201 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


//var angular = require('angular');
//AddSurvey
angular.module('AOTC').controller('addSurvey', __webpack_require__(202));
//AddSurveyDemo
angular.module('AOTC').controller('addSurveyDemo', __webpack_require__(203));
//AJHeader
angular.module('AOTC').directive('ajheader', __webpack_require__(204));
//ViewAJData
angular.module('AOTC').controller('viewAJData', __webpack_require__(205));
//ViewAJForm
angular.module('AOTC').controller('viewAJForm', __webpack_require__(206));

/***/ }),
/* 202 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {

_addSurvey.$inject = ["$stateParams", "$anchorScroll", "$state", "DTOptionsBuilder", "DTColumnDefBuilder", "$location", "$scope", "$http", "__env", "$log", "AOTCService", "$timeout"];
module.exports = _addSurvey;

//angular.module('AOTC').controller('addSurvey', _addSurvey);

function _addSurvey($stateParams, $anchorScroll, $state, DTOptionsBuilder, DTColumnDefBuilder, $location, $scope, $http, __env, $log, AOTCService, $timeout) {
    //////console.log("addSurvey controller", $stateParams);
    var vm = this;
    vm.assessorDetails = [];
    vm.boardDetails = [];
    vm.fiscalStartDate = "";
    vm.fiscalEndDate = "";



    $scope.showUrl = false;
    $scope.maximize1 = false;
    $scope.maximize2 = false;
    $scope.maximize3 = false;
    $scope.maximize4 = false;
    $scope.maximize5 = false;
    $scope.maximize6 = false;
    $scope.maximize7 = false;





    // setTimeout(function() {
    //     $scope.messageForPop = "sucess";
    //     $scope.$apply();
    //     $("#popup_success").fadeIn(500).delay(3500).fadeOut(2500);

    // }, 2000);
    // $('#preloader').css('display', 'block');
    vm.surveyData = {
        surveyMetaData: {
            assessingAuthName: "",
            listRelevantWebsites: "",
            interviewer: "",
            phoneNumberCalled: "",
            dateCalled: "",
            interviewee: "",
            intervieweeOfficeAddress: "",
            intervieweeOfficeEmail: ""
        },
        questions: [{ //assessment questions started from here
            qId: 1,
            answer: ''

        }, {
            qId: 2,
            answer: ''

        }, {
            qId: 3,
            answer: ''
        }, {
            qId: 4,
            answer: ''
        }, { //Income survey questions started from here
            qId: 5,
            answer: ''
        }, {
            qId: 6,
            answer: ''
        }, {
            qId: 7,
            answer: ''
        }, {
            qId: 8,
            answer: ''
        }, {
            qId: 9,
            answer: ''
        }, {
            qId: 10,
            answer: ''
        }, {
            qId: 11,
            answer: ''
        }, {
            qId: 12,
            answer: ''
        }, {
            qId: 13,
            answer: ''
        }, {
            qId: 14,
            answer: ''
        }, { //appeal process - first level appeal
            qId: 15,
            answer: ''
        }, {
            qId: 16,
            answer: ''
        }, {
            qId: 17,
            answer: ''
        }, {
            qId: 18,
            answer: ''
        }, {
            qId: 19,
            answer: ''
        }, {
            qId: 20,
            answer: ''
        }, {
            qId: 21,
            answer: ''
        }, {
            qId: 22,
            answer: ''
        }, {
            qId: 23,
            answer: ''
        }, {
            qId: 24,
            answer: ''
        }, { //appeal process - second level appeal
            qId: 25,
            answer: ''
        }, {
            qId: 26,
            answer: ''
        }, {
            qId: 27,
            answer: ''
        }, {
            qId: 28,
            answer: ''
        }, {
            qId: 29,
            answer: ''
        }, {
            qId: 30,
            answer: ''
        }, {
            qId: 31,
            answer: ''
        }, {
            qId: 32,
            answer: ''
        }, { //appeal process - third level appeal
            qId: 33,
            answer: ''
        }, {
            qId: 34,
            answer: ''
        }, {
            qId: 35,
            answer: ''
        }, {
            qId: 36,
            answer: ''
        }, {
            qId: 37,
            answer: ''
        }, { //tax authority
            qId: 38,
            answer: ''
        }, {
            qId: 39,
            answer: ''
        }, {
            qId: 40,
            answer: ''
        }, {
            qId: 41,
            answer: '',
            contactDetails: [{
                email: "",
                address: "",
                phone: ""
            }]
        }, { //contact info
            qId: 42,
            answer: '',
            contactDetails: [{
                email: "",
                address: "",
                phone: ""
            }]
        }, { //Does the Jurisdiction have an Income Survey process?
            qId: 43,
            answer: "no"
        }, { //Are there special rules related to evidence at the board?
            qId: 44,
            answer: 'no'
        }, { //Is there a 3rd level of appeal?
            qId: 45,
            answer: 'no'
        }]

    };



    $scope.typed = 0;
    $scope.typing = 0;

    $scope.typed2 = 0;
    $scope.typing2 = 0;

    $scope.$watch('typing2', debounce(function () {
        // $scope.$watch(vm.surveyData.questions[40].answer, debounce(function() {
        $scope.typed2 = $scope.typing2;
        vm.surveyData.questions[41].answer = $scope.typed2;
        ////console.log($scope.typed2);

        $scope.boardContactDetails = [];

        for (var k = 0; k < $scope.typed2; k++) {
            var details = {
                'phone': '',
                'email': '',
                'address': ''

            };
            $scope.boardContactDetails.push(details);

        }
        vm.boardDetails = $scope.boardContactDetails;

        $scope.$apply();
    }, 500));




    $scope.$watch('typing', debounce(function () {
        // $scope.$watch(vm.surveyData.questions[40].answer, debounce(function() {
        $scope.typed = $scope.typing;
        vm.surveyData.questions[40].answer = $scope.typed;
        ////console.log($scope.typed);

        $scope.contactDetails = [];

        for (var k = 0; k < $scope.typed; k++) {
            var details = {
                'phone': '',
                'email': '',
                'address': ''

            };
            $scope.contactDetails.push(details);

        }
        vm.assessorDetails = $scope.contactDetails;

        $scope.$apply();
    }, 500));


    $scope.numberOfBills = 1;


    $scope.$watch('numberOfBills', debounce(function () {
        // $scope.$watch(vm.surveyData.questions[40].answer, debounce(function() {
        //vm.surveyData.questions[40].answer = $scope.numberOfBills;
        ////console.log($scope.numberOfBills);

        $scope.numberOfBillsHtmlFields = [];

        for (var k = 0; k < $scope.numberOfBills; k++) {
            var billDate = {
                'billDate': ''

            };

            $scope.numberOfBillsHtmlFields.push(billDate);

        }
        vm.billDueDates = $scope.numberOfBillsHtmlFields;

        $scope.$apply();
    }, 500));

    function debounce(fn, delay) {
        var timer = null;
        return function () {
            var context = this,
                args = arguments;
            clearTimeout(timer);
            timer = setTimeout(function () {
                fn.apply(context, args);
            }, delay);
        };
    }














    vm.addAJSurvey = addAJSurvey;

    function addAJSurvey() {
        // ////console.log(vm.assessorDetails);
        vm.surveyData.questions[40].contactDetails = vm.assessorDetails;
        vm.surveyData.questions[41].contactDetails = vm.boardDetails;
        vm.surveyData.questions[39].answer = vm.fiscalStartDate + '|' + vm.fiscalEndDate;
        vm.surveyData.questions[37].answer = JSON.stringify(vm.billDueDates);
        ////console.log(vm.surveyData);

        var url = '/aJRules/addAJRules';

        $("#preloader").css("display", "block");

        AOTCService.postDataToServer(url, vm.surveyData)
            .then(function (result) {
                ////console.log('-----------ServerData: aJRules/addAJRules------');
                ////console.log(result);
                $("#preloader").css("display", "none");

                // $("#popup_success").fadeIn(500).delay(1000).fadeOut(500, function() {
                // $state.go('viewAJData');
                // });

                $scope.$emit('success', result.data.message);



            }, function (result) {
                //some error
                ////console.log(result);
            });



    }

    vm.togglePlusMinus = togglePlusMinus;

    function togglePlusMinus(maximize1) {
        maximize1 = !maximize1;



    }




    $('#sandbox-container input').datepicker({
        autoclose: true
    });


    $('#sandbox-container input').on('show', function (e) {
        console.debug('show', e.date, $(this).data('stickyDate'));

        if (e.date) {
            $(this).data('stickyDate', e.date);
        } else {
            $(this).data('stickyDate', null);
        }
    });

    $('#sandbox-container input').on('hide', function (e) {
        console.debug('hide', e.date, $(this).data('stickyDate'));
        var stickyDate = $(this).data('stickyDate');

        if (!e.date && stickyDate) {
            console.debug('restore stickyDate', stickyDate);
            $(this).datepicker('setDate', stickyDate);
            $(this).data('stickyDate', null);
        }
    });

    angular.element(document).ready(function () {
        $("#no").click(function () {
            $(".survey").hide();
        });
        $("#yes").click(function () {
            $(".survey").show();
        });
        $("#norules1").click(function() {
            $(".surveyrules").hide();
        });
        $("#yesrules1").click(function() {
            $(".surveyrules").show();
        });
        $("#noap").click(function() {
            $(".surveyap").hide();
        });
        $("#yesap").click(function() {
            $(".surveyap").show();
        });  
    });




}
/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 203 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {


_addSurveyDemo.$inject = ["$stateParams", "$anchorScroll", "$state", "DTOptionsBuilder", "DTColumnDefBuilder", "$location", "$scope", "$http", "__env", "$log", "HackathonService", "$timeout"];
module.exports = _addSurveyDemo;

//angular.module('AOTC').controller('addSurveyDemo', _addSurveyDemo);

function _addSurveyDemo($stateParams, $anchorScroll, $state, DTOptionsBuilder, DTColumnDefBuilder, $location, $scope, $http, __env, $log, HackathonService, $timeout) {
    ////console.log("addSurvey controller", $stateParams);
    var vm = this;
    vm.assessorDetails = [];
    vm.boardDetails = [];
    vm.fiscalStartDate = "";
    vm.fiscalEndDate = "";



    $scope.showUrl = false;
    $scope.maximize1 = false;
    $scope.maximize2 = false;
    $scope.maximize3 = false;
    $scope.maximize4 = false;
    $scope.maximize5 = false;
    $scope.maximize6 = false;
    $scope.maximize7 = false;





    // setTimeout(function() {
    //     $scope.messageForPop = "sucess";
    //     $scope.$apply();
    //     $("#popup_success").fadeIn(500).delay(3500).fadeOut(2500);

    // }, 2000);
    // $('#preloader').css('display', 'block');
    vm.surveyData = {
        surveyMetaData: {
            assessingAuthName: "",
            listRelevantWebsites: "",
            interviewer: "",
            phoneNumberCalled: "",
            dateCalled: "",
            interviewee: "",
            intervieweeOfficeAddress: "",
            intervieweeOfficeEmail: ""
        },
        questions: [{ //assessment questions started from here
            qId: 1,
            answer: ''

        }, {
            qId: 2,
            answer: ''

        }, {
            qId: 3,
            answer: ''
        }, {
            qId: 4,
            answer: ''
        }, { //Income survey questions started from here
            qId: 5,
            answer: ''
        }, {
            qId: 6,
            answer: ''
        }, {
            qId: 7,
            answer: ''
        }, {
            qId: 8,
            answer: ''
        }, {
            qId: 9,
            answer: ''
        }, {
            qId: 10,
            answer: ''
        }, {
            qId: 11,
            answer: ''
        }, {
            qId: 12,
            answer: ''
        }, {
            qId: 13,
            answer: ''
        }, {
            qId: 14,
            answer: ''
        }, { //appeal process - first level appeal
            qId: 15,
            answer: ''
        }, {
            qId: 16,
            answer: ''
        }, {
            qId: 17,
            answer: ''
        }, {
            qId: 18,
            answer: ''
        }, {
            qId: 19,
            answer: ''
        }, {
            qId: 20,
            answer: ''
        }, {
            qId: 21,
            answer: ''
        }, {
            qId: 22,
            answer: ''
        }, {
            qId: 23,
            answer: ''
        }, {
            qId: 24,
            answer: ''
        }, { //appeal process - second level appeal
            qId: 25,
            answer: ''
        }, {
            qId: 26,
            answer: ''
        }, {
            qId: 27,
            answer: ''
        }, {
            qId: 28,
            answer: ''
        }, {
            qId: 29,
            answer: ''
        }, {
            qId: 30,
            answer: ''
        }, {
            qId: 31,
            answer: ''
        }, {
            qId: 32,
            answer: ''
        }, { //appeal process - third level appeal
            qId: 33,
            answer: ''
        }, {
            qId: 34,
            answer: ''
        }, {
            qId: 35,
            answer: ''
        }, {
            qId: 36,
            answer: ''
        }, {
            qId: 37,
            answer: ''
        }, { //tax authority
            qId: 38,
            answer: ''
        }, {
            qId: 39,
            answer: ''
        }, {
            qId: 40,
            answer: ''
        }, {
            qId: 41,
            answer: '',
            contactDetails: [{
                email: "",
                address: "",
                phone: ""
            }]
        }, { //contact info
            qId: 42,
            answer: '',
            contactDetails: [{
                email: "",
                address: "",
                phone: ""
            }]
        }, { //Does the Jurisdiction have an Income Survey process?
            qId: 43,
            answer: "no"
        }, { //Are there special rules related to evidence at the board?
            qId: 44,
            answer: 'no'
        }, { //Is there a 3rd level of appeal?
            qId: 45,
            answer: 'no'
        }]

    };



    $scope.typed = 1;
    $scope.typing = 1;

    $scope.typed2 = 1;
    $scope.typing2 = 1;

    $scope.$watch('typing2', debounce(function () {
        // $scope.$watch(vm.surveyData.questions[40].answer, debounce(function() {
        $scope.typed2 = $scope.typing2;
        vm.surveyData.questions[41].answer = $scope.typed2;
        ////console.log($scope.typed2);

        $scope.boardContactDetails = [];

        for (var k = 0; k < $scope.typed2; k++) {
            var details = {
                'phone': '',
                'email': '',
                'address': ''

            };
            $scope.boardContactDetails.push(details);

        }
        vm.boardDetails = $scope.boardContactDetails;

        $scope.$apply();
    }, 500));




    $scope.$watch('typing', debounce(function () {
        // $scope.$watch(vm.surveyData.questions[40].answer, debounce(function() {
        $scope.typed = $scope.typing;
        vm.surveyData.questions[40].answer = $scope.typed;
        ////console.log($scope.typed);

        $scope.contactDetails = [];

        for (var k = 0; k < $scope.typed; k++) {
            var details = {
                'phone': '',
                'email': '',
                'address': ''

            };
            $scope.contactDetails.push(details);

        }
        vm.assessorDetails = $scope.contactDetails;

        $scope.$apply();
    }, 500));


    $scope.numberOfBills = 1;


    $scope.$watch('numberOfBills', debounce(function () {
        // $scope.$watch(vm.surveyData.questions[40].answer, debounce(function() {
        //vm.surveyData.questions[40].answer = $scope.numberOfBills;
        ////console.log($scope.numberOfBills);

        $scope.numberOfBillsHtmlFields = [];

        for (var k = 0; k < $scope.numberOfBills; k++) {
            var billDate = {
                'billDate': ''

            };

            $scope.numberOfBillsHtmlFields.push(billDate);

        }
        vm.billDueDates = $scope.numberOfBillsHtmlFields;

        $scope.$apply();
    }, 500));

    function debounce(fn, delay) {
        var timer = null;
        return function () {
            var context = this,
                args = arguments;
            clearTimeout(timer);
            timer = setTimeout(function () {
                fn.apply(context, args);
            }, delay);
        };
    }














    vm.addAJSurvey = addAJSurvey;

    function addAJSurvey() {
        // ////console.log(vm.assessorDetails);
        vm.surveyData.questions[40].contactDetails = vm.assessorDetails;
        vm.surveyData.questions[41].contactDetails = vm.boardDetails;
        vm.surveyData.questions[39].answer = vm.fiscalStartDate + '|' + vm.fiscalEndDate;
        vm.surveyData.questions[37].answer = JSON.stringify(vm.billDueDates);
        ////console.log(vm.surveyData);

        var url = '/aJRules/addAJRules';

        $("#preloader").css("display", "block");

        HackathonService.postDataToServer(url, vm.surveyData)
            .then(function (result) {
                ////console.log(result);
                $("#preloader").css("display", "none");

                $("#popup_success").fadeIn(500).delay(1000).fadeOut(500, function () {
                    $state.go('viewAJData');

                });



            }, function (result) {
                //some error
                ////console.log(result);
            });



    }

    vm.togglePlusMinus = togglePlusMinus;

    function togglePlusMinus(maximize1) {
        maximize1 = !maximize1;



    }




    $('#sandbox-container input').datepicker({
        autoclose: true
    });


    $('#sandbox-container input').on('show', function (e) {
        console.debug('show', e.date, $(this).data('stickyDate'));

        if (e.date) {
            $(this).data('stickyDate', e.date);
        } else {
            $(this).data('stickyDate', null);
        }
    });

    $('#sandbox-container input').on('hide', function (e) {
        console.debug('hide', e.date, $(this).data('stickyDate'));
        var stickyDate = $(this).data('stickyDate');

        if (!e.date && stickyDate) {
            console.debug('restore stickyDate', stickyDate);
            $(this).datepicker('setDate', stickyDate);
            $(this).data('stickyDate', null);
        }
    });




}

/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 204 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";



_ajheader.$inject = ["User_Config", "$state"];
module.exports = _ajheader;

//angular.module('AOTC')
//    .directive('ajheader', _ajheader);

function _ajheader(User_Config, $state) {
    var controller = ['$scope', '$location', function ($scope, $location) {
        ////console.log('AJhead controller');
        if (!localStorage.getItem('userJson')) {
            $state.go('login');
        } else {
            var userResult = JSON.parse(localStorage.getItem('userJson'));
            $scope.name = userResult.userData.name

        }

    }];
    return {
        templateUrl: 'modules/AJModules/AJHeader/header.html',
        restrict: 'EA',
        controller: controller,
        controllerAs: 'head',
        bindToController: true

    };
}

/***/ }),
/* 205 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {

_viewAJData.$inject = ["User_Config", "$stateParams", "$anchorScroll", "$state", "DTOptionsBuilder", "DTColumnDefBuilder", "$location", "$scope", "$http", "__env", "$log", "AOTCService", "$timeout"];
module.exports = _viewAJData;

//angular.module('AOTC').controller('viewAJData', _viewAJData);

function _viewAJData(User_Config, $stateParams, $anchorScroll, $state, DTOptionsBuilder, DTColumnDefBuilder, $location, $scope, $http, __env, $log, AOTCService, $timeout) {
    ////console.log("viewAJData controller", $stateParams);
    var vm = this;
    vm.tableData = [];
    vm.dtOptions = DTOptionsBuilder.newOptions()
        .withDisplayLength(20)
        .withOption('lengthMenu', [
            [20, 50, 100, -1],
            [20, 50, 100, "All"]
        ])
        .withOption('order', [
            [3, 'desc']
        ])

        .withOption('columnDefs', [{
            'type': 'date-euro',
            'targets': 3
        }]);


    vm.dtColumnDefs = [];

    $('#preloader').css('display', 'block');

    AOTCService.getDataFromServer('/aJRules/getAllSurveysMetaData')
        .then(function (result) {
            ////console.log(result);
            var ServerData = result.data;
            if (ServerData.success) {
                vm.tableData = ServerData.result;
                if (vm.tableData.length == 0) {
                    $scope.$emit('error', User_Config.NO_DATA)
                }

            }
            $('#preloader').css('display', 'none');

        }, function (result) {
            ////console.log(result);
            $('#preloader').css('display', 'none');


        });

    angular.element(document).ready(function () {
        $.extend($.fn.dataTableExt.oSort, {
            "date-euro-pre": function (a) {
                return moment(a, 'DD-MM-YYYY HH:mm');
            },

            "date-euro-asc": function (a, b) {
               
                if (a.isBefore(b))
                    return -1;
                else if (b.isBefore(a))
                    return 1;
                else
                    return 0;
            },

            "date-euro-desc": function (a, b) {

                if (a.isBefore(b))
                    return 1;
                else if (b.isBefore(a))
                    return -1;
                else
                    return 0;
            }
        });
    });



}
/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 206 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {

_viewAJForm.$inject =  ["User_Config" , "$stateParams", "$anchorScroll", "$state", "DTOptionsBuilder", "DTColumnDefBuilder", "$location", "$scope", "$http", "__env", "$log", "AOTCService", "$timeout"];
module.exports = _viewAJForm;

//angular.module('AOTC').controller('viewAJForm', _viewAJForm);

function _viewAJForm(User_Config, $stateParams, $anchorScroll, $state, DTOptionsBuilder, DTColumnDefBuilder, $location, $scope, $http, __env, $log, AOTCService, $timeout) {
    ////console.log("viewAJForm controller", $stateParams);

    var vm = this;
    vm.tableData = [];
    $scope.maximize1 = false;
    $scope.maximize2 = false;
    $scope.maximize3 = false;
    $scope.maximize4 = false;
    $scope.maximize5 = false;
    $scope.maximize6 = false;
    $scope.maximize7 = false;
    vm.hideBoardOfficeGrid = false;
    vm.hideAssessorOfficeGrid = false;

    vm.dtOptions = DTOptionsBuilder.newOptions()
        .withDisplayLength(5)
        .withOption('lengthMenu', [
            [5, 10, 15, -1],
            [5, 10, 15, "All"]
        ])
        .withOption('order', [
            [0, 'asc']
        ]);
    vm.dtColumnDefs = [];
    vm.ajRulesData = [];
    vm.AJData = {};

    if ($stateParams.AJData != null) {

        ////console.log('if')
        localStorage.setItem('AjData', angular.toJson($stateParams.AJData));
        vm.AJData = $stateParams.AJData

    } else {
        ////console.log('else')
        vm.AJData = JSON.parse(localStorage.getItem('AjData'));
    }

    ////console.log(vm.AJData)

    // setTimeout(function() {
    //     var id = 1;
    //     var answer = 2;
    //     $('#41').val(answer)
    // }, 200);

    $('#preloader').css('display', 'block');

    vm.AJQuestions = [];
    vm.assessorContacts = [];
    vm.boardContacts = [];
    vm.fiscalYearStartDate = "";
    vm.fiscalYearEndDate = "";
    vm.numberOfBills = [];

    AOTCService.getDataFromServer('/aJRules/getAllSurveysDataById?Id=' + vm.AJData.id)
        .then(function (result) {

            var serverData = result.data;
            if (serverData.success) {
                vm.AJQuestions = serverData.result;
                if (vm.AJQuestions.length == 0) {
                    $scope.$emit('danger', User_Config.NO_DATA);
                }
                for (var i = 0; i < vm.AJQuestions.length; i++) {
                    var question = vm.AJQuestions[i];

                    if (question.id == 38) {
                        var answerJson = question.answer;

                        ////console.log(JSON.parse(answerJson));
                        vm.numberOfBills = JSON.parse(answerJson);


                    }

                    if (question.id == 40) {
                        var fiscalYearDates = question.answer.split('|');
                        vm.fiscalYearStartDate = fiscalYearDates[0];
                        vm.fiscalYearEndDate = fiscalYearDates[1];

                        // ////console.log(fiscalYearDates);
                        // ////console.log(vm.fiscalYearStartDate);
                        // ////console.log(vm.fiscalYearEndDate);

                        $('#40a').text(vm.fiscalYearStartDate)
                        $('#40b').text(vm.fiscalYearEndDate)

                    }

                    if (question.id == 41 || question.id == 42) {

                        $('#' + question.id).val(question.answer)

                        //41 assessor
                        if (question.id == 41) {
                            vm.assessorContacts = question.contactDetails;
                            if (vm.assessorContacts.length == 0) {
                                vm.hideAssessorOfficeGrid = true;
                            }
                        }
                        //42 board
                        if (question.id == 42) {
                            vm.boardContacts = question.contactDetails;
                            if (vm.boardContacts.length == 0) {
                                vm.hideBoardOfficeGrid = true;


                            }
                        }

                    } else {

                        $('#' + question.id).text(question.answer)

                    }


                    //for checkboxes states


                    if (question.id == 43) {
                        if (question.answer == "yes") {
                            $(".survey").show();
                        } else {
                            $(".survey").hide();
                        }
                    }
                    if (question.id == 44) {
                        if (question.answer == "yes") {
                            $(".surveyrules").show();
                        } else {
                            $(".surveyrules").hide();
                        }
                    }

                    if (question.id == 45) {
                        if (question.answer == "yes") {
                            $(".surveyap").show();
                        } else {
                            $(".surveyap").hide();
                        }
                    }


                }

            }
            else {
                $scope.$emit('error', serverData.message);
            }


            // vm.tableData = result.data;
            $('#preloader').css('display', 'none');

        }, function (result) {
            ////console.log(result);
            $('#preloader').css('display', 'none');


        });

        angular.element(document).ready(function () {
            $("#no").click(function () {
                $(".survey").hide();
            });
            $("#yes").click(function () {
                $(".survey").show();
            });
            $("#norules1").click(function() {
                $(".surveyrules").hide();
            });
            $("#yesrules1").click(function() {
                $(".surveyrules").show();
            });
            $("#noap").click(function() {
                $(".surveyap").hide();
            });
            $("#yesap").click(function() {
                $(".surveyap").show();
            });  
            $("#norules").click(function() {
                $(".surveyrules").hide();
            });
            $("#yesrules").click(function() {
                $(".surveyrules").show();
            }); 
        }); 



}

/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 207 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


//var angular = require('angular');

angular.module('AOTC').controller('BrowserOptimizing', __webpack_require__(208));
angular.module('AOTC').factory('BrowserOptimizingService', __webpack_require__(209));


/***/ }),
/* 208 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


_BrowserOptimizing.$inject = ["BrowserOptimizingService", "deviceDetector", "$scope", "$state"];
module.exports = _BrowserOptimizing;

//angular.module('AOTC')
//    .controller('BrowserOptimizing', _BrowserOptimizing);

function _BrowserOptimizing(BrowserOptimizingService, deviceDetector, $scope, $state) {
    ////console.log("BrowserOptimizing controller");

    var vm = this;

    vm.continueToLogin = continueToLogin;

    var browserNotification = localStorage.getItem('browserNotification');

    function continueToLogin() {
        localStorage.setItem('browserNotification', true);
        $state.go('login');
    }
}


/***/ }),
/* 209 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


_BrowserOptimizingService.$inject = ["$http", "$q"];
module.exports = _BrowserOptimizingService;

//angular.module('AOTC')
//    .factory('BrowserOptimizingService', _BrowserOptimizingService
//  );

function _BrowserOptimizingService($http, $q) {

    return {

    };


}


/***/ }),
/* 210 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


//var angular = require('angular');

//******SalesComparable
//comparableComponent
angular.module('AOTC').component('comparableComponent', __webpack_require__(63).comparableComponent);
angular.module('AOTC').directive('fileinput', __webpack_require__(63).fileinput);
angular.module('AOTC').directive('ngImageSelect', __webpack_require__(63).ngImageSelect);


//ComparableForm
angular.module('AOTC').controller('CreateComparablesForm', __webpack_require__(211));

//ComparableProperties
angular.module('AOTC').controller('ComparableProperties', __webpack_require__(212));
angular.module('AOTC').factory('ComparablePropService', __webpack_require__(213));

angular.module('AOTC').service('ComparablePropUtil', __webpack_require__(214));

//ComparableSelection
angular.module('AOTC').controller('ComparableSelection', __webpack_require__(215));
angular.module('AOTC').factory('ComparableSelectionService', __webpack_require__(216));

angular.module('AOTC').service('ComparableUtil', __webpack_require__(217));

//PrincipalForm
angular.module('AOTC').controller('CreatePrincipalForm', __webpack_require__(218));
angular.module('AOTC').service('sharedService', __webpack_require__(219));


//SelectedComparables
angular.module('AOTC').controller('SelectedComparable', __webpack_require__(220));
angular.module('AOTC').factory('ComparableService', __webpack_require__(221));

angular.module('AOTC').service('ComparableUtil', __webpack_require__(222));

/***/ }),
/* 211 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {

_CreateComparablesForm.$inject = ["$stateParams", "$anchorScroll", "sharedService", "$state", "DTOptionsBuilder", "DTColumnDefBuilder", "$location", "$scope", "$http", "__env", "$log", "AOTCService", "$timeout"];
module.exports = _CreateComparablesForm;


//angular.module('AOTC').controller('CreateComparablesForm', _CreateComparablesForm
//    );

function _CreateComparablesForm($stateParams, $anchorScroll, sharedService, $state, DTOptionsBuilder, DTColumnDefBuilder, $location, $scope, $http, __env, $log, AOTCService, $timeout) {
    ////console.log("updateIERR CreateComparablesForm", $stateParams);
    var vm = this;
    // $('#successModal').modal('close');
    $('#preloader').css('display', 'none');
    vm.submitManualData = submitManualData;
    vm.property = JSON.parse(localStorage.getItem('propertyDetails'));
    ////console.log("vm.property in manualIE: ", vm.property)

    vm.formData = {

    };
    vm.PrinciplePropData = JSON.parse(localStorage.getItem('principalForm'));
    ////console.log("key" + vm.PrinciplePropData);

    vm.modalYesbutton = modalYesbutton;
    vm.gotoPropertyDetails = gotoPropertyDetails;
    vm.resetForm = resetForm;

    function resetForm() {
        vm.formData = {};
        $scope.compForm.$setPristine();
        $scope.compForm.$setUntouched();

    }

    function gotoPropertyDetails() {
        $('#successModal').modal('hide');
        $state.go('updateIERR');
    }

    function modalYesbutton() {
        ////console.log('reset form');
        vm.formData = {};

        $scope.compForm.$setPristine();
        $scope.compForm.$setUntouched();

        $('#successModal').modal('toggle');

    }


    function submitManualData() {

        $("#preloader").css("display", "block");
        ////console.log('appeal')

        vm.formData.compScore = vm.formData.compScore;
        vm.formData.taxAssessment = vm.formData.taxAssessment.toString();
        vm.formData.percentile = vm.formData.percentileValue.toString();
        vm.formData.rentLastUpdate = vm.formData.rentLastUpdate.toString();
        vm.formData.rentValueChangeDuration = vm.formData.rentValueChangeDuration.toString();
        vm.formData.taxAssessmentYear = vm.formData.taxAssessmentYear.toString();
        vm.formData.rentValueChange = vm.formData.rentValueChange.toString();
        vm.formData.finishedSqFt = vm.formData.finishedSqFt.toString();
        vm.formData.lastUpdate = vm.formData.lastUpdate.toString();
        vm.formData.rentAmount = vm.PrinciplePropData.rentEstimate.toString();
        vm.formData.amount = vm.PrinciplePropData.zEstimate.toString();
        vm.formData.valueChange = vm.PrinciplePropData.valueChange.toString();
        vm.formData.valueChangeDuration = vm.PrinciplePropData.valueChangeDuration.toString();
        vm.formData.valuationRangeHigh = vm.PrinciplePropData.valuationRangeHigh.toString();
        vm.formData.valuationRangeLow = vm.PrinciplePropData.valuationRangeLow.toString();
        vm.formData.lotSizeSqFt = vm.PrinciplePropData.lotSizeSf.toString();
        vm.formData.lastSoldDate = vm.PrinciplePropData.lastSoldDate.toString();
        vm.formData.lastSoldPrice = vm.PrinciplePropData.lastSoldPrice.toString();
        vm.formData.yearBuilt = vm.PrinciplePropData.yearBuilt.toString();
        vm.formData.imageFileName = vm.PrinciplePropData.imageFileName
        vm.PrinciplePropData.imageFileName = ''
        vm.PrinciplePropData.valueChangeDuration = vm.formData.valueChangeDuration;
        vm.PrinciplePropData.rentValueChangeDuration = vm.formData.rentValueChangeDuration;
        vm.PrinciplePropData.valueChangeDuration = vm.formData.valueChangeDuration;




        var data = {}
        data.principal = []
        data.comps = []
        data.principal.push(vm.PrinciplePropData)
        data.comps.push(vm.formData)
        data.propId = localStorage.getItem("propertyId");
        ////console.log(data);
        var url = 'salesComps/addCompsToPropManual';
        AOTCService.postDataToServer(url, data)
            .then(function (result) {
                ////console.log("CompForm: ", result);
                if (result.data.success) {
                    $scope.$emit('success', result.data.message);
                    $scope.compForm.$setPristine();
                    $scope.compForm.$setUntouched();
                    $('#successModal').modal('toggle'); // Success Model
                    // $state.go('TaskManager');
                } else {
                    $scope.$emit('danger', result.data.message);
                }
                $("#preloader").css("display", "none");

            }, function (result) {
                //////console.log(result);
                $("#preloader").css("display", "none");
            });


        /* var url2 = 'salesComps/addCompsImageManual';
         AOTCService.postDataToServer(url,image)
             .then(function(result) {
                 ////console.log("Po: ",result);
 
                     // $state.go('TaskManager');
 
             }, function(result) {
                 //////console.log(result);
 
             });
 
 
 |*/

        //call to server
        //
    }

    // setTimeout(function() {
    //     vm.formData.baseRent = 2017;
    //     $scope.$apply();
    //     $('#successModal').modal('show');

    // }, 100);











    ///=================================date picker===========================//


    $('#sandbox-container input').datepicker({
        autoclose: true
    });


    $('#sandbox-container input').on('show', function (e) {
        console.debug('show', e.date, $(this).data('stickyDate'));

        if (e.date) {
            $(this).data('stickyDate', e.date);
        } else {
            $(this).data('stickyDate', null);
        }
    });

    $('#sandbox-container input').on('hide', function (e) {
        console.debug('hide', e.date, $(this).data('stickyDate'));
        var stickyDate = $(this).data('stickyDate');

        if (!e.date && stickyDate) {
            console.debug('restore stickyDate', stickyDate);
            $(this).datepicker('setDate', stickyDate);
            $(this).data('stickyDate', null);
        }
    });
    angular.element(document).ready(function () {
        $("#myModal").modal('show');
        
        });



}

/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 212 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {

_ComparableProperties.$inject = ["ComparablePropService", "User_Config", "$timeout", "$scope", "$state"];
module.exports = _ComparableProperties;


//angular.module('AOTC')
//    .controller('ComparableProperties', _ComparableProperties
//   );

function _ComparableProperties(ComparablePropService, User_Config, $timeout, $scope, $state) {

    ////console.log("ComparableProperties controller");
    var vm = this;

    var propertyDetails = JSON.parse(localStorage.getItem('propertyDetails'));
    vm.address = propertyDetails.streetAddress;

    vm.zillowData = [];
    vm.imageArr = [];
    vm.flipBack = flipBack;
    vm.flipFront = flipFront;

    vm.addComparables = addComparables;
    vm.getZillowPropImage = getZillowPropImage;
    var userRole = localStorage.getItem('role');

    if (userRole === "Residential User") {
        $("#preloader").css('display', 'block');

        ComparablePropService.getZillowProperties()
            .then(function (result) {
                $("#preloader").css('display', 'none');
                var serverData = result.data;
                if (serverData.success) {
                    vm.zillowData = serverData.result;
                    $timeout(function () {
                        initializeCards();
                    }, 200);
                    ////console.log("vm.zillowData.comparables", vm.zillowData.comparables);

                    // set property Images crawling from Zillow and get from db if exists
                    setPropertyImages(vm.zillowData.comparables);
                } else {
                    $scope.$emit('error', serverData.message);
                }
            },
                function (err) {
                    ////console.log(err);
                });
    } else {
        ////console.log("Commercial User");
    }

    function initializeCards() {
        var localStorageZillowData = JSON.parse(localStorage.getItem('zillowData'));

        var localStorageComparables = [];
        if (localStorageZillowData) {
            localStorageComparables = localStorageZillowData.comparables;
        }

        for (var i = 0; i < localStorageComparables.length; i++) {
            var lsComparable = localStorageComparables[i];
            var found = -1;

            for (var k = 0; k < vm.zillowData.comparables.length; k++) {
                var serverComparable = vm.zillowData.comparables[k];
                if (serverComparable.zpid == lsComparable.zpid) {
                    found = k;
                    vm.zillowData.comparables[k] = lsComparable;
                }
            }
            if (found == -1) {
                vm.zillowData.comparables.push(lsComparable);
            }
        }
        var arr = vm.zillowData.comparables;
        arr = sortByKey(arr, 'selection');
        vm.zillowData.comparables = arr;
        // ////console.log(arr);

        $timeout(function () {
            for (var i = 0; i < vm.zillowData.comparables.length; i++) {
                var id = '#card_' + i;
                $(id).flip({
                    trigger: 'manual'
                });
            }
        }, 100);
    }

    function addComparables() {

        var selectedComparables = [];

        for (var i = 0; i < vm.zillowData.comparables.length; i++) {
            if (vm.zillowData.comparables[i].selection) {
                selectedComparables.push(vm.zillowData.comparables[i]);
            }
        }

        if (selectedComparables.length > 0) {
            ////console.log("selectedComparables", selectedComparables);
            var jsonData = {
                principal: vm.zillowData.principal[0],
                comparables: selectedComparables
            }
            localStorage.removeItem('zillowData');
            localStorage.setItem('zillowData', angular.toJson(jsonData));
            $state.go('selectedComparable');
        } else {
            $scope.$emit('error', 'Please select some properties.');
        }
    }

    function setPropertyImages(comps) {
        for (var i = 0; i < comps.length; i++) {
            var comp = vm.zillowData.comparables[i];
            // if the image is locally saved then don't get its new link
            if (comp.imageFileName === undefined) {

                getZillowPropImage(comp.linksHomeDetails, i);
            } else if (!comp.imageFileName.indexOf('PropertyImages')) {

                getZillowPropImage(comp.linksHomeDetails, i);
            } else {
                ////console.log("Nothing");
            }
        }
    }

    function getZillowPropImage(propertyLink, index) {
        ComparablePropService.getZillowPropImage(propertyLink)
            .then(function (result) {

                var serverData = result.data;
                if (serverData.success) {
                    vm.zillowData.comparables[index].imageFileName = serverData.result.mainImage;
                    ////console.log(serverData.result.mainImage)
                    $('#mydiv').hide();
                }
            },
                function (err) {
                    ////console.log(err);
                });
    }

    function imagePreLoader() {

    }

    function flipBack(id) {
        $(id).flip(false);
    }

    function flipFront(id) {
        $(id).flip(true);
    }

    // Sort already selected comps to top
    function sortByKey(array, key) {
        return array.sort(function (a, b) {
            var x = a[key];
            if (x == undefined) {
                x = false;
            }

            var y = b[key];
            if (y == undefined) {
                y = false;
            }
            return ((x > y) ? -1 : ((x < y) ? 1 : 0));
        });
    }
}

/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 213 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


_ComparablePropService.$inject = ["$http", "$q", "AOTCService"];
module.exports = _ComparablePropService;

//angular.module('AOTC')
//    .factory('ComparablePropService', _ComparablePropService
//   );

function _ComparablePropService($http, $q, AOTCService) {

    return {
        getZillowProperties: getZillowProperties,
        getZillowPropImage: getZillowPropImage
    };

    function getZillowProperties() {
        var propertyDetails = JSON.parse(localStorage.getItem('propertyDetails'));
        var streetName = propertyDetails.streetAddress.split(',');
        var postData = {
            city: propertyDetails.city,
            state: propertyDetails.countryState,
            address: streetName[0]
        };

        var url = '/salesComps/getZDeepCompsProperties';
        var deferred = $q.defer();
        AOTCService.postDataToServer(url, postData)
            .then(function (result) {
                deferred.resolve(result);

            }, function (result) {
                deferred.reject(result);
            });
        return deferred.promise;
    }

    function getZillowPropImage(propertyLink) {
        var postData = {
            propertyLink: propertyLink
        };
        var url = '/salesComps/getZillowPropImage';
        var deferred = $q.defer();
        AOTCService.postDataToServer(url, postData)
            .then(function (result) {
                deferred.resolve(result);

            }, function (result) {
                deferred.reject(result);
            });
        return deferred.promise;
    }
}


/***/ }),
/* 214 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


_ComparablePropUtil.$inject = [];
module.exports = _ComparablePropUtil;

//angular.module('AOTC')
//    .service('ComparablePropUtil', _ComparablePropUtil
//);

function _ComparablePropUtil() {

    var formula1 = function (val1) {
        ////console.log(val1);
    };

    var Util = {};

    Util.sample = function () {

    };


    return {
        Util: Util
    };

}


/***/ }),
/* 215 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {

_ComparableSelection.$inject = ["ComparableSelectionService", "User_Config", "$state"];
module.exports = _ComparableSelection;

//angular.module('AOTC')
//    .controller('ComparableSelection', _ComparableSelection
//    );

function _ComparableSelection(ComparableSelectionService, User_Config, $state) {
    ////console.log("ComparableSelection controller");
    var vm = this;

    vm.showResidentialProps = true;
    var propertyDetails = JSON.parse(localStorage.getItem('propertyDetails'));
    vm.mainImage = propertyDetails.imageFileName;

    if (vm.mainImage == undefined || vm.mainImage == null) {
        vm.mainImage = "assets/img/noImageAvailable.jpg";
    }
    var userRole = localStorage.getItem('role');
    localStorage.removeItem('zillowData');

    if (userRole == User_Config.RESIDENTIAL_USER) {
        vm.showResidentialProps = false;
        getSavedComparables();
    }

    vm.gotoResidentialProps = gotoResidentialProps;
    vm.gotoCommercialProps = gotoCommercialProps;

    function getSavedComparables() {
        //$("#preloader").css('display', 'block');
        //getSavedComparables if exists saved comparable then redirect to comparison

        $state.go('selectedComparable');

        //ComparableService.getComparables(1).
        //then(function (result) {
        //    //console.log('getSavedComparables : ', result);
        //    var serverData = result.data;

        //    if (serverData.success) {
        //        if (serverData.result.subjectProperty) {


        //            // if (serverData.success) {
        //            if (serverData.result.highProperties.length > 0) {
        //                var _temp = [];
        //                try {
        //                    for (var i = 0; i < serverData.result.highProperties.length; i++) {
        //                        serverData.result.highProperties[i].properties.selection = true;
        //                        serverData.result.highProperties[i].properties['propertyType'] = 'H';
        //                        _temp.push(serverData.result.highProperties[i].properties);
        //                    }
        //                    for (var i = 0; i < serverData.result.lowProperties.length; i++) {
        //                        _temp.push(serverData.result.lowProperties[i].properties);
        //                        serverData.result.lowProperties[i].properties['propertyType'] = 'L';
        //                        serverData.result.lowProperties[i].properties.selection = true;
        //                    }
        //                }
        //                catch (_e)
        //                {
        //                }

        //                serverData.result.principal = serverData.result.subjectProperty;

        //                serverData.result.comparables = _temp;

        //                localStorage.setItem('zillowData', angular.toJson(serverData.result))
        //                $state.go('selectedComparable');
        //                $("#preloader").css('display', 'none');
        //            } else {

        //                getDeepSearchResult();
        //            }
        //            //}


        //            //vm.selectedComparables = serverData.result;
        //            //vm.PrinciplePropDataDetail = {
        //            //    Jurisdiction: serverData.result.subjectProperty.jurisdictionData,
        //            //    Zillow: serverData.result.subjectProperty.zillowData
        //            //}

        //            //serverData.result.principal = serverData.result.principal[0];
        //            //localStorage.setItem('zillowData', angular.toJson(serverData.result))
        //            //$state.go('selectedComparable');
        //            $("#preloader").css('display', 'none');
        //        } else {

        //            getDeepSearchResult();
        //            $('#preloader').css('display', 'none');
        //        }
        //    }
        //}, function (err) {
        //    console.log('err : ', err);
        //    $('#preloader').css('display', 'none');
        //})

        //ComparableSelectionService.getSavedComparables().
        //then(function (result) {
        //    console.log('getSavedComparables : ', result);
        //    var serverData = result.data;

        //    if (serverData.success) {
        //        if (serverData.result.comparables.length > 0) {
        //            for (var i = 0; i < serverData.result.comparables.length; i++) {
        //                serverData.result.comparables[i].selection = true;
        //            }
        //            serverData.result.principal = serverData.result.principal[0];
        //            localStorage.setItem('zillowData', angular.toJson(serverData.result))
        //            $state.go('selectedComparable');
        //            $("#preloader").css('display', 'none');
        //        } else {

        //            getDeepSearchResult();
        //        }
        //    }
        //}, function (err) {
        //    console.log('err : ', err);
        //})

        //ComparableSelectionService.getSavedComparables().
        //then(function (result) {
        //    console.log('getSavedComparables : ', result);
        //    var serverData = result.data;

        //    if (serverData.success) {
        //        if (serverData.result.comparables.length > 0) {
        //            for (var i = 0; i < serverData.result.comparables.length; i++) {
        //                serverData.result.comparables[i].selection = true;
        //            }
        //            serverData.result.principal = serverData.result.principal[0];
        //            localStorage.setItem('zillowData', angular.toJson(serverData.result))
        //            $state.go('selectedComparable');
        //            $("#preloader").css('display', 'none');
        //        } else {

        //            getDeepSearchResult();
        //        }
        //    }
        //}, function (err) {
        //    console.log('err : ', err);
        //})

    }

    function gotoResidentialProps() {
        $state.go('comparableProperties');
    }

    function gotoCommercialProps() {
        $state.go('comparableProperties');
    }

    //getSavedComparables if exists saved comparable then redirect to comparison
    function getDeepSearchResult() {
        ComparableSelectionService.getDeepSearchResult().
        then(function (result) {
            console.log(result);
            var serverData = result.data;

            if (serverData.success) {

                if (serverData.result) {
                    serverData.result.principal = serverData.result.principal[0];
                    serverData.result.comparables = [];
                    vm.PrinciplePropData = serverData.result.principal;
                    localStorage.setItem('zillowData', angular.toJson(serverData.result))
                }
            }
            $("#preloader").css('display', 'none');
        }, function (err) {
            console.log('err : ', err);
        })
    }
    vm.gotoCreateComprables = gotoCreateComprables;

    function gotoCreateComprables() {

        $state.go('createPrincipalForm');

    }
}

/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 216 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


_ComparableSelectionService.$inject = ["$http", "$q", "AOTCService"];
module.exports = _ComparableSelectionService;

//angular.module('AOTC')
//    .factory('ComparableSelectionService', _ComparableSelectionService
//   );

function _ComparableSelectionService($http, $q, AOTCService) {

    // function getDataFromServer(apiUrl) {
    //     // ////console.log(apiUrl);
    //     var token = localStorage.getItem('token');

    //     var req = $http({
    //         method: "GET",
    //         url: apiUrl,
    //         headers: {
    //             "Access-Control-Allow-Origin": "*",
    //             "Content-Type": "application/json",
    //             "Authorization": token

    //         }

    //     });

    //     return req;

    // }

    // function putDataToServer(url, userData) {
    //     var token = localStorage.getItem('token');

    //     var request = $http({
    //         method: "PUT",
    //         url: url,
    //         data: userData,
    //         headers: {
    //             "Access-Control-Allow-Origin": "*",
    //             "Content-Type": "application/json",
    //             "Authorization": token
    //         }

    //     });

    //     return request;

    // }

    // function postDataToServer(url, userData) {
    //     var token = localStorage.getItem('token');

    //     var request = $http({
    //         method: "POST",
    //         url: url,
    //         data: userData,
    //         headers: {
    //             "Access-Control-Allow-Origin": "*",
    //             "Content-Type": "application/json",
    //             "Authorization": token
    //         }

    //     });
    //     return request;

    // }
    function getDeepSearchResult() {

        var propertyDetails = JSON.parse(localStorage.getItem('propertyDetails'));
        var streetName = propertyDetails.streetAddress.split(',');
        var postData = {
            city: propertyDetails.city,
            state: propertyDetails.countryState,
            address: streetName[0]
        };

        var url = '/salesComps/GetDeepSearchResults';
        var deferred = $q.defer();
        ////console.log(url);


        AOTCService.postDataToServer(url, postData)
            .then(function (result) {
                deferred.resolve(result);

            }, function (result) {
                deferred.reject(result);
                ////console.log(result);
            });
        return deferred.promise;
    }

    function getSavedComparables() {

        var propId = parseInt(localStorage.getItem('propertyId'));
        var url = '/salesComps/getSavedComps';
        var _data = {propId: propId};
        var deferred = $q.defer();
        console.log(url);
        AOTCService.postDataToServer(url, _data)
            .then(function (result) {
                deferred.resolve(result);

            }, function (result) {
                deferred.reject(result);
                ////console.log(result);
            });
        return deferred.promise;
    }

    return {
        getSavedComparables: getSavedComparables,
        getDeepSearchResult: getDeepSearchResult
    };

}


/***/ }),
/* 217 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


_ComparableUtil.$inject = [];
module.exports = _ComparableUtil;

//angular.module('AOTC')
//    .service('ComparableUtil', _ComparableUtil
//);

function _ComparableUtil() {

    var formula1 = function (val1) {
        ////console.log(val1);
    };

    var Util = {};

    Util.sample = function () {

    };


    return {
        Util: Util
    };

}


/***/ }),
/* 218 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {

_CreatePrincipalForm.$inject = ["$stateParams", "$anchorScroll", "sharedService", "$state", "DTOptionsBuilder", "DTColumnDefBuilder", "$location", "$scope", "$http", "__env", "$log", "AOTCService", "$timeout"];
module.exports = _CreatePrincipalForm;

//angular.module('AOTC').controller('CreatePrincipalForm', _CreatePrincipalForm
//   )
//    .directive("fileinput", [_fileinput
//    ])
//    .directive("ngImageSelect",_ngImageSelect);

function _CreatePrincipalForm($stateParams, $anchorScroll,sharedService, $state, DTOptionsBuilder, DTColumnDefBuilder, $location, $scope, $http, __env, $log, AOTCService, $timeout) {

    $scope.imagePath = '';
    $scope.isSubmitting = false
    $scope.showComps = false;
    $scope.uploadPic = function (file) {
        ////console.log('submit' + file)

        ////console.log(file)
        ////console.log('submit')
        file.upload = Upload.upload({
            url: 'salesComps/addCompsImageManual',
            data: { file: file },
        });

        file.upload.then(function (response) {
            $timeout(function () {
                file.result = response.data;
                $scope.isSubmitting = true;
                $scope.imagePath = file.result;
                submitManualData();
                ////console.log(file.result)
            });
        }, function (response) {
            if (response.status > 0)
                $scope.errorMsg = response.status + ': ' + response.data;
        }, function (evt) {
            // Math.min is to fix IE which reports 200% sometimes
            file.progress = Math.min(100, parseInt(100.0 * evt.loaded / evt.total));
        });
    }


    ////console.log("updateIERR PrincipalForm", $stateParams);
    var vm = this;
    // $('#successModal').modal('close');

    vm.submitManualData = submitManualData;
    vm.property = JSON.parse(localStorage.getItem('propertyDetails'));
    ////console.log("vm.property in manualIE: ", vm.property)

    vm.formData = {

    };

    vm.modalYesbutton = modalYesbutton;
    vm.gotoPropertyDetails = gotoPropertyDetails;
    vm.resetForm = resetForm;

    function resetForm() {
        vm.formData = {};
        $scope.compForm.$setPristine();
        $scope.compForm.$setUntouched();

    }

    function gotoPropertyDetails() {
        $('#successModal').modal('hide');
        $state.go('updateIERR');
    }

    function modalYesbutton() {
        ////console.log('reset form');
        vm.formData = {};

        $scope.compForm.$setPristine();
        $scope.compForm.$setUntouched();

        $('#successModal').modal('toggle');

    }
    if (localStorage.getItem('principalForm')) {
        vm.PrinciplePropData = JSON.parse(localStorage.getItem('principalForm'));
        $scope.showComps = true;

    }



    function submitManualData() {


        ////console.log('appeal')
        ////console.log(vm.formData)

        vm.formData.rentAmount = vm.formData.rentEstimate.toString();
        vm.formData.amount = vm.formData.zEstimate.toString();
        vm.formData.valueChange = vm.formData.valueChange.toString();
        vm.formData.valueChangeDuration = vm.formData.valueChangeDuration.toString();
        vm.formData.valuationRangeHigh = vm.formData.valuationRangeHigh.toString();
        vm.formData.valuationRangeLow = vm.formData.valuationRangeLow.toString();
        vm.formData.lotSizeSqFt = vm.formData.lotSizeSf.toString();
        vm.formData.lastSoldDate = vm.formData.lastSoldDate.toString();
        vm.formData.lastSoldPrice = vm.formData.lastSoldPrice.toString();
        vm.formData.yearBuilt = vm.formData.yearBuilt.toString();
        vm.formData.imageFileName = $scope.imagePath
        sharedService.principalForm = vm.formData

        localStorage.setItem('principalForm', angular.toJson(vm.formData));
        $scope.showComps = true;

        vm.PrinciplePropData = JSON.parse(localStorage.getItem('principalForm'));

        $('#myModalquestion').modal('hide');


    }

    $scope.imageUpload = function () {


        $scope.imageSrc = [];
        $('#imageModal').modal('toggle');

        /* for (var i = 0; i < files.length; i++) {
             vm.IEFileNames.push({
                 name: files[i].name,
                 uploadStatus: true
             });
         }*/


    }

    // setTimeout(function() {
    //     vm.formData.baseRent = 2017;
    //     $scope.$apply();
    //     $('#successModal').modal('show');

    // }, 100);











    ///=================================date picker===========================//


    $('#sandbox-container input').datepicker({
        autoclose: true
    });


    $('#sandbox-container input').on('show', function (e) {
        console.debug('show', e.date, $(this).data('stickyDate'));

        if (e.date) {
            $(this).data('stickyDate', e.date);
        } else {
            $(this).data('stickyDate', null);
        }
    });

    $('#sandbox-container input').on('hide', function (e) {
        console.debug('hide', e.date, $(this).data('stickyDate'));
        var stickyDate = $(this).data('stickyDate');

        if (!e.date && stickyDate) {
            console.debug('restore stickyDate', stickyDate);
            $(this).datepicker('setDate', stickyDate);
            $(this).data('stickyDate', null);
        }
    });



}

function _ngImageSelect() {
    return {
        link: function ($scope, el) {
            el.bind("change", function (e) {
                $scope.file = (e.srcElement || e.target).files;
                var ctx = document.getElementById('myCanvas').getContext('2d');
                ctx.clearRect(0, 0, 300, 130);
                var img = new Image();
                img.src = scope.filepreview;
                img.onload = function () {
                    ctx.drawImage(img, 0, 0);

                }

            })
        }
    }
}
function _fileinput() {
    return {
        scope: {
            fileinput: "=",
            filepreview: "=",

        },
        link: function (scope, element, attributes) {
            element.bind("change", function (changeEvent) {
                scope.fileinput = changeEvent.target.files[0];
                scope.filepreview = '';

                var reader = new FileReader();
                reader.onload = function (loadEvent) {
                    scope.$apply(function () {
                        ////console.log(scope.fileinput)


                        scope.filepreview = loadEvent.target.result;
                        var ctx = document.getElementById('myCanvas').getContext('2d');
                        ctx.clearRect(0, 0, 300, 130);
                        var img = new Image();
                        img.src = scope.filepreview;
                        img.onload = function () {
                            ctx.drawImage(img, 0, 0);

                        }


                    });
                }
                reader.readAsDataURL(scope.fileinput);
            });
        }
    }
}

/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 219 */
/***/ (function(module, exports) {

_sharedService.$inject = [];
module.exports = _sharedService;

//angular.module('AOTC')
//    .service('sharedService', _sharedService);

function _sharedService() {
    var principalForm;
    var image;
}

/***/ }),
/* 220 */
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function($) {//__SelectedComparable.$inject = ["ComparableSelectionService", "$scope", "User_Config","$state", "$timeout"];
//module.exports = _SelectedComparable;

_SelectedComparable.$inject = ["ComparableService", "$scope", "User_Config", "$state", "$timeout", "AOTCService", "$filter"];
module.exports = _SelectedComparable;

//'use strict';
//angular.module('AOTC')
//    .controller('SelectedComparable', _SelectedComparable
//    );

function _SelectedComparable(ComparableService, $scope, User_Config, $state, $timeout, AOTCService, $filter) {


    //console.log("SelectedComparables controller");
    var vm = this;
    $(document).on('click', '.col-select .dropdown-menu', function (e) {
        e.stopPropagation();
    });

    // variables
    vm.selectedComparables = [];
    vm.showGrid = true;
    vm.showCards = false;
    vm.showResidentialProps = false;
    vm.mainImage = '';
    vm.showResidentialProps = '';
    vm.selectedcomparablesFromTable = [];
    vm.searchWordAllFile = '';
    vm.searchWordSelectedFile = '';

    //GetComparablesdata
    ///salesComps/getComparables

    //var zillowData = JSON.parse(localStorage.getItem('zillowData'));
    //vm.PrinciplePropData = zillowData.principal;
    //vm.selectedComparables = zillowData.comparables;
    var zillowData;
    vm.PrinciplePropData;
    vm.selectedComparables;


    //methods
    vm.clickShowGrid = clickShowGrid;
    vm.clickShowCards = clickShowCards;
    vm.flipBack = flipBack;
    vm.flipFront = flipFront;
    vm.saveComparables = saveComparables;
    vm.deleteComparable = deleteComparable;
    //vm.checkBoxSelection = checkBoxSelection;
    vm.slideRight = slideRight;
    vm.slideLeft = slideLeft;
    vm.clickShowPropertyDetail = clickShowPropertyDetail;
    vm.clickShowPropertySummary = clickShowPropertySummary;
    vm.clickshowPropertyMap = clickshowPropertyMap;
    vm.markerClick = markerClick;
    vm.defaultComs = true;
    vm.currentCriteria = 'Viewing saved comparables';
    vm.PrinciplePropDataDetail = {
        PO: {
            "area": "",
            "bathrooms": "",
            "bedrooms": "",
            "buildingArea": "",
            "expenditure": ["", ""],
            "improvement": ["", ""],
            "location": "",
            "waterFront": "",
            "yearBuilt": ""
        }
    };

    var userRole = localStorage.getItem('role');
    var criteriaId = 1;
    vm.isResidential = (userRole == 'Residential User') ? true : false;





    setMainImg();
    checkResientialUser();
    //initColumnSelection();

    $timeout(function () {
        initializeCards();
    }, 200);

    // $(document).ready(function() {
    //     $scope.menuLeft = $('.pushmenu-left');
    //     $scope.nav_list = $('#nav_list');

    //     $scope.nav_list.click(function() {
    //         $(this).toggleClass('active');
    //         $('.pushmenu-push').toggleClass('pushmenu-push-toright');
    //         $scope.menuLeft.toggleClass('pushmenu-open');
    //     });
    // });
    vm.comparableDelete = '';
    vm.modelMessage = {
        title: "",
        message: ""
    };
    vm.deleteConfirmation = deleteConfirmation;
    vm.myModelCheck = myModelCheck;
    vm.createComparables = createComparables;

    vm.RemovePO = function (_itemName) {
        try {
            var _newVal = vm.PrinciplePropDataDetail.PO[_itemName];
            //var _item = vm.POCopy[_itemName];

            var _hasPO = _newVal.indexOf('(PO)');
            if (_hasPO == -1) {
                //$timeout(function () {
                //    _newVal = _newVal + ' (PO)';
                //    vm.PrinciplePropDataDetail.PO[_itemName] = _newVal;
                //    //vm.POCopy[_itemName] = _newVal;
                //});
            }
            else {
                var _res = _newVal.replace(" (PO)", "");
                $timeout(function () {
                    //_newVal = _res + ' (PO)';
                    vm.PrinciplePropDataDetail.PO[_itemName] = _res;

                    //vm.POCopy[_itemName] = _newVal;
                });
            }
        }
        catch (_e) { }


    };

    vm.AppendPO = function (_itemName) {
        try {
            var _newVal = vm.PrinciplePropDataDetail.PO[_itemName];
            //var _item = vm.POCopy[_itemName];

            var _hasPO = _newVal.indexOf('(PO)');
            if (_hasPO == -1) {
                $timeout(function () {
                    _newVal = _newVal + ' (PO)';
                    vm.PrinciplePropDataDetail.PO[_itemName] = _newVal;
                    //vm.POCopy[_itemName] = _newVal;
                });
            }
            else {
                var _res = _newVal.replace(" (PO)", "");
                $timeout(function () {
                    _newVal = _res + ' (PO)';
                    vm.PrinciplePropDataDetail.PO[_itemName] = _newVal;

                    //vm.POCopy[_itemName] = _newVal;
                });
            }
        }
        catch (_e) { }


    };


    vm.SaveJurisdictionData = function (_JurisdictionData) {

        //var _JurisdictionData = vm.JurisdictionCopy;
        $('#preloader').css('display', 'block');
        //console.log("saveComparables", jsonFormat)
        ComparableService.saveSubjectPropertyUpdatedData(_JurisdictionData)
            .then(function (result) {
                $('#preloader').css('display', 'none');
                //console.log('Server Data : saveComparablesToProperties', result);

                if (result.data.success) {
                    $scope.$emit('success', result.data.message);
                } else {
                    $scope.$emit('error', result.data.message);
                }
            }, function (err) {
                //console.log('error has occurred', err);
                $('#preloader').css('display', 'none');
            });

    };

    vm.SetLocality = function (_location, _val) {
        if (_val == 'Yes') var _option = 'No';
        else var _option = 'No';
        switch (_location) {
            case 'Rural':
                vm.PrinciplePropDataDetail.PO.Urban = _option;
                vm.PrinciplePropDataDetail.PO.SubUrban = _option;

                break;
            case 'Urban':
                vm.PrinciplePropDataDetail.PO.Rural = _option;
                vm.PrinciplePropDataDetail.PO.SubUrban = _option;
                break;
            case 'SubUrban':
                vm.PrinciplePropDataDetail.PO.Urban = _option;
                vm.PrinciplePropDataDetail.PO.Rural = _option;
                break;
        }
    };
    var gridOptions;
    var rowData = [];
    var columnDefs = [];
    if (vm.isResidential) {
        columnDefs = [
             { headerName: "", field: "imageFileName", width: 70, pinned: 'left', checkboxSelection: true, headerCheckboxSelection: true, minWidth: 25 },
             { headerName: "Address", field: "streetName", pinned: 'left' },
              { headerName: "<span title='Data from Assessing Jurisdiction'> District <br> Number <br> (Assr)</span>", field: "districtNumber", width: 110, hide: true },
             { headerName: "<span title='Data from Assessing Jurisdiction'>Tax Account No <br> (Assr)</span>", field: "taxAccountNo", width: 100, cellClass: 'right-align-text', hide: true },
             { headerName: "<span title='Data from Assessing Jurisdiction'>Record Owner <br> Name <br> (Assr)</span>", field: "recordOwnerName", hide: true },
             { headerName: "<span title='Data from Assessing Jurisdiction'>Owner City <br> (Assr)</span>", field: "ownerCity", hide: true },
             { headerName: "<span title='Data from Assessing Jurisdiction'>Owner State <br> (Assr) </span>", field: "ownerState", width: 110, hide: true },
             { headerName: "<span title='Data from Assessing Jurisdiction'>Zip Code <br> (Assr) </span>", field: "zipCode", width: 80, cellClass: 'right-align-text', hide: true }, //, cellClass: 
             { headerName: "<span title='Data from Assessing Jurisdiction'> Street <br> Number <br> (Assr)</span> </span>", field: "streetNumber", width: 110 },
             { headerName: "<span title='Data from Assessing Jurisdiction'> Street <br> Direction <br> (Assr) </span>", field: "streetDirection", cellRenderer: formatNull },
             { headerName: "<span title='Data from Assessing Jurisdiction'> Street Name <br> (Assr) </span>", field: "streetName" },
             { headerName: "<span title='Data from Assessing Jurisdiction'> Street <br> Type <br> (Assr) </span>", field: "streetType" },
             { headerName: "<span title='Data from Assessing Jurisdiction'> Reval <br> Year <br> (Assr) </span>", field: "revalYear", width: 110 },
             { headerName: "<span title='Data from Assessing Jurisdiction'> Year <br> Built <br> (Assr) </span>", field: "yearBuilt", width: 110 },
             { headerName: "<span title='Data from Assessing Jurisdiction'> Building <br> Area <br> (Assr) </span>", field: "buildingArea", width: 110, cellRenderer: formatNumber, cellClass: 'right-align-text' },
             { headerName: " <span title='Consideration equals sale price'>Consideration <br> (Assr) </span>", field: "consideration", width: 110, cellRenderer: currencyFormatter, cellClass: 'right-align-text' },
             { headerName: "<span title='Data from Assessing Jurisdiction'> Sales Per<br> Sq Ft <br> (Assr)", field: "salesPerSqFt", width: 110, cellClass: 'right-align-text', cellRenderer: currencyFormatter, },
             {
                 headerName: "Transfer <br> Date <br> (Assr)", field: "transferDate", width: 110, hide: true,
                 headerCellTemplate: function () {
                     var eCell = document.createElement('span');
                     eCell.innerHTML =
                         '<div title="Data from Assessing Jurisdiction" style="text-align: left;">' +
                         '  <div style="padding: 4px; overflow: hidden; text-overflow: ellipsis;">' +
                         ' Transfer Date <br> (Assr)' +
                         '    <span id="myMenuButton"><i class="fa fa-toggle-off" aria-hidden="true"></i></span>' +
                         // everything inside agHeaderCellLabel gets actioned when the user clicks
                         '  </div>' +
                         '</div>';

                     // because the menu is not with agMenu id, it means grid is not going to tie logic to it
                     var eMenuButton = eCell.querySelector('#myMenuButton');
                     eMenuButton.addEventListener('click', function () {
                         {
                             var _index = findColIndex('transferDate');
                             columnDefs[_index].hide = true;
                             _index = findColIndex('transferYear');
                             columnDefs[_index].hide = false;
                             gridOptions.api.setColumnDefs(columnDefs);
                             autoFitColums();

                         }
                         function findColIndex(_ff) {
                             for (var i = 0; i < columnDefs.length; i++) {
                                 if (columnDefs[i].field.indexOf(_ff) != -1) {
                                     return i;
                                     break;
                                 }
                             }
                         }
                     });

                     return eCell;
                 }
             },
             {
                 headerName: "Transfer <br> Year <br> (Assr)", field: "transferYear", width: 110,
                 headerCellTemplate: function () {
                     var eCell = document.createElement('span');
                     eCell.innerHTML =
                         '<div title="Data from Assessing Jurisdiction" style="text-align: left;">' +
                         '  <div style="padding: 4px; overflow: hidden; text-overflow: ellipsis;">' +
                         ' Transfer Year <br> (Assr)' +
                         '    <span id="myMenuButton2"><i class="fa fa-toggle-on" aria-hidden="true"></i></span>' +
                         // everything inside agHeaderCellLabel gets actioned when the user clicks
                         '  </div>' +
                         '</div>';

                     // because the menu is not with agMenu id, it means grid is not going to tie logic to it
                     var eMenuButton = eCell.querySelector('#myMenuButton2');
                     eMenuButton.addEventListener('click', function () {
                         {
                             var _index = findColIndex('transferYear');
                             columnDefs[_index].hide = true;

                             _index = findColIndex('transferDate');
                             columnDefs[_index].hide = false;
                             gridOptions.api.setColumnDefs(columnDefs);
                             autoFitColums();

                         }
                         function findColIndex(_ff) {
                             for (var i = 0; i < columnDefs.length; i++) {
                                 if (columnDefs[i].field.indexOf(_ff) != -1) {
                                     return i;
                                     break;
                                 }
                             }
                         }
                     });

                     return eCell;
                 }
             },
             { headerName: "<span title='Data from Assessing Jurisdiction'> Total <br> Value <br> (Assr) </span>", field: "totalValue", width: 110, cellRenderer: currencyFormatter, cellClass: 'right-align-text' },
             { headerName: "<span title='Data from Assessing Jurisdiction'> Value Per <br> Sq Ft <br> (Assr) </span>", field: "valuePerSqFt", width: 110, cellRenderer: currencyFormatter, cellClass: 'right-align-text' },
             { headerName: "<span title='Data from Assessing Jurisdiction'> Land <br> Area <br> (Assr) </span>", field: "landArea", width: 110, cellRenderer: formatNumber, cellClass: 'right-align-text' },
             {
                 headerName: "<span title='data from Zillow'> Bedroom <br> (Zillow)", field: "bedrooms", width: 80, cellClass: 'right-align-text'
             },
             {
                 headerName: "<span title='data from Zillow'> Bathroom <br> (Zillow)", field: "bathrooms", width: 80, cellClass: 'right-align-text'
             },
             { headerName: "<span title='Data from Assessing Jurisdiction'> Condition <br> (Assr) </span>", field: "condition", width: 90 },
        ];
    }
    else {
        columnDefs = [
             { headerName: "", field: "imageFileName", width: 70, pinned: 'left', checkboxSelection: true, headerCheckboxSelection: true, minWidth: 25 },
             { headerName: "Address", field: "streetName", pinned: 'left' },
                              { headerName: "<span title='Data from Assessing Jurisdiction'> Street <br> Number <br> (Assr)</span> </span>", field: "streetNumber", width: 110 },
             { headerName: "<span title='Data from Assessing Jurisdiction'> Street <br> Direction <br> (Assr) </span>", field: "streetDirection", cellRenderer: formatNull },
             { headerName: "<span title='Data from Assessing Jurisdiction'> Street Name <br> (Assr) </span>", field: "streetName" },
             { headerName: "<span title='Data from Assessing Jurisdiction'> Street <br> Type <br> (Assr) </span>", field: "streetType" },
             {
                 headerName: "Transfer <br> Date <br> (Assr)", field: "transferDate", width: 110, hide: true,
                 headerCellTemplate: function () {
                     var eCell = document.createElement('span');
                     eCell.innerHTML =
                         '<div title="Data from Assessing Jurisdiction" style="text-align: left;">' +
                         '  <div style="padding: 4px; overflow: hidden; text-overflow: ellipsis;">' +
                         ' Transfer Date <br> (Assr)' +
                         '    <span id="myMenuButton"><i class="fa fa-toggle-off" aria-hidden="true"></i></span>' +
                         // everything inside agHeaderCellLabel gets actioned when the user clicks
                         '  </div>' +
                         '</div>';

                     // because the menu is not with agMenu id, it means grid is not going to tie logic to it
                     var eMenuButton = eCell.querySelector('#myMenuButton');
                     eMenuButton.addEventListener('click', function () {
                         {
                             var _index = findColIndex('transferDate');
                             columnDefs[_index].hide = true;
                             _index = findColIndex('transferYear');
                             columnDefs[_index].hide = false;
                             gridOptions.api.setColumnDefs(columnDefs);
                             autoFitColums();

                         }
                         function findColIndex(_ff) {
                             for (var i = 0; i < columnDefs.length; i++) {
                                 if (columnDefs[i].field.indexOf(_ff) != -1) {
                                     return i;
                                     break;
                                 }
                             }
                         }
                     });

                     return eCell;
                 }
             },

             {
                 headerName: "Transfer <br> Year <br> (Assr)", field: "transferYear", width: 110,
                 headerCellTemplate: function () {
                     var eCell = document.createElement('span');
                     eCell.innerHTML =
                         '<div title="Data from Assessing Jurisdiction" style="text-align: left;">' +
                         '  <div style="padding: 4px; overflow: hidden; text-overflow: ellipsis;">' +
                         ' Transfer Year <br> (Assr)' +
                         '    <span id="myMenuButton2"><i class="fa fa-toggle-on" aria-hidden="true"></i></span>' +
                         // everything inside agHeaderCellLabel gets actioned when the user clicks
                         '  </div>' +
                         '</div>';

                     // because the menu is not with agMenu id, it means grid is not going to tie logic to it
                     var eMenuButton = eCell.querySelector('#myMenuButton2');
                     eMenuButton.addEventListener('click', function () {
                         {
                             var _index = findColIndex('transferYear');
                             columnDefs[_index].hide = true;

                             _index = findColIndex('transferDate');
                             columnDefs[_index].hide = false;
                             gridOptions.api.setColumnDefs(columnDefs);
                             autoFitColums();

                         }
                         function findColIndex(_ff) {
                             for (var i = 0; i < columnDefs.length; i++) {
                                 if (columnDefs[i].field.indexOf(_ff) != -1) {
                                     return i;
                                     break;
                                 }
                             }
                         }
                     });

                     return eCell;
                 }
             },
             { headerName: " <span title='Consideration equals sale price'>Consideration <br> (Assr) </span>", field: "consideration", width: 110, cellRenderer: currencyFormatter, cellClass: 'right-align-text' },
             { headerName: "<span title='Data from Assessing Jurisdiction'> Sales Per<br> Sq Ft <br> (Assr)", field: "salesPerSqFt", width: 110, cellClass: 'right-align-text', cellRenderer: currencyFormatter, },
             { headerName: "<span title='Data from Assessing Jurisdiction'> Year <br> Built <br> (Assr) </span>", field: "yearBuilt", width: 110 },
             { headerName: "<span title='Data from Assessing Jurisdiction'> Building <br> Area <br> (Assr) </span>", field: "buildingArea", width: 110, cellRenderer: formatNumber, cellClass: 'right-align-text' },
             { headerName: "<span title='Data from Assessing Jurisdiction'> Condition <br> (Assr) </span>", field: "condition", width: 90 },

             { headerName: "<span title='Data from Assessing Jurisdiction'> Reval <br> Year <br> (Assr) </span>", field: "revalYear", width: 110 },

             { headerName: "<span title='Data from Assessing Jurisdiction'> Total <br> Value <br> (Assr) </span>", field: "totalValue", width: 110, cellRenderer: currencyFormatter, cellClass: 'right-align-text' },
             { headerName: "<span title='Data from Assessing Jurisdiction'> Value Per <br> Sq Ft <br> (Assr) </span>", field: "valuePerSqFt", width: 110, cellRenderer: currencyFormatter, cellClass: 'right-align-text' },
             { headerName: "<span title='Data from Assessing Jurisdiction'> Land <br> Area <br> (Assr) </span>", field: "landArea", width: 110, cellRenderer: formatNumber, cellClass: 'right-align-text' },


             // { headerName: "<span title='Data from Assessing Jurisdiction'> District <br> Number <br> (Assr)</span>", field: "districtNumber", width: 110, hide: true },
             //{ headerName: "<span title='Data from Assessing Jurisdiction'>Tax Account No <br> (Assr)</span>", field: "taxAccountNo", width: 100, cellClass: 'right-align-text', hide: true },
             //{ headerName: "<span title='Data from Assessing Jurisdiction'>Record Owner <br> Name <br> (Assr)</span>", field: "recordOwnerName", hide: true },
             //{ headerName: "<span title='Data from Assessing Jurisdiction'>Owner City <br> (Assr)</span>", field: "ownerCity", hide: true },
             //{ headerName: "<span title='Data from Assessing Jurisdiction'>Owner State <br> (Assr) </span>", field: "ownerState", width: 110, hide: true },
             //{ headerName: "<span title='Data from Assessing Jurisdiction'>Zip Code <br> (Assr) </span>", field: "zipCode", width: 80, cellClass: 'right-align-text', hide: true }, //, cellClass: 
             //{
             //    headerName: "<span title='data from Zillow'> Bedroom <br> (Zillow)", field: "bedrooms", width: 80, cellClass: 'right-align-text'
             //},
             //{
             //    headerName: "<span title='data from Zillow'> Bathroom <br> (Zillow)", field: "bathrooms", width: 80, cellClass: 'right-align-text'
             //},
        ];
    }



    function formatNull(params) {
        if (params.value == 'null' || params.value == null || params.value == 'undefined') return '';
    }

    function formatNumber(params) {
        return $filter('number')(params.value, 0);
    }
    function currencyFormatter(params) {
        // this puts commas into the number eg 1000 goes to 1,000,
        // i pulled this from stack overflow, i have no idea how it works

        return $filter('currency')(params.value, "$", 0);
    }


    gridOptions = {
        columnDefs: columnDefs,
        rowData: rowData,
        headerHeight: 60,
        rowHeight: 40,
        suppressCellSelection: true,
        rowSelection: 'multiple',
        enableColResize: true,
        onRowSelected: rowSelectedFunc,
        getRowStyle: function (params) {
            if (params.data.value === 'mid') {
                return { 'background-color': '#bbbbbb' }
            }
            else if (params.data.value === 'low') {
                return { 'background-color': '#ffa570' }
            }
            else if (params.data.value === 'high') {
                return { 'background-color': '#1dd490' }
            }
            return null;
        },
        domLayout: 'autoHeight'
    };

    function rowSelectedFunc(event) {
        var _id = event.node.data.id;
        if (event.node.selected == true) {
            vm.selectedcomparablesFromTable.push(_id);

        }
        else if (event.node.selected == false) {
            var _index = vm.selectedcomparablesFromTable.indexOf(_id);
            vm.selectedcomparablesFromTable.splice(_index);
        }
        //window.alert("row " + event.node.data.athlete + " selected = " + event.node.selected);

    };

    function saveComparables() {
        $('#preloader').css('display', 'block');
        var propId = parseInt(localStorage.getItem('propertyId'));
        var jsonFormat = {
            "propId": propId,
            "compIds": vm.selectedcomparablesFromTable
        };
        //console.log("saveComparables", jsonFormat)
        ComparableService.saveComparablesToProperties(jsonFormat)
            .then(function (result) {
                vm.selectedcomparablesFromTable = [];
                $('#preloader').css('display', 'none');

                getSavedComps();
                //console.log('Server Data : saveComparablesToProperties', result);

                if (result.data.success) {
                    $scope.$emit('success', result.data.message);
                } else {
                    $scope.$emit('error', result.data.message);
                }
            }, function (err) {
                //console.log('error has occurred', err);
                $('#preloader').css('display', 'none');
            });
    };

    vm.deleteComparables = function () {
        $('#preloader').css('display', 'block');
        var propId = parseInt(localStorage.getItem('propertyId'));
        var jsonFormat = {
            "propId": propId,
            "compIds": vm.selectedcomparablesFromTable
        };
        //console.log("saveComparables", jsonFormat)
        ComparableService.deleteCompsFromProperty(jsonFormat)
            .then(function (result) {
                $('#preloader').css('display', 'none');


                getSavedComps();
                vm.selectedcomparablesFromTable = [];

                //console.log('Server Data : saveComparablesToProperties', result);

                if (result.data.success) {
                    $scope.$emit('success', result.data.message);
                } else {
                    $scope.$emit('error', result.data.message);
                }
            }, function (err) {
                //console.log('error has occurred', err);
                $('#preloader').css('display', 'none');
            });
    }


    vm.ColumnAddRemove = function (_colName, _field, _width, _after, _val) {

        if (_val) {
            //var _obj = { headerName: _colName, field: _field, width: _width };
            var _index = findColIndex(_field);
            columnDefs[_index].hide = false;
            gridOptions.api.setColumnDefs(columnDefs);
            autoFitColums()
        }
        else {
            var _index = findColIndex(_field);
            columnDefs[_index].hide = true;
            gridOptions.api.setColumnDefs(columnDefs);
            autoFitColums()

        }
        function findColIndex(_ff) {
            for (var i = 0; i < columnDefs.length; i++) {
                if (columnDefs[i].field.indexOf(_ff) != -1) {
                    return i;
                    break;
                }
            }
        }

    };

    function getComparables(_query) {
        $('#preloader').css('display', 'block');
        _query = _query ? _query : 1;
        ComparableService.getComparables(_query).
        then(function (result) {
            var serverData = result.data;

            if (serverData.success) {
                if (serverData.result.subjectProperty) {
                    vm.defaultComs = false;
                    zillowData = {
                        principal: serverData.result.subjectProperty.jurisdictionData,
                        comparables: serverData.result
                    };
                    vm.PrinciplePropData = zillowData.principal;

                    vm.selectedComparables = serverData.result;
                    vm.PrinciplePropDataDetail = {
                        Jurisdiction: serverData.result.subjectProperty.jurisdictionData,
                        Zillow: serverData.result.subjectProperty.zillowData,
                        PO: serverData.result.subjectProperty.poData
                    }

                    $("#preloader").css('display', 'none');

                    function setPropValue(_item) {
                        serverData.result.highProperties[i].properties
                    };


                    gridOptions.rowData = [];
                    for (var i = 0; i < serverData.result.highProperties.length; i++) {
                        var _propItem = serverData.result.highProperties[i];
                        _propItem.properties['value'] = _propItem.value;
                        _propItem.properties['id'] = _propItem.id;
                        _propItem.properties['imageFileName'] = _propItem.zillow ? '(Z)' : '  ';

                        gridOptions.rowData.push(_propItem.properties);
                    }

                    var _propItem = serverData.result.subjectProperty;
                    //_propItem.properties['value'] = _propItem.value;
                    _propItem.properties = _propItem.properties || {}; 
                    _propItem.properties['id'] = parseInt(localStorage.getItem('propertyId'));
                    gridOptions.rowData.push(_propItem.properties);

                    for (var i = 0; i < serverData.result.lowProperties.length; i++) {
                        var _propItem = serverData.result.lowProperties[i];
                        _propItem.properties['value'] = _propItem.value;
                        _propItem.properties['id'] = _propItem.id;
                        _propItem.properties['imageFileName'] = _propItem.zillow ? '(Z)' : '  ';

                        gridOptions.rowData.push(_propItem.properties);

                    }
                    $timeout(function () {
                        gridOptions.api.destroy();
                        var gridDiv = document.querySelector('#myGridContracts');
                        new agGrid.Grid(gridDiv, gridOptions);
                        //gridOptions.api.redrawRows();
                        gridOptions.api.setRowData(gridOptions.rowData);
                        autoFitColums();
                    });
                    $timeout(function () {
                        var x = document.getElementsByClassName("ag-body-viewport");
                        var hasHorizontalScrollbar = x[0].scrollWidth > x[0].clientWidth;
                        if (!hasHorizontalScrollbar) {
                            gridOptions.api.sizeColumnsToFit();
                        }
                    }, 100);
                    vm.locations = [];
                    createMarkers('lowProperties');
                    createMarkers('highProperties');
                    setmarkers(serverData.result.subjectProperty);
                } else {

                    getDeepSearchResult();
                    $('#preloader').css('display', 'none');
                }
            }
            else {
                $('#preloader').css('display', 'none');
            }
        }, function (err) {
            console.log('err : ', err);
            $('#preloader').css('display', 'none');
        })

    };
    //getComparables(1);
    vm.updateComsData = function (_query, _caption) {
        vm.currentCriteria = _caption;
        criteriaId = _query;
        getComparables(_query);
    };


    function autoFitColums() {
        var allColumnIds = [];
        columnDefs.forEach(function (columnDef) {
            allColumnIds.push(columnDef.field);
        });
        gridOptions.columnApi.autoSizeColumns(allColumnIds);
    }

    function getSavedComps() {
        $('#preloader').css('display', 'block');
        //_query = _query ? _query : 1;
        ComparableService.getSavedComps().
        then(function (result) {
            var serverData = result.data;

            if (serverData.success) {
                if (serverData.result.subjectProperty) {
                    vm.currentCriteria = 'Viewing saved comparables';
                    vm.defaultComs = true;
                    zillowData = {
                        principal: serverData.result.subjectProperty.jurisdictionData,
                        comparables: serverData.result
                    };
                    vm.PrinciplePropData = zillowData.principal;

                    vm.selectedComparables = serverData.result;
                    vm.PrinciplePropDataDetail = {
                        Jurisdiction: serverData.result.subjectProperty.jurisdictionData,
                        Zillow: serverData.result.subjectProperty.zillowData,
                        PO: serverData.result.subjectProperty.poData
                    }

                    $("#preloader").css('display', 'none');


                    gridOptions.rowData = [];
                    var _propItem = serverData.result.subjectProperty;
                    //_propItem.properties['value'] = _propItem.value;
                    _propItem.properties = _propItem.properties || {};
                    _propItem.properties['id'] = parseInt(localStorage.getItem('propertyId'));
                    gridOptions.rowData.push(_propItem.properties);

                    for (var i = 0; i < serverData.result.comparables.length; i++) {
                        var _propItem = serverData.result.comparables[i];
                        _propItem.properties['value'] = _propItem.value;
                        _propItem.properties['id'] = _propItem.id;
                        _propItem.properties['imageFileName'] = _propItem.zillow ? '(Z)' : '  ';


                        gridOptions.rowData.push(_propItem.properties);
                    }



                    $timeout(function () {
                        try {
                            gridOptions.api.destroy();
                        }
                        catch (_e) { }
                        var gridDiv = document.querySelector('#myGridContracts');
                        new agGrid.Grid(gridDiv, gridOptions);


                        var allColumnIds = [];
                        columnDefs.forEach(function (columnDef) {
                            allColumnIds.push(columnDef.field);
                        });
                        gridOptions.columnApi.autoSizeColumns(allColumnIds);

                        //gridOptions.api.sizeColumnsToFit()
                    });
                    $timeout(function () {
                        var x = document.getElementsByClassName("ag-body-viewport");
                        var hasHorizontalScrollbar = x[0].scrollWidth > x[0].clientWidth;
                        if (!hasHorizontalScrollbar) {
                            gridOptions.api.sizeColumnsToFit();
                        }
                    }, 100);
                    vm.locations = [];
                    createMarkers('comparables');
                    setmarkers(serverData.result.subjectProperty);
                } else {

                    getDeepSearchResult();
                    $('#preloader').css('display', 'none');
                }
            }
            else {
                $('#preloader').css('display', 'none');
            }
        }, function (err) {
            console.log('err : ', err);
            $('#preloader').css('display', 'none');
        })

    };
    getSavedComps();

    vm.markerId = 0;

    function createMarkers(_propname) {
        for (var i = 0; i < vm.selectedComparables[_propname].length; i++) {

            if (vm.selectedComparables[_propname][i].properties.ownerAddress !== null) {
            }

            // infowWindowDetails.propertyName = vm.selectedComparables[i].propertyName ? vm.selectedComparables[i].propertyName : 'Not Specified';
            var marker = {
                id: vm.markerId++,
                coords: {
                    latitude: (vm.selectedComparables[_propname][i].properties.latitude) ? parseFloat(vm.selectedComparables[_propname][i].properties.latitude) : 0,
                    longitude: (vm.selectedComparables[_propname][i].properties.longitude) ? parseFloat(vm.selectedComparables[_propname][i].properties.longitude) : 0
                },
                description: {
                    propertyName: vm.selectedComparables[_propname][i].properties.ownerAddress, //// title:"<h1>Marker 0</h1><p>This is the home marker.</p>",,
                    amount: $filter('currency')(vm.selectedComparables[_propname][i].properties.totalAssessment),
                    appealStatus: "",
                    meritToAppealDetail: ""
                },
                icon: './assets/img/b (1).png',
                options: {
                    draggable: false,
                    //icon: './assets/img/mark.png'
                    // icon: "assets/img/" + vm.selectedComparables[i].meritToAppeal + ".png"
                }
            }
            if (vm.selectedComparables[_propname][i].value == 'high') {
                marker.icon = './assets/img/marker-high.png';
            }
            if (vm.selectedComparables[_propname][i].value == 'low')
            { marker.icon = './assets/img/marker-low.png'; }
            if (vm.selectedComparables[_propname][i].value == 'mid')
            { marker.icon = './assets/img/marker-mid.png'; }

            vm.locations.push(marker);
            // $scope.$apply();
        }

    }

    function setmarkers(_subjectProperty) {



        //latitude
        //longitude


        vm.locations.push({
            id: vm.markerId++,
            coords: {
                latitude: _subjectProperty.lat,
                longitude: _subjectProperty.lng
            },
            description: {
                propertyName: _subjectProperty.ownerAddress, //// title:"<h1>Marker 0</h1><p>This is the home marker.</p>",,
                amount: $filter('currency')(_subjectProperty.totalAssessment),
                appealStatus: "",
                meritToAppealDetail: ""
            },
            icon: './assets/img/marker.png',
            options: {
                //draggable: false,
                //icons: './assets/img/mark.png'
            }
        });
        vm.icon = './assets/img/mark.png';
        //Google Map
        vm.map = {
            center: {
                latitude: 47.634705,
                longitude: -122.350054
            },
            showOverlay: true,
            zoom: 6,
            mapTypeId: google.maps.MapTypeId.ROADMAP
        };

        vm.mapOptions = {
            maxZoom: 0
        };


    };


    //vm.showPropertyMap

    function markerClick(marker) {
        vm.selectedMarker = {};
        vm.selectedMarker = marker.model;
        vm.map.center.latitude = vm.selectedMarker.coords.latitude;
        vm.map.center.longitude = vm.selectedMarker.coords.longitude;
        vm.markerWindowShow = true;
    }

    function clickShowPropertyDetail() {
        vm.ShowPropertyDetail = true;

    };

    function clickShowPropertySummary() {
        vm.ShowPropertyDetail = false;
    };

    function createComparables() {
        //console.log('v')
        $state.go('createPrincipalForm')


    }
    function deleteConfirmation(comparable) {
        //console.log('comparable is ', comparable);
        vm.modelMessage.title = 'Delete Comparable';
        vm.modelMessage.message = 'Are you sure you want to delete this comparable from this property?';
        vm.comparableDelete = comparable;
    }

    function myModelCheck() {

        if (vm.comparableDelete != null) {
            deleteComparable(vm.comparableDelete)
        }
    }

    function setMainImg() {
        var propertyDetails = JSON.parse(localStorage.getItem('propertyDetails'));
        vm.mainImage = propertyDetails.imageFileName;
        //console.log('mainImage' + vm.mainImage)

        if (vm.mainImage == undefined || vm.mainImage == null) {
            vm.mainImage = "assets/img/noImageAvailable.jpg";
        }
    }

    function checkResientialUser() {
        var userRole = localStorage.getItem('role');
        if (userRole == User_Config.RESIDENTIAL_USER) {
            vm.showResidentialProps = true;
        }
    }

    function deleteComparable(comparable) {

        //delete this comparable from server if id exists

        if (comparable.id) {
            $('#preloader').css('display', 'block');
            //delete from server and 
            ComparableService.deleteCompsFromProperty(comparable.id)
                .then(function (result) {
                    //console.log('deleteComparables result is: ', result);
                    $('#preloader').css('display', 'none');

                }, function (err) {
                    //console.log('err is ', err);
                    $('#preloader').css('display', 'none');

                })
        }

        for (var i = 0; i < vm.selectedComparables.length; i++) {
            var comp = vm.selectedComparables[i];

            if (comp.zpid == comparable.zpid) {
                vm.selectedComparables.splice(i, 1);
            }
        }

        zillowData.comparables = vm.selectedComparables;
        localStorage.removeItem('zillowData');
        localStorage.setItem('zillowData', angular.toJson(zillowData));

        $scope.$emit('success', 'Record deleted successfully');
    }

    //function saveComparables() {
    //    $('#preloader').css('display', 'block');
    //    var jsonFormat = {
    //        principal: vm.PrinciplePropData,
    //        comps: vm.selectedComparables
    //    };
    //    //console.log("saveComparables", jsonFormat)
    //    ComparableService.saveComparablesToProperties(jsonFormat)
    //        .then(function (result) {
    //            $('#preloader').css('display', 'none');
    //            //console.log('Server Data : saveComparablesToProperties', result);

    //            if (result.data.success) {
    //                $scope.$emit('success', result.data.message);
    //            } else {
    //                $scope.$emit('error', result.data.message);
    //            }
    //        }, function (err) {
    //            //console.log('error has occurred', err);
    //            $('#preloader').css('display', 'none');
    //        });
    //}

    //toggles tabs -start
    function clickShowGrid() {
        vm.showGrid = true;
        vm.showCards = false;
        vm.showPropertyMap = false;
    }

    function clickShowCards() {
        vm.showGrid = false;
        vm.showCards = true;
        vm.showPropertyMap = false;
    }

    function clickshowPropertyMap() {
        vm.showGrid = false;
        vm.showCards = false;
        vm.showPropertyMap = true;
    };
    //toggles tabs -end

    //initialize data to show
    function initializeCards() {
        for (var i = 0; i < vm.selectedComparables.length; i++) {
            var id = '#card_' + i;
            $(id).flip({
                trigger: 'manual'
            });
        }
    }

    //====ui controls
    function flipBack(id) {
        $(id).flip(false);
    }

    function flipFront(id) {
        $(id).flip(true);
    }

    // table slider
    function slideRight() {
        var container = $('#container')
        sideScroll(container[0], 'right', 25, 100, 10);
    }

    function slideLeft() {
        var container = $('#container')
        sideScroll(container[0], 'left', 25, 100, 10);
    }

    function sideScroll(element, direction, speed, distance, step) {
        var scrollAmount = 0;
        var slideTimer = setInterval(function () {
            if (direction == 'left') {
                element.scrollLeft -= step;
            } else {
                element.scrollLeft += step;
            }
            scrollAmount += step;
            if (scrollAmount >= distance) {
                window.clearInterval(slideTimer);
            }
        }, speed);
    }







    //####START========================================================= Evidences Modal ==============================================================//

    //===============================   GETTING ALL EVIDENCE FILES ======================== //

    vm.selectedPropCaption = '';
    vm.popup = {
        title: "Please explain",
        improvementYes: false,
        expenditureYes: false,
        improvementReason: '',
        expenditureReason: '',
        //SaveOption: function (_param) {
        //    vm.popup[_param + 'Yes'] = false;
        //},
        templateUrl: 'modules/ComparableModule/SalesComparable/SelectedComparables/template.html',
        templateUrl2: 'modules/ComparableModule/SalesComparable/SelectedComparables/template2.html',
        OpenDialogue: function (_param) {
            $('#myModalEvidence').modal('show');
            vm.selectedPropCaption = _param;
        },
        CheckYes: function (_param, _val) {
            if (_val.indexOf('Yes') != -1) {
                //show modal #myModalEvidence
                $('#myModalEvidence').modal('show');
                vm.selectedPropCaption = _param;
                //m.popup[_param + 'Yes'] = true;
            }
            else {
                vm.PrinciplePropDataDetail.PO[_param].options = [];
            }
        }
    };

    vm.AddNewDescriptionRow = function () {
        var _obj = {
            explanation: "",
            evidenceId: []
        };
        if (vm.PrinciplePropDataDetail.PO[vm.selectedPropCaption].options) {
            vm.PrinciplePropDataDetail.PO[vm.selectedPropCaption].options.push(_obj);
        }
        else {
            vm.PrinciplePropDataDetail.PO[vm.selectedPropCaption].options = [];
            vm.PrinciplePropDataDetail.PO[vm.selectedPropCaption].options.push(_obj);

        }
    }

    //getAllEvidenceFiles();

    function getAllEvidenceFiles() {

        vm.allEvidenceFiles = [];
        var propId = parseInt(localStorage.getItem('propertyId'));

        //$("#preloader").css("display", "block");
        var url = '/valuation/get-evidence-files';
        var _data = {propId: propId};
        console.log(url)

        AOTCService.postDataToServer(url, _data)
            .then(function (result) {

                var serverData = result.data;
                console.log('All Evidences Receieved Server Data');
                console.log(serverData);

                if (serverData.success) {

                    vm.allEvidenceFiles = serverData.result[0].evidences;
                    //by default sort By date
                    // sortBy('createdDate');
                    localStorage.removeItem('evidenceFilesAtServer');
                    localStorage.setItem('evidenceFilesAtServer', angular.toJson(vm.allEvidenceFiles));

                    //for (var i = 0; i < vm.allEvidenceFiles.length; i++) {
                    //    var evidFile = vm.allEvidenceFiles[i];

                    //    for (var k = 0; k < vm.selectedEvidences.length; k++) {
                    //        var selectedEvid = vm.selectedEvidences[k];
                    //        if (selectedEvid._id == evidFile._id) {

                    //            vm.allEvidenceFiles.splice(i, 1);
                    //            i = i - 1;

                    //        }

                    //    }

                    //}

                }

                //$("#preloader").css("display", "none");


            }, function (result) {
                //some error
                console.log(result);
                // $("#preloader").css("display", "none");

            });
    };


    vm.sortedAndSearchedEvidences = sortedAndSearchedEvidences;
    vm.sortedAndSearchedSelectedEvidences = sortedAndSearchedSelectedEvidences;

    function sortedAndSearchedEvidences() {

        var searchItem = vm.searchWordAllFile.toLowerCase();

        if (searchItem.length > 0) {

        } else {
            // console.log('return all evidence\n', vm.allEvidenceFiles);
            return vm.allEvidenceFiles;

        }
    }

    function sortedAndSearchedSelectedEvidences() {

        var searchItem = vm.searchWordSelectedFile.toLowerCase();

        if (searchItem.length > 0) {
        } else {
            // console.log('----------------------------already selectedEvidences');
            // console.log(vm.selectedEvidences);
            return vm.selectedEvidences;
        }
    }



    //upon sort click

    function restoreAllEvidence() {
        var propEvidence = localStorage.getItem('evidenceFilesAtServer');
        vm.allEvidenceFiles = JSON.parse(propEvidence);
        //by default sort By date
        // sortBy('createdDate');

        //for (var i = 0; i < vm.allEvidenceFiles.length; i++) {
        //    var evidFile = vm.allEvidenceFiles[i];
        //    for (var k = 0; k < vm.selectedEvidences.length; k++) {
        //        var selectedEvid = vm.selectedEvidences[k];
        //        if (selectedEvid._id == evidFile._id) {
        //            vm.allEvidenceFiles.splice(i, 1);
        //            i = i - 1;
        //        }
        //    }
        //}
    }

    vm.currentPropSelected = {};
    vm.OpenEvidenceModal = function (__evidance) {
        $('#myModalEvidence2').modal('show');
        vm.currentPropSelected = __evidance;
        restoreAllEvidence();
        removeFromAllEvi();
    };

    // MOVE TO SELECTED LIST//

    function removeFromAllEvi() {

        for (var i = 0; i < vm.currentPropSelected.evidenceId.length; i++) {
            var propEvidenceId = vm.currentPropSelected.evidenceId[i];
            for (var k = 0; k < vm.allEvidenceFiles.length; k++) {
                var allEvidenceId = vm.allEvidenceFiles[k]
                if (allEvidenceId._id == propEvidenceId) {
                    vm.allEvidenceFiles.splice(k, 1);
                }

            }

        }


    };

    vm.addToSelectedFiles = function (evidence) {

        try {
            vm.currentPropSelected.evidenceId.push(evidence._id);
        }
        catch (_e) { }

        //vm.PrinciplePropDataDetail.PO.expenditure[2]


        for (var i = 0; i < vm.allEvidenceFiles.length; i++) {
            var allEvidence = vm.allEvidenceFiles[i]
            if (allEvidence._id == evidence._id) {
                vm.allEvidenceFiles.splice(i, 1);
                i = i - 1;
            }

        }

    }

    //MOVE TO ALL EVIDENCE LIST  FROM SELECTED//
    vm.removeFromSelectedFiles = function (evidence) {

        for (var i = 0; i < vm.currentPropSelected.evidenceId.length; i++) {
            var allEvidence = vm.currentPropSelected.evidenceId[i]

            if (allEvidence == evidence) {
                //console.log('true')
                vm.currentPropSelected.evidenceId.splice(i, 1);
                vm.allEvidenceFiles.push({ _id: evidence });
            }

        }
    }

    //======================= on input click => OPEN MODEL(myModalEvidence) TO SELECT EVIDENCES ================= //



    //####END========================================================= Evidences Modal ==============================================================//


    // select Columns
    //function initColumnSelection() {
    //    var checkboxModelData = JSON.parse(localStorage.getItem('checkboxModelData'));

    //    if (checkboxModelData === null) {
    //        $scope.checkboxCount = 21;
    //        $scope.checkboxModel = {
    //            value1: true,
    //            value2: true,
    //            value3: true,
    //            value4: true,
    //            value5: true,
    //            value6: true,
    //            value7: true,
    //            value8: true,
    //            value9: true,
    //            value10: true,
    //            value11: true,
    //            value12: true,
    //            value13: true,
    //            value14: true,
    //            value15: true,
    //            value16: true,
    //            value17: true,
    //            value18: true,
    //            value19: true,
    //            value20: true,
    //            value21: true,
    //        };
    //    } else {
    //        $scope.checkboxCount = checkboxModelData.count;
    //        $scope.checkboxModel = checkboxModelData.checkboxModel;
    //    }
    //}

    //function checkBoxSelection(value) {

    //    //console.log('checkbox' + value)
    //    var checkboxModel = $scope.checkboxModel;
    //    var count = 0;
    //    for (var element in checkboxModel) {
    //        if (checkboxModel[element]) {
    //            count++;
    //        }
    //    }
    //    $scope.checkboxCount = count;

    //    var checkboxModelData = {
    //        count: count,
    //        checkboxModel: checkboxModel
    //    };
    //    localStorage.setItem('checkboxModelData', angular.toJson(checkboxModelData));

    //    //  vm.createComparables=createComparables;

}

/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 221 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


_ComparableService.$inject = ["$http", "$q"];
module.exports = _ComparableService;

//angular.module('AOTC')
//    .factory('ComparableService', _ComparableService);

function _ComparableService($http, $q) {

    function getDataFromServer(apiUrl) {
        // ////console.log(apiUrl);
        var token = localStorage.getItem('token');

        var req = $http({
            method: "GET",
            url: apiUrl,
            headers: {
                "Access-Control-Allow-Origin": "*",
                "Content-Type": "application/json",
                "Authorization": token
            }
        });
        return req;
    }

    function putDataToServer(url, userData) {
        var token = localStorage.getItem('token');

        var request = $http({
            method: "PUT",
            url: url,
            data: userData,
            headers: {
                "Access-Control-Allow-Origin": "*",
                "Content-Type": "application/json",
                "Authorization": token
            }

        });

        return request;

    }

    function postDataToServer(url, userData) {
        var token = localStorage.getItem('token');

        var request = $http({
            method: "POST",
            url: url,
            data: userData,
            headers: {
                "Access-Control-Allow-Origin": "*",
                "Content-Type": "application/json",
                "Authorization": token
            }

        });
        return request;

    }

    function saveComparablesToProperties(comparables) {
        //var jsonFormat = {
        //    propertyId: parseInt( localStorage.getItem('propertyId') ),
        //    comps: comparables.comps,
        //    principal: [comparables.principal]
        //};

        ////console.log(jsonFormat)


        var url = '/salesComps/addCompsToProp';
        var deferred = $q.defer();

        postDataToServer(url, comparables)
            .then(function (result) {
                deferred.resolve(result);

            }, function (result) {
                deferred.reject(result);
                ////console.log(result);
            });
        return deferred.promise;
    }

    function deleteComparables(id) {
        var jsonFormat = {
            salesComps: [id]
        };
        ////console.log(jsonFormat);
        var url = '/salesComps/deleteCompsFromProperty';

        var deferred = $q.defer();

        postDataToServer(url, jsonFormat)
            .then(function (result) {
                deferred.resolve(result);

            }, function (result) {
                deferred.reject(result);
                //console.log(result);
            });
        return deferred.promise;
    }

    ///salesComps/getComparables
    function getComparables(_query) {

        var propId = parseInt(localStorage.getItem('propertyId'));
        //var url = '/salesComps/getSavedComps?propertyId=' + propId;
        var _dataobj = {
            "propId": propId,
            "queryCriteria": _query
        };
        var deferred = $q.defer();
        var url = '/salesComps/getComparables';
        postDataToServer(url, _dataobj)
            .then(function (result) {
                deferred.resolve(result);

            }, function (result) {
                deferred.reject(result);
                //console.log(result);
            });
        return deferred.promise;
    };

    function getSavedComps(_query) {

        var propId = parseInt(localStorage.getItem('propertyId'));
        //var url = '/salesComps/getSavedComps?propertyId=' + propId;
        var _dataobj = {
            "propertyId": propId,
        };
        var deferred = $q.defer();
        var url = '/salesComps/getSavedComps';
        console.log("here is url: ",url);
        postDataToServer(url, _dataobj)
            .then(function (result) {
                deferred.resolve(result);

            }, function (result) {
                deferred.reject(result);
                //console.log(result);
            });
        return deferred.promise;
    };

    function saveSubjectPropertyUpdatedData(_data) {
        var propId = parseInt(localStorage.getItem('propertyId'));
        var url = '/salesComps/saveSubjectPropertyUpdatedData';
        var _dataobj = {
            "propertyId": propId,
            "data": _data
        }
        var deferred = $q.defer();
        //var url = '/salesComps/getComparables';
        postDataToServer(url, _dataobj)
            .then(function (result) {
                deferred.resolve(result);

            }, function (result) {
                deferred.reject(result);
                //console.log(result);
            });
        return deferred.promise;
    };


    function deleteCompsFromProperty(_data) {
        //var propId = parseInt(localStorage.getItem('propertyId'));
        var url = '/salesComps/deleteCompsFromProperty';
        //var _dataobj = {
        //    "propertyId": propId,
        //    "data": _data
        //}
        var deferred = $q.defer();
        //var url = '/salesComps/getComparables';
        postDataToServer(url, _data)
            .then(function (result) {
                deferred.resolve(result);

            }, function (result) {
                deferred.reject(result);
                //console.log(result);
            });
        return deferred.promise;
    };


    return {
        saveComparablesToProperties: saveComparablesToProperties,
        deleteComparables: deleteComparables,
        getComparables: getComparables,
        saveSubjectPropertyUpdatedData: saveSubjectPropertyUpdatedData,
        getSavedComps: getSavedComps,
        deleteCompsFromProperty: deleteCompsFromProperty
    };

}

/***/ }),
/* 222 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


_ComparableUtil.$inject = [];
module.exports = _ComparableUtil;

//angular.module('AOTC')
//    .service('ComparableUtil', _ComparableUtil
//    );

function _ComparableUtil() {

    var formula1 = function (val1) {
        ////console.log(val1);
    };

    var Util = {};

    Util.sample = function () {

    };


    return {
        Util: Util
    };

}


/***/ }),
/* 223 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


//var angular = require('angular');

////components
//contract-editor
angular.module('AOTC').component('contractEditor', __webpack_require__(94).contractEditor);
angular.module('AOTC').directive('ckEditor', __webpack_require__(94).directiveFunction);

angular.module('AOTC').factory('newContractService', __webpack_require__(224));

//contract-terms
angular.module('AOTC').component('contractTerms', __webpack_require__(225));
angular.module('AOTC').factory('newContractTermsService', __webpack_require__(226));


//sample-calculations
angular.module('AOTC').component('viewSampleCalculations', __webpack_require__(227));
angular.module('AOTC').service('SampleCalculationService', __webpack_require__(228));


//contract-CKEditor
angular.module('AOTC').controller('ContractTest', __webpack_require__(229));

//contract-wizard
angular.module('AOTC').controller('ContractWizardCtrl', __webpack_require__(230));


//InvoiceList
angular.module('AOTC').controller('InvoiceList', __webpack_require__(231));
angular.module('AOTC').factory('InvoiceListService', __webpack_require__(232));


//NewInvoice
angular.module('AOTC').controller('NewInvoice', __webpack_require__(233));
angular.module('AOTC').factory('NewInvoiceService', __webpack_require__(234));


//SavedContractList
angular.module('AOTC').controller('SavedContractList', __webpack_require__(235));
angular.module('AOTC').factory('SavedContractListService', __webpack_require__(236));


//tabs-viewer
angular.module('AOTC').controller('Contract', __webpack_require__(237));

/***/ }),
/* 224 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


_newContractService.$inject = ["$http", "AOTCService", "$q"];
module.exports = _newContractService;

function _newContractService($http, AOTCService, $q) {
    var financialAndNonFinancialTerms = [];
    var financialTermsAdded = [];
    var dataContent = '';

    function getFinancialAndNonFinancialTerms() {
        return financialAndNonFinancialTerms;
    }

    function setFinancialAndNonFinancialTerms(terms) {
        financialAndNonFinancialTerms = terms;
    }


    function getFinancialTermsAdded() {
        return financialTermsAdded;
    }


    function setFinancialTermsAdded(terms) {
        financialTermsAdded = terms;
    }




    function getContracts() {

        var url = '/contracts/getContracts';
        var defer = $q.defer();

        AOTCService.getDataFromServer(url).
        then(function (result) {
            defer.resolve(result.data);
        }, function (err) {
            defer.reject(err);
        });

        return defer.promise;
    }


    function uploadContractsFiles(files) {

        var url = '/contracts/uploadContracts';

        var defer = $q.defer();
        AOTCService.uploadFiles(url, files).
        then(function (result) {
            defer.resolve(result);
        }, function (err) {
            defer.reject(err);
        });

        return defer.promise;
    }

    function addContractTemplate(data) {

        var url = '/contracts/addContractTemplate';
        var defer = $q.defer();

        AOTCService.postDataToServer(url, data).
        then(function (result) {
            defer.resolve(result.data);
        }, function (err) {
            defer.reject(err);
        });

        return defer.promise;
    }


    function addContract(data) {

        var url = '/contracts/addContract';
        var defer = $q.defer();

        AOTCService.postDataToServer(url, data).
        then(function (result) {
            defer.resolve(result.data);
        }, function (err) {
            defer.reject(err);
        });

        return defer.promise;
    }
    ///to be used to fetch saved contracts
    var savedContracts = {};
    //called from SavedContractListController
    function saveContractData(_data) {
        angular.forEach(_data, function (_item) {
            savedContracts[_item.id] = _item.contracts;
        });

    };
    //called from ContractEditorComponent
    function getContractData(_id) {
        if (!_id) return undefined;
        return savedContracts[_id];
    }
    var contractDataByUserId = {};
    function getContractsByUserId(_id) {
        var url = '/contracts/getContractsById';
        var defer = $q.defer();
        var _data = {
            "contractId": parseInt(_id)
        };
        AOTCService.postDataToServer(url, _data).
        then(function (result) {
            defer.resolve(result.data);
        }, function (err) {
            defer.reject(err);
        });

        return defer.promise;
    }

    return {
        addContract: addContract,
        getFinancialTermsAdded: getFinancialTermsAdded,
        setFinancialTermsAdded: setFinancialTermsAdded,
        getFinancialAndNonFinancialTerms: getFinancialAndNonFinancialTerms,
        setFinancialAndNonFinancialTerms: setFinancialAndNonFinancialTerms,
        getContracts: getContracts,
        uploadContractsFiles: uploadContractsFiles,
        addContractTemplate: addContractTemplate,
        saveContractData: saveContractData,
        getContractData: getContractData,
        getContractsByUserId: getContractsByUserId,
        contractDataByUserId: contractDataByUserId

    };

}





/***/ }),
/* 225 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {




var _contractTerms = {
    templateUrl: 'modules/ContractModule/components/contract-terms/contract-terms.html',
    controllerAs: 'ContractTerms',
    controller: ["$scope", "newContractService", "newContractTermsService", "$timeout", "$stateParams", "$rootScope", controllerFunction]
    //end of component
};
//angular.module('AOTC')
//    .component('contractTerms', _contractTerms);

module.exports = _contractTerms;
function controllerFunction($scope, newContractService, newContractTermsService, $timeout, $stateParams, $rootScope) {
    console.log('contract-terms component');

    $scope.financialAndNonFinancialTerms = [];
    $scope.financialTermsAdded = [];
    $scope.financialTerms = [];
    $scope.nonFinancialTerms = [];
    $scope.preAppealValue = 16100000 * 0.01980;
    $scope.postAppealValue = 15761567 * 0.01980;

    $scope.contractId = $stateParams.id || null;
    $scope.IsViewMode = $stateParams.id ? true : false;

    $scope.preAppealValue = parseFloat($scope.preAppealValue).toFixed(2);
    $scope.postAppealValue = parseFloat($scope.postAppealValue).toFixed(2);

    $scope.netTaxSavingsGlobal = parseFloat($scope.preAppealValue - $scope.postAppealValue).toFixed(2);

    $scope.$on('contractDataByUserId-added', function () {
        try {

            $scope.financialAndNonFinancialTerms = newContractService.contractDataByUserId.nonFinancialTerms;
        }
        catch (_e) { }
    });



    getFinancialTerms();

    function getFinancialTerms() {
        $scope.financialTerms = [];
        $scope.nonFinancialTerms = [];
        $('#preloader').css('display', 'block');
        newContractTermsService.getContractTerms()
            .then(function (response) {
                $('#preloader').css('display', 'none');
                console.log(response);
                if (!response.success) {
                    return;
                }
                var terms = response.result;

                for (var i = 0; i < terms.length; i++) {

                    if (terms[i].type == 'fc') {
                        $scope.financialTerms.push(terms[i])
                    } else if (terms[i].type == 'nfc') {
                        $scope.nonFinancialTerms.push(terms[i])
                    }
                }

            }, function (err) {
                $('#preloader').css('display', 'none');
                console.log(err);
            });
    }

    $scope.AcceptTerms = function () {
        newContractService.setFinancialAndNonFinancialTerms($scope.financialAndNonFinancialTerms);
        $scope.$emit('financialAndNonFinancialTerms', []);
    }


    $scope.addTerm = function (term, type) {

        if (!term.state) {

            for (var i = 0; i < $scope.financialAndNonFinancialTerms.length; i++) {
                if ($scope.financialAndNonFinancialTerms[i].label == term.label) {
                    $scope.financialAndNonFinancialTerms.splice(i, 1);
                }
            }

            for (var i = 0; i < $scope.financialTermsAdded.length; i++) {
                if ($scope.financialTermsAdded[i].label == term.label) {
                    $scope.financialTermsAdded.splice(i, 1);
                    calculateTotalFee();
                }
            }

        } else {

            $scope.financialAndNonFinancialTerms.push(angular.copy(term));
            if (type == 'financialTerms') {
                term.rowspan = 1;

                if (term.hasLevels) {
                    term.rowspan = term.value.length + 1;
                }

                $scope.CalculateFee(term);
                $scope.financialTermsAdded.push(angular.copy(term));
                calculateTotalFee();
            }

        }

    }


    // $scope.parseJson = function(financialTerm) {

    //     if ( !financialTerm.columns.feePercentage && !financialTerm.columns.netTaxSavings)
    //         financialTerm.calculatedFee = parseInt(financialTerm.value.match(/\d/g).join(""));

    //      // if (!financialTerm.columns.numberOfProperties && !financialTerm.columns.feePercentage && !financialTerm.columns.netTaxSavings)
    //      //    financialTerm.calculatedFee = parseInt(financialTerm.value.match(/\d/g).join(""));

    //     calculateTotalFee();
    // }

    $scope.submitAddUpdateTerm = function (term) {
        if ($scope.addingNewTerm) {
            addNewTerm(term)
        } else {
            updateTerm(term)
        }
    }

    $scope.addingNewTerm = false;

    $scope.showUpdateTerm = function (term) {
        $scope.addingNewTerm = false;

        $scope.newTerm = term;
        try {
            $scope.newTerm.columns = JSON.parse($scope.newTerm.columns);

        } catch (ex) {
            // console.log('already parsed')
        }
        console.log($scope.newTerm);
        $scope.numberOfLevels = 0;
        if ($scope.newTerm.hasLevels) {
            $scope.numberOfLevels = $scope.newTerm.value.length;
        }

        if (term.type == 'nfc') {
            $scope.newTermLabel = 'Update Non-Financial Contract Term';


        }
        if (term.type == 'fc') {
            $scope.newTermLabel = 'Update Financial Contract Term';

        }
        $('#newTerm').modal('toggle');

    }


    function updateTerm(term) {
        // newTerm.columns = JSON.stringify(newTerm.columns);

        var newTerm = angular.copy(term);
        newTerm.columns = JSON.stringify(newTerm.columns);
        if (newTerm.hasLevels)
            newTerm.value = JSON.stringify(newTerm.value);




        $('#preloader').css('display', 'block');
        newContractTermsService.updateContractTerms(newTerm)
            .then(function (response) {
                $('#preloader').css('display', 'none');
                console.log(response);
                if (!response.success) {
                    $scope.$emit('danger', response.message);
                    return;
                }
                $scope.$emit('success', response.message);
                $('#newTerm').modal('toggle');
                getFinancialTerms();



            }, function (err) {
                $('#preloader').css('display', 'none');
                console.log(err);
            });

    }


    $scope.NumberOfLevels = function (newTerm, numberOflevels) {

        if (newTerm.value.constructor != Array)
            newTerm.value = [];

        var existingLevels = newTerm.value.length;

        if (existingLevels < numberOflevels) {
            for (var i = 0; i < numberOflevels - existingLevels; i++) {
                newTerm.value.push({
                    label: '',
                    value: ''
                });
            }
        } else {
            newTerm.value.splice(numberOflevels, newTerm.value.length)
        }
    }


    $scope.defaultLevelNumbers = function (newTerm) {
        newTerm.value = '';

        if (newTerm.hasLevels) {
            newTerm.value = [];
        }
    }

    $scope.showAddTermModal = function (termType) {
        $scope.addingNewTerm = true;
        $scope.numberOfLevels = 0;

        // $scope.newTerm = {
        //     label: '',
        //     value: '',
        //     hasLevels: false,
        //     type: termType,
        //     columns: {
        //         numberOfProperties: false,
        //         feePercentage: false,
        //         netTaxSavings: false
        //     }
        // };


        $scope.newTerm = {
            label: '',
            value: '',
            hasLevels: false,
            type: termType,
            columns: {
                feePercentage: false,
                netTaxSavings: false
            }
        };


        if (termType == 'nfc') {
            $scope.newTermLabel = 'New Non-Financial Contract Term';


        }
        if (termType == 'fc') {
            $scope.newTermLabel = 'New Financial Contract Term';

        }
        $('#newTerm').modal('toggle');
    }

    function addNewTerm(term) {

        var newTerm = angular.copy(term);
        newTerm.columns = JSON.stringify(newTerm.columns);
        if (newTerm.hasLevels)
            newTerm.value = JSON.stringify(newTerm.value);


        // console.log(newTerm)

        $('#preloader').css('display', 'block');
        newContractTermsService.addContractTerms(newTerm)
            .then(function (response) {

                $('#preloader').css('display', 'none');
                console.log(response);
                if (!response.success) {
                    $scope.$emit('danger', response.message);
                    return;
                }
                $scope.$emit('success', response.message);
                $('#newTerm').modal('toggle');
                getFinancialTerms();

            }, function (err) {
                $('#preloader').css('display', 'none');
                console.log(err);
            });

    }



    $scope.removeFinancialTerm = function (index) {
        $scope.financialTermsAdded.splice(index, 1);
        calculateTotalFee();
    }

    function isNumeric(n) {
        return !isNaN(parseFloat(n)) && isFinite(n);
    }

    $scope.CalculateFee = function (financialTerm) {
        console.log(financialTerm)

        if (financialTerm.hasLevels) {

            for (var i = 0; i < financialTerm.value.length; i++) {
                var result = 1;
                var level = financialTerm.value[i];
                var value = parseInt(level.value.match(/\d/g).join(""));

                if (!isNumeric(value))
                    value = 1;


                if (!isNumeric(netTax))
                    netTax = 1;


                if (financialTerm.columns.feePercentage) {
                    result = result * (value / 100);
                }

                if (financialTerm.columns.netTaxSavings) {
                    result = result * $scope.netTaxSavingsGlobal;
                }


                financialTerm.value[i].calculatedFee = parseFloat(result).toFixed(2);
            }

        } else {
            var result = 1;

            var value = parseInt(financialTerm.value.match(/\d/g).join(""));
            var netTax = parseInt(financialTerm.netTax);



            if (!isNumeric(value))
                value = 1;

            if (!isNumeric(netTax))
                netTax = 1;


            if (financialTerm.columns.feePercentage) {
                result = result * (value / 100);
            }

            if (financialTerm.columns.netTaxSavings) {
                result = result * $scope.netTaxSavingsGlobal;
            }


            financialTerm.calculatedFee = result;

            if (!financialTerm.columns.feePercentage && !financialTerm.columns.netTaxSavings)
                financialTerm.calculatedFee = value;

            // if(!financialTerm.columns.feePercentage && !financialTerm.columns.netTaxSavings && financialTerm.columns.numberOfProperties)
            // financialTerm.calculatedFee = value*numberOfProperties;


        }

    }

    $scope.totalFee = 0;

    function calculateTotalFee() {
        $scope.totalFee = 0;
        for (var i = 0; i < $scope.financialTermsAdded.length; i++) {

            // if (isNumeric($scope.financialTermsAdded[i].calculatedFee)) {
            // $scope.totalFee += $scope.financialTermsAdded[i].calculatedFee;
            // }

            if ($scope.financialTermsAdded[i].hasLevels) {

                for (var k = 0; k < $scope.financialTermsAdded[i].value.length; k++) {
                    console.log($scope.financialTermsAdded[i]);
                    $scope.totalFee += parseFloat($scope.financialTermsAdded[i].value[k].calculatedFee);

                    // if (isNumeric($scope.financialTermsAdded[i].value[k].calculatedFee)) {
                    //     $scope.totalFee += $scope.financialTermsAdded[i].value[k].calculatedFee;
                    // }
                }

            }
            else {
                $scope.totalFee += $scope.financialTermsAdded[i].calculatedFee;
            }
        }


        $scope.totalFee = parseFloat($scope.totalFee).toFixed(2);

    }


}
/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 226 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


_newContractTermsService.$inject = ["$http", "AOTCService", "$q"];
module.exports = _newContractTermsService;

//angular.module('AOTC')
//    .factory('newContractTermsService', _newContractTermsService
//   );

function _newContractTermsService($http, AOTCService, $q) {

    function getContractTerms(data) {

        var url = '/contracts/getContractTerms';
        var defer = $q.defer();

        AOTCService.getDataFromServer(url).
        then(function (result) {
            defer.resolve(result.data);
        }, function (err) {
            defer.reject(err);
        });

        return defer.promise;
    }


    function addContractTerms(data) {

        var url = '/contracts/addContractTerms';
        var defer = $q.defer();

        AOTCService.postDataToServer(url, data).
        then(function (result) {
            defer.resolve(result.data);
        }, function (err) {
            defer.reject(err);
        });

        return defer.promise;
    }

    function updateContractTerms(data) {
        //
        var url = '/contracts/updateContractTerms';
        var defer = $q.defer();

        AOTCService.postDataToServer(url, data).
        then(function (result) {
            defer.resolve(result.data);
        }, function (err) {
            defer.reject(err);
        });

        return defer.promise;
    }





    return {
        updateContractTerms: updateContractTerms,
        getContractTerms: getContractTerms,
        addContractTerms: addContractTerms

    };

}

/***/ }),
/* 227 */
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function($) {var _viewSampleCalculations = {
    templateUrl: 'modules/ContractModule/components/sample-calculations/sample-calculations.component.html',
    controllerAs: 'sampleCalculationsCtrl',
    controller: ["$scope", "SampleCalculationService", "$timeout", "$stateParams", "PrivatePropertyService", "newContractService",

        function ($scope, SampleCalculationService, $timeout, $stateParams, PrivatePropertyService, newContractService) {

            var vm = $scope
            var selectedPropertyList = PrivatePropertyService.selectedPropertyList;
            var originalValue = {};
            var validatedata = 0;

            vm.getPropertyList = {}
            vm.setPercentages = 0;
            vm.selectAll = false;
            vm.scheduleFee = {};
            vm.calaculatedData = [];
            vm.feeType = "three";
            vm.totalFee = 0;
            vm.styleSet = { color: 'gray', cursor: 'not-allowed' };
            vm.lockFee = '';
            vm.totalAmount = 0;
            vm.totaltaxSaving = 0;
            vm.IsViewMode = $stateParams.id ? false : true;
            vm.taxRate = 0;

            $scope.$on('contractDataByUserId-added', function () {
                //try {

                initScheduleFee();
                vm.calaculatedData = newContractService.contractDataByUserId.financialTerms;
                console.log(newContractService.contractDataByUserId);
                if (vm.calaculatedData[0].fee.feeType != "fixed") {
                    for (var i = 0; i < vm.calaculatedData.length; i++) {
                        console.log(i)
                        data = vm.calaculatedData[i];
                        data.assessment.valueReduction1 = data.assessment.newAssessorValue[0] - data.assessment.postAppeal1[0];
                        data.assessment.valueReduction2 = data.assessment.postAppeal1[0] - data.assessment.postAppeal2[0];
                        data.assessment.valueReduction = data.assessment.newAssessorValue[0] - data.assessment.postAppeal2[0];

                        if (data.fee.feeType === 'fixedPerProperty') {
                            data.assessment.fee = data.fee.fee;
                            data.assessment.feePercent = data.assessment.fee / data.assessment.valueReduction * data.assessment.taxRate[0] / 100;
                            vm.totalAmount += data.assessment.fee;
                            vm.totalWeightage += (data.assessment.feePercent * 100);
                            vm.totaltaxSaving += data.assessment.valueReduction * (data.assessment.taxRate[0] / 100)
                            data.assessment.fixedRate = data.fee.fee;
                        }
                        else if (data.fee.feeType === 'percentage') {
                            console.log(data)
                            var appealMerit1 = data.fee.meritLevel[0] / 100;
                            var appealMerit2 = data.fee.meritLevel[1] / 100;
                            var level1 = data.assessment.valueReduction1 * appealMerit1 * (data.assessment.taxRate[0] / 100);
                            var level2 = data.assessment.valueReduction2 * appealMerit2 * (data.assessment.taxRate[0] / 100);
                            data.assessment.feePercent = 0;
                            data.assessment.fee = level1 + level2;
                            data.assessment.feePercent = data.assessment.fee / (data.assessment.valueReduction * (data.assessment.taxRate[0] / 100));
                            console.log(data.assessment.feePercent)
                            vm.totalAmount += data.assessment.fee;
                            data.assessment.fixedRate = 0;
                            vm.totaltaxSaving += data.assessment.valueReduction * (data.assessment.taxRate[0] / 100)


                        }
                        else if (data.fee.feeType === 'fp') {
                            console.log(data)
                            data.assessment.valueReduction1 = data.assessment.newAssessorValue[0] - data.assessment.postAppeal1[0];
                            data.assessment.valueReduction2 = data.assessment.postAppeal1[0] - data.assessment.postAppeal2[0];
                            data.assessment.valueReduction = data.assessment.newAssessorValue[0] - data.assessment.postAppeal2[0];
                            var appealMerit1 = data.fee.meritLevel[0] / 100;
                            var appealMerit2 = data.fee.meritLevel[1] / 100;
                            var level1 = data.assessment.valueReduction1 * appealMerit1 * data.assessment.taxRate[0] / 100;
                            var level2 = data.assessment.valueReduction2 * appealMerit2 * data.assessment.taxRate[0] / 100;
                            data.assessment.fixedRate = data.fee.fixedRate;
                            data.assessment.fee = level1 + level2;
                            data.assessment.fee += data.assessment.fixedRate;
                            data.assessment.feePercent = (data.assessment.fee) / (data.assessment.valueReduction * (data.assessment.taxRate[0] / 100));
                            data.disabled = true;
                            data.feeType = 4;
                            console.log(data.assessment.fixedRate);
                            vm.totalAmount += data.assessment.fee;
                            vm.totaltaxSaving += data.assessment.valueReduction * (data.assessment.taxRate[0] / 100)

                        }
                    }
                }
                else {
                    vm.fixedFeeData = vm.calaculatedData[0].fee
                    console.log(vm.fixedFeeData)
                }
            });




            SampleCalculationService.fct = vm.calaculatedData;
            SampleCalculationService.feeType = vm.feeType;
            SampleCalculationService.totalFee = vm.totalFee;


            vm.selectAllProperties = function () {
                var check = vm.selectAll;
                if (check) {
                    check = true;
                    var root = vm.getPropertyList.map(function (item, index) {
                        if (!item.disabled) {
                            item.check = true;
                            return item;
                        }
                    });
                }
                else {
                    check = false;
                    var root = vm.getPropertyList.map(function (item, index) {
                        if (!item.disabled) {
                            item.check = false;
                            return item;
                        }
                    })
                }
            };

            vm.selectSepicific = function (data) {
                if (!data.check) {
                    data.check = false;
                }
                else {
                    data.check = true;
                }
            };

            vm.calculateSampleData = function () {
                var data = vm.getPropertyList;

                if (vm.feeType === 'three') {
                    clientContengancyFee(data);
                    vm.lockFee = 'two';
                }
                else if (vm.feeType === 'two') {
                    fixedPerProperty(data);
                    vm.lockFee = 'two';

                }
                else if (vm.feeType === 'four') {
                    both(data);
                    vm.lockFee = 'two';

                }
                else {
                    vm.lockFee = 'one';
                    vm.calaculatedData = [];
                    var root = vm.getPropertyList.map(function (item, index) {
                        if (!item.disabled) {
                            validatedata = 1;
                            item.check = true;
                            item.disabled = true;
                            return item;
                        }
                    });
                }

            };

            vm.selectFeeType = function (value) {
                vm.feeType = value;
                SampleCalculationService.feeType = vm.feeType;

            };

            vm.totalFeeChange = function (data) {
                vm.totalFee = data;
                SampleCalculationService.totalFee = vm.totalFee;

            };

            vm.ResetDatSet = function () {
                vm.selectAll = false;
                vm.calaculatedData = [];
                vm.getPropertyList = {};
                vm.getPropertyList = angular.copy(originalValue);
                vm.feeType = "three";
                vm.lockFee = '';
                vm.totalAmount = 0;
                vm.totaltaxSaving = 0;
            };

            vm.postData = function () {

            };


            getPropertyDetails();
            initScheduleFee();

            function getPropertyDetails() {
                var data = { propIds: selectedPropertyList, year: 2017 };
                SampleCalculationService.getPropertyDetails(data)
                    .then(function (result) {
                        originalValue = angular.copy(result.data.result);
                        vm.getPropertyList = result.data.result;
                        

                        $("#preloader").css("display", "none");

                    }, function (result) {
                        console.log(result);
                        $("#preloader").css("display", "none");
                    });
            }

            function initScheduleFee() {
                vm.scheduleFee = {
                    poor: { level1: 25, level2: 25, level3: 25 },
                    good: { level1: 15, level2: 20, level3: 25 },
                    vgood: { level1: 10, level2: 15, level3: 20 }
                };
            }

            function selectFee(merit, level) {
                var fee = vm.scheduleFee;
                return fee[merit][level] / 100;
            }

            function fixedCalculation(data) {

            }

            function fixedPerProperty(data) {
                angular.forEach(data, function (value, key) {
                    if (!value.disabled && value.check) {
                        validatedata = 1;
                        value.assessment.valueReduction1 = value.assessment.newAssessorValue[0] - value.assessment.postAppeal1[0];
                        value.assessment.valueReduction2 = value.assessment.postAppeal1[0] - value.assessment.postAppeal2[0];
                        value.assessment.valueReduction = value.assessment.newAssessorValue[0] - value.assessment.postAppeal2[0];
                        value.assessment.fee = value.assessment.fixedRate;
                        value.assessment.feePercent = value.assessment.fee / (value.assessment.valueReduction * (value.assessment.taxRate[0] / 100));
                        console.log(value.assessment.feePercent)
                        value.disabled = true;
                        value.feeType = 2;
                        vm.totalAmount += value.assessment.fee;
                        vm.totaltaxSaving += value.assessment.valueReduction * (value.assessment.taxRate[0] / 100);
                        vm.taxRate = value.assessment.taxRate[0];
                        vm.calaculatedData.push(value);

                        console.log(vm.totaltaxSaving)
                    }
                });
            }

            function clientContengancyFee(data) {
                angular.forEach(data, function (value, key) {
                    if (!value.disabled && value.check) {
                        validatedata = 1;
                        value.meritLevel = addMerit(value.assessment.appealMerit[0]);
                        console.log(value.meritLevel)
                        value.assessment.valueReduction1 = value.assessment.newAssessorValue[0] - value.assessment.postAppeal1[0];
                        value.assessment.valueReduction2 = value.assessment.postAppeal1[0] - value.assessment.postAppeal2[0];
                        value.assessment.valueReduction = value.assessment.newAssessorValue[0] - value.assessment.postAppeal2[0];
                        var appealMerit1 = selectFee(value.assessment.appealMerit[0], "level1");
                        var appealMerit2 = selectFee(value.assessment.appealMerit[0], "level2");
                        value.assessment.fixedRate = 0;
                        var level1 = value.assessment.valueReduction1 * appealMerit1 * (value.assessment.taxRate[0] / 100);
                        var level2 = value.assessment.valueReduction2 * appealMerit2 * (value.assessment.taxRate[0] / 100);
                        value.assessment.fee = level1 + level2;
                        value.assessment.feePercent = (value.assessment.fee) / (value.assessment.valueReduction * (value.assessment.taxRate[0] / 100));
                        console.log(value.assessment.feePercent)
                        value.disabled = true;
                        value.feeType = 3;
                        vm.totalAmount += value.assessment.fee;
                        vm.totaltaxSaving += value.assessment.valueReduction * (value.assessment.taxRate[0] / 100);
                        vm.calaculatedData.push(value);
                    }
                });
            }

            function both(data) {
                angular.forEach(data, function (value, key) {
                    if (!value.disabled && value.check) {
                        validatedata = 1;

                        value.meritLevel = addMerit(value.assessment.appealMerit[0]);
                        console.log(value)
                        value.assessment.valueReduction1 = value.assessment.newAssessorValue[0] - value.assessment.postAppeal1[0];
                        value.assessment.valueReduction2 = value.assessment.postAppeal1[0] - value.assessment.postAppeal2[0];
                        value.assessment.valueReduction = value.assessment.newAssessorValue[0] - value.assessment.postAppeal2[0];
                        var appealMerit1 = selectFee(value.assessment.appealMerit[0], "level1");
                        var appealMerit2 = selectFee(value.assessment.appealMerit[0], "level2");
                        var level1 = value.assessment.valueReduction1 * appealMerit1 * value.assessment.taxRate[0] / 100;
                        var level2 = value.assessment.valueReduction2 * appealMerit2 * value.assessment.taxRate[0] / 100;
                        value.assessment.fixedRate = value.assessment.fixedRate;
                        value.assessment.fee = level1 + level2;
                        value.assessment.fee += value.assessment.fixedRate;
                        value.assessment.feePercent = (value.assessment.fee) / (value.assessment.valueReduction * (value.assessment.taxRate[0] / 100));
                        value.disabled = true;
                        value.feeType = 4;
                        console.log(value.assessment.fixedRate);
                        vm.totalAmount += value.assessment.fee;
                        vm.totaltaxSaving += value.assessment.valueReduction * (value.assessment.taxRate[0] / 100);
                        vm.calaculatedData.push(value);
                    }
                });

            }

            function addMerit(data) {
                console.log(data)
                if (data === 'poor') {
                    return [vm.scheduleFee.poor.level1, vm.scheduleFee.poor.level2, vm.scheduleFee.poor.level3]
                }

                else if (data === 'vgood') {
                    return [vm.scheduleFee.vgood.level1, vm.scheduleFee.vgood.level3, vm.scheduleFee.vgood.level3]

                }
                else {
                    return good = [vm.scheduleFee.good.level1, vm.scheduleFee.good.level2, vm.scheduleFee.good.level3]

                }

            };

            function selectedCriteria(data, level) {
                if (data.meritLevel === 'good') {

                    return data[data.meritLevel][level]

                }
                else if (data.meritLevel === 'vgood') {
                    return data[data.meritLevel][level]

                }
                else {
                    return data[data.meritLevel][level]

                }

            }


            function getFinancialTerms() {
                $scope.financialTerms = [];

                $('#preloader').css('display', 'block');
                newContractTermsService.getContractTerms()
                    .then(function (response) {
                        $('#preloader').css('display', 'none');
                        console.log(response);
                        if (!response.success) {
                            return;
                        }
                        var terms = response.result;
                        $scope.financialTerms = terms;
                        console.log(terms)
                        for (var i = 0; i < terms.length; i++) {

                            if (terms[i].type == 'fc') {
                                $scope.financialTerms.push(terms[i])
                            }
                        }

                    }, function (err) {
                        $('#preloader').css('display', 'none');
                        console.log(err);
                    });
            }


        }]
}

module.exports = _viewSampleCalculations;

//angular
//    .module('AOTC')
//    .component('viewSampleCalculations', _viewSampleCalculations
//   );


/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 228 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


_SampleCalculationService.$inject = ["$q", "AOTCService"];
module.exports = _SampleCalculationService;

//angular.module('AOTC')
//    .service('SampleCalculationService', _SampleCalculationService
//    );
function _SampleCalculationService($q, AOTCService) {
    var fct = [];
    var feeType = '';
    var totalFee = 0;

    function getPropertyDetails(data) {
        //console.log(data)
        // var url = '/surveys/getSurveyById?id='+da;
        var url = '/contracts/getDataforSampleCalculations';
        var deferred = $q.defer();

        AOTCService.postDataToServer(url, data)
            .then(function (result) {
                deferred.resolve(result);

            }, function (result) {
                deferred.reject(result);
                //console.log(result);
            });
        return deferred.promise;

    };



    return {
        getPropertyDetails: getPropertyDetails
    };
}


/***/ }),
/* 229 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {

_ContractTest.$inject = ["$scope", "$location", "$location", "$state", "UtilService"];
module.exports = { ContractTest: _ContractTest, ckEditor: _ckEditor };

//angular.module('AOTC')
//    .controller('ContractTest',_ContractTest
//    )

//.directive('ckEditor', _ckEditor
//    );

function _ContractTest($scope, $location, $state, UtilService) {
    ////console.log("ContractTest");

    $scope.checkValues = function () {
        ////console.log(
         //   $scope.content
       // );
    }

    $scope.content = '<strong>Some Content</strong>';
    var articles = [
        { name: 'Clause 1' },
        { name: 'Clause 2' },
        { name: 'Clause 3' },
        { name: 'Clause 4' },
        { name: 'Clause 5' },
        { name: 'Clause 6' },
        { name: 'Clause 7' },
        { name: 'Clause 8' },
        { name: 'Clause 9' },
        { name: 'Clause 10' }
    ];

    $scope.articles = articles;

    $scope.options = {
        language: 'en',
        allowedContent: true,
        entities: false
    };

    $scope.clearFile = function () {
        UtilService.clearFile();
    };

    $scope.onReady = function () {
        ////console.log('done I am ready')

    };

    $scope.fileUploaded = function () {

        $scope.FileNames = [];
        var files = document.getElementById('file-1').files;
        $scope.fileData = files;

        for (var i = 0; i < files.length; i++) {
            $scope.FileNames.push({
                name: files[i].name
            });
        }

        ////console.log($scope.FileNames)
        ////console.log($scope.fileData)

        // Parsing is done. Update UI.
        $scope.$apply();
        $('#uploadedContracts').modal('toggle');
    }

    $scope.uploadSelectedFiles = function () {

        ////console.log($scope.FileNames)
        ////console.log($scope.fileData)

    }







    //end of controller
}


function _ckEditor() {
    return {
        require: '?ngModel',
        link: function (scope, elm, attr, ngModel) {
            var config = {
                allowedContent: true,
                height: 450
                // toolbar: [
                // 	   {name: 'clipboard',   groups: [ 'clipboard', 'undo' ] , items: [ 'Cut', 'Copy', 'Paste', 'PasteText', 'PasteFromWord', '-', 'Undo', 'Redo' ] },
                //     {name: 'basicstyles', items: ['Bold', 'Italic', 'Underline', '-', 'RemoveFormat']},
                //     {name: 'paragraph', items: ['NumberedList', 'BulletedList', '-', 'Outdent', 'Indent']},
                //     {name: 'text-align', items: ['JustifyLeft', 'JustifyCenter', 'JustifyRight', 'JustifyBlock']},
                //     {name: 'styles', items: ['Font', 'FontSize']},
                //     {name: 'colors', items: ['TextColor', 'BGColor']},
                //     {name: 'tools', items: ['Table', 'HorizontalRule', 'Maximize']},
                // ]
            };

            // elm[0].setAttribute('contenteditable', true);
            var ck = window.CKEDITOR.replace(elm[0], config);

            if (!ngModel) return;

            CKEDITOR.on('instanceReady', function () {
                ////console.log('instanceReady')

                ck.setData(ngModel.$viewValue);


                CKEDITOR.document.getById('contactList').on('dragstart', function (evt) {

                    var target = evt.data.getTarget().getAscendant('div', true);
                    CKEDITOR.plugins.clipboard.initDragDataTransfer(evt);

                    var dataTransfer = evt.data.dataTransfer;
                    // ////console.log('data is => ', target.data('contact'))
                    // ////console.log('data is => ', CONTACTS[target.data('contact')])

                    // dataTransfer.setData('contact', CONTACTS[target.data('contact')]);
                    dataTransfer.setData('text/html', target.getText());


                });



                CKEDITOR.document.getById('contactList2').on('dragstart', function (evt) {
                    var target = evt.data.getTarget().getAscendant('div', true);
                    CKEDITOR.plugins.clipboard.initDragDataTransfer(evt);

                    var dataTransfer = evt.data.dataTransfer;
                    // ////console.log('data is => ', target.data('contact'))
                    // ////console.log('data is => ', CONTACTS[target.data('contact')])

                    dataTransfer.setData('contact', CONTACTS[target.data('contact')]);
                    dataTransfer.setData('text/html', target.getText());


                });

            });

            ngModel.$render = function () {
                ////console.log("render");

                ck.setData(ngModel.$viewValue);
            };

            ck.on('change', updateModel);
            ck.on('key', updateModel);
            ck.on('dataReady', updateModel);

            ck.on('dragstart', function (evt) {
                ////console.log("dragstart");
            });

            ck.on('dragenter', function (evt) {
                ////console.log("dragenter");
            });

            ck.on('dragover', function (evt) {
                ////console.log("dragover");
            });



            function updateModel() {
                ////console.log('updateModel')
                scope.$apply(function () {
                    ngModel.$setViewValue(ck.getData());
                });
            }

            var CONTACTS = [
                { name: 'Huckleberry Finn', tel: '+48 1345 234 235', email: 'h.finn@example.com', avatar: 'hfin' },
                { name: 'D\'Artagnan', tel: '+45 2345 234 235', email: 'dartagnan@example.com', avatar: 'dartagnan' },
                { name: 'Phileas Fogg', tel: '+44 3345 234 235', email: 'p.fogg@example.com', avatar: 'pfog' },
                { name: 'Alice', tel: '+20 4345 234 235', email: 'alice@example.com', avatar: 'alice' },
                { name: 'Little Red Riding Hood', tel: '+45 2345 234 235', email: 'lrrh@example.com', avatar: 'lrrh' },
                { name: 'Winnetou', tel: '+44 3345 234 235', email: 'winnetou@example.com', avatar: 'winetou' },
                { name: 'Edmond Dantès', tel: '+20 4345 234 235', email: 'count@example.com', avatar: 'edantes' },
                { name: 'Robinson Crusoe', tel: '+45 2345 234 235', email: 'r.crusoe@example.com', avatar: 'rcrusoe' }
            ];



            CKEDITOR.disableAutoInline = true;

            // Implements a simple widget that represents contact details (see http://microformats.org/wiki/h-card).
            CKEDITOR.plugins.add('hcard', {
                requires: 'widget',

                init: function (editor) {
                    ////console.log('init editor');

                    editor.widgets.add('hcard', {
                        allowedContent: 'span(!h-card); a[href](!u-email,!p-name); span(!p-tel)',
                        requiredContent: 'span(h-card)',
                        pathName: 'hcard',

                        upcast: function (el) {
                            return el.name == 'span' && el.hasClass('h-card');
                        }
                    });

                    // This feature does not have a button, so it needs to be registered manually.
                    editor.addFeature(editor.widgets.registered.hcard);

                    // Handle dropping a contact by transforming the contact object into HTML.
                    // Note: All pasted and dropped content is handled in one event - editor#paste.
                    editor.on('paste', function (evt) {
                        ////console.log('paste');
                        var contact = evt.data.dataTransfer.getData('contact');
                        if (!contact) {
                            return;
                        }

                        evt.data.dataValue =
                            '' +
                            '' + contact.name + '' +
                            ' ' +
                            '' + contact.tel + '' +
                            '';
                    });
                }
            });




        }
    };
}
/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 230 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


_ContractWizardCtrl.$inject = ["$scope", "$location", "$state"];
module.exports = {ContractWizardCtrl: _ContractWizardCtrl, mySortable: _mySortable, myDraggable: _myDraggable };

//angular.module('AOTC').controller('ContractWizardCtrl', _ContractWizardCtrl
//    )

//    .directive('mySortable', _mySortable
//    )

//    .directive('myDraggable', _myDraggable
//    );
function _ContractWizardCtrl($scope, $location, $state) {
    ////console.log("ContractWizardCtrl")

    $scope.options = 'Select Options'
    $scope.templateData = []

    $scope.models2 = {
        selected: null,
        lists: { "B": [] }
    };

    $scope.models = {
        selected: null,
        lists: []
    };


    $scope.addContract = function () {
        $scope.models.lists.unshift({
            "id": null, "editable": true, "name": "Section Name", "title": "Section Title", "label": "Section Label",
            "type": "Section Type", "text": "Section Data",
        })

        ////console.log($scope.models.lists);
    }

    $scope.selectOptions = function (index, data) {
        $scope.models.lists[index].type = data;
    };

    $scope.saveSingleContract = function (index, data) {
        var userid = localStorage.getItem('userId');
        data[index].editable = false;
        $scope.models.lists = data;
        $scope.saveAsTemplate(data);

    };

    $scope.editSingleContract = function (index, data) {
        var userid = localStorage.getItem('userId');
        data[index].editable = true;
        $scope.models.lists = data;
    };

    $scope.saveContract = function (data) {
        var userid = localStorage.getItem('userId');
        for (var i = 0; i < data.length; i++) {
            data[i].editable = false;
            ////console.log(data[i])
        }
        $scope.postContract = { id: null, userId: userid, contracts: data };
        $scope.models.lists = data;

        ////console.log("saving" + $scope.postContract);
    }

    $scope.editContract = function (data) {
        for (var i = 0; i < data.length; i++) {
            data[i].editable = true;
        }

    }

    $scope.saveAsTemplate = function (data) {
        ////console.log(data)
        for (var i = 0; i < $scope.templateData.length; i++) {
            if (!$scope.templateData[i]) {
                $scope.templateData[i] = data
            }
        }
        if ($scope.templateData.length == 0) {
            $scope.templateData = data
        }
    }


    $scope.index = 0;

    $scope.$on('my-sorted', function (ev, val) {
        $scope.models.lists.splice(val.to, 0, $scope.models.lists.splice(val.from, 1)[0]);
    })

    $scope.$on('my-created', function (ev, val) {
        ////console.log('draggable' + val.name)
        $scope.index = val.to
        $scope.models.lists.splice(val.to, 0, val.name);
        JSON.parse($scope.models.lists[val.to])

    })

}
function _myDraggable() {

    return {
        link: function (scope, el, attrs) {
            ////console.log('draggable')
            el.draggable({
                connectToSortable: attrs.myDraggable,
                helper: "clone",
                revert: "invalid"
            });
            el.disableSelection();
        }
    }

}
function _mySortable() {
    return {
        link: function (scope, el, attrs) {
            el.sortable({
                revert: true
            });
            el.disableSelection();
            ////console.log("p")

            el.on("sortdeactivate", function (event, ui) {
                var from = angular.element(ui.item).scope().$index;
                var to = el.children().index(ui.item);
                if (to >= 0) {
                    scope.$apply(function () {
                        if (from >= 0) {
                            scope.$emit('my-sorted', { from: from, to: to });
                        } else {
                            ////console.log("data---" + from)
                            scope.$emit('my-created', { to: to, "name": ui.item.text() });
                            ui.item.remove();
                        }
                    })
                }
            });
        }
    }
}


/***/ }),
/* 231 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


_InvoiceList.$inject = ["$scope", "$stateParams", "$location", "$state", "SampleCalculationService"];
module.exports = _InvoiceList;

//angular.module('AOTC').controller('InvoiceList', _InvoiceList
//    );
function _InvoiceList($scope, $stateParams, $location, $state, SampleCalculationService) {
    ////console.log("InvoiceList", $stateParams.id)

    $scope.gotoAddNewInvoice = function () {
        $state.go('NewInvoice', { id: $stateParams.id });
    }


}

/***/ }),
/* 232 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


_InvoiceListService.$inject = ["$http", "AOTCService", "$q"];
module.exports = _InvoiceListService;

//angular.module('AOTC')
//    .factory('InvoiceListService', _InvoiceListService

//    );
function _InvoiceListService($http, AOTCService, $q) {

    function updateContractTerms(data) {

        var url = '/contracts/updateContractTerms';
        var defer = $q.defer();

        AOTCService.postDataToServer(url, data).
        then(function (result) {
            defer.resolve(result.data);
        }, function (err) {
            defer.reject(err);
        });

        return defer.promise;
    }





    return {
        updateContractTerms: updateContractTerms,

    };

}

/***/ }),
/* 233 */
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function($) {

//var agGrid = require('agGrid');
_NewInvoice.$inject = ["$scope", "$stateParams", "$state", "NewInvoiceService", "$uibModal", "$timeout", "$filter"];
module.exports = _NewInvoice;

agGrid.initialiseAgGridWithAngular1(angular);
//angular.module('AOTC').controller('NewInvoice', _NewInvoice
//    );
function _NewInvoice($scope, $stateParams, $state, NewInvoiceService, $uibModal, $timeout, $filter) {
    //////console.log("NewInvoice");

    //Local Variables
    var $ctrl = this;

    //Ag Grid
    var columnDefs = [
        { headerName: "Original Base Value before Re-Assessment", field: "originalValue", width: 110, cellRenderer: numberFormatter, cellClass: 'right-align-text' },
        { headerName: "New Value as of Re-Assessment (Pre-Appeal)", field: "newValue", width: 110, cellRenderer: numberFormatter, cellClass: 'right-align-text' },
        { headerName: "Value post Level 1 Appeal (Assessor Appeal)", field: "postLevel1", width: 110, cellRenderer: numberFormatter, cellClass: 'right-align-text' },
        { headerName: "Value post Level 2 Appeal (Board Appeal)", field: "postLevel2", width: 110, cellRenderer: numberFormatter, cellClass: 'right-align-text' },
        { headerName: "Tax Rate", field: "taxRate", width: 80, cellRenderer: numberFormatter, cellClass: 'right-align-text', cellClass: 'right-align-text' },
        { headerName: "Fee %", field: "feePercent", width: 80, cellClass: 'right-align-text' },
        { headerName: "Tax Bill Due Date", field: "taxBillDate", width: 100 },
        //summation fields
        { headerName: "Tax Bill", field: "taxBill", width: 110, cellRenderer: numberFormatter , cellClass: 'right-align-text' },
        { headerName: "Less Solid Waste", field: "lessSolidWaste", width: 100, cellRenderer: numberFormatter , cellClass: 'right-align-text' },
        { headerName: "Water Quality Protect Chg", field: "waterQuality", width: 100, cellRenderer: numberFormatter , cellClass: 'right-align-text' },
        { headerName: "Net Bill", field: "netBill", width: 110, cellClass: 'right-align-text' },
        //table fields
        { headerName: "Taxes Owed (Pre-Appeal)", field: "taxPreAppeal", width: 100, cellRenderer: numberFormatter , cellClass: 'right-align-text' },
        { headerName: "Taxes Owed (Post Level 1 (Assessor))", field: "taxLevel1", width: 100, cellRenderer: numberFormatter , cellClass: 'right-align-text' },
        { headerName: "Taxes Owed (Post Level 1 (Board))", field: "taxLevel2", width: 100, cellRenderer: numberFormatter , cellClass: 'right-align-text' },
        { headerName: "Tax Savings (Level 1)", field: "taxSavingLevel1", width: 100, cellRenderer: numberFormatter , cellClass: 'right-align-text' },
        { headerName: "Tax Savings (Level 2)", field: "taxSavingLevel2", width: 100, cellRenderer: numberFormatter , cellClass: 'right-align-text' },
        { headerName: "Fee Owed", field: "feeOwed", width: 100, cellRenderer: numberFormatter , cellClass: 'right-align-text' }
    ];
    var rowData = [];

    var gridOptions = {
        columnDefs: columnDefs,
        rowData: rowData,
        headerHeight: 60,
        suppressCellSelection: true,
        enableColResize: true,
    };


    //Bindable Members
    $ctrl.invoiceData = {
        master: {},
        details: []
    };
    $ctrl.singlePropertyData = {};
    //$ctrl.openInvoice = openInvoice;
    $ctrl.toggleView = toggleView;
    $ctrl.showGrid = true;
    $ctrl.totalItems = 0;
    $ctrl.pageSize = 1;
    $ctrl.currentPage = 1;
    $ctrl.pageChanged = function (page) {
        page = page || $ctrl.currentPage || 1;
        $ctrl.currentPage = page || 1;
        getPaginationData($ctrl.invoiceData.details, page);
    };

    //Starting Logic
    var getData = function () {
        var _data = {
            "propIds": [24497, 24498],
            "year": 2017,
            "contractId": 29744
        };
        $('#preloader').css('display', 'block');
        NewInvoiceService.getInvoiceByContractId(_data).then(function (_res) {
            $('#preloader').css('display', 'none');
            try {
                $ctrl.invoiceData = _res.result;
                getPaginationData($ctrl.invoiceData.details, 1);
                $ctrl.singlePropertyData = $ctrl.invoiceData.details[0];
                $ctrl.totalItems = $ctrl.invoiceData.details.length;
                gridOptions.rowData = $ctrl.invoiceData.details;
                $timeout(function () {
                    var gridDiv = document.querySelector('#myGrid');
                    new agGrid.Grid(gridDiv, gridOptions);
                });
            }
            catch (_e) {
            }

        });
    }();




    // Function Definitions
    function numberFormatter(params) {
        return '$'+ $filter('number')(params.value, 1);
    }

    function getPaginationData(_data, _page) {
        $ctrl.singlePropertyData = _data[_page - 1];
        $ctrl.PageStartCount = ((parseInt(_page) - 1) * parseInt(1)) + 1;
        $ctrl.PageEndCount = ($ctrl.PageStartCount + _data.length) - 1;
    };

    function toggleView(_type) {
        try {
            switch (_type) {
                case 'detail':
                    $ctrl.showGrid = false;

                    break;
                case 'grid':
                    $ctrl.showGrid = true;
                    $timeout(function () {
                        var gridDiv = document.querySelector('#myGrid');
                        new agGrid.Grid(gridDiv, gridOptions);
                    });
                    break;

            }
        }
        catch (_e) { }
    };

    
    ////Modal Open for a Property
    //function openInvoice(size, parentSelector) {
    //    var modalInstance = $uibModal.open({
    //        animation: true,
    //        templateUrl: 'modules/ContractModule/NewInvoice/invoice-dialogue.html',
    //        controller: 'InvoiceDialogueController',
    //        backdrop: 'static',
    //        controllerAs: '$ctrl',
    //        size: 'lg',
    //        resolve: {
    //        }
    //    });

    //    modalInstance.result.then(function (selectedItem) {
    //    }, function () {
    //    });
    //};

    //$scope.invoiceSpreadsheet = {
    //    original_value: 4000000,
    //    preappeal_value: 5837000,
    //    assessor_value: 5593800,
    //    board_value: 3388700,
    //    market_pre_appeal: 5837000,
    //    market_level1: 5593800,
    //    market_level2: 3388700,
    //    tax_rate: 1.2903,
    //    taxowed_pre_appeal: 0,
    //    taxowed_assessor: 0,
    //    taxowed_board: 0,
    //    tax_savings_level1: 0,
    //    tax_savings_level2: 0,
    //    fee_percentage: 25,
    //    fee_owed: 0,
    //    tax_due_date: ''
    //};

    //$scope.netBill = {
    //    tax_bill: 0,
    //    less_solid_waste: 0,
    //    water_quality: 0,
    //    net_bill: 0
    //}

    //$scope.calculatenetBill = function () {
    //    $scope.netBill.net_bill = '$' + ($scope.netBill.tax_bill - $scope.netBill.less_solid_waste - $scope.netBill.water_quality);
    //}

    //$scope.saveInvoice = function () {

    //    //console.log('before');
    //    //console.log($scope.invoiceSpreadsheet);

    //    $scope.invoiceSpreadsheet.original_value = parseFloat($scope.invoiceSpreadsheet.original_value.toString().match(/\d/g).join(""));
    //    $scope.invoiceSpreadsheet.preappeal_value = parseFloat($scope.invoiceSpreadsheet.preappeal_value.toString().match(/\d/g).join(""));
    //    $scope.invoiceSpreadsheet.assessor_value = parseFloat($scope.invoiceSpreadsheet.assessor_value.toString().match(/\d/g).join(""));
    //    $scope.invoiceSpreadsheet.board_value = parseFloat($scope.invoiceSpreadsheet.board_value.toString().match(/\d/g).join(""));

    //    $scope.invoiceSpreadsheet.market_pre_appeal = $scope.invoiceSpreadsheet.preappeal_value;
    //    $scope.invoiceSpreadsheet.market_level1 = $scope.invoiceSpreadsheet.assessor_value;
    //    $scope.invoiceSpreadsheet.market_level2 = $scope.invoiceSpreadsheet.board_value;

    //    $scope.invoiceSpreadsheet.tax_rate = parseFloat($scope.invoiceSpreadsheet.tax_rate.toString().match(/\d/g).join(""));
    //    $scope.invoiceSpreadsheet.taxowed_pre_appeal = parseFloat($scope.invoiceSpreadsheet.taxowed_pre_appeal.toString().match(/\d/g).join(""));
    //    $scope.invoiceSpreadsheet.taxowed_assessor = parseFloat($scope.invoiceSpreadsheet.taxowed_assessor.toString().match(/\d/g).join(""));
    //    $scope.invoiceSpreadsheet.taxowed_board = parseFloat($scope.invoiceSpreadsheet.taxowed_board.toString().match(/\d/g).join(""));
    //    $scope.invoiceSpreadsheet.tax_savings_level1 = parseFloat($scope.invoiceSpreadsheet.tax_savings_level1.toString().match(/\d/g).join(""));

    //    $scope.invoiceSpreadsheet.tax_savings_level2 = parseFloat($scope.invoiceSpreadsheet.tax_savings_level2.toString().match(/\d/g).join(""));
    //    $scope.invoiceSpreadsheet.fee_percentage = parseFloat($scope.invoiceSpreadsheet.fee_percentage.toString().match(/\d/g).join(""));
    //    $scope.invoiceSpreadsheet.fee_owed = parseFloat($scope.invoiceSpreadsheet.fee_owed.toString().match(/\d/g).join(""));



    //    $scope.invoiceSpreadsheet.tax_bill = parseFloat($scope.netBill.tax_bill.toString().match(/\d/g).join(""));
    //    $scope.invoiceSpreadsheet.less_solid_waste = parseFloat($scope.netBill.less_solid_waste.toString().match(/\d/g).join(""));
    //    $scope.invoiceSpreadsheet.water_quality = parseFloat($scope.netBill.water_quality.toString().match(/\d/g).join(""));
    //    $scope.invoiceSpreadsheet.net_bill = parseFloat($scope.netBill.net_bill.toString().match(/\d/g).join(""));
    //    $scope.invoiceSpreadsheet.contractId = parseFloat($stateParams.id);
    //    //console.log($scope.invoiceSpreadsheet);
    //    $('#preloader').css('display', 'block');

    //    NewInvoiceService.saveInvoice($scope.invoiceSpreadsheet)
    //        .then(function (response) {
    //            //console.log(response);
    //            $('#preloader').css('display', 'none');


    //        }, function (err) {
    //            $('#preloader').css('display', 'none');

    //            //console.log(err);

    //        });

    //}

    //$scope.calculateSpreadsheet = function () {


    //    var calculatedValues = calculateSheet(angular.copy($scope.invoiceSpreadsheet));
    //    $scope.invoiceSpreadsheet = calculatedValues;

    //    $scope.invoiceSpreadsheet.taxowed_pre_appeal = '$' + parseFloat($scope.invoiceSpreadsheet.taxowed_pre_appeal).toFixed(2);
    //    $scope.invoiceSpreadsheet.taxowed_assessor = '$' + parseFloat($scope.invoiceSpreadsheet.taxowed_assessor).toFixed(2);
    //    $scope.invoiceSpreadsheet.taxowed_board = '$' + parseFloat($scope.invoiceSpreadsheet.taxowed_board).toFixed(2);
    //    $scope.invoiceSpreadsheet.tax_savings_level1 = '$' + parseFloat($scope.invoiceSpreadsheet.tax_savings_level1).toFixed(2);
    //    $scope.invoiceSpreadsheet.tax_savings_level2 = '$' + parseFloat($scope.invoiceSpreadsheet.tax_savings_level2).toFixed(2);
    //    $scope.invoiceSpreadsheet.fee_owed = '$' + parseFloat($scope.invoiceSpreadsheet.fee_owed).toFixed(2);
    //    //console.log(calculatedValues);
    //}

    //function calculateSheet(invoiceSpreadsheet) {


    //    invoiceSpreadsheet.taxowed_pre_appeal = invoiceSpreadsheet.preappeal_value * (invoiceSpreadsheet.tax_rate / 100);

    //    invoiceSpreadsheet.taxowed_assessor = invoiceSpreadsheet.assessor_value * (invoiceSpreadsheet.tax_rate / 100);

    //    invoiceSpreadsheet.taxowed_board = invoiceSpreadsheet.board_value * (invoiceSpreadsheet.tax_rate / 100) - 0.01;

    //    invoiceSpreadsheet.tax_savings_level1 = invoiceSpreadsheet.taxowed_pre_appeal - invoiceSpreadsheet.taxowed_assessor;
    //    invoiceSpreadsheet.tax_savings_level2 = invoiceSpreadsheet.taxowed_assessor - invoiceSpreadsheet.taxowed_board;


    //    invoiceSpreadsheet.fee_owed = (invoiceSpreadsheet.tax_savings_level1 + invoiceSpreadsheet.tax_savings_level2) * (invoiceSpreadsheet.fee_percentage / 100);


    //    return invoiceSpreadsheet;
    //}


}
/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 234 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

_NewInvoiceService.$inject = ["$http", "AOTCService", "$q"];
module.exports = _NewInvoiceService;


//angular.module('AOTC')
//    .factory('NewInvoiceService', _NewInvoiceService
//    );

function _NewInvoiceService($http, AOTCService, $q) {

    function saveInvoice(data) {

        var url = '/contracts/saveInvoice';
        var defer = $q.defer();

        AOTCService.postDataToServer(url, data).
        then(function (result) {
            defer.resolve(result.data);
        }, function (err) {
            defer.reject(err);
        });

        return defer.promise;
    };

    function getInvoiceByContractId(data) {
        var url = '/contracts/getInvoiceByContractId';
        var defer = $q.defer();

        AOTCService.postDataToServer(url, data).then(function (result) {
            defer.resolve(result.data);
        }, function (err) {
            defer.reject(err);
        });

        return defer.promise;

    };



    return {
        saveInvoice: saveInvoice,
        getInvoiceByContractId: getInvoiceByContractId

    };

}

/***/ }),
/* 235 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {

//var agGrid = require('agGrid');
_SavedContractList.$inject = ["$scope", "$location", "$state", "SavedContractListService", "$timeout", "newContractService", "$compile"];
module.exports = _SavedContractList;

agGrid.initialiseAgGridWithAngular1(angular);
//angular.module('AOTC').controller('SavedContractList', _SavedContractList
//    );

function _SavedContractList($scope, $location, $state, SavedContractListService, $timeout, newContractService, $compile) {
    ////console.log("SavedContractList");
    $scope.contractList = [];
    $scope.searchText = '';
    $scope.viewInvoices = function (contract) {
        //console.log(contract)
        $state.go(
            'InvoiceList', { id: contract.id }
        );

    }

    //Starting Logic
    getContracts();

    //Local variables
    var rowData = [];
    var columnDefs = [
        { headerName: "Contract Name", field: "contractName", width: 200 },
        { headerName: "Creation Date", field: "createdDate", width: 200 },
        { headerName: "Agent Name", field: "agentName", width: 140 },
        { headerName: "Status", field: "status", width: 110 },
        { headerName: "Actions", field: "abc", width: 260, cellRenderer: renderButtons }, //, cellClass: 'padding-normal'
    ];
    function renderButtons(params) {
        try {
            var _TemplateContainer = document.createElement('div');
            var _editBtn = '<button class="btn btn-info edit-btn-grid btn-sm" style="margin-right: 10px; background: rgba(122, 218, 16, 0.82)"' +
                                ' value="' + params.data.id + '"' +
                               ' border: none;    padding: 4px;" data-toggle="tooltip" data-placement="right" title="Edit details">' +
                              '  <i class="fa  fa-pencil fa-lg"></i> </button>';
            var _viewBtn = '<button class="btn btn-info view-btn-grid btn-sm" style="margin-right: 10px; background: #3be4ff"' +
                                ' value="' + params.data.id + '"' +
                               ' border: none;    padding: 4px;" data-toggle="tooltip" data-placement="right" title="View details">' +
                              '  <i class="fa  fa-eye fa-lg"></i> </button>';
            var _invoiceBtn = '<button class="btn btn-info invoice-btn-grid btn-sm" style="margin-right: 10px; background: rgb(255, 118, 0)"' +
                                ' value="' + params.data.id + '"' +
                               ' border: none;    padding: 4px;" data-toggle="tooltip" data-placement="right" title="Create Invoice">' +
                              '  <i class="fa  fa-list-alt fa-lg"></i> </button>';
            switch (params.data.status) {
                case 'NotStarted':
                    var _btns = '<span style="display:block; text-align:center;">' + _viewBtn + _editBtn + _invoiceBtn + '</span>';
                    break;
                case 'InProgress':
                    var _btns = '<span style="display:block; text-align:center;">' + _viewBtn + '</span>';
                    break;
                case 'Complete':
                    var _btns = '<span style="display:block; text-align:center;">' + _viewBtn + _invoiceBtn + '</span>';
                    break;
            }
            _TemplateContainer.innerHTML = _btns;
            //Add Listeners
            var _editBtnTag = _TemplateContainer.querySelector('.edit-btn-grid');
            var _viewBtnTag = _TemplateContainer.querySelector('.view-btn-grid');
            var _invoiceBtnTag = _TemplateContainer.querySelector('.invoice-btn-grid');

            _viewBtnTag.addEventListener('click', function (event) {
                var _selected = event.currentTarget.value;
                $state.go('ViewContract', { id: _selected });
            });
            _editBtnTag.addEventListener('click', function (event) {
                var _selected = event.currentTarget.value;
                $state.go('ViewContract', { id: _selected });
            });
            _invoiceBtnTag.addEventListener('click', function (event) {
                var _selected = event.currentTarget.value;
                $state.go('NewInvoice', { id: 1 });
            });
            return _TemplateContainer;

        }
        catch (_e) { return ""; }

    };

    var gridOptions = {
        columnDefs: columnDefs,
        rowData: rowData,
        headerHeight: 25,
        rowHeight: 40,
        suppressCellSelection: true,
        enableColResize: true
    };

    //Function definition
    function getContracts() {
        $('#preloader').css('display', 'block');

        SavedContractListService.getContracts()
            .then(function (response) {
                $('#preloader').css('display', 'none');
                //copy id to contracts objects
                gridOptions.rowData = addID(response.result);
                //save data to fetch later
                newContractService.saveContractData(response.result);
                //show ag-grid
                $timeout(function () {
                    var gridDiv = document.querySelector('#myGridContracts');
                    new agGrid.Grid(gridDiv, gridOptions);
                    gridOptions.api.sizeColumnsToFit()
                });

            }, function (err) {
                //console.log(err);
            });
    };

    function addID(_data) {
        var _tempArray = [];
        angular.forEach(_data, function (_item) {
            _item.contracts['id'] = _item.id;
            _tempArray.push(_item.contracts);
        });
        return _tempArray;
    }


}
/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 236 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


_SavedContractListService.$inject = ["$http", "AOTCService", "$q"];
module.exports = _SavedContractListService;

//angular.module('AOTC')
//    .factory('SavedContractListService', _SavedContractListService
//    );

function _SavedContractListService($http, AOTCService, $q) {

    function getContracts(data) {

        var _data = {};

        var url = '/contracts/getContractsByUserId';
        var defer = $q.defer();

        AOTCService.postDataToServer(url, _data).
        then(function (result) {
            defer.resolve(result.data);
        }, function (err) {
            defer.reject(err);
        });

        return defer.promise;
    }





    return {

        getContracts: getContracts,

    };

}

/***/ }),
/* 237 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {



_Contract.$inject = ["$state", "$scope","__env","newContractService", "$stateParams", "SampleCalculationService", "PrivatePropertyService"];
module.exports = _Contract;

//angular.module('AOTC').controller('Contract', _Contract
//    );
function _Contract($state, $scope, __env, newContractService, $stateParams, SampleCalculationService, PrivatePropertyService) {

    var selectedPropertyList = PrivatePropertyService.selectedPropertyList;
    $scope.viewContractEditor = true;
    var fct = [];
    var validateData = 0;
    $scope.contractId = $stateParams.id || null;
    $scope.IsViewMode = $stateParams.id ? true : false;
    $scope.savedContract = newContractService.getContractData($scope.contractId); //currently viewed contract

    //Assigning Data to scope variables
    try {
        $scope.contractName = $scope.savedContract.contractName;
        $scope.agentName = $scope.savedContract.agentName;
    }
    catch (_e) { }



    $scope.ViewContractEditor = function () {
        $scope.viewContractEditor = true;
        $scope.viewSampleCalculations = false;
        $scope.$broadcast('someEvent', [1, 2, 3]);
    }

    $scope.ViewContractTerms = function () {
        $scope.viewContractEditor = false;
        $scope.viewSampleCalculations = false;
        $scope.$broadcast('someEvent', [1, 2, 3]);

    }
    $scope.ViewSampleCalculations = function () {
        $scope.viewContractEditor = false;
        $scope.viewSampleCalculations = true;
    }

    $scope.$on('financialAndNonFinancialTerms', function (evt, args) {

        $scope.viewContractEditor = true;
        $scope.viewSampleCalculations = false;
        $scope.$broadcast('updateDocument', []);
    });

    $scope.openContractModel = function () {
        //console.log(SampleCalculationService.fct);
        //console.log(SampleCalculationService.feeType);
        fct = ArrangeFinancialContracts();
        if (selectedPropertyList) {

            if ((!newContractService.dataContent)) {
                $scope.$emit('danger', 'Enter Contract Content');
            }
            else if (validateData != 1) {
                $scope.$emit('danger', 'Select Fee');

            }
            else {
                $('#newFormat').modal('toggle');
            }
        }
        else {
            $scope.$emit('danger', 'Select at least One property');

        }

    };

    $scope.saveContract = function (name, agenttName) {
        //console.log('saved')
        saveNewContract(name, agenttName);
    }


    function saveNewContract(name, agenttName) {
        $('#preloader').css('display', 'block');
        var propIds = selectedPropertyList;
        var newContract = {
            name: name,
            content: newContractService.dataContent,
            agenttName: agenttName,
            status: 'NotStarted',
            propId: selectedPropertyList
        };

        var nfct = arrangeNfct();
        var postData = { contract: newContract, fct: fct, nfct: nfct };
        //console.log(postData)
        newContractService.addContractTemplate(postData) //addContract
            .then(function (response) {
                //console.log(response);
                $('#preloader').css('display', 'none');
                $('#newFormat').modal('toggle');

                if (!response.success) {
                    $scope.$emit('danger', response.message);
                    return;
                }
                $scope.content = '';
                $scope.$emit('success', response.message);
                $state.go('SavedContractList');
            }, function (err) {
                $('#preloader').css('display', 'none');
                //console.log(err);
            });

    }

    function ArrangeFinancialContracts() {
        var percentageData = [];
        var fixedPerProperty = [];
        var fp = []
        var fixedFee = [];
        var feeType = SampleCalculationService.feeType;
        var calaculatedData = SampleCalculationService.fct;

        if (feeType != 'one') {
            angular.forEach(calaculatedData, function (value, key) {
                validateData = 1;
                //console.log(value)
                if (value.feeType === 3) {
                    percentageData.push({ 'feeType': 'percentage', 'fee': (value.assessment.feePercent * 100).toFixed(2), 'propertyId': value.propertyId, "meritLevel": value.meritLevel });
                }
                else if (value.feeType === 4) {
                    //console.log(value.meritLevel)
                    fp.push({ 'feeType': 'fp', 'fixedRate': value.assessment.fixedRate, "meritLevel": value.meritLevel, 'propertyId': value.propertyId })
                }
                else {
                    fixedPerProperty.push({ 'feeType': 'fixedPerProperty', 'fee': value.assessment.fixedRate, 'propertyId': value.propertyId })
                }
            });
        }
        else {
            fixedFee.push({ 'feeType': 'fixed', 'fee': SampleCalculationService.totalFee, 'propertyId': selectedPropertyList })
            validateData = 1;
        }
        if (feeType != 'one') {
            var postJson = [percentageData, fixedPerProperty, fp];
        }
        else {
            var postJson = [fixedFee];
        }
        //console.log(postJson)
        return postJson;
    };

    function arrangeNfct() {
        var nfct = newContractService.getFinancialAndNonFinancialTerms();
        var newNfct = [];
        angular.forEach(nfct, function (data, key) {
            newNfct.push({ termName: data.label, termValue: data.value })
        })

        return newNfct;
    }


}

/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 238 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


//var angular = require('angular');


angular.module('AOTC').directive('phoneInput', __webpack_require__(95).phoneInput);
angular.module('AOTC').filter('tel', __webpack_require__(95).tel);



/***/ }),
/* 239 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


//var angular = require('angular');

////components
//contract-editor
angular.module('AOTC').directive('header', __webpack_require__(240));

/***/ }),
/* 240 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {


_header.$inject = ["User_Config", "$state", "$timeout"];
module.exports = _header;

//angular.module('AOTC')
//    .directive('header', _header
//    );
function _header(User_Config, $state, $timeout) {
    var controller = ['$scope', '$location', 'AOTCService', '$rootScope', function ($scope, $location, AOTCService, $rootScope) {
        ////console.log('head controller');
        var head = this;
        $scope.successMessage = '';
        $scope.errorMessage = '';
        $scope.dangerMessage = '';
        $scope.showUserTab = false;

        $scope.role = '';




        var role = localStorage.getItem('role');
        $scope.role = role;

        if (role == User_Config.AJ_USER) {
            $scope.showSelectedTabs = false;

        } else if (role == User_Config.PMF_USER) {
            $scope.showSelectedTabs = false;
        } else if (role == User_Config.Admin) {
            $scope.showUserTab = true;
        }

        if (!localStorage.getItem('userJson')) {
            $state.go('login');
        } else {
            var userResult = JSON.parse(localStorage.getItem('userJson'));
            $scope.name = userResult.userData.name;
        }

        $scope.$on('userRole', function (ev, userRole) {
            $timeout(function () {
                $scope.showUserTab = false;
                if (userRole == User_Config.AJ_USER) {
                    $scope.showSelectedTabs = false;

                } else if (userRole == User_Config.PMF_USER) {
                    $scope.showSelectedTabs = false;
                } else if (userRole == User_Config.Admin) {
                    $scope.showUserTab = true;
                }
            }, 100);
        });

        $scope.$on('success', function (ev, ms) {
            $scope.successMessage = ms;
            // $scope.$apply();
            $("#head_success").fadeIn(1500).delay(500).fadeOut(500);
        });


        $scope.$on('error', function (ev, ms) {
            ////console.log('show error', ms);
            $scope.errorMessage = ms;
            // $scope.$apply();
            $("#head_error").fadeIn(1500).delay(500).fadeOut(500);
        });

        $scope.$on('danger', function (ev, ms) {
            ////console.log('show danger', ms);
            $scope.dangerMessage = ms;
            // $scope.$apply();
            $("#head_danger").fadeIn(1500).delay(500).fadeOut(500);
        });


        $scope.OpenNotfModal = function (_notf) {
            $scope.openNotModal = true;
            // try {
            //     var url = '/timeline/markAsRead';
            //     var _data = {
            //         "notId": _notf.notifications._id
            //     };
            //     if (_notf.notification.properties.readFlag == 0) {
            //         $("#preloader").css("display", "block");
            //         AOTCService.postDataToServer(url, _data)
            //             .then(function (result) {
            //                 $scope.selectedNotification = _notf;
            //                 $("#myNotificationModal").modal('show');
            //                 $rootScope.unreadNotifications = 0;
            //                 $timeout(function () {
            //                     try {
            //                         //
            //                         _notf.notification.properties.readFlag = 1;
            //                         for (var i = 0; i < $rootScope.allNotifications.external.length; i++) {
            //                             var _item = $rootScope.allNotifications.external[i];
            //                             if (_item.notification.properties.readFlag == 0) $rootScope.unreadNotifications++;

            //                         }
            //                         for (var i = 0; i < $rootScope.allNotifications.internal.length; i++) {
            //                             var _item = $rootScope.allNotifications.internal[i];
            //                             if (_item.notification.properties.readFlag == 0) $rootScope.unreadNotifications++;
            //                         }
            //                     } catch (_e) {}
            //                 });
            //                 $("#preloader").css("display", "none");
            //             }, function () {

            //                 $("#preloader").css("display", "none");
            //             });
            //     } else {
            //         $scope.selectedNotification = _notf;
            //         $("#myNotificationModal").modal('show');
            //     }
            // } catch (_e) {}



        };

        $(".nav-tabs.notification-tabs a").click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            $(this).tab('show');
        });
        head.parseProps = function(_str){
            try{
                var _parsedStr =  JSON.parse(_str);
                return _parsedStr;
            }
            catch(_e){}

        };

        $scope.isActive = isActive;

        function isActive(route) {
            ////console.log("route", route)
            ////console.log("$location.path()", $location.path())
            return route === $location.path();
        }
    }];

    return {
        templateUrl: 'modules/header/header.html',
        restrict: 'EA',
        controller: controller,
        controllerAs: 'head',
        bindToController: true

    };
}
/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 241 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


//var angular = require('angular');

angular.module('AOTC').controller('login', __webpack_require__(242));

/***/ }),
/* 242 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {


_login.$inject = ["$state", "$location", "$scope", "$http", "__env", "$log", "AOTCService", "$timeout", "AOTCAuth", "AOTCPermissions"];
module.exports = _login;

//angular.module('AOTC').controller('login', _login
//    );
function _login($state, $location, $scope, $http, __env, $log, AOTCService, $timeout, AOTCAuth, AOTCPermissions) {
    ////console.log("login-in controller");

    var vm = this;
    //vm.deviceDetector = deviceDetector;
    //////console.log("vm.deviceDetector", vm.deviceDetector);

    //var browserNotification = localStorage.getItem('browserNotification');

    //////console.log(browserNotification);

    //if (browserNotification == null) {
    //    if (vm.deviceDetector.browser != 'chrome' && vm.deviceDetector.browser != 'safari' && vm.deviceDetector.browser != 'internet explorer') {
    //        $state.go('BrowserOptimizing');
    //    }
    //}

    vm.loginUser = loginUser;
    $('#preloader').css("display", "none");

    // $state.go('main.EventTeams');

    vm.credentials = {
        email: 'mark.clint@yahoo.com',
        password: 'mark'
    };
    vm.rememberMe = false;
    vm.errorLogin = '';
    localStorage.removeItem('userJson');
    localStorage.removeItem('token');
    //remove token 
    AOTCAuth.removeToken();

    var rememberMe = localStorage.getItem('rememberMe');
    if (rememberMe) {
        vm.credentials = JSON.parse(localStorage.getItem('credentials'));
        vm.rememberMe = rememberMe;
    }

    function loginUser() {
        ////console.log("login: informations ", vm.credentials);
        var loginUserURL = '/users/userSignIn';
        $('#preloader').css("display", "block");


        AOTCService.postDataToServer(loginUserURL, vm.credentials)
            .then(function successCallback(response) {
                $('#preloader').css("display", "none");

                ////console.log("result is ", response);
                var serverData = response.data;
                //set token
                AOTCAuth.setToken(serverData.result.token);

                if (serverData.success) {


                    if (vm.rememberMe) {
                        var creds = angular.toJson(vm.credentials);
                        localStorage.setItem('rememberMe', vm.rememberMe);
                        localStorage.setItem('credentials', creds);

                    } else {
                        localStorage.removeItem('rememberMe');
                        localStorage.removeItem('credentials');

                    }

                    // var userData = serverData.result;
                    var userJson = serverData.result;
                    /////console.log(userJson);
                    localStorage.setItem('userJson', angular.toJson(userJson));
                    localStorage.setItem('userId', userJson.userId);
                    localStorage.setItem('token', userJson.token);

                    AOTCPermissions.setPermissions(userJson.roles, 'permissionMainObj');
                    AOTCPermissions.setPermissions(userJson.userData, 'userObj');
                    

                    $state.go('main');

                } else {
                    vm.errorLogin = serverData.message;
                }
                //on login

            }, function errorCallback(response) {
                $('#preloader').css("display", "none");
                ////console.log("error is ", response);
            });

    }


}
/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 243 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


//var angular = require('angular');

angular.module('AOTC').controller('main', __webpack_require__(244));
angular.module('AOTC').service('mainService', __webpack_require__(245));

/***/ }),
/* 244 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {

_main.$inject = ["User_Config", "$state", "$rootScope", "mainService", "$location", "$scope", "$http", "__env", "$log", "AOTCService", "$timeout", "DTOptionsBuilder", "DTColumnDefBuilder"]; //, "DTOptionsBuilder", "DTColumnDefBuilder"
module.exports = _main;

//angular.module('AOTC').controller('main', _main
//    );

function _main(User_Config, $state, $rootScope, mainService, $location, $scope, $http, __env, $log, AOTCService, $timeout, DTOptionsBuilder, DTColumnDefBuilder) { //, DTOptionsBuilder, DTColumnDefBuilder
    ////console.log("main controller");


    var vm = this;
    $scope.vm;
    vm.locations = [];


    vm.newstimemodel = [];
    vm.newssourcesmodel = [];
    vm.newsRegionmodel = [];

    vm.newsRegion = [{ id: 0, label: "All" }];
    vm.newssources = [{ id: 0, label: "All" }];
    vm.newstime = [{ id: "60", label: "All" }, { id: "1", label: "1 day" }, { id: "7", label: "1 week" }, { id: "30", label: "1 month" }];
    var _d= localStorage.getItem('tickerStatus');
    if(_d=='false' || _d==false){
        vm.tickerStatus = false;
    }
    else vm.tickerStatus = true;
    vm.tickerStatusFunc = function (_status) {
        vm.tickerStatus = _status;
        localStorage.setItem("tickerStatus", _status);
    };

    $scope.$watch("main.newstimemodel", function (newVal, oldVal) {
        try {
            if (newVal != oldVal) {
                var _arr = [];
                angular.forEach(newVal, function (_item) {
                    _arr.push(parseInt(_item.id));
                });
                vm.filterArrTime = _arr;
            }
        }
        catch (_e) { }
    }, true);
    $scope.$watch("main.newssourcesmodel", function (newVal, oldVal) {
        try {
            if (newVal != oldVal) {
                var _arr = [];
                angular.forEach(newVal, function (_item) {
                    _arr.push(_item.id);
                });
                vm.filterArrSources = _arr;
            }
        }
        catch (_e) { }

    }, true);
    $scope.$watch("main.newsRegionmodel", function (newVal, oldVal) {
        try {
            if (newVal != oldVal) {
                var _arr = [];
                angular.forEach(newVal, function (_item) {
                    _arr.push(_item.id);
                });
                vm.filterArrRegion = _arr;
            }
        }
        catch (_e) { }

    }, true);
    vm.filterArrRegion = [];
    vm.filterArrSources = [];
    vm.filterArrTime = [];

    vm.getResults = function () {
        var _source = (vm.filterArrSources.length == 0) ? vm.newssourcesAll : vm.filterArrSources;
        var _Region = (vm.filterArrRegion.length == 0) ? vm.newRegionAll : vm.filterArrRegion;
        getNewsss({
            "region": _Region,
            "sources": _source,
            "time": vm.filterArrTime[0] || 60
        });
    };

    vm.newsRegionsettings = { checkBoxes: true };
    vm.newssourcessettings = { checkBoxes: true };
    vm.newstimesettings = { checkBoxes: true, selectionLimit: 1 };
    vm.newsRegiontext = { buttonDefaultText: 'Select Region' };
    vm.newssourcestext = { buttonDefaultText: 'Select Source' };
    vm.newstimetext = { buttonDefaultText: 'Select Duration' };



    getNewsss({
        "region": [],
        "sources": [],
        "time": 60
    });

    vm.filterObj = {};
    function getNewsss(_data) {
        $("#preloader").css('display', 'block');
        var _time = vm.newstimemodel[0] || 60;
        var url = 'newsFeed/getNewsFeed';
        AOTCService.postDataToServer(url, _data)
            .then(function (res) {
                if (res.data.success) {
                    vm.newsData = res.data.result.results;

                    $timeout(function () {
                        $("#bn4").breakingNews({
                            effect: "slide-v",
                            autoplay: true,
                            timer: 3000,
                            color: 'blue',
                            border: true
                        });

                    }, 100);

                    try {
                        var _arr = [];
                        var _r = res.data.result.region;
                        if (_r.length) {
                            angular.forEach(res.data.result.region, function (_item) {
                                _arr.push({ id: _item, label: _item });
                            });
                            vm.newRegionAll = _r;
                            vm.newsRegion = _arr;
                        }


                        var _arr = [];
                        var _s = res.data.result.sources;
                        if (_s.length) {
                            angular.forEach(res.data.result.sources, function (_item) {
                                _arr.push({ id: _item, label: _item });
                            });
                            vm.newssourcesAll = _s;
                            vm.newssources = _arr;
                        }
                    }
                    catch (_e) { }


                    $("#preloader").css('display', 'none');
                }
                else {
                    $("#preloader").css('display', 'none');
                }



                //vm.newsRegion = [{ id: 0, label: "All" }];
                //vm.newssources = [{ id: 0, label: "All" }];
            }, function (result) {
                //some error
                ////console.log(result);
                $("#preloader").css('display', 'none');
            });
    };

    // ////console.log(User_Config);
    $('#preloader').css('display', 'block');

    // handle not to show main before login
    setTimeout(function () {

        if (!localStorage.getItem('userJson')) {
            $state.go('login');
        } else {

            var userData = JSON.parse(localStorage.getItem('userJson'));
            localStorage.setItem("userId", userData.userId);
            localStorage.setItem('role', userData.userData.role);
            $scope.$emit('userRole', userData.userData.role);
        }

        $('#preloader').css('display', 'none');
    }, 2000);

    // Service Call
    var propsData;


    vm.searchFieldRequired = false;
    vm.searchProperty = {
        accNo: '',
        address: '',
        ownerName: ''
    };
    vm.markerWindowShow = false;
    vm.selectedMarker = {};
    vm.markerId = 0;
    vm.windowOptions = {
        zIndex: 8,
        pixelOffset: {
            height: -35,
            width: 0
        }
    };
    vm.infoWindow = {};
    vm.closeMarkerWindow = closeMarkerWindow;

    var dates = ["07/05/2016", "08/02/2016", "09/02/2016", "10/02/2016", "01/02/2017"];
    var datesAppeal = ["10/01/2016", "12/02/2016", "01/10/2017", "05/01/2017", "08/02/2017"];

    vm.appealSlider = {
        minValue: datesAppeal[0],
        maxValue: datesAppeal[4], // or new Date(2016, 7, 10) is you want to use
        options: {
            floor: 0,
            ceil: 100,
            stepsArray: datesAppeal,
            translate: function (date) {
                if (date != null)
                    return date
                // return '' + date.getDay() + '/' + date.getMonth() + '/' + date.getFullYear() ;
                return '';
            },
            onEnd: function (id) {
                var exists = false;
                for (var i = 0; i < vm.selectedFilters.length; i++) {
                    if (vm.selectedFilters[i].attribute == 'Appeal Filter')
                        exists = true;
                }
                if (!exists)
                    vm.selectedFilters.push({
                        "name": 'Next Appeal Date',
                        "attribute": 'Appeal Filter',
                    });
                filterData();

            }
        }
    };

    vm.assesmentSlider = {
        minValue: dates[0],
        maxValue: dates[4], // or new Date(2016, 7, 10) is you want to use
        options: {
            floor: 0,
            ceil: 100,
            stepsArray: dates,
            translate: function (date) {
                if (date != null)
                    return date
                return '';
            },
            onEnd: function (id) {
                var exists = false;
                for (var i = 0; i < vm.selectedFilters.length; i++) {
                    if (vm.selectedFilters[i].attribute == 'Assessment Filter')
                        exists = true;
                }
                if (!exists)
                    vm.selectedFilters.push({
                        "name": 'Last Assessment Date',
                        "attribute": 'Assessment Filter',
                    });
                filterData();
            }
        }
    };

    vm.dtOptions = DTOptionsBuilder.newOptions()
        .withDisplayLength(20)
        .withOption('lengthMenu', [
            [20, 50, 100, -1],
            [20, 50, 100, "All"]
        ])
        .withOption('order', [[1, 'desc']])
        .withColumnFilter({
            aoColumns: [{
                type: 'text'
            }, {
                type: 'text'
            }, {
                type: 'text'
            }, {
                type: 'text'
            }, {
                type: 'text'
            }, {
                type: 'text'
            }, {
                type: 'text'
            }, {
                type: 'text'
            }]
        })
        .withButtons([
            {
                extend: 'colvis',
                postfixButtons: [{ extend: 'colvisRestore', text: 'Restore All' }],
                text: 'Show More',
                className: 'moreButtonDT'
            }, {
                extend: 'print',
                text: '<i class="fa fa-print"></i>',
                titleAttr: 'print'
            }, {
                extend: 'copyHtml5',
                text: '<i class="fa fa-files-o"></i>',
                titleAttr: 'Copy'
            }, {
                extend: 'excelHtml5',
                text: '<i class="fa fa-file-excel-o"></i>',
                titleAttr: 'Excel'
            }, {
                extend: 'pdfHtml5',
                text: '<i class="fa fa-file-pdf-o"></i>',
                titleAttr: 'PDF'
            }
        ]);

    vm.apealStatusFilter = [];
    var expanded = false;
    vm.filteredPropertyData = [];

    vm.map;
    vm.mapOptions;

    vm.dtColumnDefs = [
        DTColumnDefBuilder.newColumnDef(0).notSortable()
    ];
    vm.selectedFilters = [];

    vm.toggleImage = toggleImage;
    vm.toggleFilters = toggleFilters; //expand or hide "filters with checkboxes"
    vm.selectFilter = selectFilter;
    vm.selectAllFilters = selectAllFilters;
    vm.checkToggle = checkToggle;
    vm.toggleImageDrawer = toggleImageDrawer;
    vm.menuImageRotate = menuImageRotate;
    vm.removeFilter = removeFilter;
    vm.markerClick = markerClick;
    vm.goToPropDetails = goToPropDetails;
    // vm.uniqueTableData = getPropertyData();
    vm.uniqueTableData = propsData;
    // vm.propertyData = getPropertyData();
    vm.propertyData = propsData;
    ////console.log("abc==>", vm.propertyData)
    vm.findProperty = findProperty;
    // vm.showAdvanceModal             = showAdvanceModal;
    vm.filteredAppealData = [];

    vm.map = {
        center: {
            latitude: 39.551210,
            longitude: -77.740677
        },
        showOverlay: true,
        zoom: 6,
        options: {
            mapTypeId: google.maps.MapTypeId.SATELLITE
        }

    };

    var mapStyleArray = [
        {
            "featureType": "administrative",
            "elementType": "labels.text.fill",
            "stylers": [{ "color": "#444444" }]
        }, { "featureType": "landscape", "elementType": "all", "stylers": [{ "color": "#ffffff" }] }, {
            "featureType": "poi",
            "elementType": "all",
            "stylers": [{ "visibility": "off" }]
        }, {
            "featureType": "road",
            "elementType": "all",
            "stylers": [{ "saturation": -100 }, { "lightness": 45 }]
        }, {
            "featureType": "road.highway",
            "elementType": "all",
            "stylers": [{ "visibility": "simplified" }]
        }, {
            "featureType": "road.arterial",
            "elementType": "labels.icon",
            "stylers": [{ "visibility": "off" }]
        }, { "featureType": "transit", "elementType": "all", "stylers": [{ "visibility": "off" }] }, {
            "featureType": "water",
            "elementType": "all",
            "stylers": [{ "color": "#46bcec" }, { "visibility": "on" }]
        }
    ];

    vm.mapOptions = {
        styles: mapStyleArray,
        maxZoom: 0,
        mapTypeId: google.maps.MapTypeId.SATELLITE

    };

    //fetchin marker from .dummy data
    loadRemoteData(function () {

        initializeFilters(vm);
        for (var i = 0; i < vm.propertyData.length; i++) {

            if (vm.propertyData[i].propertyName !== null) {
            }

            // infowWindowDetails.propertyName = vm.propertyData[i].propertyName ? vm.propertyData[i].propertyName : 'Not Specified';
            var marker = {
                id: vm.markerId++,
                coords: {
                    latitude: (vm.propertyData[i].lat) ? parseFloat(vm.propertyData[i].lat) : 0,
                    longitude: (vm.propertyData[i].lng) ? parseFloat(vm.propertyData[i].lng) : 0
                },
                description: {
                    propertyName: vm.propertyData[i].propertyName, //// title:"<h1>Marker 0</h1><p>This is the home marker.</p>",,
                    appealStatus: "",
                    meritToAppealDetail: ""
                },
                options: {
                    draggable: false
                    // icon: "assets/img/" + vm.propertyData[i].meritToAppeal + ".png"
                }
            }
            vm.locations.push(marker);
            // $scope.$apply();
        }
        ////console.log(vm.locations.length);
    });

    function goToPropDetails(propertyId) {
        $("#preloader").css('display', 'block');

        mainService.getPropertyDetialsById(propertyId).
        then(function (result) {
            // ////console.log('getPropertyDetialsById: ', result);
            var serverData = result.data;
            ////console.log('getPropertyDetialsById: ', serverData.result[0]);

            if (serverData.success) {

                localStorage.setItem('propertyId', serverData.result[0]._id);
                localStorage.setItem('propertyDetails', angular.toJson(serverData.result[0]));

                $("#preloader").css('display', 'none');
                setTimeout(function () {
                    $state.go('viewIERR.propertyDetailsTab');    // Defined in
                }, 500);
            }
        }, function (err) {
            //some error
            ////console.log("Error: ", err);
            $("#preloader").css("display", "none");
        })
    }

    function applyRemoteData(newProps) {

        ///$scope.newProps = newProps.result;
        vm.propertyData = newProps.result.data;
        // ////console.log("=========>>>", vm.propertyData.length);
        // vm.propertyData = getPropertyData(newProps.result.data);
        propsData = newProps.result.data;
    }

    function loadRemoteData(cb) {
        // The friendService returns a promise.
        mainService.getProps()
            .then(
                function (props) {
                    var serverData = props;
                    if (serverData.success) {
                        vm.propertyData = props.result.data;
                        propsData = props.result.data;
                        vm.uniqueTableData = propsData;
                        localStorage.setItem('landingPageProperties', angular.toJson(vm.propertyData));
                    }
                    cb();
                }
            );
    }

    function findProperty() {
        initializeFilters(vm);
        vm.selectedFilters = [];
        vm.markerWindowShow = false;

        // ////console.log('findProperty');
        // ////console.log(vm.searchProperty);
        //vm.vm.uniqueTableData//find on filtered Data;
        var accNoMatch = [];
        var addressMatch = [];
        var nameMatch = [];
        // if(vm.filteredAppealData.length == 0){
        //     vm.uniqueTableData = getPropertyData();
        // }

        //////////////////////////////////////////////////////////////////////////////////////////////////
        if (vm.searchProperty.accNo.length > 0) {

            for (var i = 0; i < vm.propertyData.length; i++) {
                var prop = vm.propertyData[i];
                ////console.log('index of')
                // ////console.log(prop.accNo.toLowerCase().indexOf(vm.searchProperty.accNo.toLowerCase()))

                if (prop.accNo.toLowerCase().indexOf(vm.searchProperty.accNo.toLowerCase()) > -1) {
                    accNoMatch.push(prop);
                }
            }

        } else {

            accNoMatch = vm.propertyData;
        }
        //////////////////////////////////////////////////////////////////////////////////////////////////
        if (vm.searchProperty.address.length > 0) {

            for (var i = 0; i < accNoMatch.length; i++) {
                var prop = accNoMatch[i];

                if (prop.propertyAddress.toLowerCase().indexOf(vm.searchProperty.address.toLowerCase()) > -1) {
                    addressMatch.push(prop);
                }
            }
        } else {

            addressMatch = accNoMatch;
        }
        //////////////////////////////////////////////////////////////////////////////////////////////////
        if (vm.searchProperty.ownerName.length > 0) {

            for (var i = 0; i < addressMatch.length; i++) {
                var prop = addressMatch[i];

                if (prop.ownerName.toLowerCase().indexOf(vm.searchProperty.ownerName.toLowerCase()) > -1) {
                    nameMatch.push(prop);
                }
            }

        } else {

            nameMatch = addressMatch;
        }
        //////////////////////////////////////////////////////////////////////////////////////////////////

        vm.uniqueTableData = [];
        vm.uniqueTableData = nameMatch;

        // ////console.log('total data\n', vm.uniqueTableData);
        setTimeout(function () {
            vm.searchProperty = {
                accNo: '',
                address: '',
                ownerName: ''
            };

        }, 10);
        showSelectedMarkers();
    }

    function closeMarkerWindow() {
        ////console.log('close window');
        vm.markerWindowShow = false;
    }

    function markerClick(marker) {
        vm.selectedMarker = {};
        vm.selectedMarker = marker.model;
        vm.map.center.latitude = vm.selectedMarker.coords.latitude;
        vm.map.center.longitude = vm.selectedMarker.coords.longitude;
        vm.markerWindowShow = true;
    }

    function removeFilter(filter) {

        ////console.log(filter);

        switchFilterState(vm.meritFilter, filter);
        switchFilterState(vm.designeeFilter, filter);
        switchFilterState(vm.apealStatusFilter, filter);

        for (var i = vm.jurisdictionFilter.filters.length - 1; i >= 0; i--) {

            switchFilterState(vm.jurisdictionFilter.filters[i], filter);

        }

        if (filter.attribute == 'Assessment Filter') {

            vm.assesmentSlider.minValue = dates[0];
            vm.assesmentSlider.maxValue = dates[4];

        }

        if (filter.attribute == 'Appeal Filter') {

            vm.appealSlider.minValue = datesAppeal[0];
            vm.appealSlider.maxValue = datesAppeal[4];

        }
        //asdasd

        for (var i = 0; i < vm.selectedFilters.length; i++) {

            if (vm.selectedFilters[i].name == filter.name) {

                vm.selectedFilters.splice(i, 1);

            }
        }

        ////console.log('\n==>all filters ');
        ////console.log(vm.selectedFilters);

        if (vm.selectedFilters.length == 0) {
            $('#myModal').modal('toggle');
        }

        filterData();
    }

    function switchFilterState(myfilters, filter) {

        for (var i = 0; i < myfilters.filters.length; i++) {
            var myfilter = myfilters.filters[i];
            if (myfilter.name == filter.name) {
                myfilter.state = +!myfilter.state;
            }
        }
    }

    function selectFilter(filter, attribute) {

        // attribute= angular.toJson(attribute);

        ////console.log('select Filters type ' + attribute);
        ////console.log(filter);
        filter.state = +!filter.state

        if (filter.state) {
            vm.selectedFilters.push({
                "name": filter.name,
                "attribute": attribute,
                "value": (filter.value) ? "" + filter.value : ''
            });

        } else {

            for (var i = 0; i < vm.selectedFilters.length; i++) {

                if (vm.selectedFilters[i].name == filter.name) {
                    vm.selectedFilters.splice(i, 1);
                }
            }


        }

        ////console.log('\n==>all filters ');
        ////console.log(vm.selectedFilters);

        filterData();
    }

    ////////////////////////////////////         methods for Filters                             ///////////////////////////////
    function selectAllFilters(filterArray, attribute) {

        ////console.log('select all', filterArray);
        filterArray.state = +!filterArray.state;

        if (filterArray.state) {
            for (var i = 0; i < filterArray.filters.length; i++) {

                if (filterArray.filters[i].state != 1) {
                    //if filter is not active
                    filterArray.filters[i].state = 1;

                    vm.selectedFilters.push({
                        "name": filterArray.filters[i].name,
                        "attribute": attribute,
                        "countryState": filterArray.name
                    });
                }
            }
            ////console.log('all filters ');
            ////console.log(vm.selectedFilters);
        } else {
            for (var i = 0; i < filterArray.filters.length; i++) {

                filterArray.filters[i].state = 0;


                for (var k = 0; k < vm.selectedFilters.length; k++) {

                    if (vm.selectedFilters[k].name == filterArray.filters[i].name) {
                        vm.selectedFilters.splice(k, 1);
                    }
                }
            }

            ////console.log('all filters ');
            ////console.log(vm.selectedFilters);
        }


        filterData();
    }

    function filterData() {
        vm.searchProperty = {
            accNo: '',
            address: '',
            ownerName: ''
        };
        vm.selectedMarker = {};
        var designee = "";
        var meritToAppeal = "";
        var status = "";
        var state = "";
        var filter;

        for (var i = 0; i < vm.selectedFilters.length; i++) {

            filter = vm.selectedFilters[i];

            if (filter.attribute == 'meritToAppeal') {

                if (meritToAppeal.length == 0) {
                    meritToAppeal = "" + filter.value;
                } else {

                    meritToAppeal = meritToAppeal + "," + filter.value;
                }
            }

            if (filter.attribute == 'designee') {

                if (designee.length == 0) {
                    designee = filter.name;
                } else {

                    designee = designee + "," + filter.name;
                }
            }

            if (filter.attribute == 'appealStatus') {

                if (status.length == 0) {
                    status = filter.name;

                } else {
                    status = status + "," + filter.name;
                }
            }
            if (filter.attribute == 'jurisdiction') {

                if (filter.name == null) {
                    state = filter.countryState;
                } else if (state.length == 0) {
                    state = filter.name;

                } else {
                    state = state + "," + filter.name;
                }
            }

        }

        ////console.log("desig == " + designee);
        ////console.log("status == " + status);
        ////console.log("state == " + state);
        ////console.log("meritToAppeal == " + meritToAppeal);


        vm.filteredMeritToAppealProperty = [];
        // No designe.
        if (meritToAppeal.length == 0) {
            ////console.log();
            vm.filteredMeritToAppealProperty = vm.propertyData;

        } else {

            for (var k = 0; k < vm.propertyData.length; k++) {

                var property = vm.propertyData[k];

                if (meritToAppeal.indexOf(property.meritToAppeal) >= 0) {

                    vm.filteredMeritToAppealProperty.push(property);
                }

            }

        }

        //////////////////////////////////////////////////////////////////////////////////
        vm.filteredPropertyData = [];
        // No designe.
        if (designee.length == 0) {

            vm.filteredPropertyData = vm.filteredMeritToAppealProperty;

        } else {

            for (var k = 0; k < vm.filteredMeritToAppealProperty.length; k++) {

                var property = vm.filteredMeritToAppealProperty[k];

                if (designee.indexOf(property.designee) >= 0) {

                    vm.filteredPropertyData.push(property);
                }

            }

        }

        //////////////////////////////////////////////////////////////////////////////////////
        vm.filteredDesigneeData = [];

        if (status.length == 0) {

            vm.filteredDesigneeData = vm.filteredPropertyData;

        } else {

            for (var k = 0; k < vm.filteredPropertyData.length; k++) {
                var property = vm.filteredPropertyData[k];
                if (status.indexOf(property.appealStatus) >= 0) {

                    vm.filteredDesigneeData.push(property);
                }
            }
        }


        vm.filteredStatusData = [];
        ////console.log("filter: ", filter);

        if (filter !== undefined && filter.name == null) {

            for (var k = 0; k < vm.filteredDesigneeData.length; k++) {

                var property = vm.filteredDesigneeData[k];


                // if (state.indexOf(property.jurisdiction.laws) >= 0) {
                if (state.indexOf(property.countryState) >= 0) {

                    vm.filteredStatusData.push(property);

                }

            }

        } else {
            ////console.log("alert");
            if (state.length == 0) {

                vm.filteredStatusData = vm.filteredDesigneeData;

            } else {

                for (var k = 0; k < vm.filteredDesigneeData.length; k++) {

                    var property = vm.filteredDesigneeData[k];


                    // if (state.indexOf(property.jurisdiction.laws) >= 0) {
                    if (state.indexOf(property.county) >= 0) {

                        vm.filteredStatusData.push(property);

                    }

                }
            }
        }

        ////console.log("vm.filteredStatusData==>", vm.filteredStatusData);

        // vm.filteredAssessmentData = [];
        // for (var k = 0; k < vm.filteredStatusData.length; k++) {

        //     var property = vm.filteredStatusData[k];

        //     // ////console.log("assessment" + property.jurisdiction.laws);

        //     var propertyAssesmentDate = new Date(property.lastAssessment);

        //     var startDate = new Date(vm.assesmentSlider.minValue);
        //     var endDate = new Date(vm.assesmentSlider.maxValue);

        //     // ////console.log('start date', startDate)
        //     // ////console.log('endDate date', endDate)
        //     // ////console.log('propertyAssesmentDate date', propertyAssesmentDate)

        //     if (propertyAssesmentDate >= startDate && propertyAssesmentDate <= endDate) {
        //         // ////console.log('assessment match', propertyAssesmentDate)
        //         vm.filteredAssessmentData.push(property);

        //     }


        // }


        // vm.filteredAppealData = [];


        // for (var k = 0; k < vm.filteredAssessmentData.length; k++) {

        //     var property = vm.filteredAssessmentData[k];

        //     // ////console.log("assessment" + property.jurisdiction.laws);

        //     var propertyAssesmentDate = new Date(property.nextAppealDate);

        //     var startDate = new Date(vm.appealSlider.minValue);
        //     var endDate = new Date(vm.appealSlider.maxValue);

        //     // ////console.log('start date', startDate)
        //     // ////console.log('endDate date', endDate)
        //     // ////console.log('propertyAssesmentDate date', propertyAssesmentDate)

        //     if (propertyAssesmentDate >= startDate && propertyAssesmentDate <= endDate) {
        //         // ////console.log('assessment match', propertyAssesmentDate)
        //         vm.filteredAppealData.push(property);

        //     }

        // }

        ////console.log('\nfiltered propertyData filteredStatus', vm.filteredAppealData);
        //vm.uniqueTableData = [];
        // vm.uniqueTableData = vm.filteredAppealData;
        vm.uniqueTableData = vm.filteredStatusData;
        ////console.log(" vm.uniqueTableData::", vm.uniqueTableData);

        showSelectedMarkers();
    }

    function showSelectedMarkers() {

        vm.locations = [];

        for (var i = 0; i < vm.uniqueTableData.length; i++) {

            var marker = {
                id: vm.markerId++,
                coords: {
                    latitude: vm.uniqueTableData[i].lat,
                    longitude: vm.uniqueTableData[i].lng
                },
                description: {
                    propertyName: vm.uniqueTableData[i].propertyName, //// title:"<h1>Marker 0</h1><p>This is the home marker.</p>",,
                    appealStatus: "",
                    meritToAppealDetail: ""
                }, //// title:"<h1>Marker 0</h1><p>This is the home marker.</p>",
                options: {
                    draggable: false,
                    icon: "assets/img/" + vm.uniqueTableData[i].meritToAppeal + ".png"
                }

            };


            vm.locations.push(marker);
        }

        // vm.map.zoom = 4;
    }

    function checkToggle(event) {

        ////console.log('checked toggle')
        if ($(event.target).children().is(':checked')) {
            $(event.target).children().prop('checked', false);

        } else {
            $(event.target).children().prop('checked', true);

        }
    }

    function toggleImageDrawer() {


        if ($('#drawer-handle').children().hasClass('fa fa-backward')) {

            $('#drawer-handle').children().removeClass('fa fa-backward')
            $('#drawer-handle').children().addClass('fa fa-forward')

        } else {
            $('#drawer-handle').children().removeClass('fa fa-forward')
            $('#drawer-handle').children().addClass('fa fa-backward')
        }
    }

    function toggleImage(event) { //toggle menu arrow and expand body on clicking label

        if ($(event.target).children().hasClass('rotatedown')) {
            $(event.target).children().removeClass('rotatedown');
            $(event.target).children().addClass('rotateup');
        } else {
            $(event.target).children().addClass('rotatedown');
            $(event.target).children().removeClass('rotateup');


        }
        $(event.target).parent().children('ul.tree').toggle(500);
    }

    function menuImageRotate(event) {
        if ($(event.target).hasClass('rotatedown')) {
            $(event.target).removeClass('rotatedown');
            $(event.target).addClass('rotateup');
        } else {
            $(event.target).addClass('rotatedown');
            $(event.target).removeClass('rotateup');


        }
        $(event.target).parent().next('ul.tree').toggle(500);
    }

    function toggleFilters(event) {

        $(event.target).parent().children('ul.tree').toggle(500);
    }

    function initializeFilters(vm) {

        vm.meritFilter = {
            name: 'Merit to Appeal',
            filters: [{
                name: 'Good Merit',
                value: 1,
                state: 0
            }, {
                name: 'Marginal',
                value: 2,
                state: 0
            }, {
                name: 'No Apparent Merit',
                value: 3,
                state: 0
            }]
        };


        vm.designeeFilter = {
            name: 'DESIGNEE',
            filters: [{
                name: 'Joey Tribbiani',
                state: 0
            }, {
                name: 'Jacks Teller',
                state: 0
            }]
        };


        vm.apealStatusFilter = {
            name: 'APPEAL STATUS',
            filters: [

                {
                    name: 'No Appeal Yet',
                    state: 0
                }, {
                    name: 'Appeal Rejected',
                    state: 0
                }, {
                    name: 'No Further Appeal',
                    state: 0
                }, {
                    name: 'Appeal In Progress',
                    state: 0
                }
            ]
        };

        var states = [];

        for (var i = 0; i < propsData.length; i++) {

            if (propsData[i].countryState !== null && !containsObjectState(propsData[i].countryState, states)) {
                var county = [];
                county.push(propsData[i].county);
                states.push({ "state": propsData[i].countryState, "county": county });

            } else {
                var val = propsData[i].countryState;
                var index = states.findIndex(function (item, i) {
                    return item.state === val
                });
                // ////console.log("index",index);
                if (index > -1) {
                    if (propsData[i].county !== null && (states[index].county.indexOf(propsData[i].county)) === -1) {
                        states[index].county.push(propsData[i].county);
                    }
                }
            }
        }
        var filters = [];
        for (var i = 0; i < states.length; i++) {
            var fil = [];
            if (states[i].county[0] !== undefined) {
                for (var j = 0; j < states[i].county.length; j++) {
                    fil.push({
                        name: states[i].county[j],
                        state: 0
                    });
                }
            }

            filters.push({
                name: states[i].state,
                state: 0,
                filters: fil
            });
        }

        ////console.log("filters=======>", filters);

        vm.jurisdictionFilter = {
            name: 'JURISDICTIONs',
            filters: filters
        };
    }

    angular.element(document).ready(function () {
        // $('label.tree-toggler').click(function() {
        //     $(this).parent().children('ul.tree').toggle(500);
        // });
        // var ckbox = $('#checkbox');
        var dt_from = "01/01/2017 ";
        var dt_to = "12/29/2017 ";
        $('.slider-time').html(dt_from);
        $('.slider-time2').html(dt_to);
        var min_val = Date.parse(dt_from) / 1000;
        var max_val = Date.parse(dt_to) / 1000;

        function zeroPad(num, places) {
            var zero = places - num.toString().length + 1;
            return Array(+(zero > 0 && zero)).join("0") + num;
        }

        function formatDT(__dt) {
            var year = __dt.getFullYear();
            var month = zeroPad(__dt.getMonth() + 1, 2);
            var date = zeroPad(__dt.getDate(), 2);
            var hours = zeroPad(__dt.getHours(), 2);
            var minutes = zeroPad(__dt.getMinutes(), 2);
            var seconds = zeroPad(__dt.getSeconds(), 2);
            return date + '-' + month + '-' + year;
        };


        $("#slider-range").slider({
            range: true,
            min: min_val,
            max: max_val,
            step: 10,
            values: [min_val, max_val],
            slide: function (e, ui) {
                var dt_cur_from = new Date(ui.values[0] * 1000); //.format("yyyy-mm-dd hh:ii:ss");
                $('.slider-time').html(formatDT(dt_cur_from));

                var dt_cur_to = new Date(ui.values[1] * 1000); //.format("yyyy-mm-dd hh:ii:ss");
                $('.slider-time2').html(formatDT(dt_cur_to));
            }
        });

        var dt_from = "01/01/2017 ";
        var dt_to = "12/29/2017 ";

        $('.slider-timea').html(dt_from);
        $('.slider-time2a').html(dt_to);
        var min_val = Date.parse(dt_from) / 1000;
        var max_val = Date.parse(dt_to) / 1000;

        function zeroPad(num, places) {
            var zero = places - num.toString().length + 1;
            return Array(+(zero > 0 && zero)).join("0") + num;
        }

        function formatDT(__dt) {
            var year = __dt.getFullYear();
            var month = zeroPad(__dt.getMonth() + 1, 2);
            var date = zeroPad(__dt.getDate(), 2);
            var hours = zeroPad(__dt.getHours(), 2);
            var minutes = zeroPad(__dt.getMinutes(), 2);
            var seconds = zeroPad(__dt.getSeconds(), 2);
            return date + '-' + month + '-' + year;
        };


        $("#slider-rangea").slider({
            range: true,
            min: min_val,
            max: max_val,
            step: 10,
            values: [min_val, max_val],
            slide: function (e, ui) {
                var dt_cur_from = new Date(ui.values[0] * 1000); //.format("yyyy-mm-dd hh:ii:ss");
                $('.slider-timea').html(formatDT(dt_cur_from));

                var dt_cur_to = new Date(ui.values[1] * 1000); //.format("yyyy-mm-dd hh:ii:ss");
                $('.slider-time2a').html(formatDT(dt_cur_to));
            }
        });


        // var ckbox = $('#checkbox');

        var expanded = false;
        $("#drawer-handle,#prp").click(function () {
            if (expanded = !expanded) {
                $("#drawer-content").animate({
                    "margin-right": 0
                }, "slow");
            } else {
                $("#drawer-content").animate({
                    "margin-right": -800
                }, "slow");
            }
        });

        $('#adv-searcsh').on('click', function (event) {
            //The event won't be propagated to the document NODE and
            // therefore events delegated to document won't be fired
            event.stopPropagation();
        });
    });




}
function containsObjectState(obj, list) {
    var i;
    for (i = 0; i < list.length; i++) {
        if (list[i].state === obj) {
            return true;
        }
    }
    return false;
}


/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 245 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";



_mainService.$inject = ["$http", "$q", "AOTCService"];
module.exports = _mainService;

//angular.module('AOTC')
//    .service("mainService", _mainService
   
//    );
function _mainService($http, $q, AOTCService) {
    // Return public API.
    return ({

        getProps: getProps,
        getPropertyDetialsById: getPropertyDetialsById

    });
    // ---
    // PUBLIC METHODS.
    // ---

    // function getPropertyById(){

    // }

    function getPropertyDetialsById(propertyId) {
        var url = '/properties/getPropertyDetialsById';
        var _data = {propId: propertyId};
        var deferred = $q.defer();

        AOTCService.postDataToServer(url,_data )
            .then(function (result) {
                deferred.resolve(result);

            }, function (result) {
                deferred.reject(result);
                ////console.log(result);
            });
        return deferred.promise;
    }

    // I get all of the tasks in the remote collection.
    function getProps() {
        var request = $http({
            method: "get",
            url: "/properties/getPropertiesLandingPage",
            params: {
                action: "get"
            }
        });
        return (request.then(handleSuccess, handleError));
    }



    function getNews(_id) {
        var request = $http({
            method: "post",
            url: "/newsFeed/getNewsFeed",
            params: {
                "region": [],
                "sources": [],
                "time": 60
            }
        });
        return (request.then(handleSuccess, handleError));
    }


    // ---
    // PRIVATE METHODS.
    // ---
    // I transform the error response, unwrapping the application dta from
    // the API response payload.
    function handleError(response) {
        // The API response from the server should be returned in a
        // nomralized format. However, if the request was not handled by the
        // server (or what not handles properly - ex. server error), then we
        // may have to normalize it on our end, as best we can.
        if (
            !angular.isObject(response.data) ||
            !response.data.message
        ) {
            return ($q.reject("An unknown error occurred."));
        }
        // Otherwise, use expected error message.
        return ($q.reject(response.data.message));
    }
    // I transform the successful response, unwrapping the application data
    // from the API response payload.
    function handleSuccess(response) {

        return (response.data);
    }
}

/***/ }),
/* 246 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


//var angular = require('angular');

////******IE_RR_Module
//***ManualUpload
//IE
angular.module('AOTC').controller('manualIE', __webpack_require__(247));
//RR
angular.module('AOTC').controller('manualRR', __webpack_require__(248));
//TaxBill
angular.module('AOTC').controller('taxBill', __webpack_require__(249));


//***MultipleUpload
angular.module('AOTC').controller('multipleUploadIERR', __webpack_require__(250));

//***SingleUpload
angular.module('AOTC').controller('uploadIERR', __webpack_require__(251));

//***unlinkedProperties
//tabs
angular.module('AOTC').controller('unlinkedProperties', __webpack_require__(252));

//corrupt
angular.module('AOTC').controller('corruptFiles', __webpack_require__(253));

//unlinked
angular.module('AOTC').controller('unlinkedFiles', __webpack_require__(254));
angular.module('AOTC').factory('UnlinkService', __webpack_require__(255));



//unparsed
angular.module('AOTC').controller('unparsedFiles', __webpack_require__(256));



//***Update_IE_RR
angular.module('AOTC').controller('updateIERR', __webpack_require__(257));

//***View_IE_RR
//tabs
//income_expense
angular.module('AOTC').controller('income_expense', __webpack_require__(258));

//other_files
angular.module('AOTC').controller('other_files', __webpack_require__(259));

//propertyDetails
angular.module('AOTC').controller('PropertyDetailsTab', __webpack_require__(96).PropertyDetailsTab);
angular.module('AOTC').directive('ngPropertyImageSelect', __webpack_require__(96).ngPropertyImageSelect);


angular.module('AOTC').factory('PropertyDetailsTabService', __webpack_require__(262));

//public_property_details
angular.module('AOTC').controller('PublicPropertyDetailsTab', __webpack_require__(263));
angular.module('AOTC').controller('PublicPropertyDetailsForProperty', __webpack_require__(264));

angular.module('AOTC').factory('PublicPropertyDetailsTabService', __webpack_require__(265));


//rent_role
angular.module('AOTC').controller('rent_role', __webpack_require__(266));

//tax_bills
angular.module('AOTC').controller('tax_bills', __webpack_require__(267));
//viewIERR
angular.module('AOTC').controller('viewIERR', __webpack_require__(268));


//*****property-list
//***tabs
//pri-property-list
angular.module('AOTC').controller('PropertyListCtrl', __webpack_require__(269));
angular.module('AOTC').service('PrivatePropertyService', __webpack_require__(270));


//public-property-list
angular.module('AOTC').controller('PublicPropertyCtrl', __webpack_require__(271));
angular.module('AOTC').service('PublicPropertyService', __webpack_require__(272));



//***tabs-viewer
angular.module('AOTC').controller('TabsViewerCtrl', __webpack_require__(273));

//*****property-valuation
angular.module('AOTC').controller('PropValuation', __webpack_require__(99).PropValuation);
angular.module('AOTC').directive('inputFocusFunction', __webpack_require__(99).inputFocusFunction);
//angular.module('AOTC').service('ValuationHelper', require('./property-valuation/property-valuation.helper'));
angular.module('AOTC').factory('ValuationService', __webpack_require__(274));
angular.module('AOTC').factory('PetitionerFormulae', __webpack_require__(275));



//*****property-workspace
//***ScenarioOne
//Sensitivity
angular.module('AOTC').controller('SensitivityOne', __webpack_require__(276));
angular.module('AOTC').service('SensitivityService', __webpack_require__(277));

//***ScenarioService
angular.module('AOTC').service('ScenarioDataService', __webpack_require__(278));
angular.module('AOTC').directive('resizable', __webpack_require__(279));


//***ScenarioThree
angular.module('AOTC').controller('SensitivityThree', __webpack_require__(280));
//angular.module('AOTC').directive('resizable', require('./property-workspace/ScenarioThree/Sensitivity/sensitivity.service'));



//*****UploadProperties
angular.module('AOTC').controller('Properties', __webpack_require__(100).Properties);
angular.module('AOTC').directive('upload', __webpack_require__(100).upload);
//mapdata
angular.module('AOTC').controller('Map', __webpack_require__(281));




//*****AssignProperties
angular.module('AOTC').controller('PropAssignment', __webpack_require__(282));
angular.module('AOTC').controller('AssignedUsersListCtrl', __webpack_require__(283));

//taxAppeal

angular.module('AOTC').controller('TaxAppeal', __webpack_require__(284));


/***/ }),
/* 247 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {

_manualIE.$inject = ["$stateParams", "$anchorScroll", "$state", "DTOptionsBuilder", "DTColumnDefBuilder", "$location", "$scope", "$http", "__env", "$log", "AOTCService", "$timeout"];
module.exports = _manualIE;

//angular.module('AOTC').controller('manualIE', _manualIE
//    );
function _manualIE($stateParams, $anchorScroll, $state, DTOptionsBuilder, DTColumnDefBuilder, $location, $scope, $http, __env, $log, AOTCService, $timeout) {
    //////console.log("updateIERR controller", $stateParams);
    var vm = this;
    // $('#successModal').modal('close');

    vm.submitManualData = submitManualData;
    vm.property = JSON.parse(localStorage.getItem('propertyDetails'));
    //////console.log("vm.property in manualIE: ", vm.property)

    vm.formData = {

    };

    vm.modalYesbutton = modalYesbutton;
    vm.gotoPropertyDetails = gotoPropertyDetails;
    vm.resetForm = resetForm;

    vm.datePickers = {
        asOfDate: false,
        reportCreationDate: false

    };
    vm.openDatePicker = function (_name) {
        vm.datePickers[_name] = true;
    };

    vm.dateFormat = 'MM/dd/yyyy';

    var initModal = function () {
        $("#myModal").modal('show');
    }();

    function resetForm() {
        vm.formData = {};
        $scope.manualForm.$setPristine();
        $scope.manualForm.$setUntouched();

    }

    function gotoPropertyDetails() {
        //$('#successModal').modal('hide');
        $state.go('updateIERR');
    }

    function modalYesbutton() {
        ////console.log('reset form');
        vm.formData = {};

        $scope.manualForm.$setPristine();
        $scope.manualForm.$setUntouched();

        //$('#successModal').modal('toggle');

    }


    function submitManualData() {
        var url = '/incomeExpenses/addPropertyIEManual';
        $("#preloader").css("display", "block");

        vm.formData.propId = localStorage.getItem("propertyId");
        vm.formData.baseRent = vm.formData.baseRent.toString();
        vm.formData.cashFlowNetIncome = vm.formData.cashFlowNetIncome.toString();
        vm.formData.miscellaneousIncome = vm.formData.miscellaneousIncome.toString();
        vm.formData.parkingIncome = vm.formData.parkingIncome.toString();
        vm.formData.realEstateTaxes = vm.formData.realEstateTaxes.toString();
        vm.formData.rentalIncome = vm.formData.rentalIncome.toString();
        vm.formData.totalAdministrative = vm.formData.totalAdministrative.toString();
        vm.formData.totalContractedServices = vm.formData.totalContractedServices.toString();
        vm.formData.totalExpenses = vm.formData.totalExpenses.toString();
        vm.formData.totalIncome = vm.formData.totalIncome.toString();
        vm.formData.totalMaintenance = vm.formData.totalMaintenance.toString();
        vm.formData.totalOperatingExpRecoverable = vm.formData.totalOperatingExpRecoverable.toString();
        vm.formData.totalOperatingExpUnRecoverable = vm.formData.totalOperatingExpUnRecoverable.toString();
        vm.formData.totalPersonnel = vm.formData.totalPersonnel.toString();
        vm.formData.totalTaxesAndInsurance = vm.formData.totalTaxesAndInsurance.toString();
        vm.formData.totalUtilities = vm.formData.totalUtilities.toString();

        ////console.log(vm.formData);

        AOTCService.postDataToServer(url, vm.formData)
            .then(function (result) {
                ////console.log("addPropertyIEManual: ", result);
                if (result.data.success) {
                    $scope.$emit('success', result.data.message);
                    $scope.manualForm.$setPristine();
                    $scope.manualForm.$setUntouched();
                    //$state.go('updateIERR');
                    //$('#successModal').modal('toggle'); // Success Model
                     $state.go('PropertyList.private_property_list');
                } else {
                    $scope.$emit('danger', result.data.message);
                }
                $("#preloader").css("display", "none");

            }, function (result) {
                //////console.log(result);
                $("#preloader").css("display", "none");
            });




        //call to server
        //
    }

    // setTimeout(function() {
    //     vm.formData.baseRent = 2017;
    //     $scope.$apply();
    //     $('#successModal').modal('show');

    // }, 100);











    ///=================================date picker===========================//


    // $('#sandbox-container input').datepicker({
    //     autoclose: true
    // });


    // $('#sandbox-container input').on('show', function (e) {
    //     console.debug('show', e.date, $(this).data('stickyDate'));

    //     if (e.date) {
    //         $(this).data('stickyDate', e.date);
    //     } else {
    //         $(this).data('stickyDate', null);
    //     }
    // });

    // $('#sandbox-container input').on('hide', function (e) {
    //     console.debug('hide', e.date, $(this).data('stickyDate'));
    //     var stickyDate = $(this).data('stickyDate');

    //     if (!e.date && stickyDate) {
    //         console.debug('restore stickyDate', stickyDate);
    //         $(this).datepicker('setDate', stickyDate);
    //         $(this).data('stickyDate', null);
    //     }
    // });


}
/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 248 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {

_manualRR.$inject = ["$rootScope", "$stateParams", "$anchorScroll", "$state", "DTOptionsBuilder", "DTColumnDefBuilder", "$location", "$scope", "$http", "__env", "$log", "AOTCService", "$timeout"];
module.exports = _manualRR;


//angular.module('AOTC').controller('manualRR', _manualRR
//    );

function _manualRR($rootScope, $stateParams, $anchorScroll, $state, DTOptionsBuilder, DTColumnDefBuilder, $location, $scope, $http, __env, $log, AOTCService, $timeout) {
    //////console.log("manualRR Controller");

    var vm = this;
    // $('#myModalquestion').modal('toggle');

    vm.property = {};
    vm.tenants = [];

    vm.formData = {};

    $(document).on('focus', ".datepicker_recurring_start", function () {
        $(this).datepicker();
    });

    if ($stateParams.property) {
        localStorage.setItem('SelectedProperty', angular.toJson($stateParams.property));
        vm.property = $stateParams.property;
    } else {
        vm.property = JSON.parse(localStorage.getItem('propertyDetails'));
    }
    // ////console.log("vm.property in RRmanual: ", vm.property);

    vm.addNewTenant = addNewTenant;
    vm.removeTenant = removeTenant;
    vm.allSelected = 0;
    vm.selectAll = selectAll;
    vm.submitRRForm = submitRRForm;
    vm.resetForm = resetForm;
    vm.gotoPropertyDetails = gotoPropertyDetails;
    vm.toggleSelection = toggleSelection;
    vm.dateFormat = 'MM/dd/yyyy';


    // $timeout(function() {
    // $('#successModal').modal('toggle');

    // }, 500);

    function gotoPropertyDetails() {
        $('#successModal').modal('toggle');

        $timeout(function () {
            $state.go('updateIERR');
        }, 500);
    }

    function attachValidTenants() {
        var validTenants = [];
        for (var i = 0; i < vm.tenants.length; i++) {
            var validObj = false;
            var obj = vm.tenants[i];
            for (var key in obj) {
                if (obj[key] && obj[key].toString().indexOf("object:") < 0) {
                    validObj = true;
                    obj[key] = obj[key].toString();
                }
            }
            if (validObj) {
                validTenants.push(obj);
            }
        }

        return validTenants;
    }

    function submitRRForm() {
        var url = '/rentRolls/addPropertyRRManual';
        $("#preloader").css("display", "block");

        vm.formData.propId = localStorage.getItem("propertyId");
        vm.formData.baseRent = vm.formData.baseRent.toString();
        vm.formData.totalGrossRentMonthly = vm.formData.totalGrossRentMonthly.toString();
        vm.formData.totalGrossRentPerSquareFeetPerYear = vm.formData.totalGrossRentPerSquareFeetPerYear.toString();
        vm.formData.totalSF = vm.formData.totalSF.toString();
        vm.formData.vacantPercentage = vm.formData.vacantPercentage.toString();
        vm.formData.vacantSF = vm.formData.vacantSF.toString();

        vm.formData.tenants = attachValidTenants();

        ////console.log('submitted form : func=> submitRRForm', url);
        ////console.log(vm.formData)

        AOTCService.postDataToServer(url, vm.formData).then(function (result) {
            ////console.log('Server Data  :');
            ////console.log(result);

            $scope.rentRollForm.$setPristine();
            $scope.rentRollForm.$setUntouched();

            $scope.tenantForm.$setPristine();
            $scope.tenantForm.$setUntouched();

            if (result.data.success) {
                $scope.$emit('success', result.data.message);
                $('#successModal').modal('toggle');
            } else {
                $scope.$emit('danger', result.data.message);

            }

            $("#preloader").css("display", "none");

        }, function (result) {

            $("#preloader").css("display", "none");
        });
    }

    function selectAll() {

        vm.allSelected = +!vm.allSelected;
        for (var i = 0; i < vm.tenants.length; i++) {
            var tenant = vm.tenants[i];
            if (vm.allSelected == 0) {
                tenant.selected = 0;
            } else {
                tenant.selected = 1;
            }
        }
        // vm.showRemoveButton =  vm.allSelected;
        checkTenantSelection();
    }

    function toggleSelection(tenant) {
        tenant.selected = +!tenant.selected;
        checkTenantSelection();
    }
    vm.showRemoveButton = false;

    function checkTenantSelection() {
        var active = false;
        for (var i = 0; i < vm.tenants.length; i++) {
            var tenant = vm.tenants[i];
            if (tenant.selected) {
                active = true;
            }
        }
        vm.showRemoveButton = active;


        var allActive = true;
        for (var i = 0; i < vm.tenants.length; i++) {
            var tenant = vm.tenants[i];
            if (!tenant.selected) {
                allActive = false;
            }
        }
        //if no one is active then un-select all
        vm.allSelected = allActive;
    }

    // $timeout(function() {
    //     addNewTenant();

    // }, 500);



    function addNewTenant() {

        vm.tenants.push({
            selected: 0,
            unit: '',
            tenant: '',
            squareFeet: '',
            startDate: '',
            endDate: '',
            baseRentMonthly: '',
            baseRentAnnualized: '',
            baseRentPerSquareFeetPerYear: '',
            baseRentPercentRentBump: '',
            rolling12Months: '',
            rollingPerSquareFeetPerYear: '',
            grossRentMonthly: '',
            grossRentPerSquareFeetPerYear: ''
        });

        $scope.tenantForm.$setPristine();
        $scope.tenantForm.$setUntouched();
    }


    function resetForm() {
        vm.formData = {};
        vm.tenants = [];
        vm.showRemoveButton = false;

        $scope.rentRollForm.$setPristine();
        $scope.rentRollForm.$setUntouched();

        $scope.tenantForm.$setPristine();
        $scope.tenantForm.$setUntouched();

        $('#successModal').modal('hide');

    }

    function removeTenant() {
        var unSelectedTenants = [];
        for (var i = 0; i < vm.tenants.length; i++) {
            var tenant = vm.tenants[i];
            if (tenant.selected == 0) {
                unSelectedTenants.push(tenant);
            }
        }

        vm.tenants = unSelectedTenants;
        if (vm.tenants.length == 0) {
            vm.allSelected = 0;
            vm.showRemoveButton = false;
        }
    }

    vm.datePickers = {
        asOfDate: false,
        reportCreationDate: false

    };
    vm.openDatePicker = function(_name){
        vm.datePickers[_name] = true;
    };

    // $('#sandbox-container input').datepicker({
    //     autoclose: true
    // });

    // $('#sandbox-container input').on('show', function (e) {
    //     console.debug('show', e.date, $(this).data('stickyDate'));

    //     if (e.date) {
    //         $(this).data('stickyDate', e.date);
    //     } else {
    //         $(this).data('stickyDate', null);
    //     }
    // });

    // $('#sandbox-container input').on('hide', function (e) {
    //     console.debug('hide', e.date, $(this).data('stickyDate'));
    //     var stickyDate = $(this).data('stickyDate');

    //     if (!e.date && stickyDate) {
    //         console.debug('restore stickyDate', stickyDate);
    //         $(this).datepicker('setDate', stickyDate);
    //         $(this).data('stickyDate', null);
    //     }
    // });
}

/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 249 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {

_taxBill.$inject = ["$stateParams", "$anchorScroll", "$state", "DTOptionsBuilder", "DTColumnDefBuilder", "$location", "$scope", "$http", "__env", "$log", "AOTCService", "$timeout"];
module.exports = _taxBill;

//angular.module('AOTC').controller('taxBill', _taxBill);
function _taxBill($stateParams, $anchorScroll, $state, DTOptionsBuilder, DTColumnDefBuilder, $location, $scope, $http, __env, $log, AOTCService, $timeout) {
    //////console.log("taxBill controller", $stateParams);

    var vm = this;

    vm.formData = {};
    vm.property = {};
    vm.propertyId = localStorage.getItem('propertyId')

    if ($stateParams.property) {
        localStorage.setItem('SelectedProperty', angular.toJson($stateParams.property));
        vm.property = $stateParams.property;
    } else {
        vm.property = JSON.parse(localStorage.getItem('propertyDetails'));
    }
    vm.resetForm = resetForm;
    vm.submitAccData = submitAccData;

    function submitAccData() {
        $("#preloader").css("display", "block");

        var url = '/properties/updateTaxAccNo';

        vm.formData.propId = vm.propertyId;

        // ////console.log(vm.formData);
        AOTCService.postDataToServer(url, vm.formData)
            .then(function (result) {
                ////console.log("updateTaxAccNo: ", result);

                if (result.data.success) {
                    $scope.accForm.$setPristine();
                    $scope.accForm.$setUntouched();
                    $('#successModal').modal('toggle');
                } else {
                    $scope.$emit('error', result.data.message);
                }
                $("#preloader").css("display", "none");

            }, function (result) {
                $("#preloader").css("display", "none");
            }
        );
    }

    vm.gotoupdateProperty = gotoupdateProperty;
    vm.modalYesbutton = modalYesbutton;

    function gotoupdateProperty() {
        $('#successModal').modal('hide');
        $state.go('updateIERR');
    }

    function modalYesbutton() {
        vm.formData = {};

        $scope.accForm.$setPristine();
        $scope.accForm.$setUntouched();

        $('#successModal').modal('toggle');
    }

    function resetForm() {
        vm.formData = {};
        $scope.accForm.$setPristine();
        $scope.accForm.$setUntouched();
    }
}

/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 250 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {

_multipleUploadIERR.$inject = ["UtilService", "$stateParams", "$state", "DTOptionsBuilder", "DTColumnDefBuilder", "$location", "$scope", "$http", "__env", "$log", "AOTCService", "$timeout"];
module.exports = _multipleUploadIERR;

//angular.module('AOTC').controller('multipleUploadIERR', _multipleUploadIERR
//    );
function _multipleUploadIERR(UtilService, $stateParams, $state, DTOptionsBuilder, DTColumnDefBuilder, $location, $scope, $http, __env, $log, AOTCService, $timeout) {
    //////console.log("multipleUploadIERR controller");

    var vm = this;

    vm.showIEFile = false;
    vm.showRRFile = false;
    vm.IEFileName = "";
    vm.RRFileName = "";
    vm.uploadSelectedFiles = uploadSelectedFiles;
    vm.showMyModal = showMyModal;

    vm.propertyId = "";
    vm.RRFileUploadStatus = false;
    vm.IEFileUploadStatus = false;
    vm.property = {};

    vm.IERR_Result = {
        IEData: [],
        RRData: []
    };

    function showMyModal(selected) {

        UtilService.clearFile();

        vm.hideModalFormFillButton = false;
        vm.FileNames = [];
        vm.selected = selected;

        if (vm.selected == 0) {

            $scope.uploadFileLabel = 'Upload File(s)';
            $scope.formFillLabel = 'Fill Form';
            $scope.modalHeading = 'Income Expense Statement(s) or enter data manually';

        } else if (vm.selected == 1) {

            $scope.uploadFileLabel = 'Upload File(s)';
            $scope.formFillLabel = 'Fill Form';
            $scope.modalHeading = 'Rent Roll Report(s) or enter data manually';
        }
        $('#myModal').modal('toggle');
    }

    function sendRRData(callback) {

        var url = '/rentRolls/addBulkPropertyRR';

        $("#preloader").css("display", "block");

        AOTCService.uploadFiles(url, vm.RRData)
            .then(function (result) {

                $("#preloader").css("display", "none");

                ////console.log("addBulkPropertyRR result: ", result);
                var serverData = result.data;

                if (serverData.success) {
                    $('#myModal').modal('toggle');

                    setTimeout(function () {
                        $state.go('TaskManager', {
                            messageFrom: 'multipleUploadIERR',
                            message: serverData.message
                        });

                    }, 500);

                } else {
                    $scope.$emit('danger', serverData.message);
                }


                callback();

            }, function (result) {

                $("#preloader").css("display", "none");

            });
    }

    function sendIEData(callback) {
        $("#preloader").css("display", "block");

        var url = '/incomeExpenses/addBulkPropertyIE';

        AOTCService.uploadFiles(url, vm.IEData)
            .then(function (result) {
                $("#preloader").css("display", "none");

                ////console.log("addBulkPropertyIE result: ", result);
                var serverData = result.data;

                if (serverData.success) {
                    $('#myModal').modal('toggle');

                    setTimeout(function () {

                        $state.go('TaskManager', {
                            messageFrom: 'multipleUploadIERR',
                            message: serverData.message
                        });


                    }, 500);



                } else {
                    $scope.$emit('danger', serverData.message);
                }

                callback();

            }, function (result) {
                $("#preloader").css("display", "none");
            });
    }

    $scope.fileUploaded = function () {

        vm.FileNames = [];

        if (vm.selected == 0) { //IE
            var files = document.getElementById('files-IERR').files;
            vm.IEData = files;
            for (var i = 0; i < files.length; i++) {
                vm.FileNames.push({
                    name: files[i].name,
                    uploadStatus: true
                });
            }
        } else if (vm.selected == 1) { //RR
            var files = document.getElementById('files-IERR').files;
            vm.RRData = files;
            for (var i = 0; i < files.length; i++) {
                vm.FileNames.push({
                    name: files[i].name,
                    uploadStatus: true
                });
            }
        }



        // Parsing is done. Update UI.
        $scope.$apply();
    }

    function uploadSelectedFiles() {
        if (vm.selected == 0) {
            sendIEData(function () {
                ////console.log("sendIEData");
            });

        } else if (vm.selected == 1) {
            sendRRData(function () {
                ////console.log("sendRRData");
            });
        }
    }
}

/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 251 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {

_uploadIERR.$inject = ["$stateParams", "$state", "DTOptionsBuilder", "DTColumnDefBuilder", "$location", "$scope", "$http", "__env", "$log", "AOTCService", "$timeout"];
module.exports = _uploadIERR;

//angular.module('AOTC').controller('uploadIERR', _uploadIERR
//    );
function _uploadIERR($stateParams, $state, DTOptionsBuilder, DTColumnDefBuilder, $location, $scope, $http, __env, $log, AOTCService, $timeout) {
    //////console.log("UploadIERR controller", $stateParams.property);

    var vm = this;
    vm.showIEFile = false;
    vm.showRRFile = false;
    vm.IEFileName = "";
    vm.RRFileName = "";
    vm.sendData = sendData;

    vm.propertyId = "";
    vm.property = {};

    vm.RRFileUploadStatus = false;
    vm.IEFileUploadStatus = false;

    vm.IERR_Result = {
        IEData: null,
        RRData: null
    };

    if ($stateParams.property) {
        localStorage.setItem('SelectedProperty', angular.toJson($stateParams.property));
        vm.property = $stateParams.property;
        vm.propertyId = $stateParams.property.prop._id;
    } else {
        vm.property = JSON.parse(localStorage.getItem('SelectedProperty'));
        vm.propertyId = vm.property.prop._id;
    }

    ////console.log(vm.property);


    function sendData() {

        if (vm.showRRFile) {
            ////console.log('rr data')
            sendRRData();
        }
        if (vm.showIEFile) {
            ////console.log('ie data')

            sendIEData();
        }
    }

    function sendRRData() {

        var url = '/rentRolls/addPropertyRR?propId=' + vm.propertyId;
        $("#preloader").css("display", "block");
        ////console.log("==>", url);
        ////console.log("vm.RRData==>", vm.RRData);

        ///========================================================/ //

        AOTCService.uploadFiles(url, vm.RRData)
            .then(function (result) {
                ////console.log(result);
                vm.IERR_Result.RRData = result.data;

                if (vm.RRData && vm.IEData) {
                    ////console.log('wait');
                    vm.RRFileUploadStatus = true;
                    if (vm.IEFileUploadStatus) {
                        checkResult();
                    }

                } else {
                    ////console.log('dont wait');
                    checkResult();
                }

            }, function (result) {
                $("#preloader").css("display", "none");
                ////console.log(result);
            });

    }

    function sendIEData() {
        $("#preloader").css("display", "block");
        var url = '/incomeExpenses/addPropertyIE?propId=' + vm.propertyId;
        ////console.log("==>", url);
        ////console.log("vm.IEData==>", vm.IEData);

        ///========================================================/ //

        AOTCService.uploadFiles(url, vm.IEData)
            .then(function (result) {
                ////console.log("sendIEData result");

                ////console.log(result);
                vm.IERR_Result.IEData = result.data;

                if (vm.RRData && vm.IEData) {
                    vm.IEFileUploadStatus = true;
                    if (vm.RRFileUploadStatus) {
                        checkResult();
                    }

                } else {
                    checkResult();
                }

            }, function (result) {
                $("#preloader").css("display", "none");
                ////console.log(result);
            });

    }

    function checkResult() {

        ////console.log(vm.IERR_Result);

        if (vm.IERR_Result.IEData && vm.IERR_Result.RRData) {
            ////console.log('IE RR Both Data checking');
            var IE_Result = vm.IERR_Result.IEData;
            var RR_Result = vm.IERR_Result.RRData;


            if (IE_Result.success == true && IE_Result.result && IE_Result.result.length == 0 &&
                RR_Result.success == true && RR_Result.result.length == 0) {
                ////console.log('every thing successfull and length is zero');
                $state.go('listProperties', { messageFrom: "uploadIERR" });

            } else {
                //show un parsed files in result
                ////console.log('show un parsed files');
                for (var i = 0; i < vm.IEFileNames.length; i++) {
                    var RRFile = vm.IEFileNames[i].name;
                    for (var k = 0; k < IE_Result.result.length; k++) {
                        if (RRFile == IE_Result.result[k]) {
                            vm.IEFileNames[i].uploadStatus = false;
                        }
                    }
                }

                for (var i = 0; i < vm.RRFileNames.length; i++) {
                    var RRFile = vm.RRFileNames[i].name;
                    for (var k = 0; k < RR_Result.result.length; k++) {
                        if (RRFile == RR_Result.result[k]) {
                            vm.RRFileNames[i].uploadStatus = false;
                        }
                    }
                }

                ////console.log(vm.RRFileNames);

                ////console.log(vm.IEFileNames);
                $("#preloader").css("display", "none");
                $(".dangerr").fadeIn(1500).delay(500).fadeOut(500);





            }


        } else if (vm.IERR_Result.IEData) {

            ////console.log('IE Data checking');
            var IE_Result = vm.IERR_Result.IEData;
            ////console.log(IE_Result)
            if (IE_Result.result == null) {
                IE_Result.result = [];
            }

            if (IE_Result.success == true && IE_Result.result.length == 0) {
                ////console.log('every thing successfull and length is zero');
                $state.go('listProperties', { messageFrom: "uploadIERR" });

            } else {
                //show un parsed files in result
                ////console.log('show un parsed files in result key');
                ////console.log("vm.IEFileNames");
                ////console.log(vm.IEFileNames);

                for (var i = 0; i < vm.IEFileNames.length; i++) {
                    var RRFile = vm.IEFileNames[i].name;
                    for (var k = 0; k < IE_Result.result.length; k++) {
                        if (RRFile == IE_Result.result[k]) {
                            vm.IEFileNames[i].uploadStatus = false;
                        }
                    }
                }
                $("#preloader").css("display", "none");
                $(".dangerr").fadeIn(1500).delay(500).fadeOut(500);

            }
        } else if (vm.IERR_Result.RRData) {
            ////console.log('RR Data checking');
            var RR_Result = vm.IERR_Result.RRData;
            ////console.log(RR_Result)

            if (RR_Result.success == true && RR_Result.result && RR_Result.result.length == 0) {
                ////console.log('every thing successfull and length is zero');
                $state.go('listProperties', { messageFrom: "uploadIERR" });

            } else {
                //show un parsed files in reult
                ////console.log('show un parsed files in result key');
                ////console.log("vm.RRFileNames");
                ////console.log(vm.RRFileNames);


                for (var i = 0; i < vm.RRFileNames.length; i++) {
                    var RRFile = vm.RRFileNames[i].name;
                    for (var k = 0; k < RR_Result.result.length; k++) {
                        if (RRFile == RR_Result.result[k]) {
                            vm.RRFileNames[i].uploadStatus = false;
                        }
                    }
                }
                // ////console.log(vm.RRFileNames);


                $("#preloader").css("display", "none");
                $(".dangerr").fadeIn(1500).delay(500).fadeOut(500);

            }

        }

    }

    vm.IEFileNames = [];
    vm.RRFileNames = [];

    $scope.IEfileUploaded = function () {


        // ////console.log(vm.IEFileNames)

    }

    vm.removeIEFile = removeIEFile;

    function removeIEFile(file) {
        // ////console.log(vm.IEFileNames);

        // for (var i = 0; i < vm.IEFileNames.length; i++) {
        //     var obj = vm.IEFileNames[i];
        //     if(obj.name == file.name){
        //         vm.IEFileNames.splice(i,1)
        //     }
        // }
    }


    $scope.RRfileUploaded = function () {

        ////console.log('RRfileUploaded used');
        vm.RRFileNames = [];




        var files = document.getElementById('file-rr').files;
        vm.RRData = files;

        ////console.log(files);
        // vm.RRFileName = file.name;
        for (var i = 0; i < files.length; i++) {
            vm.RRFileNames.push({
                name: files[i].name,
                uploadStatus: true
            });
        }

        vm.showRRFile = true;

        // Parsing is done. Update UI.
        // $scope.parsingComplete = true;
        $scope.$digest();

    }

}


/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 252 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


_unlinkedProperties.$inject = ["$stateParams", "$anchorScroll","$state", "DTOptionsBuilder", "DTColumnDefBuilder", "$location", "$scope", "$http", "__env", "$log", "AOTCService", "$timeout"];
module.exports = _unlinkedProperties;

//angular.module('AOTC').controller('unlinkedProperties', _unlinkedProperties
//);
function _unlinkedProperties($stateParams, $anchorScroll, $state, DTOptionsBuilder, DTColumnDefBuilder, $location, $scope, $http, __env, $log, AOTCService, $timeout) {
    ////console.log("unlinkedProperties controller", $stateParams);

    var vm = this;

    vm.isActive = isActive;
    vm.showUnlinkedFiles = showUnlinkedFiles;
    vm.showCorruptFiles = showCorruptFiles;
    vm.showUnparsedFiles = showUnparsedFiles;

    function showUnlinkedFiles() {
        $state.go('unlinkedProperties.unlinkedFiles')
    }
    function showCorruptFiles() {
        $state.go('unlinkedProperties.corruptFiles')
    }
    function showUnparsedFiles() {
        $state.go('unlinkedProperties.unparsedFiles')
    }

    function isActive(viewLocation) {
        return viewLocation === $location.path();
    }

}


/***/ }),
/* 253 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


_corruptFiles.$inject = ["$stateParams", "$anchorScroll", "$state", "DTOptionsBuilder", "DTColumnDefBuilder", "$location", "$scope", "$http", "__env", "$log", "AOTCService", "$timeout"];
module.exports = _corruptFiles;

//angular.module('AOTC').controller('corruptFiles', _corruptFiles
//);
function _corruptFiles($stateParams, $anchorScroll, $state, DTOptionsBuilder, DTColumnDefBuilder, $location, $scope, $http, __env, $log, AOTCService, $timeout) {
    //////console.log("corruptFiles controller", $stateParams);

    var vm = this;

}

/***/ }),
/* 254 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {

_unlinkedFiles.$inject = ["UnlinkService"];
module.exports = _unlinkedFiles;

//angular.module('AOTC').controller('unlinkedFiles', _unlinkedFiles
//);

function _unlinkedFiles(UnlinkService) {
    //////console.log("unlinkedFiles controller");

    var vm = this;
    vm.tableData = [];
    $("#preloader").css("display", "block");

    UnlinkService.getUnlinkedFiles()
        .then(function (result) {

            ////console.log("\n=>server result\n");
            // ////console.log(result);
            vm.tableData = result.data.result;
            ////console.log(vm.tableData);

            $("#preloader").css("display", "none");


        }, function (err) {
            $("#preloader").css("display", "none");
            ////console.log("\n=>server error\n");
            ////console.log(err);


        });
}

/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 255 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


_UnlinkService.$inject = ["$http", "$q"];
module.exports = _UnlinkService;

//angular.module('AOTC')
//    .factory('UnlinkService', _UnlinkService
//    );
function _UnlinkService($http, $q) {

    function getDataFromServer(apiUrl) {
        // ////console.log(apiUrl);
        var token = localStorage.getItem('token');

        var req = $http({
            method: "GET",
            url: apiUrl,
            headers: {
                "Access-Control-Allow-Origin": "*",
                "Content-Type": "application/json",
                "Authorization": token

            }

        });

        return req;

    }

    function putDataToServer(url, userData) {
        var token = localStorage.getItem('token');

        var request = $http({
            method: "PUT",
            url: url,
            data: userData,
            headers: {
                "Access-Control-Allow-Origin": "*",
                "Content-Type": "application/json",
                "Authorization": token
            }

        });

        return request;

    }

    function postDataToServer(url, userData) {
        var token = localStorage.getItem('token');

        var request = $http({
            method: "POST",
            url: url,
            data: userData,
            headers: {
                "Access-Control-Allow-Origin": "*",
                "Content-Type": "application/json",
                "Authorization": token
            }

        });
        return request;

    }




    function getUnlinkedFiles() {
        var url = '/unlinkedFiles/getUnlinkedFiles';
        ////console.log(url);

        var deferred = $q.defer();

        getDataFromServer(url)
            .then(function (result) {
                deferred.resolve(result);

            }, function (result) {
                deferred.reject(result);
                ////console.log(result);
            });
        return deferred.promise;
    }

    return {
        getUnlinkedFiles: getUnlinkedFiles,
        getDataFromServer: getDataFromServer,
        postDataToServer: postDataToServer,
        putDataToServer: putDataToServer

    };

}


/***/ }),
/* 256 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


_unparsedFiles.$inject = ["$stateParams", "$anchorScroll", "$state", "DTOptionsBuilder", "DTColumnDefBuilder", "$location", "$scope", "$http", "__env", "$log", "AOTCService", "$timeout"];
module.exports = _unparsedFiles;

//angular.module('AOTC').controller('unparsedFiles', _unparsedFiles
//);
function _unparsedFiles($stateParams, $anchorScroll, $state, DTOptionsBuilder, DTColumnDefBuilder, $location, $scope, $http, __env, $log, AOTCService, $timeout) {
    ////console.log("unparsedFiles controller", $stateParams);

    var vm = this;

}

/***/ }),
/* 257 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {

_updateIERR.$inject = ["UtilService", "$stateParams", "$anchorScroll","$state", "DTOptionsBuilder", "DTColumnDefBuilder", "$location", "$scope", "$http", "__env", "$log", "AOTCService", "$timeout"];
module.exports = _updateIERR;

//angular.module('AOTC')
//    .controller('updateIERR', _updateIERR
//    );
function _updateIERR(UtilService, $stateParams, $anchorScroll, $state, DTOptionsBuilder, DTColumnDefBuilder, $location, $scope, $http, __env, $log, AOTCService, $timeout) {
    ////console.log("updateIERR controller", $stateParams);
    var vm = this;
    // if($stateParams.id) {
    // console.log($stateParams.id)
    // }
    vm.property = {};
    vm.property = JSON.parse(localStorage.getItem('propertyDetails'));
    vm.propertyId = JSON.parse(localStorage.getItem('propertyId'));
    vm.userId = JSON.parse(localStorage.getItem('userId'));

    vm.FileNames = [];
    vm.selected = -1;

    vm.selection = [{
        id: 0,
        state: 'IE'
    }, {
        id: 1,
        state: 'RR'
    }, ];

    vm.uploadData = uploadData;
    vm.gotoManualUpload = gotoManualUpload;
    vm.images = [];

    vm.IERR_Result = {
        IEData: null,
        RRData: null
    };

    vm.otherData = [];
    $scope.uploadFileLabel = '';
    $scope.formFillLabel = '';
    $scope.modalHeading = '';
    vm.hideModalFormFillButton = false;

    vm.showMyModal = showMyModal;

    function gotoManualUpload() {

        $('#myModal').modal('toggle');
        setTimeout(function () {
            if (vm.selected == 0) //IE
            {
                $state.go('manualIE');

            } else if (vm.selected == 1) //RR
            {
                $state.go('manualRR');
            } else if (vm.selected == 3) // TaxBill
            {
                $state.go('taxBill');
            }
        }, 500);
    }

    function uploadData() {
        ////console.log('uploadData');
        if (vm.selected == 0) { // IE

            sendIEData();
        } else if (vm.selected == 1) { // RR

            sendRRData();
        } else if (vm.selected == 3) { // taxBills

            sendTaxBill();
        } else if (vm.selected == 4) { // moreFiles

            sendOthersData();
        }
    }

    function sendIEData() {
        if (vm.IEData) {
            $("#preloader").css("display", "block");
            var url = '/incomeExpenses/addPropertyIE?propId=' + vm.propertyId;
            ////console.log("==>", url);
            ////console.log("vm.IEData==>", vm.IEData);
            ////console.log("==>", url);
            // ////console.log("vm.IEData==>", vm.IEData);

            AOTCService.uploadFiles(url, vm.IEData)
                .then(function (result) {

                    ////console.log("addPropertyIE", result);

                    vm.IERR_Result.IEData = result.data;
                    $('#myModal').modal('toggle');
                    $timeout(function () {
                        ////console.log('task manager');
                        $state.go('TaskManager');

                    }, 500)

                    // checkResult();
                }, function (result) {
                    $("#preloader").css("display", "none");
                    ////console.log(result);
                });
        }
    }

    function sendRRData() {
        if (vm.RRData) {
            $("#preloader").css("display", "block");
            var url = '/rentRolls/addPropertyRR?propId=' + vm.propertyId;;
            $("#preloader").css("display", "block");
            ////console.log("==>", url);
            // ////console.log("vm.RRData==>", vm.RRData);

            AOTCService.uploadFiles(url, vm.RRData)
                .then(function (result) {

                    ////console.log("addPropertyRR: ", result);

                    vm.IERR_Result.RRData = result.data;
                    $('#myModal').modal('toggle');
                    $timeout(function () {
                        ////console.log('task manager');
                        $state.go('TaskManager');
                    }, 500);

                    // checkResult();
                }, function (result) {
                    $("#preloader").css("display", "none");
                    ////console.log(result);
                });
        }
    }

    function sendOthersData() {
        ////console.log('sendOthersData');
        ////console.log("vm.othersData==>", vm.othersData);

        if (vm.othersData) {
            $("#preloader").css("display", "block");

            var url = '/otherFiles/uploadOtherFiles?propId=' + vm.propertyId;

            var desc = '';

            for (var i = 0; i < vm.FileNames.length; i++) {
                if (i + 1 == vm.FileNames.length) {
                    desc += vm.FileNames[i].description;
                } else {
                    desc += vm.FileNames[i].description + ',';
                }
            }

            AOTCService.uploadFilesWithDescription(url, vm.othersData, desc)
                .then(function (result) {
                    ////console.log(result);

                    var serverData = result.data;
                    ////console.log(serverData);

                    if (serverData.success == true) {
                        $("#preloader").css("display", "none");
                        $('#myModal').modal('toggle');
                        $scope.$emit('success', serverData.message);
                        setTimeout(function () {
                            $state.go("viewIERR.other_files"); // Defined in
                        }, 500);
                    } else {

                        $("#preloader").css("display", "none");
                        // $(".dangerr").fadeIn(1500).delay(500).fadeOut(500);
                        $scope.$emit('danger', serverData.message);
                    }
                }, function (result) {
                    $("#preloader").css("display", "none");
                    ////console.log(result);
                });
        }
    }

    function sendTaxBill() {
        if (vm.taxBill) {
            $("#preloader").css("display", "block");

            var url = '/taxBills/uploadTaxBillFile?propId=' + vm.propertyId;

            var desc = '';

            for (var i = 0; i < vm.FileNames.length; i++) {
                if (i + 1 == vm.FileNames.length) {
                    desc += vm.FileNames[i].description;
                } else {
                    desc += vm.FileNames[i].description + ',';
                }
            }
            ////console.log(desc);

            AOTCService.uploadFilesWithDescription(url, vm.taxBill, desc)
                .then(function (result) {
                    ////console.log(result);

                    var serverData = result.data;
                    ////console.log(serverData);

                    if (serverData.success == true) {
                        $("#preloader").css("display", "none");
                        $('#myModal').modal('toggle');
                        $scope.$emit('success', serverData.message);
                        setTimeout(function () {
                            $state.go("viewIERR.tax_bills"); // Defined
                        }, 500);
                    } else {
                        $("#preloader").css("display", "none");
                        $(".dangerr").fadeIn(1500).delay(500).fadeOut(500);
                    }
                }, function (result) {
                    $("#preloader").css("display", "none");
                    ////console.log(result);
                });
        }
    }

    function showMyModal(selected) {

        UtilService.clearFile();

        vm.hideModalFormFillButton = false;
        vm.FileNames = [];
        vm.selected = selected;

        vm.IEData = [];
        vm.RRData = [];
        vm.taxBill = [];
        vm.othersData = [];

        if (vm.selected == 0) {

            $scope.uploadFileLabel = 'Upload File(s)';
            $scope.formFillLabel = 'Fill Form';
            $scope.modalHeading = 'Income Expense Statement(s) or enter data manually';

        } else if (vm.selected == 1) {

            $scope.uploadFileLabel = 'Upload File(s)';
            $scope.formFillLabel = 'Fill Form';
            $scope.modalHeading = 'Rent Roll Report(s) or enter data manually';

        } else if (vm.selected == 3) {

            $scope.uploadFileLabel = 'Upload File(s)';
            $scope.formFillLabel = 'Fill Form';
            $scope.modalHeading = 'Tax Bill(s) or enter data manually';

            // vm.hideModalFormFillButton = true;
        } else if (vm.selected == 4) {

            $scope.uploadFileLabel = 'Upload File(s)';
            vm.hideModalFormFillButton = true;
            $scope.modalHeading = 'More File(s)';

        }

        $('#myModal').modal('toggle');
    }

    $scope.fileUploaded = function (files) {

        var files = document.getElementById('file-1').files;
        vm.FileNames = [];


        if (vm.selected == 0) { //IE
            vm.IEData = files;
            for (var i = 0; i < files.length; i++) {
                vm.FileNames.push({
                    name: files[i].name,
                    uploadStatus: true
                });
            }
        } else if (vm.selected == 1) { //RR
            vm.RRData = files;
            for (var i = 0; i < files.length; i++) {
                vm.FileNames.push({
                    name: files[i].name,
                    uploadStatus: true
                });
            }
        } else if (vm.selected == 3) { // TaxBills
            vm.taxBill = files;
            for (var i = 0; i < files.length; i++) {
                vm.FileNames.push({
                    name: files[i].name,
                    description: '',
                    uploadStatus: true
                });
            }
        } else if (vm.selected == 4) { // others
            vm.othersData = files;
            for (var i = 0; i < files.length; i++) {
                vm.FileNames.push({
                    name: files[i].name,
                    description: '',
                    uploadStatus: true
                });
            }
        }
        // Parsing is done. Update UI.
        $scope.$apply();
    }


}
/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 258 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {


_income_expense.$inject = ["$stateParams","$location", "$scope", "$http", "__env", "$log", "AOTCService","UtilService", "$timeout"];
module.exports = _income_expense;

//angular.module('AOTC').controller('income_expense', _income_expense
//    );
function _income_expense($stateParams, $location, $scope, $http, __env, $log, AOTCService, UtilService, $timeout) {
    ////console.log("income_expense  controller", $stateParams);

    var vm = this;
    // $scope.user = {
    //     name: 'awesome user'
    // };

    vm.numberFormatter = function (val) {
        var result = UtilService.numberFormatter(val);
        return result
    };

    vm.keyValMaker = function (object) {
        var result;
        result = UtilService.keyValMaker(object);
        return result;
    };

    vm.reducedData = function (object) {
        var result;
        result = UtilService.reducedData(object);
        return result;
    };

    // vm.IERRProperty = JSON.parse(localStorage.getItem('viewIERRProperty'));
    vm.propertiesCount = localStorage.getItem('propertiesCount');
    vm.IERRProperty = JSON.parse(localStorage.getItem('propertyDetails'));
    vm.propertyId = JSON.parse(localStorage.getItem('propertyId'));

    setTimeout(function () {
        $('#paragraphs').cascadingDivs();

    }, 200);


    // ////console.log(vm.IERRProperty)

    vm.toggleActiveClass = toggleActiveClass;

    function toggleActiveClass(property) {

        if (property.activeClass == "glyphicon-plus") {

            property.activeClass = "glyphicon-minus";

        } else {

            property.activeClass = "glyphicon-plus";

        }

        for (var i = 0; i < vm.tableData.length; i++) {
            var pr = vm.tableData[i];
            if (pr.id != property.id) {
                pr.activeClass = "glyphicon-plus";
            }

        }
    }

    getPropertyIE();
    getPropertyDataReduction();

    vm.hideYardiTable = false;


    function getPropertyIE() {
        var url = '/incomeExpenses/getPropertyIE';
        //var url = '/properties/getPropertyIE?id=36';
        ////console.log(url)
        var _data = {"propId": vm.propertyId};
        $("#preloader").css("display", "block");

        AOTCService.postDataToServer(url, _data)
            .then(function (result) {
                var serverData = result.data;
                ////console.log('getPropertyIE server data', result);

                if (serverData.success) {

                    vm.tableData = serverData.result;
                    ////console.log(vm.tableData)

                    if (vm.tableData.length == 0) {
                        vm.hideYardiTable = true;

                    }


                    for (var i = 0; i < vm.tableData.length; i++) {
                        var prop = vm.tableData[i];

                        prop.id = prop.IE._id;
                        if (i == 0) {
                            prop.isActive = true;
                            prop.activeClass = 'glyphicon-minus'
                        } else {
                            prop.isActive = false;
                            prop.activeClass = 'glyphicon-plus'
                        }

                    }
                    $("#preloader").css("display", "none");
                }

                // id: 'collapseOne',
                //     acc_heading: 'first record',
                //     isActive: true,
                //     activeClass: 'glyphicon-minus'



            }, function (result) {
                //some error
                ////console.log(result);
                $("#preloader").css("display", "none");

            });
    }
    vm.mriShow = true;
    vm.yardiShow = true;

    function getPropertyDataReduction() {
        vm.mriShow = true;
        vm.yardiShow = true;

        var url = '/incomeExpenses/dataReductionIE';
        //var url = '/properties/getPropertyIE?id=36';
        // ////console.log(url)
        $("#preloader").css("display", "block");
        var metaData = {
            propId: vm.propertyId,
            year: 2017
        };

        AOTCService.postDataToServer(url, metaData)
            .then(function (result) {
                ////console.log('dataReductionIE server data:', result);
                if (result.data.success) {
                    var serverData = result.data;
                    vm.yardiIEData = serverData.result.yardiIEData;
                    vm.yardiIEYear = vm.yardiIEData[vm.yardiIEData.length - 1];
                    vm.mriIEData = serverData.result.mriIEData;
                    vm.mriIEYear = vm.mriIEData[vm.mriIEData.length - 1];

                    if (vm.mriIEData.length == 0) {
                        vm.mriShow = false;
                    } else if (vm.yardiIEData.length == 0) {
                        vm.yardiShow = false;
                    }
                }



            }, function (result) {
                ////console.log(result);
            });
    }

    vm.unlinkIncomeExpense = unlinkIncomeExpense;
    vm.deleteIncomeExpense = deleteIncomeExpense;
    vm.myModelCheck = myModelCheck;
    vm.modelMessage = {
        title: "",
        message: ""
    };

    vm.incomeExpenseIds = [];
    vm.selection = -1;


    function unlinkIncomeExpense(incomeExpense) {
        vm.modelMessage.title = 'Unlink ' + incomeExpense.IE.properties.fileName;
        vm.modelMessage.message = 'Are you sure to unlink file from this property?';
        vm.selection = 1;
        vm.incomeExpenseIds.push(incomeExpense.IE._id);
    }

    function deleteIncomeExpense(incomeExpense) {
        ////console.log("here it is")

        vm.modelMessage.title = 'Delete ' + incomeExpense.IE.properties.fileName;
        vm.modelMessage.message = 'Are you sure to delete file from this property?';
        vm.selection = 0;
        vm.incomeExpenseIds.push(incomeExpense.IE._id);
    }

    function myModelCheck() {
        if (vm.selection === 1) {

            unlinkIncomeExpenses();
        } else if (vm.selection === 0) {

            deleteIncomeExpenses();
        }
        vm.selection = -1;
    }


    // Unlink taxBill call
    function unlinkIncomeExpenses() {

        var url = '/incomeExpenses/unlinkIEFiles';

        $("#preloader").css("display", "block");

        vm.data = {
            propId:parseInt(localStorage.getItem('propertyId')),
            incomeExpenseIds: vm.incomeExpenseIds
        };

        AOTCService.postDataToServer(url, vm.data).then(function (result) {
            ////console.log(result);

            if (result.data.success) {
                $scope.$emit('success', result.data.message);
                getPropertyIE();
                getPropertyDataReduction();
            } else {
                $scope.$emit('error', result.data.message);
            }
            vm.incomeExpenseIds = [];

            $("#preloader").css("display", "none");
        }, function (result) {
            $("#preloader").css("display", "none");
            $scope.$emit('error', result.data.message);
        });
    }

    // Delete taxBill call
    function deleteIncomeExpenses() {

        var url = '/incomeExpenses/deleteIEById';

        $("#preloader").css("display", "block");

        vm.data = {
            incomeExpenseIds: vm.incomeExpenseIds
        };

        AOTCService.postDataToServer(url, vm.data).then(function (result) {
            ////console.log(result);

            if (result.data.success) {
                $scope.$emit('success', result.data.message);
                getPropertyIE();
            } else {
                $scope.$emit('error', result.data.message);
            }
            vm.incomeExpenseIds = [];

            $("#preloader").css("display", "none");
        }, function (result) {
            $("#preloader").css("display", "none");
            $scope.$emit('error', result.data.message);
        });
    }
}

/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 259 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {

_other_files.$inject = ["$location", "$scope", "$http", "__env", "$log", "AOTCService", "$timeout"];
module.exports = _other_files;

//angular.module('AOTC').controller('other_files', _other_files
//    );

function _other_files($location, $scope, $http, __env, $log, AOTCService, $timeout) {
    ////console.log("other_files controller");

    var vm = this;

    vm.propertiesCount = localStorage.getItem('propertiesCount');
    vm.propertyId = JSON.parse(localStorage.getItem('propertyId'));
    vm.unlinkOtherFile = unlinkOtherFile;
    vm.deleteOtherFile = deleteOtherFile;
    vm.myModelCheck = myModelCheck;
    vm.modelMessage = {
        title: "",
        message: ""
    }

    vm.otherFileIds = [];
    vm.selection = -1;

    getOtherFiles();

    function unlinkOtherFile(otherFiles) {
        vm.modelMessage.title = 'Unlink ' + otherFiles.otherFileNodes.properties.fileName;
        vm.modelMessage.message = 'Are you sure to unlink file from this property?';
        vm.otherFileIds.push(otherFiles.otherFileNodes._id);
        vm.selection = 0;
    }

    function deleteOtherFile(otherFiles) {
        vm.modelMessage.title = 'Delete ' + otherFiles.otherFileNodes.properties.fileName;
        vm.modelMessage.message = 'Are you sure to delete file from this property?';
        vm.otherFileIds.push(otherFiles.otherFileNodes._id);
        vm.selection = 1;
    }

    function myModelCheck() {
        if (vm.selection === 1) {

            deleteOtherFiles();
        } else if (vm.selection === 0) {

            unlinkOtherFiles();
        }
        vm.selection = -1;
    }

    // getOther Files
    function getOtherFiles() {

        var url = '/otherfiles/getOtherFiles';
        var _data = {propId: vm.propertyId};
        $("#preloader").css("display", "block");

        AOTCService.postDataToServer(url, _data).then(function (result) {

            ////console.log("getOtherFiles: ", result);

            var serverData = result.data;

            if (serverData.success) {

                vm.tableData = serverData.result;

                $("#preloader").css("display", "none");

                setTimeout(function () {
                    $('[data-tooltip="tooltip"]').tooltip();
                }, 100);
            }
        }, function (result) {
            //some error
            ////console.log(result);
            $("#preloader").css("display", "none");
        });
    }

    // Unlink taxBill call
    function unlinkOtherFiles() {

        var url = '/otherFiles/unlinkOtherFilesById';

        $("#preloader").css("display", "block");

        vm.data = {
            propId:parseInt(localStorage.getItem('propertyId')),
            otherFileIds: vm.otherFileIds
        };

        AOTCService.postDataToServer(url, vm.data).then(function (result) {
            ////console.log(result);

            if (result.data.success) {
                $scope.$emit('success', result.data.message);
                getOtherFiles();
            } else {
                $scope.$emit('error', result.data.message);
            }
            vm.taxBillIds = [];

            $("#preloader").css("display", "none");
        }, function (result) {
            $("#preloader").css("display", "none");
            $scope.$emit('error', result.data.message);
        });
    }

    // Delete taxBill call
    function deleteOtherFiles() {

        var url = '/otherFiles/deleteOtherFilesById';

        $("#preloader").css("display", "block");

        vm.data = {
            otherFileIds: vm.otherFileIds
        };

        AOTCService.postDataToServer(url, vm.data).then(function (result) {
            ////console.log(result);

            if (result.data.success) {
                $scope.$emit('success', result.data.message);
                getOtherFiles();
            } else {
                $scope.$emit('error', result.data.message);
            }
            vm.taxBillIds = [];

            $("#preloader").css("display", "none");
        }, function (result) {
            $("#preloader").css("display", "none");
            $scope.$emit('error', result.data.message);
        });
    }
}

/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 260 */
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {var apply = Function.prototype.apply;

// DOM APIs, for completeness

exports.setTimeout = function() {
  return new Timeout(apply.call(setTimeout, window, arguments), clearTimeout);
};
exports.setInterval = function() {
  return new Timeout(apply.call(setInterval, window, arguments), clearInterval);
};
exports.clearTimeout =
exports.clearInterval = function(timeout) {
  if (timeout) {
    timeout.close();
  }
};

function Timeout(id, clearFn) {
  this._id = id;
  this._clearFn = clearFn;
}
Timeout.prototype.unref = Timeout.prototype.ref = function() {};
Timeout.prototype.close = function() {
  this._clearFn.call(window, this._id);
};

// Does not start the time, just sets up the members needed.
exports.enroll = function(item, msecs) {
  clearTimeout(item._idleTimeoutId);
  item._idleTimeout = msecs;
};

exports.unenroll = function(item) {
  clearTimeout(item._idleTimeoutId);
  item._idleTimeout = -1;
};

exports._unrefActive = exports.active = function(item) {
  clearTimeout(item._idleTimeoutId);

  var msecs = item._idleTimeout;
  if (msecs >= 0) {
    item._idleTimeoutId = setTimeout(function onTimeout() {
      if (item._onTimeout)
        item._onTimeout();
    }, msecs);
  }
};

// setimmediate attaches itself to the global object
__webpack_require__(261);
// On some exotic environments, it's not clear which object `setimmeidate` was
// able to install onto.  Search each possibility in the same order as the
// `setimmediate` library.
exports.setImmediate = (typeof self !== "undefined" && self.setImmediate) ||
                       (typeof global !== "undefined" && global.setImmediate) ||
                       (this && this.setImmediate);
exports.clearImmediate = (typeof self !== "undefined" && self.clearImmediate) ||
                         (typeof global !== "undefined" && global.clearImmediate) ||
                         (this && this.clearImmediate);

/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(45)))

/***/ }),
/* 261 */
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global, process) {(function (global, undefined) {
    "use strict";

    if (global.setImmediate) {
        return;
    }

    var nextHandle = 1; // Spec says greater than zero
    var tasksByHandle = {};
    var currentlyRunningATask = false;
    var doc = global.document;
    var registerImmediate;

    function setImmediate(callback) {
      // Callback can either be a function or a string
      if (typeof callback !== "function") {
        callback = new Function("" + callback);
      }
      // Copy function arguments
      var args = new Array(arguments.length - 1);
      for (var i = 0; i < args.length; i++) {
          args[i] = arguments[i + 1];
      }
      // Store and register the task
      var task = { callback: callback, args: args };
      tasksByHandle[nextHandle] = task;
      registerImmediate(nextHandle);
      return nextHandle++;
    }

    function clearImmediate(handle) {
        delete tasksByHandle[handle];
    }

    function run(task) {
        var callback = task.callback;
        var args = task.args;
        switch (args.length) {
        case 0:
            callback();
            break;
        case 1:
            callback(args[0]);
            break;
        case 2:
            callback(args[0], args[1]);
            break;
        case 3:
            callback(args[0], args[1], args[2]);
            break;
        default:
            callback.apply(undefined, args);
            break;
        }
    }

    function runIfPresent(handle) {
        // From the spec: "Wait until any invocations of this algorithm started before this one have completed."
        // So if we're currently running a task, we'll need to delay this invocation.
        if (currentlyRunningATask) {
            // Delay by doing a setTimeout. setImmediate was tried instead, but in Firefox 7 it generated a
            // "too much recursion" error.
            setTimeout(runIfPresent, 0, handle);
        } else {
            var task = tasksByHandle[handle];
            if (task) {
                currentlyRunningATask = true;
                try {
                    run(task);
                } finally {
                    clearImmediate(handle);
                    currentlyRunningATask = false;
                }
            }
        }
    }

    function installNextTickImplementation() {
        registerImmediate = function(handle) {
            process.nextTick(function () { runIfPresent(handle); });
        };
    }

    function canUsePostMessage() {
        // The test against `importScripts` prevents this implementation from being installed inside a web worker,
        // where `global.postMessage` means something completely different and can't be used for this purpose.
        if (global.postMessage && !global.importScripts) {
            var postMessageIsAsynchronous = true;
            var oldOnMessage = global.onmessage;
            global.onmessage = function() {
                postMessageIsAsynchronous = false;
            };
            global.postMessage("", "*");
            global.onmessage = oldOnMessage;
            return postMessageIsAsynchronous;
        }
    }

    function installPostMessageImplementation() {
        // Installs an event handler on `global` for the `message` event: see
        // * https://developer.mozilla.org/en/DOM/window.postMessage
        // * http://www.whatwg.org/specs/web-apps/current-work/multipage/comms.html#crossDocumentMessages

        var messagePrefix = "setImmediate$" + Math.random() + "$";
        var onGlobalMessage = function(event) {
            if (event.source === global &&
                typeof event.data === "string" &&
                event.data.indexOf(messagePrefix) === 0) {
                runIfPresent(+event.data.slice(messagePrefix.length));
            }
        };

        if (global.addEventListener) {
            global.addEventListener("message", onGlobalMessage, false);
        } else {
            global.attachEvent("onmessage", onGlobalMessage);
        }

        registerImmediate = function(handle) {
            global.postMessage(messagePrefix + handle, "*");
        };
    }

    function installMessageChannelImplementation() {
        var channel = new MessageChannel();
        channel.port1.onmessage = function(event) {
            var handle = event.data;
            runIfPresent(handle);
        };

        registerImmediate = function(handle) {
            channel.port2.postMessage(handle);
        };
    }

    function installReadyStateChangeImplementation() {
        var html = doc.documentElement;
        registerImmediate = function(handle) {
            // Create a <script> element; its readystatechange event will be fired asynchronously once it is inserted
            // into the document. Do so, thus queuing up the task. Remember to clean up once it's been called.
            var script = doc.createElement("script");
            script.onreadystatechange = function () {
                runIfPresent(handle);
                script.onreadystatechange = null;
                html.removeChild(script);
                script = null;
            };
            html.appendChild(script);
        };
    }

    function installSetTimeoutImplementation() {
        registerImmediate = function(handle) {
            setTimeout(runIfPresent, 0, handle);
        };
    }

    // If supported, we should attach to the prototype of global, since that is where setTimeout et al. live.
    var attachTo = Object.getPrototypeOf && Object.getPrototypeOf(global);
    attachTo = attachTo && attachTo.setTimeout ? attachTo : global;

    // Don't get fooled by e.g. browserify environments.
    if ({}.toString.call(global.process) === "[object process]") {
        // For Node.js before 0.9
        installNextTickImplementation();

    } else if (canUsePostMessage()) {
        // For non-IE10 modern browsers
        installPostMessageImplementation();

    } else if (global.MessageChannel) {
        // For web workers, where supported
        installMessageChannelImplementation();

    } else if (doc && "onreadystatechange" in doc.createElement("script")) {
        // For IE 6–8
        installReadyStateChangeImplementation();

    } else {
        // For older browsers
        installSetTimeoutImplementation();
    }

    attachTo.setImmediate = setImmediate;
    attachTo.clearImmediate = clearImmediate;
}(typeof self === "undefined" ? typeof global === "undefined" ? this : global : self));

/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(45), __webpack_require__(98)))

/***/ }),
/* 262 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {

_PropertyDetailsTabService.$inject = ["$http", "AOTCService", "$q"];
module.exports = _PropertyDetailsTabService;

//angular.module('AOTC')
//    .factory('PropertyDetailsTabService', _PropertyDetailsTabService
//    );
function _PropertyDetailsTabService($http, AOTCService, $q) {

    return {
        getAllImages: getAllImages,
        getProperty: getProperty,
        deleteImageById: deleteImageById,
        setMainImage: setMainImage
    };

    function getAllImages() {

        var propId = parseInt(localStorage.getItem('propertyId'));
        var _data = {propId:propId };
        var url = '/propertyImages/getAllImages';
        // var url = '/propertyImages/getAllImages?id=7647';

        var deferred = $q.defer();

        AOTCService.postDataToServer(url, _data)
            .then(function (result) {
                deferred.resolve(result);

            }, function (result) {
                deferred.reject(result);
                ////console.log(result);
            });
        return deferred.promise;
    }

    function getProperty() {

        var propId = parseInt(localStorage.getItem('propertyId'));
        var _data = {propId: propId};        
        var url = '/properties/getSlavePropertiesByMasterId';

        var deferred = $q.defer();
        $("#preloader").css("display", "block");

        AOTCService.postDataToServer(url, _data)
            .then(function (result) {
                deferred.resolve(result);
            }, function (result) {
                deferred.reject(result);
                ////console.log(result);
            });
        return deferred.promise;
    }

    function deleteImageById(imageId, tag) {
        var jsonFormat = {
            imageId: imageId,
            tag: tag
        };
        var url = '/propertyImages/deleteImageById';

        var deferred = $q.defer();

        AOTCService.postDataToServer(url, jsonFormat)
            .then(function (result) {
                deferred.resolve(result);

            }, function (result) {
                deferred.reject(result);
                ////console.log(result);
            });
        return deferred.promise;
    }

    function setMainImage(propertyId, imageId) {
        var jsonFormat = {
            propId: propertyId,
            imageId: imageId
        };
        var url = '/propertyImages/setMainImage';

        var deferred = $q.defer();

        AOTCService.postDataToServer(url, jsonFormat)
            .then(function (result) {
                deferred.resolve(result);

            }, function (result) {
                deferred.reject(result);
                ////console.log(result);
            });
        return deferred.promise;
    }
}
/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 263 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {

_PublicPropertyDetailsTab.$inject = ["$stateParams", "$location", "$scope", "$http", "__env", "$log", "AOTCService", "PropertyDetailsTabService", "$timeout"];
module.exports = _PublicPropertyDetailsTab;

//angular.module('AOTC').controller('PublicPropertyDetailsTab', _PublicPropertyDetailsTab
//    );
function _PublicPropertyDetailsTab($stateParams, $location, $scope, $http, __env, $log, AOTCService, PropertyDetailsTabService, $timeout) {
    ////console.log("PublicPropertyDetailsTab");

    var vm = this;

    // $('#custom_carousel').on('slide.bs.carousel', function(evt) {
    //     $('#custom_carousel .controls li.active').removeClass('active');
    //     $('#custom_carousel .controls li:eq(' + $(evt.relatedTarget).index() + ')').addClass('active');
    // })
    $scope.isArray = function(value){
        try{
            if(Array.isArray(value))
            {
              var _val = '';
              for(var i=0;i<value.length;i++){
                if(i!=(value.length-1)) _val += value[i] + ', ';
                else _val += value[i];
              }
              return _val;
            }
            else return value;
        }
        catch(_e){
            return value;
        }
      };
    vm.toggleActiveClass = toggleActiveClass;
    vm.deleteImageById = deleteImageById;

    vm.flipBack = flipBack;
    vm.flipFront = flipFront;
    vm.isDeleting = false;
    $scope.showInfo = true;
    $('#propCard').flip({
        trigger: 'manual'
    });

    $(".nav-tabs.public-tabs a").click(function (e) {
        e.preventDefault();
        e.stopPropagation();
        $(this).tab('show');
    });
    // vm.IERRProperty = JSON.parse(localStorage.getItem('propertyDetails'));
    vm.propertyDetails = JSON.parse(localStorage.getItem('propertyDetails'));
    vm.propertyId = JSON.parse(localStorage.getItem('propertyId'));
    vm.images = [];
    vm.properties = [];
    vm.showAllData = false;

    vm.myModelCheck = myModelCheck;
    vm.deleteByID = deleteByID;
    vm.setMainImage = setMainImage;

    vm.imageDeleteId = '';
    vm.imageDeleteTag = '';
    vm.deleteByIDImage = null;
    vm.modelMessage = {
        title: "",
        message: ""
    };

    // Public prop details
    vm.publicProperty = null;
    //var getData = function () {
    //    $http.get('/modules/PropertyModule/View_IE_RR/tabs/propertyDetails/propertyData.json').then(function (_data) {
    //        vm.publicProperty = _data['propertyData0'];
    //    });
    //}();


    //if (vm.propertyDetails.publicProperty != null) {
    //    vm.publicProperty = vm.propertyDetails.publicProperty;
    //}

    // initial image index
    $scope._Index = 0;

    // Map Options
    $scope.map = {
        center: {
            latitude: vm.propertyDetails.latitude,
            longitude: vm.propertyDetails.longitude
        },
        zoom: 14
    };

    $scope.marker = {
        id: 1,
        coords: {
            latitude: vm.propertyDetails.latitude,
            longitude: vm.propertyDetails.longitude
        },
        options: {
            draggable: false,
            icon: "assets/img/marker.png"
        },
        events: {

        }
    };

    getAllImages();

    // --------------------------------------------
    // getAllImages
    // --------------------------------------------
    function getAllImages() {
        ////console.log('images')
        PropertyDetailsTabService.getAllImages().
        then(function (result) {
            ////console.log('getAllImages: ', result);

            var serverData = result.data;

            if (serverData.success) {
                vm.images = serverData.result;
                updateDrag(false);
                vm.isDeleting = false;


            }
        }, function (err) {
            //some error
            ////console.log("Error: ", err);
            $("#preloader").css("display", "none");
        });
    }



    var getProp = function(){
        var _url = 'properties/getPublicPropertyDetailsById';
        var _data = {
            "publicPropertyId":vm.propertyId
        };
        $("#preloader").css("display", "block");
        AOTCService.postDataToServer(_url, _data)
        .then(function (response) {
            if (response.data.success) {
                var _serverData = response.data.result[0];
                var someTemp = {};
                angular.forEach(_serverData.details, function(_value, _key){
                    angular.extend(someTemp, _value);
                });
                vm.allPropertyDetails =  someTemp;
                console.log(vm.allPropertyDetails)

    
            } else {
                $scope.$emit('danger', response.data.message);
            }
            $("#preloader").css("display", "none");
    
        }, function (result) {
            $("#preloader").css("display", "none");
        });

    }();

    function VerifyJSon(s){ try {
        JSON.parse(s);
        console.log(s)

        return true;
    } catch (e) {
        console.log(e)
        return false;
    }
    };


    // --------------------------------------------

    // --------------------------------------------
    // getPropertyDetails Slaves
    // --------------------------------------------
    // PropertyDetailsTabService.getProperty().
    // then(function(result) {

    //         ////console.log(result);
    //         // ////console.log(result.data.length);
    //         var serverData = result.data;
    //         if (serverData.success) {

    //             vm.properties = serverData.result[0].prop;
    //             // ////console.log(vm.properties);
    //             localStorage.setItem('propertiesCount', vm.properties.length);

    //             for (var i = 0; i < vm.properties.length; i++) {
    //                 var prop = vm.properties[i];
    //                 prop.id = prop._id;
    //                 // prop.showAllData = false;

    //                 if (i == 0) {
    //                     prop.isActive = true;
    //                     prop.activeClass = 'glyphicon-minus'
    //                 } else {
    //                     prop.isActive = false;
    //                     prop.activeClass = 'glyphicon-plus'
    //                 }
    //             }
    //         }
    //         $("#preloader").css("display", "none");
    //     }, function(err) {
    //         //some error
    //         ////console.log("Error: ", err);
    //         $("#preloader").css("display", "none");
    //     })
    // --------------------------------------------

    // if a current image is the same as requested image
    $scope.isActive = function (index) {

        return $scope._Index === index;
    };

    $scope.showPhoto = function (index) {
        $scope._Index = index;
    };

    // show prev image
    $scope.showPrev = function () {



        $scope._Index = ($scope._Index > 0) ? --$scope._Index : vm.images.length - 1;

        ////console.log($scope._Index)
        var offset = ($scope._Index) * 100

        $('#drag').animate({
            'right': offset + "px"
        });
    };

    // show next image
    $scope.showNext = function () {

        $scope._Index = ($scope._Index < vm.images.length - 1) ? ++$scope._Index : 0;
        //$('#drag').hide("slide", {direction: "left" },  1020);
        var offset = $scope._Index * 100

        $('#drag').animate({
            'right': offset + "px"
        });


    };


    function toggleActiveClass(property) {

        if (property.activeClass == "glyphicon-plus") {
            property.activeClass = "glyphicon-minus";
        } else {

            property.activeClass = "glyphicon-plus";
        }

        for (var i = 0; i < vm.properties.length; i++) {
            var pr = vm.properties[i];
            if (pr.id != property.id) {
                pr.activeClass = "glyphicon-plus";
            }
        }
    }

    // function getProperty() {

    //     var url = '/properties/getPublicPropertyDetailsById';
    //     //var _data = {propId: vm.propertyId};
    //     $("#preloader").css("display", "block");
    //     var _data = {
    //         "publicPropertyId": vm.propertyId
    //     };
    //     AOTCService.postDataToServer(url, _data)
    //         .then(function (result) {

    //             ////console.log(result);
    //             // ////console.log(result.data.length);
    //             var serverData = result.data;
    //             if (serverData.success) {
    //                 vm.properties = serverData.result[0].prop;
    //                 // ////console.log(vm.properties);
    //                 localStorage.setItem('propertiesCount', vm.properties.length);
    //                 for (var i = 0; i < vm.properties.length; i++) {
    //                     var prop = vm.properties[i];
    //                     prop.id = prop._id;
    //                     prop.showAllData = false;

    //                     if (i == 0) {
    //                         prop.isActive = true;
    //                         prop.activeClass = 'glyphicon-minus'
    //                     } else {
    //                         prop.isActive = false;
    //                         prop.activeClass = 'glyphicon-plus'
    //                     }
    //                 }
    //             }
    //             $("#preloader").css("display", "none");
    //         }, function (result) {
    //             //some error
    //             ////console.log(result);
    //             $("#preloader").css("display", "none");
    //         });
    // }

    function deleteImageById(imageId, tag) {
        // ////console.log("delete called", tag);
        var len = (vm.images).length;
        var index = $scope._Index;

        if (len === (index + 1)) {
            $scope.showPhoto(len - 2);
        }

        // ////console.log("len----->", len);
        PropertyDetailsTabService.deleteImageById(imageId, tag)
            .then(function (result) {
                ////console.log('Server result is ->' + result);
                if (result.data.success) {
                    getAllImages();
                    updateDrag(true);

                    $scope.$emit('success', 'Record deleted successfully');
                } else {
                    $scope.$emit('error', 'Record deleted unsuccessfull');
                    vm.isDeleting = false;

                }
            }, function (err) {
                ////console.log('err is ', err);
            })
    }

    function flipBack(id) {
        $('#propCard').flip(false);
    }

    function flipFront(id) {
        $('#propCard').flip(true);
    }

    function deleteByID(name, id, tag) {

        vm.modelMessage.title = 'Delete Picture';
        vm.modelMessage.message = "Are you sure you want to delete picture “" + name + "” from this property?";
        vm.imageDeleteId = id;
        vm.imageDeleteTag = tag;
    }

    function myModelCheck() {
        ////console.log('----');
        vm.isDeleting = true;
        if (vm.imageDeleteId != null) {
            deleteImageById(vm.imageDeleteId, vm.imageDeleteTag)
        }
    }

    function updateDrag(flag) {

        $timeout(function () {
            // var items = $(".nav li").length;
            var items = vm.images.length;
            ////console.log('link')

            // Flag is defined to load the previous image if the image delete is last one.
            // if(flag){
            //     $scope.showPhoto(items - 1);
            // }

            var leftRight = 0;
            // var val = items * 9;

            if (items > 7) {
                leftRight = (items - 7) * -100;

                // leftRight = (items - 7) * -(val);
            }

            $('.nav').draggable({
                axis: "x",
                stop: function () {
                    var ml = parseInt($(this).css('left'));
                    if (ml > 0)
                        $(this).animate({
                            left: "0px"
                        });
                    if (ml < leftRight)
                        $(this).animate({
                            left: leftRight + "px"
                        });
                }
            });
        }, 500);
    }

    function setMainImage(imageId) {

        var propertyId = localStorage.getItem('propertyId');

        PropertyDetailsTabService.setMainImage(propertyId, imageId)
            .then(function (result) {
                ////console.log('Server result is ', result);
                if (result.data.success) {
                    getAllImages();
                    updateDrag(false);
                    $scope.$emit('success', 'Main image set successfully');
                } else {
                    $scope.$emit('error', 'Main image set unsuccessfull');
                }
            }, function (err) {
                ////console.log('err is ', err);
            })
    }

}
/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 264 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {

_PublicPropertyDetailsTab.$inject = ["$stateParams", "$location", "$scope", "$http", "__env", "$log", "AOTCService", "PropertyDetailsTabService", "$timeout"];
module.exports = _PublicPropertyDetailsTab;

//angular.module('AOTC').controller('PublicPropertyDetailsTab', _PublicPropertyDetailsTab
//    );
function _PublicPropertyDetailsTab($stateParams, $location, $scope, $http, __env, $log, AOTCService, PropertyDetailsTabService, $timeout) {
    ////console.log("PublicPropertyDetailsTab");

    var vm = this;

    // $('#custom_carousel').on('slide.bs.carousel', function(evt) {
    //     $('#custom_carousel .controls li.active').removeClass('active');
    //     $('#custom_carousel .controls li:eq(' + $(evt.relatedTarget).index() + ')').addClass('active');
    // })
    $scope.isArray = function(value){
        try{
            if(Array.isArray(value))
            {
              var _val = '';
              for(var i=0;i<value.length;i++){
                if(i!=(value.length-1)) _val += value[i] + ', ';
                else _val += value[i];
              }
              return _val;
            }
            else return value;
        }
        catch(_e){
            return value;
        }
      };
    vm.toggleActiveClass = toggleActiveClass;
    vm.isDeleting = false;
    $scope.showInfo = true;
    $('#propCard').flip({
        trigger: 'manual'
    });

    $(".nav-tabs.public-tabs a").click(function (e) {
        e.preventDefault();
        e.stopPropagation();
        $(this).tab('show');
    });
    // vm.IERRProperty = JSON.parse(localStorage.getItem('propertyDetails'));
    vm.propertyDetails = JSON.parse(localStorage.getItem('propertyDetails'));
    vm.propertyId = JSON.parse(localStorage.getItem('propertyId'));
    vm.publicPropertyId = vm.propertyDetails.publicData;
    
    vm.images = [];
    vm.properties = [];
    vm.showAllData = false;
    vm.imageDeleteId = '';
    vm.imageDeleteTag = '';
    vm.deleteByIDImage = null;
    vm.modelMessage = {
        title: "",
        message: ""
    };

    // Public prop details
    vm.publicProperty = null;
    //var getData = function () {
    //    $http.get('/modules/PropertyModule/View_IE_RR/tabs/propertyDetails/propertyData.json').then(function (_data) {
    //        vm.publicProperty = _data['propertyData0'];
    //    });
    //}();


    //if (vm.propertyDetails.publicProperty != null) {
    //    vm.publicProperty = vm.propertyDetails.publicProperty;
    //}

    // initial image index
    $scope._Index = 0;

    // Map Options



    var getProp = function(){
        var _url = 'properties/getPublicPropertyDetailsById';
        var _data = {
            "publicPropertyId":vm.publicPropertyId
        };
        $("#preloader").css("display", "block");
        AOTCService.postDataToServer(_url, _data)
        .then(function (response) {
            if (response.data.success) {
                var _serverData = response.data.result[0];
                var someTemp = {};
                angular.forEach(_serverData.details, function(_value, _key){
					console.log(_value)
                    angular.extend(someTemp, _value);
                });
				var verify = {};
				angular.forEach(someTemp, function(_value, _key){
					var check = VerifyJSon(_value[1])
					console.log(check)
					if(check != false && check!=null) {
				      _value[1] = check

					}
                });
				console.log(someTemp)
                 vm.allPropertyDetails =  someTemp;

            } else {
                $scope.$emit('danger', response.data.message);
            }
            $("#preloader").css("display", "none");
    
        }, function (result) {
            $("#preloader").css("display", "none");
        });

    }();

    function VerifyJSon(s){ try {
       var arr=  JSON.parse(s);

         return arr;
    } catch (e) {
        return false;
     }
    };

    // --------------------------------------------

    // if a current image is the same as requested image
    $scope.isActive = function (index) {

        return $scope._Index === index;
    };

    $scope.showPhoto = function (index) {
        $scope._Index = index;
    };

    // show prev image



    function toggleActiveClass(property) {

        if (property.activeClass == "glyphicon-plus") {
            property.activeClass = "glyphicon-minus";
        } else {

            property.activeClass = "glyphicon-plus";
        }

        for (var i = 0; i < vm.properties.length; i++) {
            var pr = vm.properties[i];
            if (pr.id != property.id) {
                pr.activeClass = "glyphicon-plus";
            }
        }
    }


}
/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 265 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {

_PublicPropertyDetailsTabService.$inject = ["$http", "$q", "AOTCService"];
module.exports = _PublicPropertyDetailsTabService;

//angular.module('AOTC')
//    .factory('PublicPropertyDetailsTabService', _PublicPropertyDetailsTabService
//    );

function _PublicPropertyDetailsTabService($http, $q, AOTCService) {

    return {
        getAllImages: getAllImages,
        getProperty: getProperty,
        deleteImageById: deleteImageById,
        setMainImage: setMainImage
    };

    function getAllImages() {

        var propId = parseInt(localStorage.getItem('propertyId'));
        var _data = {propId: propId};
        var url = '/propertyImages/getAllImages';
        // var url = '/propertyImages/getAllImages?id=7647';

        var deferred = $q.defer();

        AOTCService.postDataToServer(url, _data)
            .then(function (result) {
                deferred.resolve(result);

            }, function (result) {
                deferred.reject(result);
                ////console.log(result);
            });
        return deferred.promise;
    }

    function getProperty() {

        var propId = parseInt(localStorage.getItem('propertyId'));
        var _data = {propId:propId };        
        var url = '/properties/getSlavePropertiesByMasterId';

        var deferred = $q.defer();
        $("#preloader").css("display", "block");

        AOTCService.postDataToServer(url, _data)
            .then(function (result) {
                deferred.resolve(result);
            }, function (result) {
                deferred.reject(result);
                ////console.log(result);
            });
        return deferred.promise;
    }

    function deleteImageById(imageId, tag) {
        var jsonFormat = {
            imageId: imageId,
            tag: tag
        };
        var url = '/propertyImages/deleteImageById';

        var deferred = $q.defer();

        AOTCService.postDataToServer(url, jsonFormat)
            .then(function (result) {
                deferred.resolve(result);

            }, function (result) {
                deferred.reject(result);
                ////console.log(result);
            });
        return deferred.promise;
    }

    function setMainImage(propertyId, imageId) {
        var jsonFormat = {
            propId: propertyId,
            imageId: imageId
        };
        var url = '/propertyImages/setMainImage';

        var deferred = $q.defer();

        AOTCService.postDataToServer(url, jsonFormat)
            .then(function (result) {
                deferred.resolve(result);

            }, function (result) {
                deferred.reject(result);
                ////console.log(result);
            });
        return deferred.promise;
    }
}

/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 266 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {

_rent_role.$inject = ["$scope", "AOTCService", "UtilService", "$timeout"];
module.exports = _rent_role;

//angular.module('AOTC').controller('rent_role', _rent_role
//    );

function _rent_role($scope, AOTCService, UtilService, $timeout) {
    ////console.log("rent_role controller");
    var vm = this;
    // Variables Declaration
    vm.propertiesCount = localStorage.getItem('propertiesCount');
    vm.IERRProperty = JSON.parse(localStorage.getItem('propertyDetails'));
    vm.propertyId = JSON.parse(localStorage.getItem('propertyId'));
    // vm.selectedOtherFileToUnlink = {};       // To be made functional.
    // vm.selectedOtherFileToDelete = {};       // To be made functional.
    vm.modelMessage = {
        title: "",
        message: ""
    }

    // Functions Declaration
    vm.toggleActiveClass = toggleActiveClass;
    vm.unlinkRentRoll = unlinkRentRoll;
    vm.deleteRentRoll = deleteRentRoll;
    vm.myModelCheck = myModelCheck;
    vm.rentRollsIds = [];


    vm.numberFormatter = numberFormatter;
    vm.keyValMakerForGrid = keyValMakerForGrid;
    vm.keyValMaker = keyValMaker;

    // eg 29/08/2004 gets converted to 20040829
    function monthToComparableNumber(date) {
        if (date === undefined || date === null || date.length < 5) {
            return null;
        }
        var splitDate = date.split('/');
        if (splitDate.length != 3) {
            return null
        }

        // var result = (yearNumber * 10000) + (monthNumber * 100) + dayNumber;
        return splitDate;
    }

    function dateComparator(date1, date2) {
        var date1Number = monthToComparableNumber(date1[1]);
        var date2Number = monthToComparableNumber(date2[1]);

        if (date1Number === null && date2Number === null) {
            return 0;
        }
        if (date1Number === null) {
            return -1;
        }
        if (date2Number === null) {
            return 1;
        }

        var y1 = date1Number[2];
        var m1 = date1Number[0];
        var d1 = date1Number[1];

        var y2 = date2Number[2];
        var m2 = date2Number[0];
        var d2 = date2Number[1];

        var result = 0;
        if (y1 != y2) {
            result = y1 - y2;
        } else if (y1 == y2) {
            if (m1 != m2) {
                result = m1 - m2;
            } else if (m1 == m2) {
                result = d1 - d2;
            }
        }
        return result;
    }

    getPropertyRR();

    function getPropertyRR() {
        var url = '/rentRolls/getPropertyRR';
        //var url = '/properties/getPropertyRR?id=36';
        // ////console.log(url);
        var _data = {"propId": vm.propertyId};
        $("#preloader").css("display", "block");

        AOTCService.postDataToServer(url, _data)
            .then(function (result) {
                ////console.log("getPropertyRR Server result: ", result);
                var serverData = result.data;
                if (serverData.success) {
                    vm.tableData = serverData.result;
                    // ////console.log(vm.tableData);
                    //without timeout ng-grid donot render as DOM is rendered after some time
                    $timeout(function () {

                        for (var i = 0; i < vm.tableData.length; i++) {

                            var prop = vm.tableData[i];
                            //find best object
                            var tenant = keyValMakerForGrid(prop.tenants[0]);
                            var columnDefs = [];

                            for (var k = 0; k < tenant.length; k++) {
                                var obj = tenant[k];
                                var key = Object.keys(obj)[0];
                                // ////console.log('------keys--------', key);
                                var objValueArray = obj[key];
                                // ////console.log('------Field value is--------', objValueArray);

                                // ////console.log(objValueArray);
                                var myColumns = {
                                    headerName: obj[key][0],
                                    comparator: '',
                                    field: key,
                                    cellRenderer: '',
                                    suppressSorting: false
                                };
                                if (objValueArray[0] == "Start Date" || objValueArray[0] == "End Date") {
                                    myColumns.comparator = dateComparator;
                                    myColumns.cellRenderer = function (params) {
                                        if (params.value[1] == null) {
                                            params.value[1] = '';
                                        }
                                        return '<span class="pull-right">' + params.value[1] + '</span>';
                                    }

                                } else if (objValueArray[0] == "Tenant") {
                                    myColumns.cellRenderer = function (params) {
                                        var value = numberFormatter(params.value);
                                        if (value == null) {
                                            value = '';
                                        }
                                        return '<span class="pull-left">' + value + '</span>';
                                    }
                                } else {
                                    myColumns.suppressSorting = true;
                                    myColumns.cellRenderer = function (params) {
                                        var value = numberFormatter(params.value);
                                        if (value == null) {
                                            value = '';
                                        }
                                        return '<span class="pull-right">' + value + '</span>';
                                    };

                                }
                                columnDefs.push(myColumns);
                            }

                            if (prop.tenants.length > 0) {
                                var id = '#myGrid' + i;
                                var gridDiv = document.querySelector(id);
                                var gridOptions = {
                                    enableSorting: true,
                                    // pagination: true,
                                    // paginationAutoPageSize: true,
                                    columnDefs: columnDefs,
                                    rowData: prop.tenants,
                                    onGridReady: function (params) {
                                        // params.api.sizeColumnsToFit();
                                    },
                                    enableColResize: true
                                };
                                new agGrid.Grid(gridDiv, gridOptions);
                                // autoSizeAll(gridOptions, columnDefs);
                            }

                            //accordian controlling
                            prop.id = prop.RR._id;

                            if (i == 0) {
                                prop.isActive = true;
                                prop.activeClass = 'glyphicon-minus'
                            } else {
                                prop.isActive = false;
                                prop.activeClass = 'glyphicon-plus'
                            }

                            setTimeout(function () {
                                $('[data-tooltip="tooltip"]').tooltip();
                            }, 100);
                        }
                        $("#preloader").css("display", "none");

                    }, 500);

                }
            }, function (result) {
                //some error
                ////console.log(result);
                $("#preloader").css("display", "none");

            });
    }

    function autoSizeAll(gridOptions, columnDefs) {
        ////console.log('grid options', gridOptions);
        ////console.log('columnDefs', columnDefs);
        var allColumnIds = [];
        columnDefs.forEach(function (columnDef) {
            allColumnIds.push(columnDef.field);
        });
        gridOptions.columnApi.autoSizeColumns(allColumnIds);
    }

    function unlinkRentRoll(rentRolls) {
        vm.modelMessage.title = 'Unlink RentRoll: ' + rentRolls.RR.properties.fileName;
        vm.modelMessage.message = 'Are you sure to unlink RentRoll from this property?';
        vm.selection = 1;
        vm.rentRollsIds.push(rentRolls.RR._id);
    }

    function deleteRentRoll(rentRolls) {
        vm.modelMessage.title = 'Delete RentRoll: ' + rentRolls.RR.properties.fileName;
        vm.modelMessage.message = 'Are you sure to delete RentRoll from this property?';
        vm.selection = 0;
        vm.rentRollsIds.push(rentRolls.RR._id);
    }

    function myModelCheck() {
        if (vm.selection === 1) {

            unlinkRentRolls();
        } else if (vm.selection === 0) {

            deleteRentRolls();
        }
        vm.selection = -1;
    }

    function unlinkRentRolls() {
        var url = '/rentRolls/unlinkRentRollsById';

        $("#preloader").css("display", "block");

        vm.data = {
            propId:parseInt(localStorage.getItem('propertyId')),
            rentRollsIds: vm.rentRollsIds
        };

        AOTCService.postDataToServer(url, vm.data).then(function (result) {
            /////console.log(result);

            if (result.data.success) {
                $scope.$emit('success', result.data.message);
                getPropertyRR();
            } else {
                $scope.$emit('error', result.data.message);
            }
            vm.rentRolls = [];

            $("#preloader").css("display", "none");
        }, function (result) {
            $("#preloader").css("display", "none");
            $scope.$emit('error', result.data.message);
        });
    }

    // Delete taxBill call
    function deleteRentRolls() {

        var url = '/rentRolls/deleteRentRollsById';

        $("#preloader").css("display", "block");

        vm.data = {
            rentRollsIds: vm.rentRollsIds
        };

        AOTCService.postDataToServer(url, vm.data).then(function (result) {
            ////console.log(result);

            if (result.data.success) {
                $scope.$emit('success', result.data.message);
                getPropertyRR();
            } else {
                $scope.$emit('error', result.data.message);
            }
            vm.rentRolls = [];

            $("#preloader").css("display", "none");
        }, function (result) {
            $("#preloader").css("display", "none");
            $scope.$emit('error', result.data.message);
        });
    }

    function numberFormatter(keyArr) {
        var result = UtilService.numberFormatter(keyArr);
        return result;
    };

    function keyValMakerForGrid(object) {
        var result;
        result = UtilService.keyValMakerForGrid(object);
        return result;
    };

    function keyValMaker(object) {
        var result;
        result = UtilService.keyValMaker(object);
        return result;
    };

    function toggleActiveClass(property) {

        if (property.activeClass == "glyphicon-plus") {
            property.activeClass = "glyphicon-minus";
        } else {
            property.activeClass = "glyphicon-plus";
        }

        for (var i = 0; i < vm.tableData.length; i++) {
            var pr = vm.tableData[i];
            if (pr.id != property.id) {
                pr.activeClass = "glyphicon-plus";
            }
        }
    }
}

/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 267 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {

_tax_bills.$inject = ["$location", "$scope", "$http", "__env", "$log", "AOTCService", "$timeout"];
module.exports = _tax_bills;

//angular.module('AOTC').controller('tax_bills', _tax_bills
//    );
function _tax_bills($location, $scope, $http, __env, $log, AOTCService, $timeout) {
    ////console.log("tax_bills controller");

    var vm = this;

    vm.propertiesCount = localStorage.getItem('propertiesCount');
    vm.propertyId = JSON.parse(localStorage.getItem('propertyId'));
    vm.unlinkTaxBill = unlinkTaxBill;
    vm.deleteTaxBill = deleteTaxBill;
    vm.myModelCheck = myModelCheck;
    vm.modelMessage={
        title:"",
        message:""
    };
    vm.taxBillIds = [];
    vm.selection = -1;

    getTaxBills();

    function unlinkTaxBill(TaxBills) {
        vm.modelMessage.title = 'Unlink '+TaxBills.taxBills.properties.fileName;
        vm.modelMessage.message = 'Are you sure to unlink file from this property?';
        vm.selection = 1;
        vm.taxBillIds.push(TaxBills.taxBills._id);
    }

    function deleteTaxBill(TaxBills) {
        vm.modelMessage.title = 'Delete '+TaxBills.taxBills.properties.fileName;
        vm.modelMessage.message = 'Are you sure to delete file from this property?';
        vm.selection = 0;
        vm.taxBillIds.push(TaxBills.taxBills._id);
    }

    function myModelCheck(){
        if(vm.selection === 1){

            unlinkTaxBills();
        } else if(vm.selection === 0){

            deleteTaxBills();
        }
        vm.selection = -1;
    }

    // get taxBills
    function getTaxBills() {
        var _data = {propId:vm.propertyId };
        var url = '/taxBills/getTaxBills';
        $("#preloader").css("display", "block");

        AOTCService.postDataToServer(url, _data).then(function(result) {

            ////console.log("getTaxBills: ", result);

            var serverData = result.data;

            if (serverData.success) {

                vm.tableData = serverData.result;

                $("#preloader").css("display", "none");

                setTimeout(function() {
                    $('[data-tooltip="tooltip"]').tooltip();
                }, 100);
            }
        }, function(result) {
            //some error
            ////console.log(result);
            $("#preloader").css("display", "none");
        });
    }

    // Unlink taxBill call
    function unlinkTaxBills() {

        var url = '/taxBills/unlinkTaxBillsById';

        $("#preloader").css("display", "block");

        vm.data = {
            propId:parseInt(localStorage.getItem('propertyId')),
            taxBillIds:vm.taxBillIds
        };

        AOTCService.postDataToServer(url, vm.data).then(function(result) {
            ////console.log(result);

            if (result.data.success) {
                $scope.$emit('success',result.data.message);
                getTaxBills();
            } else {
                $scope.$emit('error',result.data.message);
            }
            vm.taxBillIds = [];

            $("#preloader").css("display", "none");
        }, function(result) {
            $("#preloader").css("display", "none");
            $scope.$emit('error',result.data.message);
        });
    }

    // Delete taxBill call
    function deleteTaxBills() {

        var url = '/taxBills/deleteTaxBillsById';

        $("#preloader").css("display", "block");

        vm.data = {
            taxBillIds:vm.taxBillIds
        };

        AOTCService.postDataToServer(url, vm.data).then(function(result) {
            ////console.log(result);
            
            if (result.data.success) {
                $scope.$emit('success',result.data.message);
                getTaxBills();
            } else{
                $scope.$emit('error',result.data.message);
            }
            vm.taxBillIds = [];

            $("#preloader").css("display", "none");
        }, function(result) {
            $("#preloader").css("display", "none");
            $scope.$emit('error',result.data.message);
        });
    }
}

/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 268 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {

_viewIERR.$inject = ["$stateParams", "$anchorScroll", "$state", "DTOptionsBuilder", "DTColumnDefBuilder", "$location", "$scope", "$http", "__env", "$log", "AOTCService", "$timeout"];
module.exports = _viewIERR;

//angular.module('AOTC').controller('viewIERR', _viewIERR
//    );
function _viewIERR($stateParams, $anchorScroll, $state, DTOptionsBuilder, DTColumnDefBuilder, $location, $scope, $http, __env, $log, AOTCService, $timeout) {
    ////console.log("ViewIERR controller", $stateParams);
    var vm = this;

    vm.IERRProperty = {};

    // if ($stateParams.property) {
    //     localStorage.setItem('viewIERRProperty', angular.toJson($stateParams.property));
    //     vm.IERRProperty = $stateParams.property;


    // } else {

    //     vm.IERRProperty = JSON.parse(localStorage.getItem('viewIERRProperty'));

    // }
    //publicProperty
    vm.IERRProperty = JSON.parse(localStorage.getItem('propertyDetails'));
    vm.propertyId = JSON.parse(localStorage.getItem('propertyId'));
    var userRole = localStorage.getItem('role');

    if (userRole === "Assessing Authority") {
        vm.hideTabs = false;
    } else {
        vm.hideTabs = true;
    }

    ////console.log(vm.IERRProperty);

    // vm.propertyId = $stateParams.property.prop._id;

    vm.isActive = isActive
    vm.showRentRole = showRentRole;
    vm.showIncomeExpense = showIncomeExpense;
    vm.showOtherFiles = showOtherFiles;
    vm.showTaxBills = showTaxBills;
    vm.showPublicProperty = showPublicProperty;
    
    

    function isActive(viewLocation) {
        // ////console.log("viewLocation",viewLocation);
        return viewLocation === $location.path();
    }


    if ($stateParams.success) {
        $("div.success").fadeIn(1500).delay(500).fadeOut(1500, function () { });

    }
    vm.showPropertyDetails = showPropertyDetails;

    function showPropertyDetails() {
        // $window.location.href = '#/detail/analytics';    
        // $state.go('viewIERR.property_details');
        $state.go('viewIERR.propertyDetailsTab');
        // $window.location.reload();

        // ////console.log('showAnalytics clickd in homejs');
    }

    function showIncomeExpense() {
        // $window.location.href = '#/detail/analytics';    
        $state.go('viewIERR.income_expense');
        // $window.location.reload();

        // ////console.log('showAnalytics clickd in homejs');
    }
    function showPublicProperty() {
        // $window.location.href = '#/detail/analytics';    
        $state.go('viewIERR.public_property_tab');
        // $window.location.reload();

        // ////console.log('showAnalytics clickd in homejs');
    }

    function showRentRole() {
        // $window.location.href = '#/home/posts';    
        // $state.go('detail.logs');
        $state.go('viewIERR.rent_role');

        // $window.location.href = '#/detail/logs';    
        // ////console.log('showLogs clickd in homejs');
    }

    function showOtherFiles() {
        $state.go('viewIERR.other_files');
    }

    function showTaxBills() {
        ////console.log("showTaxBills Called");
        $state.go('viewIERR.tax_bills');
    }
}

/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 269 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {

//var agGrid = require('agGrid');
_PropertyListCtrl.$inject = ["AOTCPermissions", "User_Config", "$timeout", "$compile", "PrivatePropertyService", "$state", "$scope", "$location"];
module.exports = _PropertyListCtrl;

agGrid.initialiseAgGridWithAngular1(angular);
//angular.module('AOTC').controller('PropertyListCtrl', _PropertyListCtrl
//    );

function _PropertyListCtrl(AOTCPermissions, User_Config, $timeout, $compile, PrivatePropertyService, $state, $scope, $location) {
    var vm = this;
    vm.userId = localStorage.getItem('userId');
    vm.paginationPageSize = 25;
    vm.pagesInCash = 1;

    vm.showDeleteButton = false;
    vm.showMultiPartAccount = false;
    vm.showContractButton = false;

    vm.userRole = localStorage.getItem('role');
    vm.hideButtons = false;
    vm.AJUser = false;
    vm.headingLabel = 'View Private Properties';


    if (vm.userRole == User_Config.AJ_USER) {
        vm.hideButtons = true;
        vm.AJUser = true;
        vm.headingLabel = 'View Properties in Your Jurisdiction';
    }

    var serverInProgress = 0;

    setTimeout(function () {
        $('[data-tooltip="tooltip"]').tooltip();
    }, 1000);

    var columnDefs = [{
        headerName: "",
        field: "",
        width: 50,
        suppressFilter: true,
        suppressSorting: true,
        headerCheckboxSelection: false,
        checkboxSelection: !vm.AJUser
    }, {
        headerName: "Images",
        field: "imageFileName",
        width: 65,
        suppressFilter: true,
        suppressSorting: true,
        cellRenderer: function (params) {

            if (params.data) {

                if (params.value) {
                    var imageHTML = '<img src="' + params.value + '" class="img-responsive">';
                } else {
                    var imageHTML = '<img src="assets/img/noImageAvailable.jpg" class="img-responsive">';
                }
                return imageHTML;
            }
        }
    }, {
        headerName: "Tax Account Number",
        field: "taxAccountNo",
        filterParams: {
            applyButton: true,
            clearButton: true
        },
        // headerCheckboxSelection: !vm.AJUser,
        // checkboxSelection: !vm.AJUser,
        cellRenderer: function (params) {
            if (params.data) {
                var finalVal = params.value;

                if (params.data.publicProperty != null) {
                    finalVal += '<img class="pull-right" title="Public Property" height="27" width="39" aria-hidden="true" src="assets/img/publicProperty.png">';
                }

                if (params.data.relationType == User_Config.MULTI_PART) {

                    finalVal += '<i class="fa fa-window-restore fa-lg pull-right my-center" title="Multi-Part" aria-hidden="true"></i> ';
                } else if (params.data.relationType == User_Config.MULTI_ACCOUNT) {
                    finalVal += '<i class="fa fa-puzzle-piece fa-lg pull-right my-center"  title="Multi-Account" aria-hidden="true"></i> ';
                }
                return finalVal;
            }
        }
    }, {
        headerName: "Property Name",
        field: "propertyName",
        filter: 'text',
        filterParams: {
            applyButton: true,
            clearButton: true
        }
    }, {
        headerName: "Property Address",
        field: "streetName",
        filterParams: {
            applyButton: true,
            clearButton: true
        }
    }, {
        headerName: "Owner Name",
        field: "recordOwnerName",
        filterParams: {
            applyButton: true,
            clearButton: true
        }
    }, {
        headerName: "Actions",
        width: 300,
        suppressResize: true,
        cellRenderer: MyCellRenderer,
        suppressFilter: true,
        suppressSorting: true
    }];

    var gridOptions = {
        floatingFilter: true,
        enableServerSideSorting: true,
        enableServerSideFilter: true,
        rowHeight: 40,
        enableColResize: true,
        rowSelection: 'multiple',
        rowDeselection: true,
        suppressRowClickSelection: vm.AJUser,
        columnDefs: columnDefs,
        rowModelType: 'infinite',
        paginationOverflowSize: 2,
        maxConcurrentDatasourceRequests: 2,
        infiniteInitialRowCount: 1,
        maxPagesInCache: vm.pagesInCash,
        getRowNodeId: function (item) {
            return item.id;
        },
        onGridReady: function (params) {
            params.api.sizeColumnsToFit();
        },
        onSelectionChanged: function (event) {
            var selectedProps = gridOptions.api.getSelectedRows();
            ////console.log('selectedProps', selectedProps.length);
            ////console.log('server in progress', selectedProps);
            if (serverInProgress != 1) {
                if (selectedProps.length > 0) {
                    vm.showContractButton = true;
                    $scope.$apply();
                    ////console.log('server in progress', vm.showContractButton);


                }

                if (selectedProps.length > 1) {
                    ////console.log('active delete button')
                    vm.showDeleteButton = true;
                    decideToShowMultiAccountMultiPart(selectedProps);
                    if (!$scope.$$phase) {
                        $scope.$apply();
                    }
                } else if (serverInProgress == 0) {
                    if (selectedProps.length == 0) {
                        vm.showContractButton = false;
                        vm.showDeleteButton = false;
                        vm.showMultiPartAccount = false;
                    }


                    if (!$scope.$$phase) {
                        $scope.$apply();
                    }
                }
            }
        }
    };

    gridOptions.pagination = true;
    gridOptions.infiniteBlockSize = vm.paginationPageSize;
    gridOptions.paginationPageSize = vm.paginationPageSize;

    function getSelectedPropertiesId() {
        var propIdList = [];
        var selectedProps = gridOptions.api.getSelectedRows();
        for (var i = 0; i < selectedProps.length; i++) {
            var property = selectedProps[i];
            ////console.log(property)
            propIdList.push(property._id);
        }
        // ////console.log(propIdList);
        return propIdList;
    }


    $scope.createContract = function () {
        var propIdList = getSelectedPropertiesId();
        // //console.log('propIdList' , propIdList);
        localStorage.setItem('selectedPopertiesId', angular.toJson(propIdList));
        PrivatePropertyService.selectedPropertyList = propIdList
        console.log(PrivatePropertyService.selectedPropertyList)
        $state.go('Contract');
    }

    function moveToMultiAccount() {
        serverInProgress = 1;

        //send selected prop to multi-account url
        $("#preloader").css("display", "block");

        var url = '/properties/multiAccountLinking';
        var propIdList = getSelectedPropertiesId();

        var jsonFormat = {
            propIds: propIdList
        };
        ////console.log(jsonFormat);
        gridOptions.api.deselectAll();
        PrivatePropertyService.postDataToServer(url, jsonFormat)
            .then(function (result) {
                serverInProgress = 0;
                vm.showDeleteButton = false;
                vm.showMultiPartAccount = false;
                ////console.log(result);
                var serverData = result.data;
                $("#preloader").css("display", "none");

                if (serverData.success) {
                    setRowData([]);
                    $scope.$emit('success', serverData.message);

                } else {
                    $scope.$emit('error', serverData.message);
                }


            }, function (error) {

                ////console.log(error);
                $("#preloader").css("display", "none");
                // $scope.$emit('error',serverData.message);
            });
    }

    function moveToMultiPart() {
        serverInProgress = 1;
        //send selected prop to multi-part url
        // $("#preloader").css("display", "block");
        var url = '/properties/multiPartLinking';
        var propIdList = getSelectedPropertiesId();
        var jsonFormat = {
            propIds: propIdList
        };

        ////console.log(jsonFormat);
        gridOptions.api.deselectAll();
        PrivatePropertyService.postDataToServer(url, jsonFormat)
            .then(function (result) {
                serverInProgress = 0;
                ////console.log(result);
                var serverData = result.data;
                vm.showDeleteButton = false;
                vm.showMultiPartAccount = false;
                $("#preloader").css("display", "none");

                if (serverData.success) {
                    setRowData([]);
                    $scope.$emit('success', serverData.message);

                } else {
                    $scope.$emit('error', serverData.message);
                }

            }, function (error) {
                $("#preloader").css("display", "none");
                ////console.log(error);
            });
    }

    function deleteProperties() {
        //delete selected prop
        serverInProgress = 1;

        // $("#preloader").css("display", "block");

        var propIds = getSelectedPropertyIdsList();
        var selectedProps = gridOptions.api.getSelectedRows();

        if (selectedProps.length > 0) {
            gridOptions.api.deselectAll();
        }

        PrivatePropertyService.deleteProperties(propIds)
            .then(function (serverData) {
                serverInProgress = 0;
                ////console.log(serverData);
                $("#preloader").css("display", "none");
                if (serverData.success) {
                    setRowData([]);
                    vm.showDeleteButton = false;
                    vm.showMultiPartAccount = false;
                    $scope.$emit('success', serverData.message);

                } else {
                    $scope.$emit('error', serverData.message);
                }
            }, function (err) {
                serverInProgress = 0;
                ////console.log(err);
                $scope.$emit('error', err.message);
                $("#preloader").css("display", "none");
                ////console.log(error);
            });
    }

    function decideToShowMultiAccountMultiPart(selectedProps) {

        var multiPart_exist = false;
        var multiAccount_exist = false;

        for (var i = 0; i < selectedProps.length; i++) {
            var property = selectedProps[i];

            if (property.relationType == 'multiaccount') {
                multiAccount_exist = true;
            } else if (property.relationType == 'multipart') {
                multiPart_exist = true;
            }
        }

        if (multiAccount_exist && multiPart_exist) {
            vm.showMultiPartAccount = false;

        } else if (selectedProps.length > 1) {
            vm.showMultiPartAccount = true;

        } else {
            vm.showMultiPartAccount = false;
        }
    }

    var gridDiv = document.querySelector('#myGrid');
    new agGrid.Grid(gridDiv, gridOptions);

    setRowData([]);

    function setRowData(allOfTheData) {

        var dataSource = {
            rowCount: null, // behave as infinite scroll
            getRows: function (params) {
                ////console.log("\n\n***************GET ROWS ==> Params**********\n");
                ////console.log(params);
                serverInProgress = 1;

                var myParams = {
                    paginationPageSize: vm.paginationPageSize,
                    startRow: params.startRow,
                    sortModel: params.sortModel[0] ? params.sortModel[0] : {},
                    filterModel: params.filterModel
                };

                $("#pri-preloader").css("display", "block");

                PrivatePropertyService.getProps(myParams)
                    .then(function (response) {
                        serverInProgress = 0;
                        var serverData = response.data;
                        ////console.log('\n=> Server response\n', serverData);
                        if (serverData.success) {
                            vm.tableData = serverData.result.data;
                            allOfTheData = vm.tableData;

                            for (var i = 0; i < allOfTheData.length; i++) {
                                var obj = allOfTheData[i];
                                obj.id = obj._id;
                            }

                            var lastRow;
                            var rowsThisPage = allOfTheData;
                            lastRow = serverData.result.totalRecords;
                            params.successCallback(rowsThisPage, lastRow);
                        }

                        $("#preloader").css("display", "none");
                        $("#pri-preloader").css("display", "none");

                    });
            }

        };
        gridOptions.api.setDatasource(dataSource);
    }

    //===================================== delete properties -start-=======================================//

    vm.deletePropAlert = deletePropAlert;
    vm.multiAccountAlert = multiAccountAlert;
    vm.multiPartAlert = multiPartAlert;
    vm.modalYesAction = modalYesAction;

    vm.modelMessage = {
        title: "",
        message: ""
    }

    function deletePropAlert() {
        vm.selectedOption = 0;
        if (getSelectedPropertyIdsList().length > 1) {
            vm.modelMessage.title = 'Delete Properties';
            vm.modelMessage.message = 'Are you sure you want to delete the selected properties?';
        } else {
            vm.modelMessage.title = 'Delete Property';
            vm.modelMessage.message = 'Are you sure you want to delete this property?';
        }
    }

    function multiAccountAlert() {
        vm.selectedOption = 1;
        vm.modelMessage.title = 'Multi Account Property';
        vm.modelMessage.message = 'Are you sure to link these properties?';
    }

    function multiPartAlert() {
        vm.selectedOption = 2;
        vm.modelMessage.title = 'Multi Part Property';
        vm.modelMessage.message = 'Are you sure to link these properties?';
    }

    function modalYesAction() {
        if (vm.selectedOption == 0) // 0  for delete
        {
            deleteProperties();

        }
        if (vm.selectedOption == 1) // 1  for multiaccount
        {
            moveToMultiAccount();
        }
        if (vm.selectedOption == 2) // 2  for multi part
        {
            moveToMultiPart();
        }
    }

    function getSelectedPropertyIdsList() {
        var propIdList = [];
        var selectedProps = gridOptions.api.getSelectedRows();
        ////console.log(selectedProps);
        for (var i = 0; i < selectedProps.length; i++) {
            propIdList.push(selectedProps[i]._id);
        }
        return propIdList;
    }



    $scope.viewEvaluation = function () {
        ////console.log('viewEvaluation');
        ////console.log(property);

        localStorage.setItem('propertyDetails', angular.toJson(property.properties));
        localStorage.setItem('propertyId', angular.toJson(property._id));


        property.prop = property.masterProperty;
        // ////console.log(property.prop._id);
        $state.go('propertyValuation', { //uploadIERR updateIERR
            property: property
        });

        // viewIERR.property_details({property : prop})

    }

    //===================================== delete properties -end-=======================================//
    //===================================== Table Actions Buttons -start-=================================//

    function MyCellRenderer() {}

    MyCellRenderer.prototype.init = function (params) {
        if (params.data) {
            this.eGui = document.createElement('span');
            if (vm.userRole == User_Config.AJ_USER) {
                // User is type AJ
                innerHtml = '<span style="display:block; text-align:center;"><button class="btn btn-info" style="background: #107dda;border: none;    padding: 4px;" data-toggle="tooltip" data-placement="right" title="View details" value="' + params.data._id + '" ><i class="fa  fa-eye fa-lg"></i></button></span>';
                this.eGui.innerHTML = innerHtml;
                this.viewButton = this.eGui.querySelectorAll('.btn-info')[0];

            } else {
                var viewBtnStatus = (params.data.roles.viewPropertyDetails) ? 'inline' : 'none';
                var comparableBtnStatus = (params.data.roles.viewComparables) ? 'inline' : 'none';
                var valuationBtnStatus = (params.data.roles.viewValuationForm) ? 'inline' : 'none';
                var attachBtnStatus = (params.data.roles.attachFilesToProperty) ? 'inline' : 'none';
                var assignBtnStatus = (params.data.roles.assignProperty) ? 'inline' : 'none';


                var innerHtml =
                    '<span style="display:block; text-align:center;">' +
                    '<button ' +
                    '           class="btn btn-info " style="margin-right: 10px; background: rgba(122, 218, 16, 0.82); ' +
                    '           border: none;    padding: 4px;display:' + viewBtnStatus + ';" data-toggle="tooltip" ' +
                    '           data-placement="right" title="View details" ' +
                    '           value=" ' + params.data._id + ' " > ' +
                    '           <i class="fa  fa-eye fa-lg"></i> </button> ' +
                    '       <button ' +
                    '           class="btn btn-info " style="margin-right: 10px; background: #3be4ff ; ' +
                    '           border: none;padding: 4px;display:' + attachBtnStatus + ';" data-toggle="tooltip" data-placement="right" ' + ' title="Attach files" ' +
                    '            value=" ' + params.data._id + ' " > ' +
                    '           <i class="fa fa-paperclip fa-lg"></i> </button> ' +

                    '       <button  class="btn btn-info " style="margin-right: 10px; background:#ff9800 ; ' +
                    '           border: none;    padding: 4px;display:' + valuationBtnStatus + ';" data-toggle="tooltip" data-placement="right" ' +
                    '           title="Valuation" ' +
                    '            value=" ' + params.data._id + ' "> ' +
                    '           <i class="fa fa-list-alt fa-lg"></i> </button> ' +
                    '       <button ' +
                    '           class="btn btn-info " style="margin-right: 10px; background: rgb(255, 118, 0); ' +
                    '           border: none;    padding: 4px;display:' + comparableBtnStatus + ';" data-toggle="tooltip" data-placement="right" ' + ' title="Comparables" ' +
                    '           value=" ' + params.data._id + ' " > ' +
                    '           <i class="fa fa-exchange fa-lg"></i> </button> ' +
                    '       <button ' +
                    '       class="btn btn-info " style="margin-right: 5px; background: #f44336;border: none;' +
                    '               padding: 4px;" data-toggle="tooltip" data-placement="right" title="Delete Property" ' +
                    '           value=" ' + params.data._id + ' " > ' +
                    '           <i class="fa fa-trash fa-lg"></i> </button> ' +
                    '       <button ' +
                    '       class="btn btn-info " style="margin-right: 5px; background:  rgba(122, 218, 16, 0.82);border: none;display:' + assignBtnStatus + ';' +
                    '               padding: 4px;" data-toggle="tooltip" data-placement="right" title="Assign" ' +
                    '           value=" ' + params.data._id + ' " > ' +
                    '           <i class="fa fa-hand-o-right fa-lg"></i> </button> ' +
                    '   </span>';

                this.eGui.innerHTML = innerHtml;

                this.viewButton = this.eGui.querySelectorAll('.btn-info')[0];
                this.attachButton = this.eGui.querySelectorAll('.btn-info')[1];
                this.valuationButton = this.eGui.querySelectorAll('.btn-info')[2];
                this.comparablesButton = this.eGui.querySelectorAll('.btn-info')[3];
                this.deleteButton = this.eGui.querySelectorAll('.btn-info')[4];
                this.assignButton = this.eGui.querySelectorAll('.btn-info')[5];


            }

            if (vm.userRole != User_Config.AJ_USER) {
                // add event listener to button
                this.valuationEventListener = function (event) {
                    // ////console.log('eventListener 1 button was clicked!!', this.value);
                    var property = getPropertyObjectFromList(this.value);
                    if (property) {
                        //set permissions
                        AOTCPermissions.setPermissions(property.roles, 'permissionPerPropertyObj');
                        localStorage.setItem('propertyDetails', angular.toJson(property));
                        localStorage.setItem('propertyId', angular.toJson(parseInt(this.value)));
                        $timeout(function(){
                            $state.go('propertyValuation');
                        });
                        
                    }
                };

                this.attachEventListener = function (event) {
                    // ////console.log('eventListener 3 button was clicked!!', this.value);
                    var property = getPropertyObjectFromList(this.value);
                    if (property) {
                        //set permissions
                        AOTCPermissions.setPermissions(property.roles, 'permissionPerPropertyObj');
                        localStorage.setItem('propertyDetails', angular.toJson(property));
                        localStorage.setItem('propertyId', angular.toJson(parseInt(this.value)));
                        $timeout(function(){
                            $state.go('updateIERR');
                        });

                    }
                };

                this.comparableEventListener = function (event) {
                    // ////console.log('eventListener 4 button was clicked!!', this.value);
                    var property = getPropertyObjectFromList(this.value);
                    if (property) {
                        //set permissions
                        AOTCPermissions.setPermissions(property.roles, 'permissionPerPropertyObj');
                        localStorage.setItem('propertyDetails', angular.toJson(property));
                        localStorage.setItem('propertyId', angular.toJson(parseInt(this.value)));
                        $timeout(function(){
                            $state.go('comparableSelection');
                        });
                    }
                };

                this.deleteEventListener = function (event) {

                    ////console.log('eventListener 5 button was clicked!!', this.value);
                    deletePropAlert();
                    $('#myModalquestion').modal('toggle');

                };

                this.valuationButton.addEventListener('click', this.valuationEventListener);
                this.attachButton.addEventListener('click', this.attachEventListener);
                this.deleteButton.addEventListener('click', this.deleteEventListener);
                this.comparablesButton.addEventListener('click', this.comparableEventListener);
            }

            this.assignEventListener = function (event) {
                var property = getPropertyObjectFromList(this.value);

                if (property) {
                    AOTCPermissions.setPermissions(property.roles, 'permissionPerPropertyObj');
                    localStorage.setItem('propertyDetails', angular.toJson(property));
                    localStorage.setItem('propertyId', angular.toJson(parseInt(this.value)));
                    // $state.go('viewIERR.property_details');
                    $timeout(function(){
                        $state.go('assignedUsersList');
                    });
                }

            };
            this.assignButton.addEventListener('click', this.assignEventListener);



            this.viewEventListener = function (event) {
                ////console.log('eventListener 2 button was clicked!!', this.value);
                var property = getPropertyObjectFromList(this.value);

                if (property) {
                    //set permissions
                    AOTCPermissions.setPermissions(property.roles, 'permissionPerPropertyObj');
                    localStorage.setItem('propertyDetails', angular.toJson(property));
                    localStorage.setItem('propertyId', angular.toJson(parseInt(this.value)));
                    // $state.go('viewIERR.property_details');
                    $timeout(function(){
                        $state.go('viewIERR.propertyDetailsTab');
                    });
                }

            };

            this.viewButton.addEventListener('click', this.viewEventListener);
        }
    };

    // gets called once when grid ready to insert the element
    MyCellRenderer.prototype.getGui = function () {
        return this.eGui;
    };

    // gets called whenever the user gets the cell to refresh
    MyCellRenderer.prototype.refresh = function (params) {
        // set value into cell again
        this.eValue.innerHTML = params.valueFormatted ? params.valueFormatted : params.value;
    };

    // gets called when the cell is removed from the grid
    //     MyCellRenderer.prototype.destroy = function() {
    //         // do cleanup, remove event listener from button
    //         this.eButton.removeEventListener('click', this.eventListener);
    //     };


    //===================================== Table Actions Buttons -end-=================================//

    function getPropertyObjectFromList(id) {
        var propFound = null;
        angular.forEach(vm.tableData, function (value, key) {
            if (value._id == id) {
                propFound = value;
            }
        });
        return propFound;
    }

    String.prototype.startsWith = function (needle) {
        return (this.indexOf(needle) == 0);
    };
}
/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 270 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/**
 * Created by MW Team 3 on 4/23/2017.
 */


_PrivatePropertyService.$inject = ["$http", "$q", "$location"];
module.exports = _PrivatePropertyService;

//angular.module('AOTC').service("PrivatePropertyService", _PrivatePropertyService);
function _PrivatePropertyService($http, $q, $location) {
    var selectedPropertyList = {}
    // Return public API.
    return ({
        getProps: getProps,
        deleteProperties: deleteProperties,
        postDataToServer: postDataToServer
    });

    function getProps(postParams) {
        var url = '/properties/getMasterProperties';
        return postDataToServer(url, postParams)
    }

    function deleteProperties(propertyIds) {
        var token = localStorage.getItem('token');

        var url = '/properties/deletePropertiesByIds';
        var request = $http({
            method: "POST",
            url: url,
            data: {
                propIds: propertyIds
            },
            headers: {
                "Access-Control-Allow-Origin": "*",
                "Content-Type": "application/json",
                "Authorization": token
            }
        });
        return (request.then(handleSuccess, handleError));
    }

    function postDataToServer(url, postParams) {
        var token = localStorage.getItem('token');

        ////console.log('in service post method')

        var request = $http({
            method: "POST",
            url: url,
            data: postParams,
            headers: {
                "Access-Control-Allow-Origin": "*",
                "Content-Type": "application/json",
                "Authorization": token
            }
        });
        return request;
    }

    // ---
    // PRIVATE METHODS.
    // ---
    // I transform the error response, unwrapping the application dta from
    // the API response payload.
    function handleError(response) {
        // The API response from the server should be returned in a
        // nomralized format. However, if the request was not handled by the
        // server (or what not handles properly - ex. server error), then we
        // may have to normalize it on our end, as best we can.
        if (!angular.isObject(response.data) || !response.data.message) {
            return ($q.reject("An unknown error occurred."));
        }
        // Otherwise, use expected error message.
        return ($q.reject(response.data.message));
    }

    // I transform the successful response, unwrapping the application data
    // from the API response payload.
    function handleSuccess(response) {
        return (response.data);
    }
}

/***/ }),
/* 271 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {

_PublicPropertyCtrl.$inject = ["User_Config", "PublicPropertyService", "$http", "$timeout", "$compile", "$state", "$scope", "$location", "AOTCService"];
module.exports = _PublicPropertyCtrl;

agGrid.initialiseAgGridWithAngular1(angular);
//angular.module('AOTC').controller('PublicPropertyCtrl', _PublicPropertyCtrl
//    );
function _PublicPropertyCtrl(User_Config, PublicPropertyService, $http, $timeout, $compile, $state, $scope, $location, AOTCService) {
    var vm = this;
    vm.userId = localStorage.getItem('userId');

    vm.paginationPageSize = 25;
    vm.pagesInCash = 1;

    vm.showDeleteButton = false;
    vm.showMultiPartAccount = false;
    var serverInProgress = 0;
    $("#preloader").css("display", "none");
    $("#pri-preloader").css("display", "none");

    // vm.moveToMultiAccount = moveToMultiAccount;
    // vm.moveToMultiPart = moveToMultiPart;

    $scope.showInfo = true;
    var columnDefs = [{
            headerName: "Tax Account Number",
            field: "taxAccountNo",
            filterParams: {
                applyButton: true,
                clearButton: true
            },
            cellRenderer: function (params) {
                if (params.data) {
                    if (params.data.relationType == User_Config.MULTI_PART)
                        return params.value + '<i class="fa fa-window-restore fa-lg pull-right my-center" aria-hidden="true"></i> ';
                    else if (params.data.relationType == User_Config.MULTI_ACCOUNT) {
                        return params.value + '<i class="fa fa-puzzle-piece fa-lg pull-right my-center" aria-hidden="true"></i> ';

                    } else {
                        return params.value;
                    }
                } else {
                    return 'No data found';
                }
            }
        }, {
            headerName: "Property Name",
            filterParams: {
                applyButton: true,
                clearButton: true
            },
            field: "propertyName"
        }, {
            headerName: "Property Address",
            filterParams: {
                applyButton: true,
                clearButton: true
            },
            field: "streetName"
        }, {
            headerName: "Owner Name",
            filterParams: {
                applyButton: true,
                clearButton: true
            },
            field: "recordOwnerName"
        }, {
            headerName: "Actions",
            width: 100,
            suppressResize: true,
            cellRenderer: MyCellRenderer,
            suppressFilter: true,
            suppressSorting: true
        }

    ];



    var gridOptions = {
        floatingFilter: true,
        enableServerSideSorting: true,
        enableServerSideFilter: true,
        rowHeight: 40,
        enableColResize: true,
        // rowSelection: 'multiple',
        suppressPaginationPanel: true,
        rowDeselection: false,
        columnDefs: columnDefs,
        rowModelType: 'infinite',
        //paginationOverflowSize: 2,
        maxConcurrentDatasourceRequests: 2,
        infiniteInitialRowCount: 1,
        maxPagesInCache: vm.pagesInCash,
        getRowNodeId: function (item) {
            return item.id;
        },
        onGridReady: function (params) {
            // ////console.log('grid is ready')
            params.api.sizeColumnsToFit();
            // params.api.angularCompileRows = true;

        },
        onSelectionChanged: function (event) {
            // ////console.log('onSelectionChanged event', event);
            var selectedProps = gridOptions.api.getSelectedRows();
            ////console.log('selectedProps', selectedProps);
            ////console.log('server in progress', serverInProgress);
            if (serverInProgress == 1) {
                // gridOptions.api.deselectAll();
            }
            if (selectedProps.length > 0) {
                ////console.log('active delete button')
                vm.showDeleteButton = true;
                decideToShowMultiAccountMultiPart(selectedProps);
                $scope.$apply();
            } else if (serverInProgress == 0) {
                vm.showDeleteButton = false;
                vm.showMultiPartAccount = false;
                $scope.$apply();
            }
        }
    };
    gridOptions.pagination = true;
    gridOptions.paginationPageSize = vm.paginationPageSize;
    gridOptions.infiniteBlockSize = vm.paginationPageSize;

    var gridDiv = document.querySelector('#myGrid');
    new agGrid.Grid(gridDiv, gridOptions);

    setRowData(1, 5);
    vm.totalItems = 0;
    vm.pageSize = 5;
    vm.currentPage = 1;
    vm.pageChanged = function(page, size) {
      size = size || vm.pageSize || 5;
      page = page || vm.currentPage || 1;
      vm.currentPage = page || 1;
      setRowData(page, size);
    };
    function setRowData(_page, _size) {
        
        var dataSource = {
            rowCount: null, // behave as infinite scroll
            getRows: function (params) {
                serverInProgress = 1;

                $("#pri-preloader").css("display", "block");

                var _url = '/properties/getAJPublicProperties';

                var _data= {
                    "startRow": (_page-1)*_size,
                    "paginationPageSize": _size,
                    "state": null
                };
            
                AOTCService.postDataToServer(_url, _data)
                    .then(function (response) {
                        //$("#pri-preloader").css("display", "none");
                        if (response.data.success) {
                            //var serverData = response.data;
                            var serverData = response.data.result;
                            var rowsThisPage = [];
                            for (var i = 0; i < serverData.properties.length; i++) {
                                var obj = {};
                                obj.id = serverData.properties[i].prop._id;
                                angular.extend(obj, serverData.properties[i].prop.properties);
                                rowsThisPage[i] = obj;
                            }
                            vm.tableData = rowsThisPage;
                            var lastRow;
                            //var rowsThisPage = allOfTheData;
                            lastRow = serverData.count;
                            vm.totalItems = lastRow;
                            vm.PageStartCount = ((parseInt(_page) - 1) * parseInt(_size)) + 1;
                            vm.PageEndCount = (vm.PageStartCount + serverData.properties.length) - 1;

                            params.successCallback(rowsThisPage, serverData.properties.length);

                        } else {
                            $scope.$emit('danger', response.data.message);
                        }
                        $("#pri-preloader").css("display", "none");

                    }, function (result) {
                        $("#pri-preloader").css("display", "none");
                    });
            }

        };
        gridOptions.api.setDatasource(dataSource);

    }




    function MyCellRenderer() {}

    MyCellRenderer.prototype.init = function (params) {
        if (params.data) {
            this.eGui = document.createElement('span');

            var innerHtml = '<span style="display:block; text-align:center;"><button class="btn btn-info " style="margin-right: 18px; background: rgba(122, 218, 16, 0.82);border: none;padding: 4px;" data-toggle="tooltip" data-placement="right" title="View details" value="' + params.data.id + '" ><i class="fa  fa-eye fa-lg"></i> </button></span>';

            this.eGui.innerHTML = innerHtml;
            this.viewButton = this.eGui.querySelectorAll('.btn-info')[0];


            this.viewEventListener = function (event) {
                ////console.log('viewEventListener was clicked!!', this.value);
                var property = getPropertyObjectFromList(this.value);

                if (property) {
                    localStorage.setItem('propertyDetails', angular.toJson(property));
                    localStorage.setItem('propertyId', angular.toJson(parseInt(this.value)));
                    // $state.go('viewIERR.property_details');
                    $state.go('publicPropertyDetailsTab');
                }

            };

            this.viewButton.addEventListener('click', this.viewEventListener);
        }
    };

    // gets called once when grid ready to insert the element
    MyCellRenderer.prototype.getGui = function () {
        return this.eGui;
    };

    // gets called whenever the user gets the cell to refresh
    MyCellRenderer.prototype.refresh = function (params) {
        // set value into cell again
        this.eValue.innerHTML = params.valueFormatted ? params.valueFormatted : params.value;
    };

    function getPropertyObjectFromList(id) {
        var propFound = null;
        angular.forEach(vm.tableData, function (value, key) {
            if (value.id == id) {
                propFound = value;
            }
        });
        return propFound;
    }

}
/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 272 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/**
 * Created by MW Team 3 on 4/23/2017.
 */


_PublicPropertyService.$inject = ["$http", "$q"];
module.exports = _PublicPropertyService;

//angular.module('AOTC')
//    .service(
//        "PublicPropertyService", _PublicPropertyService
        
//    );
function _PublicPropertyService($http, $q) {
    // Return public API.
    return ({
        getPublicProps: getPublicProps
    });
    function postDataToServer(url, postParams) {

        var token = localStorage.getItem('token');
        var request = $http({
            method: "POST",
            url: url,
            data: postParams,
            headers: {
                "Access-Control-Allow-Origin": "*",
                "Content-Type": "application/json",
                "Authorization": token
            }
        });
        return request;
    }


    // I get all of the tasks in the remote collection.
    function getPublicProps(params) {
        var url = '/properties/getAJPublicProperties';
        return postDataToServer(url, params);
    }

    // ---
    // PRIVATE METHODS.
    // ---
    // I transform the error response, unwrapping the application dta from
    // the API response payload.
    function handleError(response) {
        // The API response from the server should be returned in a
        // nomralized format. However, if the request was not handled by the
        // server (or what not handles properly - ex. server error), then we
        // may have to normalize it on our end, as best we can.
        if (
            !angular.isObject(response.data) || !response.data.message
        ) {
            return ($q.reject("An unknown error occurred."));
        }
        // Otherwise, use expected error message.
        return ($q.reject(response.data.message));
    }

    // I transform the successful response, unwrapping the application data
    // from the API response payload.
    function handleSuccess(response) {

        return (response.data);
    }
}

/***/ }),
/* 273 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {
_TabsViewerCtrl.$inject = ["User_Config", "$stateParams", "$anchorScroll", "$state", "$location", "$scope", "$http", "__env", "$log", "AOTCService", "$timeout"];
module.exports = _TabsViewerCtrl;

//angular.module('AOTC').controller('TabsViewerCtrl', _TabsViewerCtrl
//    );
function _TabsViewerCtrl(User_Config, $stateParams, $anchorScroll, $state, $location, $scope, $http, __env, $log, AOTCService, $timeout) {
    //////console.log("TabsViewerCtrl controller", $stateParams);
    var vm = this;


    vm.isActive = isActive;
    vm.showPubPropertylist = showPubPropertylist;
    vm.showPriPropertylist = showPriPropertylist;
    vm.hideTabs = false;
    $("#preloader").css("display", "block");

    localStorage.removeItem('selectedScenario');

    var user = JSON.parse(localStorage.getItem('userJson'));
    ////console.log(user.userData.role);

    // user.userData.role = User_Config.AJ_USER;

    if (user.userData.role == User_Config.AJ_USER) {
        vm.hideTabs = true;
        $state.go('PropertyList.private_property_list');
    }

    function isActive(viewLocation) {
        return viewLocation === $location.path();
    }


    if ($stateParams.success) {
        $("div.success").fadeIn(1500).delay(500).fadeOut(1500, function () {
        });

    }


    function showPriPropertylist() {
        // $window.location.href = '#/detail/analytics';    
        $state.go('PropertyList.private_property_list');
        // ////console.log('showAnalytics clickd in homejs');
    }

    function showPubPropertylist() {
        // $window.location.href = '#/detail/analytics';    
        $state.go('PropertyList.pub_property_list');
        // $window.location.reload();

        // ////console.log('showAnalytics clickd in homejs');
    }

}
/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 274 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


_ValuationService.$inject = ["$http", "$q"];
module.exports = _ValuationService;

//angular.module('AOTC')
//    .factory('ValuationService', _ValuationService
//    );
function _ValuationService($http, $q) {

    function getDataFromServer(apiUrl) {
        // ////console.log(apiUrl);
        var token = localStorage.getItem('token');

        var req = $http({
            method: "GET",
            url: apiUrl,
            headers: {
                "Access-Control-Allow-Origin": "*",
                "Content-Type": "application/json",
                "Authorization": token
            }

        });

        return req;

    }

    function getValuationForms(url, formData) {
        ////console.log(url);
        var token = localStorage.getItem('token');

        var req = $http({
            method: "POST",
            url: url,
            data: formData,
            headers: {
                "Access-Control-Allow-Origin": "*",
                "Content-Type": "application/json",
                "Authorization": token

            }

        });

        return req;

    }

    function putDataToServer(url, userData) {
        var token = localStorage.getItem('token');

        var request = $http({
            method: "PUT",
            url: url,
            data: userData,
            headers: {
                "Access-Control-Allow-Origin": "*",
                "Content-Type": "application/json",
                "Authorization": token
            }

        });

        return request;

    }

    function postDataToServer(url, userData) {
        var token = localStorage.getItem('token');

        var request = $http({
            method: "POST",
            url: url,
            data: userData,
            headers: {
                "Access-Control-Allow-Origin": "*",
                "Content-Type": "application/json",
                "Authorization": token
            }

        });
        return request;

    }

    function appeal(url, formData) {
        var token = localStorage.getItem('token');
        var request = $http({
            method: "POST",
            url: url,
            data: formData,
            headers: {
                "Access-Control-Allow-Origin": "*",
                "Content-Type": "application/json",
                "Authorization": token
            }

        });
        return request;

    }

    function deleteForm(url, formData) {
        var token = localStorage.getItem('token');
        var request = $http({
            method: "POST",
            url: url,
            data: formData,
            headers: {
                "Access-Control-Allow-Origin": "*",
                "Content-Type": "application/json",
                "Authorization": token
            }
        });
        return request;
    }

    function replaceValuationForm(url, formData) {
        var token = localStorage.getItem('token');

        var request = $http({
            method: "POST",
            url: url,
            data: formData,
            headers: {
                "Access-Control-Allow-Origin": "*",
                "Content-Type": "application/json",
                "Authorization": token
            }

        });
        return request;

    }

    function uploadFiles(uploadUrl, files) {
        // ////console.log(jsonForm);

        var token = localStorage.getItem('token');

        var fd = new FormData();

        for (var i = 0; i < files.length; i++) {
            fd.append('file', files[i]);

        }

        return $http.post(uploadUrl, fd, {
            transformRequest: angular.identity,
            headers: {
                'Content-Type': undefined,
                "Authorization": token
            }
        });

    }

    function getEvaluationData(metaData) {

        var serverData = {};
        var url = '/valuation';
        var deferred = $q.defer();

        postDataToServer(url, metaData)
            .then(function (result) {
                deferred.resolve(result);

            }, function (result) {
                deferred.reject(result);
                ////console.log(result);
            });
        return deferred.promise;
    }

    function getConsolidatedData(metaData) {

        var serverData = {};
        var url = '/incomeExpenses/propertyValuationIE';
        var deferred = $q.defer();
        postDataToServer(url, metaData)
            .then(function (result) {
                deferred.resolve(result);

            }, function (result) {
                deferred.reject(result);
                ///console.log(result);
            });
        return deferred.promise;
    }

    function getPetitionerModalsData() {

        var serverData = {};
        var url = '/valuation/get-modal';
        ////console.log(url);
        var deferred = $q.defer();
        var _data = {
            id: localStorage.getItem('formId'),
            propId: parseInt(localStorage.getItem('propertyId'))
        };
        // ////console.log("This: ",url);

        postDataToServer(url, _data)
            .then(function (result) {
                deferred.resolve(result);

            }, function (result) {
                ////console.log(result);
                deferred.reject(result);
            });
        return deferred.promise;
    }


    function getFormById() {


        var url = 'valuation/get-forms-by-formId';
        ////console.log(url);
        var deferred = $q.defer();
        var _data = {
            formId: localStorage.getItem('formId'),
            propId:parseInt(localStorage.getItem('propertyId'))
        };
        // ////console.log("This: ",url);

        postDataToServer(url, _data)
            .then(function (result) {
                deferred.resolve(result);

            }, function (result) {
                ////console.log(result);
                deferred.reject(result);
            });
        return deferred.promise;
    }

    return {
        getFormById: getFormById,
        getPetitionerModalsData: getPetitionerModalsData,
        getConsolidatedData: getConsolidatedData,
        getEvaluationData: getEvaluationData,
        getDataFromServer: getDataFromServer,
        uploadFiles: uploadFiles,
        postDataToServer: postDataToServer,
        putDataToServer: putDataToServer,
        getValuationForms: getValuationForms,
        replaceValuationForm: replaceValuationForm,
        appeal: appeal,
        deleteForm: deleteForm

    };

}

/***/ }),
/* 275 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


_PetitionerFormulae.$inject = [];
module.exports = _PetitionerFormulae;

//angular.module('AOTC')
//    .service('PetitionerFormulae', _PetitionerFormulae
//    );
function _PetitionerFormulae() {

    var formula1 = function (val1) {
        ////console.log(val1);
    };

    var Petitioner = {};

    Petitioner.expensesDolar = function (leaseableSqFt, expensePerSFPetitioner) {
        var expensesDolar = leaseableSqFt * expensePerSFPetitioner;
        // ////console.log(leaseableSqFt, marketRent);
        return expensesDolar;
    };

    Petitioner.expensesPercentage = function (expensesDolar, effectiveRent) {
        var expensesPercentage = expensesDolar / effectiveRent;
        return expensesPercentage;
    };


    Petitioner.annualRent = function (leaseableSqFt, marketRent) {
        var annualRent = leaseableSqFt * marketRent;
        ////console.log(leaseableSqFt, marketRent);
        return annualRent;
    };

    Petitioner.vacancy = function (grossPotentialRent, vacancypercent) {
        var annualRent = grossPotentialRent * vacancypercent;
        return annualRent;
    };

    Petitioner.effectiveRent = function (annualRent, vacancypercent) {
        var effectiveRent = annualRent - vacancypercent;
        return effectiveRent;
    };

    Petitioner.expenses = function (effectiveRent, expensesPercent) {
        var expenses = effectiveRent * expensesPercent;
        return expenses;
    };

    Petitioner.expensesPerSf = function (expenses, sqFt) {
        var expensesPerSf = expenses / sqFt;
        return expensesPerSf;
    };

    Petitioner.netOperatingIncome = function (effectiveRent, expenses) {
        var netOperatingIncome = effectiveRent - expenses;
        return netOperatingIncome;
    };

    Petitioner.overAllCapRate = function (baseCapRate, effectiveTaxRate) {
        var overAllCapRate = baseCapRate + effectiveTaxRate;
        return overAllCapRate;
    };

    Petitioner.valueDirectCap = function (OCR, NOI) {
        var valueDirectCap = NOI / OCR;
        return valueDirectCap;
    };

    Petitioner.valuePerSqFt = function (valueDirectCap, leaseableSqFt) {
        var valuePerSqFt = valueDirectCap / leaseableSqFt;
        return valuePerSqFt;
    };


    Petitioner.vdcPostDeduction = function (valueDirectCap, totalDeductionAddition) {
        var vdcPostDeduction = valueDirectCap - totalDeductionAddition;
        return vdcPostDeduction;
    };

    Petitioner.vdcPostDeductionPerSF = function (vdcPostDeduction, leaseableSqFt) {
        var vdcPostDeductionPerSF = vdcPostDeduction / leaseableSqFt;
        return vdcPostDeductionPerSF;
    };

    //takes array and sort it only applicable for selected and all evidences
    function sortByKey(array, key) {
        return array.sort(function (a, b) {
            var x;
            var y;
            if (a.properties[key] && b.properties[key]) {
                x = a.properties[key].toLowerCase();
                y = b.properties[key].toLowerCase();
            }
            return ((x < y) ? -1 : ((x > y) ? 1 : 0));
        });
    };

    function sortArrayByKey(array, key) {

        return array.sort(function (fristObjArr, secondObjArr) {
            var x;
            var y;
            var ob1;
            var ob2;
            if (fristObjArr.properties[key])
                ob1 = fristObjArr.properties[key][1];

            if (secondObjArr.properties[key])
                ob2 = secondObjArr.properties[key][1];

            if (ob1 && ob2) {
                x = ob1.toLowerCase();
                y = ob2.toLowerCase();
            }
            return ((x < y) ? -1 : ((x > y) ? 1 : 0));
        });
    };


    return {
        Petitioner: Petitioner,
        sortArrayByKey: sortArrayByKey,
        sortByKey: sortByKey
    };

}


/***/ }),
/* 276 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {

_SensitivityOne.$inject = ["$timeout", "PetitionerFormulae", "$state", "$scope", "SensitivityService", "ScenarioDataService"];
module.exports = _SensitivityOne;

//angular.module('AOTC')
//    .controller('SensitivityOne', _SensitivityOne
//    );

function _SensitivityOne($timeout, PetitionerFormulae, $state, $scope, SensitivityService, ScenarioDataService) {
    ////console.log("SensitivityOne controllersss");
    var vm = this;
    vm.formId = parseInt(localStorage.getItem('formId'));
    vm.userId = parseInt(localStorage.getItem('userId'));
    localStorage.removeItem('selectedScenario');

    $scope.col = 3;
    vm.sensitivityNamesCount = 4;
    vm.scenarioNamesCount = 1;
    vm.submitClicked = false;
    vm.scenarioTwoActive = false;

    vm.property = JSON.parse(localStorage.getItem('propertyDetails'));

    vm.showSensitivityTab = true;
    vm.showScenarioTab = false;
    vm.showScenario = showScenario;
    vm.showSensitivity = showSensitivity;
    vm.sensitivityErrorCount = sensitivityErrorCount;

    setTimeout(function () {
        $('[data-tooltip="tooltip"]').tooltip();
    }, 1000);



    var scenarioDataService = ScenarioDataService.GetValues();
    // ////console.log(scenarioDataService);
    $scope.apple = function () {
        ////console.log('check dy dhupaay');
    }
    function regenerateValue(scenarioDataService) {

        $timeout(function () {
            vm.marketRentSets = scenarioDataService.marketRentSets
            vm.vacancySets = scenarioDataService.vacancySets;
            vm.expenseSets = scenarioDataService.expenseSets;
            vm.BCRSets = scenarioDataService.BCRSets;
            vm.scenarioSets = scenarioDataService.scenarioSets;

            marketRentSetsCount = scenarioDataService.marketRentSetsCount;
            vacancySetsCount = scenarioDataService.vacancySetsCount;
            expenseSetsCount = scenarioDataService.expenseSetsCount;
            BCRSetsCount = scenarioDataService.BCRSetsCount;
            scenarioSetsCount = scenarioDataService.scenarioSetsCount;


        }, 10);
    }

    if (scenarioDataService.scenarioToShow == 'one') {
        $timeout(function () {
            $scope.col = 3;
        }, 10);
        vm.scenarioTwoActive = false;
        regenerateValue(scenarioDataService);

    } else if (scenarioDataService.scenarioToShow == 'two') {
        $timeout(function () {
            $scope.col = 2;
        }, 10);
        vm.scenarioTwoActive = true;
        regenerateValue(scenarioDataService);

    } else {

        //===================================   get workspace ===================================//
        SensitivityService.getWorkspace()
            .then(function (result) {
                ////console.log(result);

                if (result.data.result) {
                    var serverData = result.data.result[0];
                    ////console.log(serverData);
                    vm.marketRentSets = serverData.marketPerSF;
                    vm.vacancySets = serverData.vacancyPercent;
                    vm.expenseSets = serverData.expensePerSF;
                    vm.BCRSets = serverData.BaseCapRate;
                    vm.scenarioSets = serverData.scenarios;
                }



                if (vm.marketRentSets.length == 0) {
                    vm.marketRentSets.push(getNewSet(marketRentSetsCount));
                }

                if (vm.vacancySets.length == 0) {
                    vm.vacancySets.push(getNewSet(vacancySetsCount));
                }

                if (vm.expenseSets.length == 0) {
                    vm.expenseSets.push(getNewSet(expenseSetsCount));
                }

                if (vm.BCRSets.length == 0) {
                    vm.BCRSets.push(getNewSet(BCRSetsCount));
                }

                if (vm.scenarioSets.length == 0) {
                    vm.scenarioSets.push(getNewSet(scenarioSetsCount));
                }


            }, function (err) {
                ////console.log(err);

            });

    }



    $scope.showScenarioOne = function () {
        ////console.log('showScenarioOne')
        $scope.col = 3;
        vm.scenarioTwoActive = false;

    }
    $scope.showScenarioTwo = function () {
        ////console.log('showScenarioTwo')
        $scope.col = 2;
        vm.scenarioTwoActive = true;

    }

    $scope.showScenarioThree = function () {
        ////console.log('showScenarioTwo')
        $scope.col = 2;
        vm.scenarioTwoActive = true;

        ScenarioDataService.SetValues(
            vm.marketRentSets,
            vm.vacancySets,
            vm.expenseSets,
            vm.BCRSets,
            vm.scenarioSets,
            'three',
            marketRentSetsCount,
            vacancySetsCount,
            expenseSetsCount,
            BCRSetsCount,
            scenarioSetsCount
        );

        $state.go('SensitivityThree');


    }

    function showSensitivity() {
        vm.showSensitivityTab = true;
        vm.showScenarioTab = false;
        sensitivityErrorCount();
    }

    function showScenario() {
        vm.showSensitivityTab = false;
        vm.showScenarioTab = true;
        sensitivityErrorCount();
    }


    function sensitivityErrorCount() {
        vm.sensitivityNamesCount = 0;

        for (var i = 0; i < vm.marketRentSets.length; i++) {
            if (!vm.marketRentSets[i].name) {
                vm.sensitivityNamesCount++;
            }
        }
        for (var i = 0; i < vm.vacancySets.length; i++) {
            if (!vm.vacancySets[i].name) {
                vm.sensitivityNamesCount++;
            }
        }
        for (var i = 0; i < vm.expenseSets.length; i++) {
            if (!vm.expenseSets[i].name) {
                vm.sensitivityNamesCount++;
            }
        }
        for (var i = 0; i < vm.BCRSets.length; i++) {
            if (!vm.BCRSets[i].name) {
                vm.sensitivityNamesCount++;
            }
        }

        vm.scenarioNamesCount = 0;
        for (var i = 0; i < vm.scenarioSets.length; i++) {
            if (!vm.scenarioSets[i].name) {
                vm.scenarioNamesCount++;
            }
        }
    }

    var leaseableSqFt = 255;
    var vacancyPercentage = 245;
    var expensePercentage = 123;
    var expenseSF = 123;
    var otherIncome = 649;
    var BCR = 157;
    var ETR = 649;
    var assessedValue = 561;
    var assessedValueSF = 502;
    var marketRentSF = 345; //vacancy %  &  expense % calculation



    //===================================   save scenario ===================================//
    vm.saveScenario = saveScenario;

    function saveScenario(redirect) {
        sensitivityErrorCount();
        vm.submitClicked = true;

        if (vm.sensitivityNamesCount != 0 || vm.scenarioNamesCount != 0) {
            $scope.$emit('error', 'Write workSpace(s) name');
            return;
        }

        var names = [];

        for (var i = 0; i < vm.marketRentSets.length; i++) {
            names.push(vm.marketRentSets[i].name);
        }
        for (var i = 0; i < vm.vacancySets.length; i++) {
            names.push(vm.vacancySets[i].name);
        }
        for (var i = 0; i < vm.expenseSets.length; i++) {
            names.push(vm.expenseSets[i].name);
        }
        for (var i = 0; i < vm.BCRSets.length; i++) {
            names.push(vm.BCRSets[i].name);
        }
        for (var i = 0; i < vm.scenarioSets.length; i++) {
            names.push(vm.scenarioSets[i].name);
        }

        var saveFormJson = {
            propId:parseInt(localStorage.getItem('propertyId')),
            formId: vm.formId,
            name: names,
            sensitivityCaluations: [{
                marketPerSF: vm.marketRentSets,
                vacancyPercent: vm.vacancySets,
                expensePerSF: vm.expenseSets,
                BaseCapRate: vm.BCRSets
            }],
            scenarios: vm.scenarioSets
        };

        $("#preloader").css("display", "block");

        ////console.log('--------------------------saveWorkSpace------------------------');
        ////console.log(saveFormJson);

        SensitivityService.saveWorkSpace(saveFormJson)
            .then(function (result) {
                $("#preloader").css("display", "none");
                ////console.log('result', result);
                if (result.data.success) {
                    $scope.$emit('success', result.data.message);
                    if (redirect) {
                        $state.go(redirect);
                    }
                } else {
                    $scope.$emit('danger', result.data.message);

                }
                // checkResult(result);


            }, function (err) {
                $("#preloader").css("display", "none");
                ////console.log('err');
            });

    }

    //===================================   use Scenario ===================================//

    vm.useInValuation = useInValuation;

    function useInValuation(set) {
        // saveScenario();
        ////console.log('use in valuations', set);
        localStorage.setItem('selectedScenario', angular.toJson(set))
        saveScenario('propertyValuation')

    }

    //===================================   addScenarioSet ===================================//
    var scenarioSetsCount = 0;
    vm.addScenarioSet = addScenarioSet;
    vm.addScenarioSetWithValues = addScenarioSetWithValues;
    vm.removeScenarioSet = removeScenarioSet;
    vm.calculateScenarioSet = calculateScenarioSet;
    vm.useSetInScenario = useSetInScenario;


    vm.scenarioSets = [];
    scenarioSetsCount++;
    vm.scenarioSets.push(getNewSet(scenarioSetsCount));

    function addScenarioSet() {
        if (vm.scenarioSets.length < 10) {
            scenarioSetsCount++;
            vm.scenarioSets.push(getNewSet(scenarioSetsCount));
        } else {
            $scope.$emit('error', 'Can not add more sets');
        }
    }

    function addScenarioSetWithValues(value, fieldName) {
        if (vm.scenarioSets.length < 10) {
            scenarioSetsCount++;
            var set = getNewSet(scenarioSetsCount);
            set[fieldName] = value;
            calculateScenarioSet(set, fieldName);
            vm.scenarioSets.push(set);
        } else {
            $scope.$emit('error', 'Can not add more sets');
        }
    }

    function useSetInScenario(value, scenarioSet, fieldName) {
        ////console.log('useSetInScenario');

        scenarioSet[fieldName] = value;
        calculateScenarioSet(scenarioSet, fieldName);

    }

    function removeScenarioSet(index) {
        vm.scenarioSets.splice(index, 1);
    }
    vm.marketRenPre2 = -1;
    vm.vacPre2 = -1;
    vm.expensePre2 = -1
    vm.expensePerPre2 = -1
    vm.BCRPre2 = -1

    function calculateScenarioSet(set, inputName) {
        var expenseCalculation = 0;
        if (inputName == 'marketRentSF') {
            if (!set.marketRentSF || !$.isNumeric(set.marketRentSF)) {
                set.marketRentSF = 0
                vm.marketRenPre2 = 0;
            }


            if (vm.marketRenPre2 == 0 && set.marketRentSF >= 1) {
                if (set.marketRentSF < 10) {
                    set.marketRentSF = set.marketRentSF / 10;
                    set.marketRentSF = set.marketRentSF * 10;
                    vm.marketRenPre2 = set.marketRentSF
                }
                else {
                    set.marketRentSF = set.marketRentSF / 10;
                    vm.marketRenPre2 = set.marketRentSF

                }
            }
            // marketRentSF = set.marketRentSF;

        } else if (inputName == 'vacancyPercentage') {
            if (!set.vacancyPercentage || !$.isNumeric(set.vacancyPercentage)) {
                set.vacancyPercentage = 0;
                vm.vacPre2 = 0;
            }
            if (set.vacancyPercentage >= 100) {
                set.vacancyPercentage = 100;
            }
            if (vm.vacPre2 == 0 && set.vacancyPercentage >= 1) {
                if (set.vacancyPercentage < 10) {
                    set.vacancyPercentage = set.vacancyPercentage / 10;
                    set.vacancyPercentage = set.vacancyPercentage * 10;
                    vm.vacPre2 = set.vacancyPercentage
                }
                else {
                    set.vacancyPercentage = set.vacancyPercentage / 10;
                    vm.vacPre2 = set.vacancyPercentage

                }
            }
            // vacancyPercentage = set.vacancyPercentage;
        } else if (inputName == 'expenseSF') {
            expenseCalculation = 0;
            //yet to implement
            if (!set.expenseSF || !$.isNumeric(set.expenseSF)) {
                set.expenseSF = 0;
                vm.expensePre2 = 0
            }
            if (vm.expensePre2 == 0 && set.expenseSF >= 1) {
                if (set.expenseSF < 10) {
                    set.expenseSF = set.expenseSF / 10;
                    set.expenseSF = set.expenseSF * 10;
                    vm.expensePre2 = set.expenseSF
                }
                else {
                    set.expenseSF = set.expenseSF / 10;
                    vm.expensePre2 = set.expenseSF

                }
            }


            // expenseSF = set.expenseSF;
        } else if (inputName == 'expensePercentage') {
            expenseCalculation = 1;
            if (!set.expensePercentage || !$.isNumeric(set.expensePercentage)) {
                set.expensePercentage = 0;
                vm.expensePerPre2 = 0;
            }
            if (set.expensePercentage >= 100) {
                set.expensePercentage = 100;
            }
            if (vm.expensePerPre2 == 0 && set.expensePercentage >= 1) {
                if (set.expensePercentage < 10) {
                    set.expensePercentage = set.expensePercentage / 10;
                    set.expensePercentage = set.expensePercentage * 10;
                    vm.expensePerPre2 = set.expensePercentage
                }

                else {
                    set.expensePercentage = set.expensePercentage / 10;
                    vm.expensePerPre2 = set.expensePercentage

                }
            }

            // expensePercentage = set.expensePercentage;
        } else if (inputName == 'BCR') {
            if (!set.BCR || !$.isNumeric(set.BCR)) {
                set.BCR = 0;
                vm.BCRPre2 = 0;
            }
            if (set.BCR >= 100) {
                set.BCR = 100;
            }
            if (vm.BCRPre2 == 0 && set.BCR >= 1) {
                if (set.BCR < 10) {
                    set.BCR = set.BCR / 10;
                    set.BCR = set.BCR * 10;
                    vm.BCRPre2 = set.BCR
                }
                else {
                    set.BCR = set.BCR / 10;
                    vm.BCRPre2 = set.BCR

                }
            }
            // BCR = set.BCR;
        }



        var annualRent = PetitionerFormulae.Petitioner.annualRent(set.petitionerLeasableSF, set.marketRentSF);
        var GPR = annualRent;
        var VacancyDolar = PetitionerFormulae.Petitioner.vacancy(GPR, (set.expenseSF / 100));
        var effectiveRent = annualRent + VacancyDolar;
        if (expenseCalculation == 1) {
            var expense = PetitionerFormulae.Petitioner.expenses(set.expensePercentage, effectiveRent);
            var expenseSF = PetitionerFormulae.Petitioner.expensesPerSf(expense, set.petitionerLeasableSF);
            set.expenseSF = expenseSF;
        } else {
            var expense = PetitionerFormulae.Petitioner.expensesDolar(set.expenseSF, set.petitionerLeasableSF);
            var expensePercentage = PetitionerFormulae.Petitioner.expensesPercentage(expense, effectiveRent);
            set.expensePercentage = expensePercentage;
        }
        var NOI = PetitionerFormulae.Petitioner.netOperatingIncome(effectiveRent, expense);
        var OCR = PetitionerFormulae.Petitioner.overAllCapRate(parseInt(set.BCR), parseInt(set.petitionerETR));
        var VDC = PetitionerFormulae.Petitioner.valueDirectCap(OCR, NOI);
        var ValueSQFT = PetitionerFormulae.Petitioner.valuePerSqFt(VDC, set.petitionerLeasableSF);

        set.vacancyPercentage = set.vacancyPercentage;
        // set.expenseSF = set.petitionerLeasableSF;
        set.expensePercentage = set.expensePercentage;
        set.NOI = NOI;
        set.value = VDC;
        set.valueSF = ValueSQFT;
        set.assessedValue = assessedValue;
        set.assessedValueSF = assessedValueSF;
        set.petitionerLeasableSF = set.petitionerLeasableSF;
        set.petitionerMarketRentSF = set.marketRentSF;
        set.petitionerAnnualRent = annualRent;
        set.petitionerGPR = GPR;
        set.petitionerVacancyPercentage = set.vacancyPercentage;
        set.petitionerVacancy = VacancyDolar;
        set.petitionerEffectiveRent = effectiveRent;
        set.petitionerExpensePercentage = set.expensePercentage;
        set.petitionerExpense = expense;
        set.petitionerExpenseSF = set.expenseSF;
        // set.petitionerOI = set.petitionerOI;
        set.petitionerNOI = NOI;
        set.petitionerBCR = set.BCR;
        set.petitionerETR = set.petitionerETR;
        set.petitionerOCR = OCR;
        set.petitionerVDC = VDC;
        set.petitionerValueSF = ValueSQFT;
        set.petitionerNOIBySF = NOI / set.petitionerLeasableSF;
        parseDecimail(set, set.vacancyPercentage, set.expensePercentage, set.petitionerBCR)

    }

    //===================================market rent per sqft===================================//
    var marketRentSetsCount = 0;
    vm.marketRentActive = true;
    vm.toggleMarketRent = toggleMarketRent;
    vm.addMarketRentSet = addMarketRentSet;
    vm.removeMRSet = removeMRSet;

    vm.marketRentSets = [];
    marketRentSetsCount++;
    vm.marketRentSets.push(getNewSet(marketRentSetsCount));
    var counts = 4;
    $scope.col = 3;
    vm.pre = -1;

    function setColMd(colState) {
        ////console.log('colState', colState);
        // if(colState){
        //     counts++;
        // }
        // else{
        //     counts--;
        // }

        // ////console.log('counts' , counts);

        // if(counts != 0 )
        //     $scope.col  =  12 / counts;

        // ////console.log(' $scope.col' ,  $scope.col);

    }

    function toggleMarketRent() {
        vm.marketRentActive = !vm.marketRentActive;
        setColMd(vm.marketRentActive);
    }

    function addMarketRentSet() {
        marketRentSetsCount++;

        vm.marketRentSets.push(getNewSet(marketRentSetsCount));
    }

    function removeMRSet(index) {
        vm.marketRentSets.splice(index, 1);
    }

    vm.calculateMarketRentSet = function (set) {
        ////console.log('aaaaaaaaaaasssssss', set.marketRentSF);

        if (!set.marketRentSF || !$.isNumeric(set.marketRentSF)) {
            set.marketRentSF = 0;
            vm.pre = 0;
        }
        if (set.marketRentSF == 0 && set.marketRentSF[1] != '.') {
            ////console.log('aaaaaaaaaaasssssss00');

            set.marketRentSF = 0;
            vm.pre = 0;
        }
        ////console.log('aaaaaaaaaaasssssss00' + vm.pre);


        if (vm.pre == 0 && set.marketRentSF >= 1) {
            if (set.marketRentSF < 10) {
                set.marketRentSF = set.marketRentSF / 10;
                set.marketRentSF = set.marketRentSF * 10;
                vm.pre = set.marketRentSF
            }
            else {
                set.marketRentSF = set.marketRentSF / 10;
                vm.pre = set.marketRentSF

            }
        }


        ////console.log('after', set.marketRentSF);

        var annualRent = PetitionerFormulae.Petitioner.annualRent(set.petitionerLeasableSF, set.marketRentSF);
        var GPR = annualRent;
        var VacancyDolar = PetitionerFormulae.Petitioner.vacancy(GPR, (set.vacancyPercentage / 100));

        var effectiveRent = annualRent + VacancyDolar;


        var expense = PetitionerFormulae.Petitioner.expenses(effectiveRent, (set.expensePercentage / 100));

        var expensesSF = PetitionerFormulae.Petitioner.expensesPerSf(expense, set.petitionerLeasableSF);

        var NOI = PetitionerFormulae.Petitioner.netOperatingIncome(effectiveRent, expense);

        var OCR = PetitionerFormulae.Petitioner.overAllCapRate(parseInt(set.BCR), parseInt(set.petitionerETR));

        var VDC = PetitionerFormulae.Petitioner.valueDirectCap(OCR, NOI);
        var ValueSQFT = PetitionerFormulae.Petitioner.valuePerSqFt(VDC, set.petitionerLeasableSF);

        set.expenseSF = expensesSF;
        // set.expensePercentage = expensePercentage;
        set.NOI = NOI / set.petitionerLeasableSF;
        // set.BCR = BCR;
        set.value = VDC;
        set.valueSF = ValueSQFT;
        // set.assessedValue = assessedValue;
        set.assessedValueSF = set.assessedValue / set.petitionerLeasableSF;
        // set.petitionerLeasableSF = leaseableSqFt;
        set.petitionerMarketRentSF = set.marketRentSF;
        set.petitionerAnnualRent = annualRent;
        set.petitionerGPR = GPR;
        set.petitionerVacancyPercentage = set.vacancyPercentage;
        set.petitionerVacancy = VacancyDolar;
        set.petitionerEffectiveRent = effectiveRent;
        // set.petitionerExpensePercentage = set.expensePercentage;
        set.petitionerExpense = expense;
        set.petitionerExpenseSF = expensesSF;
        // set.petitionerOI = otherIncome;
        set.petitionerNOI = NOI;
        // set.petitionerBCR = BCR;
        // set.petitionerETR = ETR;
        set.petitionerOCR = OCR;
        set.petitionerVDC = VDC;
        set.petitionerValueSF = ValueSQFT;
        set.petitionerNOIBySF = NOI / set.petitionerLeasableSF;
        ////console.log(set);


    }


    //=================================== vacancy %  ============================================//


    var vacancySetsCount = 0;

    vm.vacancyActive = true;
    vm.addVacancySet = addVacancySet;
    vm.toggleVacancy = toggleVacancy;
    vm.removeVacancySet = removeVacancySet;
    vm.vacancySets = [];
    vacancySetsCount++;
    vm.vacancySets.push(getNewSet(vacancySetsCount));

    function toggleVacancy() {
        vm.vacancyActive = !vm.vacancyActive;
        setColMd(vm.vacancyActive);
    }

    function addVacancySet() {
        vacancySetsCount++;
        vm.vacancySets.push(getNewSet(vacancySetsCount));
    }

    function removeVacancySet(index) {
        vm.vacancySets.splice(index, 1);
    }

    function parseDecimail(set, vacancy, expensePer, baseCap) {
        var parseVac = vacancy.toString().trim();
        var parseExp = expensePer.toString().trim();
        var parseBase = baseCap.toString().trim();

        if (parseVac.indexOf('.') >= 0) {

            var parseVacLen = parseVac.split(".")[1].length;
            if (parseVacLen > 2) {
                ////console.log('founded')
                set.vacancyPercentage = Math.round(set.vacancyPercentage * 100) / 1000
                if (set.vacancyPercentage == 0) {
                    set.vacancyPercentage = 0.00
                }
            }
        }
        ////console.log(set.expensePercentage + '---' + parseExp.indexOf('.'))

        if (parseExp.indexOf('.') >= 0) {

            var parseExpLen = (parseExp.split(".")[1].length);
            if (parseExpLen > 2) {
                ////console.log('founded' + parseExp)

                set.expensePercentage = Math.round(set.expensePercentage * 100) / 1000
                if (set.expensePercentage == 0) {
                    set.expensePercentage = 0.00
                }
            }

        }
        if (parseBase.indexOf('.') >= 0) {
            var parseBaseLen = parseBase.split(".")[1].length;
            if (parseBaseLen > 2) {
                set.petitionerBCR = Math.round(set.petitionerBCR * 100) / 100
                if (set.petitionerBCR == 0) {
                    set.petitionerBCR = 0.00
                }
            }
        }





    }


    vm.vacPre = -1;
    vm.calculateVacancySet = function (set) {

        if (!set.vacancyPercentage || !$.isNumeric(set.vacancyPercentage)) {
            set.vacancyPercentage = 0;
            vm.vacPre = 0;
        }
        if (set.vacancyPercentage == 0 && set.vacancyPercentage[1] != '.') {
            set.vacancyPercentage = 0;
            vm.vacPre = 0;
        }
        if (set.vacancyPercentage > 100) {
            set.vacancyPercentage = 100;
        }

        if (vm.vacPre == 0 && set.vacancyPercentage >= 1) {
            if (set.vacancyPercentage < 10) {
                set.vacancyPercentage = set.vacancyPercentage / 10;
                set.vacancyPercentage = set.vacancyPercentage * 10;
                vm.vacPre = set.vacancyPercentage
            }
            else {
                set.vacancyPercentage = set.vacancyPercentage / 10;
                vm.expPre = set.vacancyPercentage

            }
        }



        var annualRent = PetitionerFormulae.Petitioner.annualRent(set.petitionerLeasableSF, set.marketRentSF);
        var GPR = annualRent;
        var VacancyDolar = PetitionerFormulae.Petitioner.vacancy(GPR, (set.vacancyPercentage / 100));

        var effectiveRent = annualRent + VacancyDolar;

        var expense = PetitionerFormulae.Petitioner.expenses(effectiveRent, (set.expensePercentage / 100));

        var expensesSF = PetitionerFormulae.Petitioner.expensesPerSf(expense, set.petitionerLeasableSF);

        var NOI = PetitionerFormulae.Petitioner.netOperatingIncome(effectiveRent, expense);

        var OCR = PetitionerFormulae.Petitioner.overAllCapRate(parseInt(set.BCR), parseInt(set.petitionerETR));

        var VDC = PetitionerFormulae.Petitioner.valueDirectCap(OCR, NOI);
        var ValueSQFT = PetitionerFormulae.Petitioner.valuePerSqFt(VDC, set.petitionerLeasableSF);


        set.expenseSF = expensesSF;
        // set.expensePercentage = expensePercentage;
        set.NOI = NOI / set.petitionerLeasableSF;
        // set.BCR = BCR;
        set.value = VDC;
        set.valueSF = ValueSQFT;
        // set.assessedValue = assessedValue;
        set.assessedValueSF = set.assessedValue / set.petitionerLeasableSF;
        // set.petitionerLeasableSF = leaseableSqFt;
        set.petitionerMarketRentSF = set.marketRentSF;
        set.petitionerAnnualRent = annualRent;
        set.petitionerGPR = GPR;
        set.petitionerVacancyPercentage = set.vacancyPercentage;
        set.petitionerVacancy = VacancyDolar;
        set.petitionerEffectiveRent = effectiveRent;
        // set.petitionerExpensePercentage = set.expensePercentage;
        set.petitionerExpense = expense;
        set.petitionerExpenseSF = expensesSF;
        // set.petitionerOI = otherIncome;
        set.petitionerNOI = NOI;
        // set.petitionerBCR = BCR;
        // set.petitionerETR = ETR;
        set.petitionerOCR = OCR;
        set.petitionerVDC = VDC;
        set.petitionerValueSF = ValueSQFT;
        set.petitionerNOIBySF = NOI / set.petitionerLeasableSF;

    }
    //=================================== expense % =============================================//
    var expenseSetsCount = 0;

    vm.expenseActive = true;
    vm.toggleExpense = toggleExpense;
    vm.addExpenseSet = addExpenseSet;
    vm.removeExpenseSet = removeExpenseSet;
    vm.expenseSets = [];
    expenseSetsCount++;
    vm.expenseSets.push(getNewSet(expenseSetsCount));

    function toggleExpense() {
        if (!vm.clickcheck) {
            vm.expenseActive = !vm.expenseActive;
            setColMd(vm.expenseActive);
            vm.clickcheck = false;
        }
        else {
            vm.clickcheck = false;

        }

    }

    function addExpenseSet() {
        expenseSetsCount++;
        vm.expenseSets.push(getNewSet(expenseSetsCount));
    }

    function removeExpenseSet(index) {
        vm.expenseSets.splice(index, 1);
    }
    vm.expPre == -1;
    vm.expPre2 = -1;

    vm.calculateExpenseSet = function (set) {


        if (vm.expenseInputActive) {
            ////console.log('expenseInputActive', vm.expenseInputActive);

            if (!set.expenseSF || !$.isNumeric(set.expenseSF)) {
                set.expenseSF = 0;
                vm.expPre = 0;
            }
            if (set.expenseSF == 0 && set.expenseSF[1] != '.') {
                set.expenseSF = 0;
                vm.expPre = 0;
            }


            if (vm.expPre == 0 && set.expenseSF >= 1) {
                if (set.expenseSF < 10) {
                    set.expenseSF = set.expenseSF / 10;
                    set.expenseSF = set.expenseSF * 10;
                    vm.expPre = set.expenseSF
                }
                else {
                    set.expenseSF = set.expenseSF / 10;
                    vm.expPre = set.expenseSF

                }
            }


        } else {
            ////console.log('expenseInputActive', vm.expenseInputActive);

            if (!set.expensePercentage || !$.isNumeric(set.expensePercentage)) {
                set.expensePercentage = 0;
                vm.expPre2 = 0;
            }
            if (set.expensePercentage == 0 && set.expensePercentage[1] != '.') {
                set.expensePercentage = 0;
                vm.expPre2 = 0;
            }
            if (set.expensePercentage > 100) {
                set.expensePercentage = 100;
            }
            if (vm.expPre2 == 0 && set.expensePercentage >= 1) {
                if (set.expensePercentage < 10) {
                    set.expensePercentage = set.expensePercentage / 10;
                    set.expensePercentage = set.expensePercentage * 10;
                    vm.expPre2 = set.expensePercentage
                }
                else {
                    set.expensePercentage = set.expensePercentage / 10;
                    vm.expPre2 = set.expensePercentage

                }
            }

        }


        var annualRent = PetitionerFormulae.Petitioner.annualRent(set.petitionerLeasableSF, set.marketRentSF);
        var GPR = annualRent;
        var VacancyDolar = PetitionerFormulae.Petitioner.vacancy(GPR, (set.vacancyPercentage / 100));
        var effectiveRent = annualRent + VacancyDolar;

        if (!vm.expenseInputActive) {
            var expense = PetitionerFormulae.Petitioner.expenses(set.expensePercentage, effectiveRent);
            var expenseSF = PetitionerFormulae.Petitioner.expensesPerSf(expense, set.petitionerLeasableSF);
        } else {
            var expense = PetitionerFormulae.Petitioner.expensesDolar(set.expenseSF, set.petitionerLeasableSF);
            var expensePercentage = PetitionerFormulae.Petitioner.expensesPercentage(expense, effectiveRent);
        }
        // var expensesSF = PetitionerFormulae.Petitioner.expensesPerSf(expense, set.petitionerLeasableSF);

        var NOI = PetitionerFormulae.Petitioner.netOperatingIncome(effectiveRent, expense);
        var OCR = PetitionerFormulae.Petitioner.overAllCapRate(parseInt(set.BCR), parseInt(set.petitionerETR));
        var VDC = PetitionerFormulae.Petitioner.valueDirectCap(OCR, NOI);
        var ValueSQFT = PetitionerFormulae.Petitioner.valuePerSqFt(VDC, set.petitionerLeasableSF);



        // set.vacancyPercentage = vacancyPercentage;
        //if expenseSF is active donot update
        if (!vm.expenseInputActive) {
            ////console.log('expenseInset.set.expenseSF', set.expenseSF);

            set.expenseSF = expenseSF;
            // set.expensePercentage = expensePercentage;
            set.NOI = NOI / set.petitionerLeasableSF;
            // set.BCR = BCR;
            set.value = VDC;
            set.valueSF = ValueSQFT;
            // set.assessedValue = assessedValue;
            set.assessedValueSF = set.assessedValue / set.petitionerLeasableSF;
            // set.petitionerLeasableSF = leaseableSqFt;
            set.petitionerMarketRentSF = set.marketRentSF;
            set.petitionerAnnualRent = annualRent;
            set.petitionerGPR = GPR;
            set.petitionerVacancyPercentage = set.vacancyPercentage;
            set.petitionerVacancy = VacancyDolar;
            set.petitionerEffectiveRent = effectiveRent;
            // set.petitionerExpensePercentage = set.expensePercentage;
            set.petitionerExpense = expense;
            set.petitionerExpenseSF = expenseSF;
            // set.petitionerOI = otherIncome;
            set.petitionerNOI = NOI;
            set.petitionerBCR = set.BCR;
            // set.petitionerETR = ETR;
            set.petitionerOCR = OCR;
            set.petitionerVDC = VDC;
            set.petitionerValueSF = ValueSQFT;
            set.petitionerNOIBySF = NOI / set.petitionerLeasableSF;

        } else {

            // set.expenseSF = expenseSF;
            set.expensePercentage = expensePercentage;
            set.NOI = NOI / set.petitionerLeasableSF;
            // set.BCR = BCR;
            set.value = VDC;
            set.valueSF = ValueSQFT;
            // set.assessedValue = assessedValue;
            set.assessedValueSF = set.assessedValue / set.petitionerLeasableSF;
            // set.petitionerLeasableSF = leaseableSqFt;
            set.petitionerMarketRentSF = set.marketRentSF;
            set.petitionerAnnualRent = annualRent;
            set.petitionerGPR = GPR;
            set.petitionerVacancyPercentage = set.vacancyPercentage;
            set.petitionerVacancy = VacancyDolar;
            set.petitionerEffectiveRent = effectiveRent;
            // set.petitionerExpensePercentage = set.expensePercentage;
            set.petitionerExpense = expense;
            set.petitionerExpenseSF = expenseSF;
            // set.petitionerOI = otherIncome;
            set.petitionerNOI = NOI;
            set.petitionerBCR = set.BCR;
            // set.petitionerETR = ETR;
            set.petitionerOCR = OCR;
            set.petitionerVDC = VDC;
            set.petitionerValueSF = ValueSQFT;
            set.petitionerNOIBySF = NOI / set.petitionerLeasableSF;

        }
        // set.expensePercentage = expensePercentage;

    }

    vm.expenseInputActive = true;
    vm.clickcheck = false;
    vm.ExpenseSFInput = function () {
        vm.clickcheck = true;
        vm.expenseInputActive = true;
    }

    vm.ExpensePercentageInput = function () {
        vm.clickcheck = true;
        vm.expenseInputActive = false;
    }

    //=================================== Bace cape Rate=========================================//
    vm.baseCapeRateActive = true;
    var BCRSetsCount = 0;
    vm.toggleBaseCapeRate = toggleBaseCapeRate;
    vm.addBCRSet = addBCRSet;
    vm.removeBCRSet = removeBCRSet;
    vm.BCRSets = [];
    BCRSetsCount++;
    vm.BCRSets.push(getNewSet(BCRSetsCount));

    function toggleBaseCapeRate() {
        ////console.log('toggleBaseCapeRate');
        vm.baseCapeRateActive = !vm.baseCapeRateActive;
        setColMd(vm.baseCapeRateActive);
    }

    function addBCRSet() {
        BCRSetsCount++;
        vm.BCRSets.push(getNewSet(BCRSetsCount));
    }

    function removeBCRSet(index) {
        vm.BCRSets.splice(index, 1);
    }
    vm.bcrPre = -1;
    vm.calculateBCRSet = function (set) {

        if (!set.BCR || !$.isNumeric(set.BCR)) {
            set.BCR = 0;
            vm.bcrPre = 0;
        }
        if (set.BCR == 0 && set.BCR[1] != '.') {
            set.BCR = 0;
            vm.bcrPre = 0;
        }
        if (set.BCR >= 100) {
            set.BCR = 100;
        }
        if (vm.bcrPre == 0 && set.BCR >= 1) {
            if (set.BCR < 10) {
                set.BCR = set.BCR / 10;
                set.BCR = set.BCR * 10;
                vm.bcrPre = set.BCR
            }
            else {
                set.BCR = set.BCR / 10;
                vm.bcrPre = set.BCR

            }
        }

        var annualRent = PetitionerFormulae.Petitioner.annualRent(set.petitionerLeasableSF, set.marketRentSF);
        var GPR = annualRent;
        var VacancyDolar = PetitionerFormulae.Petitioner.vacancy(GPR, (set.vacancyPercentage / 100));
        var effectiveRent = annualRent + VacancyDolar;
        var expense = PetitionerFormulae.Petitioner.expenses(effectiveRent, (set.expensePercentage / 100));
        var expensesSF = PetitionerFormulae.Petitioner.expensesPerSf(expense, set.petitionerLeasableSF);
        var NOI = PetitionerFormulae.Petitioner.netOperatingIncome(effectiveRent, expense);
        var OCR = PetitionerFormulae.Petitioner.overAllCapRate(parseInt(set.BCR), parseInt(set.petitionerETR));
        var VDC = PetitionerFormulae.Petitioner.valueDirectCap(OCR, NOI);
        var ValueSQFT = PetitionerFormulae.Petitioner.valuePerSqFt(VDC, set.petitionerLeasableSF);


        set.expenseSF = expensesSF;
        // set.expensePercentage = expensePercentage;
        set.NOI = NOI / set.petitionerLeasableSF;
        // set.BCR = BCR;
        set.value = VDC;
        set.valueSF = ValueSQFT;
        // set.assessedValue = assessedValue;
        set.assessedValueSF = set.assessedValue / set.petitionerLeasableSF;
        // set.petitionerLeasableSF = leaseableSqFt;
        set.petitionerMarketRentSF = set.marketRentSF;
        set.petitionerAnnualRent = annualRent;
        set.petitionerGPR = GPR;
        set.petitionerVacancyPercentage = set.vacancyPercentage;
        set.petitionerVacancy = VacancyDolar;
        set.petitionerEffectiveRent = effectiveRent;
        // set.petitionerExpensePercentage = set.expensePercentage;
        set.petitionerExpense = expense;
        set.petitionerExpenseSF = expensesSF;
        // set.petitionerOI = otherIncome;
        set.petitionerNOI = NOI;
        set.petitionerBCR = set.BCR;
        // set.petitionerETR = ETR;
        set.petitionerOCR = OCR;
        set.petitionerVDC = VDC;
        set.petitionerValueSF = ValueSQFT;
        set.petitionerNOIBySF = NOI / set.petitionerLeasableSF;
    }

    //=============================================================================================//


    function getNewSet(count) {
        var set = {
            name: 'Set ' + count,
            marketRentSF: 24,
            vacancyPercentage: 4,
            expenseSF: -10.89,
            expensePercentage: -47,
            NOI: 12.5,
            BCR: 7.000,
            value: 18867631,
            valueSF: 147,
            assessedValue: 31391491,
            assessedValueSF: 244,
            // petitioner set
            petitionerLeasableSF: 128626,
            petitionerMarketRentSF: 24,
            petitionerAnnualRent: 3087024,
            petitionerGPR: 3087024,
            petitionerVacancyPercentage: 4,
            petitionerVacancy: -123481,
            petitionerEffectiveRent: 2963543,
            petitionerExpensePercentage: -47,
            petitionerExpense: -1400000,
            petitionerExpenseSF: -10.88,
            petitionerOI: 0,
            petitionerNOI: 1810505,
            petitionerNOIBySF: 14.08,
            petitionerBCR: 7.000,
            petitionerETR: 1.2830,
            petitionerOCR: 8.2830,
            petitionerVDC: 21858082,
            petitionerValueSF: 170
        };
        return set;
    }


    //=============================================================================================//



    //====================================Modal Decisions=========================================================//

    vm.gotoValuation = function () {
        setTimeout(function () {
            $state.go('propertyValuation', {
                messageFrom: 'scenario'
            });

        }, 500);
        $('#myModalquestion').modal('toggle');

    }

    vm.numberFormatter = function (val, roundedVal) {
        var result = UtilService.numberFormatterValuation(val, roundedVal);
        return result
    };

}

/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 277 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


_SensitivityService.$inject = ["$http", "$q", "AOTCService"];
module.exports = _SensitivityService;

//angular.module('AOTC')
//    .factory('SensitivityService', _SensitivityService
//    );
function _SensitivityService($http, $q, AOTCService) {

    return {
        saveWorkSpace: saveWorkSpace,
        replaceWorkSpace: replaceWorkSpace,
        getWorkspace: getWorkspace

    };

    function saveWorkSpace(workspace) {
        ////console.log('workspace', workspace)

        var url = '/valuation/save-work-space' ;
        var deferred = $q.defer();

        AOTCService.postDataToServer(url, workspace)
            .then(function (result) {
                deferred.resolve(result);

            }, function (result) {
                deferred.reject(result);
            });
        return deferred.promise;

    }

    function getWorkspace() {

        var postData = {
            "propId":parseInt(localStorage.getItem('propertyId')),
            "formId": parseInt(localStorage.getItem('formId'))
        };

        var url = '/valuation/get-work-space';
        var deferred = $q.defer();
        ////console.log(postData);

        AOTCService.postDataToServer(url, postData)
            .then(function (result) {
                deferred.resolve(result);

            }, function (result) {
                deferred.reject(result);
            });

        return deferred.promise;

    }


    function replaceWorkSpace(workspace) {

        var url = '/valuation/replace-work-space';
        var deferred = $q.defer();

        AOTCService.postDataToServer(url, workspace)
            .then(function (result) {
                deferred.resolve(result);

            }, function (result) {
                deferred.reject(result);
            });
        return deferred.promise;

    }

}


/***/ }),
/* 278 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


_ScenarioDataService.$inject = [];
module.exports = _ScenarioDataService;

//angular.module('AOTC')
//    .service('ScenarioDataService', _ScenarioDataService
//    );
function _ScenarioDataService() {

    var ScenarioValues = {

        marketRentSets: [],
        vacancySets: [],
        expenseSets: [],
        BCRSets: [],
        scenarioSets: [],
        scenarioToShow: '',

        marketRentSetsCount: 0,
        vacancySetsCount: 0,
        expenseSetsCount: 0,
        BCRSetsCount: 0,
        scenarioSetsCount: 0

    };

    function SetValues(marketRentSets, vacancySets, expenseSets, BCRSets, scenarioSets, scenarioToShow,
        marketRentSetsCount,
        vacancySetsCount,
        expenseSetsCount,
        BCRSetsCount,
        scenarioSetsCount) {

        ScenarioValues.marketRentSets = marketRentSets;
        ScenarioValues.vacancySets = vacancySets;
        ScenarioValues.expenseSets = expenseSets;
        ScenarioValues.BCRSets = BCRSets;
        ScenarioValues.scenarioSets = scenarioSets;
        ScenarioValues.scenarioToShow = scenarioToShow;

        ScenarioValues.marketRentSetsCount = marketRentSetsCount;
        ScenarioValues.vacancySetsCount = vacancySetsCount;
        ScenarioValues.expenseSetsCount = expenseSetsCount;
        ScenarioValues.BCRSetsCount = BCRSetsCount;
        ScenarioValues.scenarioSetsCount = scenarioSetsCount;



    }

    function GetValues() {

        return ScenarioValues;
    }


    return {
        SetValues: SetValues,
        GetValues: GetValues
    };

}


/***/ }),
/* 279 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


_resizable.$inject = [];
module.exports = _resizable;

//angular.module('AOTC')
//    .directive('resizable', _resizable
//    );
function _resizable() {
    var toCall;

    function throttle(fun) {
        if (toCall === undefined) {
            toCall = fun;
            setTimeout(function () {
                toCall();
                toCall = undefined;
            }, 100);
        } else {
            toCall = fun;
        }
    }
    return {
        restrict: 'AE',
        scope: {
            rDirections: '=',
            rCenteredX: '=',
            rCenteredY: '=',
            rWidth: '=',
            rHeight: '=',
            rFlex: '=',
            rGrabber: '@',
            rDisabled: '@'
        },
        link: function (scope, element, attr) {
            var flexBasis = 'flexBasis' in document.documentElement.style ? 'flexBasis' :
                'webkitFlexBasis' in document.documentElement.style ? 'webkitFlexBasis' :
                'msFlexPreferredSize' in document.documentElement.style ? 'msFlexPreferredSize' : 'flexBasis';

            // register watchers on width and height attributes if they are set
            scope.$watch('rWidth', function (value) {
                element[0].style.width = scope.rWidth + 'px';
            });
            scope.$watch('rHeight', function (value) {
                element[0].style.height = scope.rHeight + 'px';
            });

            element.addClass('resizable');

            var style = window.getComputedStyle(element[0], null),
                w,
                h,
                dir = scope.rDirections,
                vx = scope.rCenteredX ? 2 : 1, // if centered double velocity
                vy = scope.rCenteredY ? 2 : 1, // if centered double velocity
                inner = scope.rGrabber ? scope.rGrabber : '<span class="glyphicon glyphicon-transfer"></span>',
                start,
                dragDir,
                axis,
                info = {};

            var updateInfo = function (e) {
                info.width = false;
                info.height = false;
                if (axis === 'x')
                    info.width = parseInt(element[0].style[scope.rFlex ? flexBasis : 'width']);
                else
                    info.height = parseInt(element[0].style[scope.rFlex ? flexBasis : 'height']);
                info.id = element[0].id;
                info.evt = e;
            };

            var dragging = function (e) {
                var prop, offset = axis === 'x' ? start - e.clientX : start - e.clientY;
                switch (dragDir) {
                    case 'top':
                        prop = scope.rFlex ? flexBasis : 'height';
                        element[0].style[prop] = h + (offset * vy) + 'px';
                        break;
                    case 'bottom':
                        prop = scope.rFlex ? flexBasis : 'height';
                        element[0].style[prop] = h - (offset * vy) + 'px';
                        break;
                    case 'right':
                        prop = scope.rFlex ? flexBasis : 'width';
                        element[0].style[prop] = w - (offset * vx) + 'px';
                        break;
                    case 'left':
                        prop = scope.rFlex ? flexBasis : 'width';
                        element[0].style[prop] = w + (offset * vx) + 'px';
                        break;
                }
                updateInfo(e);
                throttle(function () { scope.$emit('angular-resizable.resizing', info); });
            };
            var dragEnd = function (e) {
                updateInfo();
                scope.$emit('angular-resizable.resizeEnd', info);
                scope.$apply();
                document.removeEventListener('mouseup', dragEnd, false);
                document.removeEventListener('mousemove', dragging, false);
                element.removeClass('no-transition');
            };
            var dragStart = function (e, direction) {
                dragDir = direction;
                axis = dragDir === 'left' || dragDir === 'right' ? 'x' : 'y';
                start = axis === 'x' ? e.clientX : e.clientY;
                w = parseInt(style.getPropertyValue('width'));
                h = parseInt(style.getPropertyValue('height'));

                //prevent transition while dragging
                element.addClass('no-transition');

                document.addEventListener('mouseup', dragEnd, false);
                document.addEventListener('mousemove', dragging, false);

                // Disable highlighting while dragging
                if (e.stopPropagation) e.stopPropagation();
                if (e.preventDefault) e.preventDefault();
                e.cancelBubble = true;
                e.returnValue = false;

                updateInfo(e);
                scope.$emit('angular-resizable.resizeStart', info);
                scope.$apply();
            };

            dir.forEach(function (direction) {
                var grabber = document.createElement('div');
                // add class for styling purposes
                grabber.setAttribute('class', 'rg-' + direction);
                grabber.innerHTML = inner;



                element[0].prepend(grabber);
                grabber.ondragstart = function () {
                    return false;
                };
                grabber.addEventListener('mousedown', function (e) {
                    var disabled = (scope.rDisabled === 'true');
                    if (!disabled && e.which === 1) {
                        // left mouse click
                        dragStart(e, direction);
                    }
                }, false);
            });
        }
    };
}


/***/ }),
/* 280 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {

_SensitivityThree.$inject = ["PetitionerFormulae", "$state", "$timeout", "$scope", "SensitivityService", "ScenarioDataService"];
module.exports = _SensitivityThree;

//angular.module('AOTC')
//    .controller('SensitivityThree', _SensitivityThree
//    );
function _SensitivityThree(PetitionerFormulae, $state, $timeout, $scope, SensitivityService, ScenarioDataService) {
    ////console.log("SensitivityThree controllersss");
    var vm = this;
    vm.formId = parseInt(localStorage.getItem('formId'));

    $scope.col = 3;
    vm.sensitivityNamesCount = 4;
    vm.scenarioNamesCount = 1;
    vm.submitClicked = false;
    vm.scenarioTwoActive = false;

    vm.property = JSON.parse(localStorage.getItem('propertyDetails'));

    vm.showSensitivityTab = true;
    vm.showScenarioTab = false;
    // vm.showScenario = showScenario;
    // vm.showSensitivity = showSensitivity;
    vm.sensitivityErrorCount = sensitivityErrorCount;

    setTimeout(function () {

        $('#paragraphs').cascadingDivs();
        $('[data-tooltip="tooltip"]').tooltip();

    }, 10);


    var scenarioDataService = ScenarioDataService.GetValues();
    ////console.log(scenarioDataService);
    if (scenarioDataService.scenarioToShow == 'three')
        regenerateValue(scenarioDataService);

    function regenerateValue(scenarioDataService) {

        $timeout(function () {

            vm.marketRentSets = scenarioDataService.marketRentSets
            vm.vacancySets = scenarioDataService.vacancySets;
            vm.expenseSets = scenarioDataService.expenseSets;
            vm.BCRSets = scenarioDataService.BCRSets;
            vm.scenarioSets = scenarioDataService.scenarioSets;

            marketRentSetsCount = scenarioDataService.marketRentSetsCount;
            vacancySetsCount = scenarioDataService.vacancySetsCount;
            expenseSetsCount = scenarioDataService.expenseSetsCount;
            BCRSetsCount = scenarioDataService.BCRSetsCount;
            scenarioSetsCount = scenarioDataService.scenarioSetsCount;


        }, 10);
    }

    $scope.gotoScenario = function (scenarioToShow) {
        ScenarioDataService.SetValues(
            vm.marketRentSets,
            vm.vacancySets,
            vm.expenseSets,
            vm.BCRSets,
            vm.scenarioSets,
            scenarioToShow,
            marketRentSetsCount,
            vacancySetsCount,
            expenseSetsCount,
            BCRSetsCount,
            scenarioSetsCount
        );

        // ScenarioOne
        $state.go('ScenarioOne');

    }

    $scope.showScenarioOne = function () {
        ////console.log('showScenarioOne')
        $scope.col = 3;
        vm.scenarioTwoActive = false;

    }
    $scope.showScenarioTwo = function () {
        ////console.log('showScenarioTwo')
        $scope.col = 2;
        vm.scenarioTwoActive = true;

    }


    // function showSensitivity() {
    //     vm.showSensitivityTab = true;
    //     vm.showScenarioTab = false;
    //     sensitivityErrorCount();
    // }

    // function showScenario() {
    //     vm.showSensitivityTab = false;
    //     vm.showScenarioTab = true;
    //     sensitivityErrorCount();
    // }


    function sensitivityErrorCount() {
        vm.sensitivityNamesCount = 0;

        for (var i = 0; i < vm.marketRentSets.length; i++) {
            if (!vm.marketRentSets[i].name) {
                vm.sensitivityNamesCount++;
            }
        }
        for (var i = 0; i < vm.vacancySets.length; i++) {
            if (!vm.vacancySets[i].name) {
                vm.sensitivityNamesCount++;
            }
        }
        for (var i = 0; i < vm.expenseSets.length; i++) {
            if (!vm.expenseSets[i].name) {
                vm.sensitivityNamesCount++;
            }
        }
        for (var i = 0; i < vm.BCRSets.length; i++) {
            if (!vm.BCRSets[i].name) {
                vm.sensitivityNamesCount++;
            }
        }

        vm.scenarioNamesCount = 0;
        for (var i = 0; i < vm.scenarioSets.length; i++) {
            if (!vm.scenarioSets[i].name) {
                vm.scenarioNamesCount++;
            }
        }
    }

    var leaseableSqFt = 255;
    var vacancyPercentage = 245;
    var expensePercentage = 123;
    var expenseSF = 123;
    var otherIncome = 649;
    var BCR = 157;
    var ETR = 649;
    var assessedValue = 561;
    var assessedValueSF = 502;
    var marketRentSF = 345; //vacancy %  &  expense % calculation


    //===================================   save scenario ===================================//
    vm.saveScenario = saveScenario;

    function saveScenario() {
        sensitivityErrorCount();
        vm.submitClicked = true;

        if (vm.sensitivityNamesCount != 0 || vm.scenarioNamesCount != 0) {
            $scope.$emit('error', 'Write workSpace(s) name');
            return;
        }

        var names = [];

        for (var i = 0; i < vm.marketRentSets.length; i++) {
            names.push(vm.marketRentSets[i].name);
        }
        for (var i = 0; i < vm.vacancySets.length; i++) {
            names.push(vm.vacancySets[i].name);
        }
        for (var i = 0; i < vm.expenseSets.length; i++) {
            names.push(vm.expenseSets[i].name);
        }
        for (var i = 0; i < vm.BCRSets.length; i++) {
            names.push(vm.BCRSets[i].name);
        }
        for (var i = 0; i < vm.scenarioSets.length; i++) {
            names.push(vm.scenarioSets[i].name);
        }

        var saveFormJson = {
            formId: vm.formId,
            name: names,
            sensitivityCaluations: [{
                marketPerSF: vm.marketRentSets,
                vacancyPercent: vm.vacancySets,
                expensePerSF: vm.expenseSets,
                BaseCapRate: vm.BCRSets
            }],
            scenarios: vm.scenarioSets
        };

        $("#preloader").css("display", "block");

        SensitivityService.saveWorkSpace(saveFormJson)
            .then(function (result) {
                $("#preloader").css("display", "none");
                ////console.log('result', result);
                if (result.data.success) {
                    $scope.$emit('success', result.data.message);
                    if (redirect) {
                        $state.go(redirect);
                    }
                } else {
                    $scope.$emit('danger', result.data.message);

                }
                // checkResult(result);


            }, function (err) {
                $("#preloader").css("display", "none");
                ////console.log('err');
            });

    }

    //===================================   addScenarioSet ===================================//
    var scenarioSetsCount = 0;
    vm.addScenarioSet = addScenarioSet;
    vm.addScenarioSetWithValues = addScenarioSetWithValues;
    vm.removeScenarioSet = removeScenarioSet;
    vm.calculateScenarioSet = calculateScenarioSet;
    vm.useSetInScenario = useSetInScenario;


    vm.scenarioSets = [];
    scenarioSetsCount++;
    vm.scenarioSets.push(getNewSet(scenarioSetsCount));

    function addScenarioSet() {
        if (vm.scenarioSets.length < 10) {
            scenarioSetsCount++;
            vm.scenarioSets.push(getNewSet(scenarioSetsCount));
        } else {
            $scope.$emit('error', 'Can not add more sets');
        }
    }

    function addScenarioSetWithValues(value, fieldName) {
        if (vm.scenarioSets.length < 10) {
            scenarioSetsCount++;
            var set = getNewSet(scenarioSetsCount);
            set[fieldName] = value;
            calculateScenarioSet(set, fieldName);
            vm.scenarioSets.push(set);
        } else {
            $scope.$emit('error', 'Can not add more sets');
        }
    }

    function useSetInScenario(value, scenarioSet, fieldName) {
        ////console.log('useSetInScenario');

        scenarioSet[fieldName] = value;
        calculateScenarioSet(scenarioSet, fieldName);

    }

    function removeScenarioSet(index) {
        vm.scenarioSets.splice(index, 1);
    }
    vm.marketRenPre2 = 0;
    vm.vacPre2 = 0;
    vm.expensePre2 = 0;
    vm.expensePerPre2 = 0;
    vm.BCRPre2 = 0;

    function calculateScenarioSet(set, inputName) {

        if (inputName == 'marketRentSF') {
            if (!set.marketRentSF || !$.isNumeric(set.marketRentSF)) {
                set.marketRentSF = 0
                vm.marketRenPre2 = 0;
            }
            if (set.marketRentSF == 0 && set.marketRentSF[1] != '.') {
                set.marketRentSF = 0
                vm.marketRenPre2 = 0;
            }
            if (vm.marketRenPre2 == 0 && set.marketRentSF >= 1) {
                if (set.marketRentSF < 10) {
                    set.marketRentSF = set.marketRentSF / 10;
                    set.marketRentSF = set.marketRentSF * 10;
                    vm.marketRenPre2 = set.marketRentSF
                }
                else {
                    set.marketRentSF = set.marketRentSF / 10;
                    vm.marketRenPre2 = set.marketRentSF

                }
            }
            marketRentSF = set.marketRentSF;

        } else if (inputName == 'vacancyPercentage') {
            if (!set.vacancyPercentage || !$.isNumeric(set.vacancyPercentage)) {
                set.vacancyPercentage = 0;
                vm.vacPre2 = 0;
            }
            if (set.vacancyPercentage == 0 && set.vacancyPercentage[1] != '.') {
                set.vacancyPercentage = 0
                vm.vacPre2 = 0;
            }
            if (set.vacancyPercentage >= 100) {
                set.vacancyPercentage = 100;
            }
            if (vm.vacPre2 == 0 && set.vacancyPercentage >= 1) {
                if (set.vacancyPercentage < 10) {
                    set.vacancyPercentage = set.vacancyPercentage / 10;
                    set.vacancyPercentage = set.vacancyPercentage * 10;
                    vm.vacPre2 = set.vacancyPercentage
                }
                else {
                    set.vacancyPercentage = set.vacancyPercentage / 10;
                    vm.vacPre2 = set.vacancyPercentage

                }
            }
            vacancyPercentage = set.vacancyPercentage;
        } else if (inputName == 'expenseSF') {
            //yet to implement
            if (!set.expenseSF || !$.isNumeric(set.expenseSF)) {
                set.expenseSF = 0;
                vm.expensePre2 = 0
            }
            if (set.expenseSF == 0 && set.expenseSF[1] != '.') {
                set.expenseSF = 0
                vm.expensePre2 == 0
            }

            if (vm.expensePre2 == 0 && set.expenseSF >= 1) {
                if (set.expenseSF < 10) {
                    set.expenseSF = set.expenseSF / 10;
                    set.expenseSF = set.expenseSF * 10;
                    vm.expensePre2 = set.expenseSF
                }
                else {
                    set.expenseSF = set.expenseSF / 10;
                    vm.expensePre2 = set.expenseSF

                }
            }
            expenseSF = set.expenseSF;
        } else if (inputName == 'expensePercentage') {
            if (!set.expensePercentage || !$.isNumeric(set.expensePercentage)) {
                set.expensePercentage = 0;
                vm.expensePerPre2 = 0;
            }
            if (set.expensePercentage == 0 && set.expensePercentage[1] != '.') {
                set.expensePercentage = 0
                vm.expensePerPre2 = 0
            }
            if (set.expensePercentage >= 100) {
                set.expensePercentage = 100;
            }


            if (vm.expensePerPre2 == 0 && set.expensePercentage >= 1) {
                if (set.expensePercentage < 10) {
                    set.expensePercentage = set.expensePercentage / 10;
                    set.expensePercentage = set.expensePercentage * 10;
                    vm.expensePerPre2 = set.expensePercentage
                }
                else {
                    set.expensePercentage = set.expensePercentage / 10;
                    vm.expensePerPre2 = set.expensePercentage

                }
            }
            expensePercentage = set.expensePercentage;
        } else if (inputName == 'BCR') {
            if (!set.BCR || !$.isNumeric(set.BCR)) {
                set.BCR = 0;
                vm.BCRPre2 = 0;
            }
            if (set.BCR == 0 && set.BCR[1] != '.') {
                set.BCR = 0
                vm.BCRPre2 = 0
            }
            if (set.BCR >= 100) {
                set.BCR = 100;
            }

            if (vm.BCRPre2 == 0 && set.BCR >= 1) {
                if (set.BCR < 10) {
                    set.BCR = set.BCR / 10;
                    set.BCR = set.BCR * 10;
                    vm.BCRPre2 = set.BCR
                }
                else {
                    set.BCR = set.BCR / 10;
                    vm.BCRPre2 = set.BCR

                }
            }
            BCR = set.BCR;
        }



        var annualRent = PetitionerFormulae.Petitioner.annualRent(leaseableSqFt, marketRentSF);
        var GPR = annualRent;
        var VacancyDolar = PetitionerFormulae.Petitioner.vacancy(GPR, (vacancyPercentage / 100));
        var effectiveRent = PetitionerFormulae.Petitioner.effectiveRent(annualRent, (VacancyDolar / 100));
        var expense = PetitionerFormulae.Petitioner.expenses(effectiveRent, (expensePercentage / 100));
        var expensesSF = PetitionerFormulae.Petitioner.expensesPerSf(expense, leaseableSqFt);
        var NOI = PetitionerFormulae.Petitioner.netOperatingIncome(effectiveRent, expense);
        var OCR = PetitionerFormulae.Petitioner.overAllCapRate(parseInt(BCR), parseInt(ETR));
        var VDC = PetitionerFormulae.Petitioner.valueDirectCap(OCR, NOI);
        var ValueSQFT = PetitionerFormulae.Petitioner.valuePerSqFt(VDC, leaseableSqFt);
        ////console.log(expensePercentage + marketRentSF)
        set.vacancyPercentage = vacancyPercentage;
        set.expenseSF = expenseSF;
        set.expensePercentage = expensePercentage;
        set.NOI = NOI;
        set.BCR = BCR;
        set.value = VDC;
        set.valueSF = ValueSQFT;
        set.assessedValue = assessedValue;
        set.assessedValueSF = assessedValueSF;
        set.petitionerLeasableSF = leaseableSqFt;
        set.petitionerMarketRentSF = set.marketRentSF;
        set.petitionerAnnualRent = annualRent;
        set.petitionerGPR = GPR;
        set.petitionerVacancyPercentage = vacancyPercentage;
        set.petitionerVacancy = VacancyDolar;
        set.petitionerEffectiveRent = effectiveRent;
        set.petitionerExpensePercentage = expensePercentage;
        set.petitionerExpense = expense;
        set.petitionerExpenseSF = expensesSF;
        set.petitionerOI = otherIncome;
        set.petitionerNOI = NOI;
        set.petitionerBCR = BCR;
        set.petitionerETR = ETR;
        set.petitionerOCR = OCR;
        set.petitionerVDC = VDC;
        set.petitionerValueSF = ValueSQFT;
        set.petitionerNOIBySF = NOI / leaseableSqFt;

    }

    //===================================market rent per sqft===================================//
    var marketRentSetsCount = 0;
    vm.marketRentActive = true;
    vm.toggleMarketRent = toggleMarketRent;
    vm.addMarketRentSet = addMarketRentSet;
    vm.removeMRSet = removeMRSet;

    vm.marketRentSets = [];
    marketRentSetsCount++;
    vm.marketRentSets.push(getNewSet(marketRentSetsCount));
    var counts = 4;
    $scope.col = 3;

    function setColMd(colState) {
        ////console.log('colState', colState);
        // if(colState){
        //     counts++;
        // }
        // else{
        //     counts--;
        // }

        // ////console.log('counts' , counts);

        // if(counts != 0 )
        //     $scope.col  =  12 / counts;

        // ////console.log(' $scope.col' ,  $scope.col);

    }

    function toggleMarketRent() {
        vm.marketRentActive = !vm.marketRentActive;
        setColMd(vm.marketRentActive);
    }

    function addMarketRentSet() {
        marketRentSetsCount++;

        vm.marketRentSets.push(getNewSet(marketRentSetsCount));
    }
    vm.pre = 0;
    function removeMRSet(index) {
        vm.marketRentSets.splice(index, 1);
    }

    vm.calculateMarketRentSet = function (set) {

        if (!set.marketRentSF || !$.isNumeric(set.marketRentSF)) {
            set.marketRentSF = 0;
        }
        if (!set.marketRentSF || !$.isNumeric(set.marketRentSF)) {
            set.marketRentSF = 0;
            vm.pre = 0;
        }
        if (set.marketRentSF == 0 && set.marketRentSF[1] != '.') {
            ////console.log('aaaaaaaaaaasssssss00');

            set.marketRentSF = 0;
            vm.pre = 0;
        }
        ////console.log('aaaaaaaaaaasssssss00' + vm.pre);


        if (vm.pre == 0 && set.marketRentSF >= 1) {
            if (set.marketRentSF < 10) {
                set.marketRentSF = set.marketRentSF / 10;
                set.marketRentSF = set.marketRentSF * 10;
                vm.pre = set.marketRentSF
            }
            else {
                set.marketRentSF = set.marketRentSF / 10;
                vm.pre = set.marketRentSF

            }
        }

        var annualRent = PetitionerFormulae.Petitioner.annualRent(leaseableSqFt, set.marketRentSF);
        var GPR = annualRent;
        var VacancyDolar = PetitionerFormulae.Petitioner.vacancy(GPR, (vacancyPercentage / 100));
        var effectiveRent = PetitionerFormulae.Petitioner.effectiveRent(annualRent, (VacancyDolar / 100));
        var expense = PetitionerFormulae.Petitioner.expenses(effectiveRent, (expensePercentage / 100));
        var expensesSF = PetitionerFormulae.Petitioner.expensesPerSf(expense, leaseableSqFt);
        var NOI = PetitionerFormulae.Petitioner.netOperatingIncome(effectiveRent, expense);
        var OCR = PetitionerFormulae.Petitioner.overAllCapRate(parseInt(BCR), parseInt(ETR));
        var VDC = PetitionerFormulae.Petitioner.valueDirectCap(OCR, NOI);
        var ValueSQFT = PetitionerFormulae.Petitioner.valuePerSqFt(VDC, leaseableSqFt);

        set.vacancyPercentage = vacancyPercentage;
        set.expenseSF = expensesSF;
        set.expensePercentage = expensePercentage;
        set.NOI = NOI;
        set.BCR = BCR;
        set.value = VDC;
        set.valueSF = ValueSQFT;
        set.assessedValue = assessedValue;
        set.assessedValueSF = assessedValueSF;
        set.petitionerLeasableSF = leaseableSqFt;
        set.petitionerMarketRentSF = set.marketRentSF;
        set.petitionerAnnualRent = annualRent;
        set.petitionerGPR = GPR;
        set.petitionerVacancyPercentage = vacancyPercentage;
        set.petitionerVacancy = VacancyDolar;
        set.petitionerEffectiveRent = effectiveRent;
        set.petitionerExpensePercentage = expensePercentage;
        set.petitionerExpense = expense;
        set.petitionerExpenseSF = expensesSF;
        set.petitionerOI = otherIncome;
        set.petitionerNOI = NOI;
        set.petitionerBCR = BCR;
        set.petitionerETR = ETR;
        set.petitionerOCR = OCR;
        set.petitionerVDC = VDC;
        set.petitionerValueSF = ValueSQFT;
        set.petitionerNOIBySF = NOI / leaseableSqFt;

    }


    //=================================== vacancy %  ============================================//


    var vacancySetsCount = 0;

    vm.vacancyActive = true;
    vm.addVacancySet = addVacancySet;
    vm.toggleVacancy = toggleVacancy;
    vm.removeVacancySet = removeVacancySet;
    vm.vacancySets = [];
    vacancySetsCount++;
    vm.vacancySets.push(getNewSet(vacancySetsCount));

    function toggleVacancy() {
        vm.vacancyActive = !vm.vacancyActive;
        setColMd(vm.vacancyActive);
    }

    function addVacancySet() {
        vacancySetsCount++;
        vm.vacancySets.push(getNewSet(vacancySetsCount));
    }

    function removeVacancySet(index) {
        vm.vacancySets.splice(index, 1);
    }
    vm.vacPre = 0;
    vm.calculateVacancySet = function (set) {
        set.marketRentSF = marketRentSF;

        if (!set.vacancyPercentage || !$.isNumeric(set.vacancyPercentage)) {
            set.vacancyPercentage = 0;
            vm.vacPre = 0;
        }
        if (set.vacancyPercentage == 0 && set.vacancyPercentage[1] != '.') {
            set.vacancyPercentage = 0;
            vm.vacPre = 0;
        }

        if (vm.vacPre == 0 && set.vacancyPercentage >= 1) {
            if (set.vacancyPercentage < 10) {
                set.vacancyPercentage = set.vacancyPercentage / 10;
                set.vacancyPercentage = set.vacancyPercentage * 10;
                vm.vacPre = set.vacancyPercentage
            }
            else {
                set.vacancyPercentage = set.vacancyPercentage / 10;
                vm.expPre = set.vacancyPercentage

            }
        }


        var annualRent = PetitionerFormulae.Petitioner.annualRent(leaseableSqFt, set.marketRentSF);
        var GPR = annualRent;
        var VacancyDolar = PetitionerFormulae.Petitioner.vacancy(GPR, (set.vacancyPercentage / 100));
        var effectiveRent = PetitionerFormulae.Petitioner.effectiveRent(annualRent, (VacancyDolar / 100));
        var expense = PetitionerFormulae.Petitioner.expenses(effectiveRent, (expensePercentage / 100));
        var expensesSF = PetitionerFormulae.Petitioner.expensesPerSf(expense, leaseableSqFt);
        var NOI = PetitionerFormulae.Petitioner.netOperatingIncome(effectiveRent, expense);
        var OCR = PetitionerFormulae.Petitioner.overAllCapRate(parseInt(BCR), parseInt(ETR));
        var VDC = PetitionerFormulae.Petitioner.valueDirectCap(OCR, NOI);
        var ValueSQFT = PetitionerFormulae.Petitioner.valuePerSqFt(VDC, leaseableSqFt);

        // set.vacancyPercentage = vacancyPercentage;
        set.expenseSF = expensesSF;
        set.expensePercentage = expensePercentage;
        set.NOI = NOI;
        set.BCR = BCR;
        set.value = VDC;
        set.valueSF = ValueSQFT;
        set.assessedValue = assessedValue;
        set.assessedValueSF = assessedValueSF;
        set.petitionerLeasableSF = leaseableSqFt;
        set.petitionerMarketRentSF = set.marketRentSF;
        set.petitionerAnnualRent = annualRent;
        set.petitionerGPR = GPR;
        set.petitionerVacancyPercentage = set.vacancyPercentage;
        set.petitionerVacancy = VacancyDolar;
        set.petitionerEffectiveRent = effectiveRent;
        set.petitionerExpensePercentage = expensePercentage;
        set.petitionerExpense = expense;
        set.petitionerExpenseSF = expensesSF;
        set.petitionerOI = otherIncome;
        set.petitionerNOI = NOI;
        set.petitionerBCR = BCR;
        set.petitionerETR = ETR;
        set.petitionerOCR = OCR;
        set.petitionerVDC = VDC;
        set.petitionerValueSF = ValueSQFT;
        set.petitionerNOIBySF = NOI / leaseableSqFt;

    }
    //=================================== expense % =============================================//
    var expenseSetsCount = 0;

    vm.expenseActive = true;
    vm.toggleExpense = toggleExpense;
    vm.addExpenseSet = addExpenseSet;
    vm.removeExpenseSet = removeExpenseSet;
    vm.expenseSets = [];
    expenseSetsCount++;
    vm.expenseSets.push(getNewSet(expenseSetsCount));

    function toggleExpense() {
        vm.expenseActive = !vm.expenseActive;
        setColMd(vm.expenseActive);

    }

    function addExpenseSet() {
        expenseSetsCount++;
        vm.expenseSets.push(getNewSet(expenseSetsCount));
    }

    function removeExpenseSet(index) {
        vm.expenseSets.splice(index, 1);
    }
    vm.expPre2 = 0;
    vm.expPre = 0;
    vm.calculateExpenseSet = function (set) {
        set.vacancyPercentage = vacancyPercentage;
        set.marketRentSF = marketRentSF;

        if (vm.expenseInputActive) {
            ////console.log('expenseInputActive', vm.expenseInputActive);

            if (!set.expenseSF || !$.isNumeric(set.expenseSF)) {
                set.expenseSF = 0;
                vm.expPre = 0;
            }
            if (set.expenseSF == 0 && set.expenseSF[1] != '.') {
                set.expenseSF = 0;
                vm.expPre = 0;
            }

            if (vm.expPre == 0 && set.expenseSF >= 1) {
                if (set.expenseSF < 10) {
                    set.expenseSF = set.expenseSF / 10;
                    set.expenseSF = set.expenseSF * 10;
                    vm.expPre = set.expenseSF
                }
                else {
                    set.expenseSF = set.expenseSF / 10;
                    vm.expPre = set.expenseSF

                }
            }


            set.expensePercentage = expensePercentage;

        } else {
            ////console.log('expenseInputActive', vm.expenseInputActive);

            if (!set.expensePercentage || !$.isNumeric(set.expensePercentage)) {
                set.expensePercentage = 0;
                vm.expPre2 = 0;
            }
            if (set.expensePercentage == 0 && set.expensePercentage[1] != '.') {
                set.expensePercentage = 0;
                vm.expPre2 = 0;
            }
            ////console.log('previous', vm.expPre2);

            if (vm.expPre2 == 0 && set.expensePercentage >= 1) {
                if (set.expensePercentage < 10) {
                    set.expensePercentage = set.expensePercentage / 10;
                    set.expensePercentage = set.expensePercentage * 10;
                    vm.expPre2 = set.expensePercentage
                }
                else {
                    set.expensePercentage = set.expensePercentage / 10;
                    vm.expPre2 = set.expensePercentage

                }
            }

            expensePercentage = set.expensePercentage;

        }

        var annualRent = PetitionerFormulae.Petitioner.annualRent(leaseableSqFt, set.marketRentSF);
        var GPR = annualRent;
        var VacancyDolar = PetitionerFormulae.Petitioner.vacancy(GPR, (set.vacancyPercentage / 100));
        var effectiveRent = PetitionerFormulae.Petitioner.effectiveRent(annualRent, (VacancyDolar / 100));

        var expense = PetitionerFormulae.Petitioner.expenses(effectiveRent, (expensePercentage / 100));
        var expenseSF = PetitionerFormulae.Petitioner.expensesPerSf(expense, leaseableSqFt);
        var NOI = PetitionerFormulae.Petitioner.netOperatingIncome(effectiveRent, expense);
        var OCR = PetitionerFormulae.Petitioner.overAllCapRate(parseInt(BCR), parseInt(ETR));
        var VDC = PetitionerFormulae.Petitioner.valueDirectCap(OCR, NOI);
        var ValueSQFT = PetitionerFormulae.Petitioner.valuePerSqFt(VDC, leaseableSqFt);

        // set.vacancyPercentage = vacancyPercentage;
        //if expenseSF is active donot update
        if (!vm.expenseInputActive) {
            set.expenseSF = expenseSF;
        }
        // set.expensePercentage = expensePercentage;
        set.NOI = NOI;
        set.BCR = BCR;
        set.value = VDC;
        set.valueSF = ValueSQFT;
        set.assessedValue = assessedValue;
        set.assessedValueSF = assessedValueSF;
        set.petitionerLeasableSF = leaseableSqFt;
        set.petitionerMarketRentSF = set.marketRentSF;
        set.petitionerAnnualRent = annualRent;
        set.petitionerGPR = GPR;
        set.petitionerVacancyPercentage = set.vacancyPercentage;
        set.petitionerVacancy = VacancyDolar;
        set.petitionerEffectiveRent = effectiveRent;
        set.petitionerExpensePercentage = expensePercentage;
        set.petitionerExpense = expense;
        set.petitionerExpenseSF = expenseSF;
        set.petitionerOI = otherIncome;
        set.petitionerNOI = NOI;
        set.petitionerBCR = BCR;
        set.petitionerETR = ETR;
        set.petitionerOCR = OCR;
        set.petitionerVDC = VDC;
        set.petitionerValueSF = ValueSQFT;
        set.petitionerNOIBySF = NOI / leaseableSqFt;
    }

    vm.expenseInputActive = true;

    vm.ExpenseSFInput = function () {
        vm.expenseInputActive = true;
    }

    vm.ExpensePercentageInput = function () {
        vm.expenseInputActive = false;
    }

    //=================================== Bace cape Rate=========================================//
    vm.baseCapeRateActive = true;
    var BCRSetsCount = 0;
    vm.toggleBaseCapeRate = toggleBaseCapeRate;
    vm.addBCRSet = addBCRSet;
    vm.removeBCRSet = removeBCRSet;
    vm.BCRSets = [];
    BCRSetsCount++;
    vm.BCRSets.push(getNewSet(BCRSetsCount));

    function toggleBaseCapeRate() {
        ////console.log('toggleBaseCapeRate');
        vm.baseCapeRateActive = !vm.baseCapeRateActive;
        setColMd(vm.baseCapeRateActive);
    }

    function addBCRSet() {
        BCRSetsCount++;
        vm.BCRSets.push(getNewSet(BCRSetsCount));
    }

    function removeBCRSet(index) {
        vm.BCRSets.splice(index, 1);
    }
    vm.bcrPre = -1;
    vm.calculateBCRSet = function (set) {
        set.vacancyPercentage = vacancyPercentage;
        set.marketRentSF = marketRentSF;
        if (!set.BCR || !$.isNumeric(set.BCR)) {
            set.BCR = 0;
        }
        if (!set.BCR || !$.isNumeric(set.BCR)) {
            set.BCR = 0;
            vm.bcrPre = 0;
        }
        if (set.BCR == 0 && set.BCR[1] != '.') {
            set.BCR = 0;
            vm.bcrPre = 0;
        }
        if (vm.bcrPre == 0 && set.BCR >= 1) {
            if (set.BCR < 10) {
                set.BCR = set.BCR / 10;
                set.BCR = set.BCR * 10;
                vm.bcrPre = set.BCR
            }
            else {
                set.BCR = set.BCR / 10;
                vm.bcrPre = set.BCR

            }
        }


        var annualRent = PetitionerFormulae.Petitioner.annualRent(leaseableSqFt, set.marketRentSF);
        var GPR = annualRent;
        var VacancyDolar = PetitionerFormulae.Petitioner.vacancy(GPR, (set.vacancyPercentage / 100));
        var effectiveRent = PetitionerFormulae.Petitioner.effectiveRent(annualRent, (VacancyDolar / 100));
        var expense = PetitionerFormulae.Petitioner.expenses(effectiveRent, (expensePercentage / 100));
        var expensesSF = PetitionerFormulae.Petitioner.expensesPerSf(expense, leaseableSqFt);
        var NOI = PetitionerFormulae.Petitioner.netOperatingIncome(effectiveRent, expense);
        var OCR = PetitionerFormulae.Petitioner.overAllCapRate(parseInt(set.BCR), parseInt(ETR));
        var VDC = PetitionerFormulae.Petitioner.valueDirectCap(OCR, NOI);
        var ValueSQFT = PetitionerFormulae.Petitioner.valuePerSqFt(VDC, leaseableSqFt);

        set.vacancyPercentage = vacancyPercentage;
        set.expenseSF = expensesSF;
        set.expensePercentage = expensePercentage;
        set.NOI = NOI;
        // set.BCR = BCR;
        set.value = VDC;
        set.valueSF = ValueSQFT;
        set.assessedValue = assessedValue;
        set.assessedValueSF = assessedValueSF;
        set.petitionerLeasableSF = leaseableSqFt;
        set.petitionerMarketRentSF = set.marketRentSF;
        set.petitionerAnnualRent = annualRent;
        set.petitionerGPR = GPR;
        set.petitionerVacancyPercentage = set.vacancyPercentage;
        set.petitionerVacancy = VacancyDolar;
        set.petitionerEffectiveRent = effectiveRent;
        set.petitionerExpensePercentage = expensePercentage;
        set.petitionerExpense = expense;
        set.petitionerExpenseSF = expensesSF;
        set.petitionerOI = otherIncome;
        set.petitionerNOI = NOI;
        set.petitionerBCR = BCR;
        set.petitionerETR = ETR;
        set.petitionerOCR = OCR;
        set.petitionerVDC = VDC;
        set.petitionerValueSF = ValueSQFT;
        set.petitionerNOIBySF = NOI / leaseableSqFt;
    }


    //===================================   use Scenario ===================================//

    vm.useInValuation = useInValuation;

    function useInValuation(set) {
        // saveScenario();
        ////console.log('use in valuations', set);
        localStorage.setItem('selectedScenario', angular.toJson(set))
        saveScenario('propertyValuation')

    }

    //=============================================================================================//


    function getNewSet(count) {
        var set = {
            name: 'Set ' + count,
            marketRentSF: 0,
            vacancyPercentage: 0,
            expenseSF: 0,
            expensePercentage: 0,
            NOI: 0,
            BCR: 0,
            value: 0,
            valueSF: 0,
            assessedValue: 0,
            assessedValueSF: 0,
            // petitioner set
            petitionerLeasableSF: 0,
            petitionerMarketRentSF: 0,
            petitionerAnnualRent: 0,
            petitionerGPR: 0,
            petitionerVacancyPercentage: 0,
            petitionerVacancy: 0,
            petitionerEffectiveRent: 0,
            petitionerExpensePercentage: 0,
            petitionerExpense: 0,
            petitionerExpenseSF: 0,
            petitionerOI: 0,
            petitionerNOI: 0,
            petitionerNOIBySF: 0,
            petitionerBCR: 0,
            petitionerETR: 0,
            petitionerOCR: 0,
            petitionerVDC: 0,
            petitionerValueSF: 0
        };
        return set;
    }
    //=============================================================================================//

    //====================================Modal Decisions=========================================================//
}

/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 281 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {

_Map.$inject = ["$stateParams", "$anchorScroll", "$state", "DTOptionsBuilder", "DTColumnDefBuilder", "$location", "$http", "__env", "$log", "AOTCService", "$timeout"];
module.exports = _Map;

//angular.module('AOTC').controller('Map', _Map
//    );

function _Map($stateParams, $anchorScroll, $state, DTOptionsBuilder, DTColumnDefBuilder, $location, $http, __env, $log, AOTCService, $timeout) {
    //////console.log("Data Mapping controller");
    var vm = this;
    vm.fileName = localStorage.getItem("onlyFileName");

    // vm.targetFields = ["LAND USE CODE", "ZONING ", "ACCOUNT NUMBER ", "OWNER NAME ", "OWNER ADDRESS ", "OWNER CITY ", "OWNER STATE ", "OWNER ZIP ", "STREET NUMB ", "STREET DIRN ", "STREET NAME ", "STREET TYPE"];

    // Variables
    var targetDataFields = JSON.parse(localStorage.getItem("targetDataFields"));
    var mapping = JSON.parse(localStorage.getItem("mapData"));

    // ////console.log("targetDataFields: ",targetDataFields);
    // ////console.log("mapping: ",mapping);

    // Attributes
    vm.mappedData = mapping;
    vm.targetFields = targetDataFields.split('|');


    // Behaviour
    vm.completeMapping = function () {
        $("#preloader").css("display", "block");

        var url = '/properties/MapPropertiesData?userId=' + localStorage.getItem("userId");

        var formatedMapping = {
            mapping: vm.mappedData,
            fileName: vm.fileName
        };

        // ////console.log("formatedMapping: ",formatedMapping);

        AOTCService.postDataToServer(url, formatedMapping)
            .then(function (result) {
                $("#preloader").css("display", "none");
                ////console.log(result);

                if (result.data.success) {
                    //go to task manager
                    $state.go('TaskManager');

                } else {
                    ////console.log('show some error');
                }
            }, function (result) {
                $("#preloader").css("display", "none");
                ////console.log(result);
            }
        );
    }

    setTimeout(function () {
        var c = {};
        $(".inventor").draggable({
            helper: "clone",
            start: function (event, ui) {
                c.tr = this;
                c.helper = ui.helper;
            }
        });
        $(".invention").droppable({
            drop: function (event, ui) {
                var inventor = ui.draggable.text().trim();
                $(this).find("input").val(inventor);
                $(c.tr).add();
                $(c.helper).add();
                var key = event.target.getAttribute("id")
                vm.mappedData[key] = inventor;
                // ////console.log(vm.mappedData)
            }
        });
    }, 10);
}

/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 282 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {

_PropAssignment.$inject = ["$state", "$timeout", "$rootScope", "$stateParams", "AOTCService", "$scope", "ValuationService", "UtilService"];
module.exports = _PropAssignment;
//angular.module('AOTC')
//    .controller('PropAssignment',_PropValuation );
function _PropAssignment($state, $timeout, $rootScope, $stateParams, AOTCService, $scope, ValuationService, UtilService) {
    ////console.log("PropValuation controller", $stateParams);

    var $ctrl = this;


    //===============================   variables ======================== //


    $ctrl.property = JSON.parse(localStorage.getItem('propertyDetails'));
    $ctrl.propertyId = JSON.parse(localStorage.getItem('propertyId'));

    $timeout(function () {
        $('#myModal').modal('show');
    });

    $ctrl.formsList = [];
    //==========================================Methods========================================= //
    //===============================   GETTING DATA ======================== //
    $ctrl.userRoles = JSON.parse(localStorage.getItem('propertyDetails')).roles || {};

    $ctrl.userByRole = [];

    $ctrl.getDatas = function (_value) {
        if (!_value) return;
        var url = '/users/getUserByRole';
        var _data = {
            "roleName": _value,
            "propId": parseInt(localStorage.getItem('propertyId'))
        };
        $("#preloader").css("display", "block");

        AOTCService.postDataToServer(url, _data)
            .then(function (response) {
                if (response.data.success) {
                    $ctrl.userByRole = response.data.result;
                    $('#myModal').modal('hide');
                    resetRolesData();

                }
                $("#preloader").css("display", "none");
                //$scope.$emit('success', response.data.message);



            }, function (result) {
                $("#preloader").css("display", "none");

                //some error
                ////console.log(result);
            });

    };
    $ctrl.selectedUsers = [];
    $ctrl.addToselectedUsers = function (_id, _val) {
        if (_val) {
            $ctrl.selectedUsers.push(_id);
        } else {
            var index = $ctrl.selectedUsers.indexOf(_id);
            $ctrl.selectedUsers.splice(index, 1);
        }

    };

    $ctrl.saveData = function () {
        var _data = {
            "propId": parseInt(localStorage.getItem('propertyId')),
            "agentId": $ctrl.selectedUsers,
            "roles": $ctrl.rolesForSelectedUsers
        };
        var url = '/properties/assignPropertyToAgent';
        $("#preloader").css("display", "block");

        AOTCService.postDataToServer(url, _data)
            .then(function (response) {
                if (response.data.success) {
                    resetRolesData();
                    $scope.$emit('success', response.data.message);
                    $timeout(function () {
                        $("#preloader").css("display", "none");
                        $state.go('assignedUsersList');
                    }, 2000);
                } else $scope.$emit('error', response.data.message);
                
                //$scope.$emit('success', response.data.message);
            }, function (result) {
                $("#preloader").css("display", "none");
                $scope.$emit('error', result.data.message);
                //some error
                ////console.log(result);
            });
    };

    //====================================================================================================================================//

    resetRolesData();

    function resetRolesData() {
        $ctrl.rolesForSelectedUsers = {
            "viewPropertyPublicData": false,
            "unlinkPropertyData": false,
            "viewRentRolls": false,
            "attachFilesToProperty": false,
            "viewIncomeExpense": false,
            "editValuationWorkspace": false,
            "editValuationForm": false,
            "viewValuationWorkspace": false,
            "editPropertyImage": false,
            "viewComparables": false,
            "viewValuationForm": false,
            "viewPropertyDetails": false,
            "viewTaxBills": false,
            "assignProperty": false
        };
        $ctrl.selectedUsers = [];
    }

    $scope.$on("$destroy", function handler() {
        $('#myModal').modal('hide');
        $('body').removeClass('modal-open');
        $('.modal-backdrop').remove();

    });



}
/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 283 */
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function($) {_assignedUsersListCtrl.$inject = ["$stateParams", "$state", "$location", "$scope", "AOTCService", "$timeout", "$filter", "$q"];
module.exports = _assignedUsersListCtrl;

//angular.module('AOTC').controller('AssignedUsersListCtrl',
//    _assignedUsersListCtrl);

function _assignedUsersListCtrl($stateParams, $state, $location, $scope, AOTCService, $timeout, $filter, $q) {

    //Bindable Members
    var $ctrl = this;
    $ctrl.property = JSON.parse(localStorage.getItem('propertyDetails'));
    $ctrl.propertyId = JSON.parse(localStorage.getItem('propertyId'));
    $ctrl.showRightsModal = function () {
        $('#mySelectModal').modal('show');
    };

    $ctrl.allUserRoles = [];
    //========================Starting Logic =======================//

    getAssignedUsers();

    function getAssignedUsers() {

        var url = '/properties/getAssignedUsers';
        var _data = {
            "propId":parseInt(localStorage.getItem('propertyId'))
        };
        //var defer = $q.defer();
        $('#preloader').css("display", "block");

        AOTCService.postDataToServer(url, _data).
        then(function (result) {
            if (result.data.success) {
                $ctrl.assignedUsers = result.data.result;

            }
            $('#preloader').css("display", "none");

        }, function (err) {
            $('#preloader').css("display", "none");

        });

        //return defer.promise;
    }

    $ctrl.updateUserRole = function (_data, _id, _form) {
        var _objData = {
            // "roleId": _id,
            // "role": _data,
            "propId":parseInt(localStorage.getItem('propertyId')),
            "agentId":[_id],
            "roles":_data 
        };
        var _url = '/properties/assignPropertyToAgent';
        $('#preloader').css("display", "block");

        AOTCService.postDataToServer(_url, _objData)
            .then(function successCallback(response) {
                $('#preloader').css("display", "none");

                ////console.log("result is ", response);
                var serverData = response.data;
                //set token
                if (serverData.success) {
                    //_form.$setPristine();
                    _form.$setPristine();
                    $scope.$emit('success',serverData.message);
                } else {
                     $scope.$emit('danger', serverData.message);
                }


            }, function errorCallback(response) {
                $('#preloader').css("display", "none");
            });

    };

    $ctrl.deleteUserRole = function(_data, _id, _index){
        var _objData = {
            "propId":parseInt(localStorage.getItem('propertyId')),
            "agentId":[_id]
        };
        var _url = '/properties/removeAssignedUser';
        $('#preloader').css("display", "block");

        AOTCService.postDataToServer(_url, _objData)
            .then(function successCallback(response) {
                $('#preloader').css("display", "none");

                ////console.log("result is ", response);
                var serverData = response.data;
                //set token
                if (serverData.success) {
                    $timeout(function(){
                        $ctrl.assignedUsers.splice(_index, 1);                        
                    });
                    $scope.$emit('success',serverData.message);
                } else {
                     $scope.$emit('danger', serverData.message);
                }


            }, function errorCallback(response) {
                $('#preloader').css("display", "none");
            });

    };

}
/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 284 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {

_taxAppeal.$inject = ["UtilService", "$stateParams", "$anchorScroll","$state", "DTOptionsBuilder", "DTColumnDefBuilder", "$location", "$scope", "$http", "__env", "$log", "AOTCService", "$timeout"];
module.exports = _taxAppeal;

//angular.module('AOTC')
//    .controller('updateIERR', _updateIERR
//    );
function _taxAppeal(UtilService, $stateParams, $anchorScroll, $state, DTOptionsBuilder, DTColumnDefBuilder, $location, $scope, $http, __env, $log, AOTCService, $timeout) {
    var vm = this;
    
    $scope.data = null; 
    $scope.subData = null;
    $scope.show = true;
    $scope.showModal = false;
    $scope.openSign = false;
    $scope.uploadRadio = null;
    $scope.pin = '';
    $scope.uploadModal = false;
    var configId = {property: null, event: null}
    var configData = {data:null,eventIndex:null};
    var subEventsDetect = null;
    var sendFile = null;
    var configSign =  {data:[]}


    function getPropertyDetails()  {
   
    var url = '/appeal/getPropertyTimelineData';
    var postData = {"appealYear":2018}
    $("#preloader").css("display", "block");
    
    AOTCService.postDataToServer(url, postData)
        .then(function (result) {
            $("#preloader").css("display", "none");
              console.log(result.data)
              $scope.data = result.data.result
              $scope.staticTable(1);

            }, function (result) {
            //some error
            ////console.log(result);
            $("#preloader").css("display", "none");
        });
    }
    getPropertyDetails();

    $scope.staticTable = function(pindex){
        console.log(pindex)
         $(document).ready(function() {
                $('.JStableOuter table').scroll(function(e) {
              
                  $('.JStableOuter thead').css("left", -$(".JStableOuter tbody").scrollLeft());
                  $('.JStableOuter thead th:nth-child(1)').css("left", $(".JStableOuter table").scrollLeft() -0 );
                  $('.JStableOuter tbody td:nth-child(1)').css("left", $(".JStableOuter table").scrollLeft());
              
                  $('.JStableOuter thead').css("top", -$(".JStableOuter tbody").scrollTop());
                  $('.JStableOuter thead tr th').css("top", $(".JStableOuter table").scrollTop());
              
                });
              });
            }
    
    $scope.checkMessage = function(type){
       
       var condition = {'not-started': type=='Not Started' || !type,'done': type=='Done',
        'applicable': type=='Not applicable','in-progress': type=='In Progress',
      }
    
        return condition;
    }

    $scope.setWarning = function(notification) {
        if ('type' in notification) return notification['type'] == 'warning' ? 'red-card' : 'blue-card';
        else return 'blue-card'
    }

    $scope.buttonComp = function(state) {
        if ('warning' in state && state.warning)  return 'red-button';
        else if ('flag' in state && state.flag==false)  return 'disable-button'
        else return 'blue-button';
     }

     $scope.executeSign = function(pin){
        //  /executeSignature
        var url = '/appeal/executeSignature';
        var data = []
        data.push( configSign.data)
        var postData = {"pin":pin, "data": data}
        $("#preloader").css("display", "block");
        console.log(postData)
        
        AOTCService.postDataToServer(url, postData)
            .then(function (result) {
                $("#preloader").css("display", "none");
                  console.log(result.data)
                 
                }, function (result) {
                //some error
                ////console.log(result);
                console.log(result)
                $("#preloader").css("display", "none");
            });
         
     }

    $scope.noteComp = function(state) {
       
        if ('warning' in state && state.warning)
            {
           

                return 'red-note';
                
            }
            
        else  return 'blue-note';
    }

    $scope.openModal = function(data, prop,subEventIndex){
        // $scope.modalData = null;\
 
        
        configId.property = prop.propertyId;
        configId.event =    prop.eventId;
        configData.data = prop;
        configData.subEventIndex = subEventIndex;
        console.log(configData)
        if(data.buttonText=='Details') {
            $scope.showModal = true;
            $scope.modalData = {data: data, additionalItems: prop.additionalItems};
            console.log($scope.modalData)
        

        } else if (data.buttonText=='Schedule Review') {

        } else if (data.buttonText=='Execute Signature') {
            $scope.openSign = true;
            configSign.data = prop.subEvents[subEventIndex]
        
        }
        
        console.log(data)
    }

    $scope.signModal = function(type){
        type==1 ? $scope.uploadModal = true : $scope.uploadModal = false ;

    }

    $scope.closeModal = function(){
        $scope.showModal = false;
        $scope.openSign = false;
     
        console.log('hide')
    }

     $scope.changeComp = function(event,column,pColumn) {
         if(event.subEvents.sublength==0) {
             return
         }
        $scope.subData = null;
        var jProperty =  $scope.data.jurisdictions[pColumn].properties;
        var jName = $scope.data.jurisdictions[pColumn].name
        subEventsDetect = {event: event, cloumn: column, pColumn: pColumn} 
        var extractSubEvents = [];
        for (var i  = 0 ; i  < jProperty.length;i++) {
            var subEvents = jProperty[i].events[column].subEvents;
            var eventId = jProperty[i].events[column].eventId;
            var index = i;
             extractSubEvents.push({fcolName : jProperty[i].name, fcolOwnerName : jProperty[i].ownerName,
                 subEvents: subEvents,propertyId  : jProperty[i].id, eventId:  eventId,additionalItems: jProperty[i].events[column].additionalItems, 
                 info: subEventsDetect, propertyIndex: index, eventIndex: column})
        }
        console.log(extractSubEvents)

        $scope.subData = {data: $scope.data, prop: extractSubEvents,jName: jName};
        console.log($scope.subData)
        
        $scope.show =  false;
        // $scope.staticTable(0);
    }

    $scope.uplaodFile = function(file) {
          console.log(file.files)
          sendFile = null;
          var files = file.files;
          var FileNames = [];
          var selected  = 0;
          sendFile = files
          
    }

    $scope.switchMode = function(){
        $scope.subData = null;
        $scope.show =  true;
        console.log('show class')
      
    }

    function UpdateData(){
        // 
        $timeout( function(){
            var url = '/appeal/getPropertyTimelineData';
        var postData = {"appealYear":2018, "userId": 9922606}
        $("#preloader").css("display", "block");
        
        AOTCService.postDataToServer(url, postData)
            .then(function (result) {
                $("#preloader").css("display", "none");
                  console.log(result.data)
                  $scope.data = result.data.result
                  $scope.staticTable(1);
                  $scope.changeComp(subEventsDetect.event,subEventsDetect.cloumn,subEventsDetect.pColumn)
                  $scope.modalData = $scope.data.jurisdictions[subEventsDetect.pColumn]
                  .properties[configData.data.propertyIndex].events[configData.data.eventIndex].subEvents[configData.subEventIndex].properties
                  console.log($scope.modalData)
                  $scope.uploadModal = false
                }, function (result) {
                //some error
                ////console.log(result);
                $("#preloader").css("display", "none");
            });
        }, 5000 );
       
        



    }

    $scope.sendData = function(radio){
        console.log(radio)
      
           $("#preloader").css("display", "block");
           console.log(radio)
           if(radio==1) {
            var url = '/incomeExpenses/addPropertyIE?propId=' + configId.property  +'&tId='+ configId.event;// backend push

           } else if (radio==2){
            var url = '/rentRolls/addPropertyRR?propId=' + configId.property  +'&tId='+ configId.event;

           } else if (radio==3) {
            var url = '/otherFiles/uploadOtherFiles?propId=' + configId.property  +'&tId='+ configId.event;
           }
            AOTCService.uploadFiles(url, sendFile)
                .then(function (result) {
                      console.log(result)
                       UpdateData();
                       $scope.uploadModal = false
            
                }, function (result) {
                    $("#preloader").css("display", "none");
                    ////console.log(result);
                });
        }
    
 
}
/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 285 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


//var angular = require('angular');

angular.module('AOTC').controller('Signup', __webpack_require__(101).Signup);
angular.module('AOTC').directive('pwCheck', __webpack_require__(101).pwCheck);

/***/ }),
/* 286 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


//var angular = require('angular');

////******EditSurvey
//***EditableSurveysMenu
//angular.module('AOTC').directive('myDraggable', require('./EditSurvey/EditableSurveysMenu/EditabelSurveysMenu.service').myDraggable);

//EditArrangeSurvey
angular.module('AOTC').directive('myDraggable', __webpack_require__(65).myDraggable);
angular.module('AOTC').filter('nameFilter', __webpack_require__(65).nameFilter);
angular.module('AOTC').component('editArrangeSurveyComponent', __webpack_require__(65).editArrangeSurveyComponent);

//EditCreateSurvey
angular.module('AOTC').component('editCreateSurveyComponent', __webpack_require__(287));

//EditViewSurvey
angular.module('AOTC').component('editViewSurveyComponent', __webpack_require__(288));


//editSurveyWizard
angular.module('AOTC').controller('editSurveyCtrl', __webpack_require__(289));


////******FillSurvey
angular.module('AOTC').controller('FillSurvey', __webpack_require__(290));
angular.module('AOTC').service('FillSurveyService', __webpack_require__(291));


////******SubmissionList
angular.module('AOTC').controller('SubmissionList', __webpack_require__(292));
angular.module('AOTC').service('SubmissionListService', __webpack_require__(293));


//////******SurveyAnswer

////******SurveyList
angular.module('AOTC').controller('SurveyList', __webpack_require__(294));
angular.module('AOTC').service('SurveylistService', __webpack_require__(295));


////******SurveySubmissions
angular.module('AOTC').controller('SurveySubmissions', __webpack_require__(296));
angular.module('AOTC').service('SurveySubmissionsService', __webpack_require__(297));

////******Wizards
//AddQuestion
angular.module('AOTC').controller('AddQuestionCtrl', __webpack_require__(298));
angular.module('AOTC').service('AddQuestionService', __webpack_require__(299));
angular.module('AOTC').component('inputFields', __webpack_require__(300));



//ArrangeSurvey
angular.module('AOTC').controller('ArrangeSurveyCtrl', __webpack_require__(301));
angular.module('AOTC').service('ArrangeSurveyService', __webpack_require__(302));
angular.module('AOTC').service('ArrangeSurveyUtil', __webpack_require__(303));


angular.module('AOTC').component('arrangeSurveyComponent', __webpack_require__(66).arrangeSurveyComponent);
angular.module('AOTC').filter('nameFilter', __webpack_require__(66).nameFilter);
angular.module('AOTC').directive('myDraggable', __webpack_require__(66).myDraggable);



//CreateSurvey
//angular.module('AOTC').controller('ArrangeSurveyCtrl', require('./Wizards/CreateSurvey/ArrangeSurvey.controller'));
angular.module('AOTC').service('CreateSurveyService', __webpack_require__(304));
angular.module('AOTC').service('CreateSurveyUtil', __webpack_require__(305));


angular.module('AOTC').component('createSurveyComponent', __webpack_require__(306));
//angular.module('AOTC').component('inputFields', require('./Wizards/CreateSurvey/GenericQuestionOptions.component'));

//sectionSettings

angular.module('AOTC').controller('sectionSettingsCtrl', __webpack_require__(307));
angular.module('AOTC').service('sectionSettingsService', __webpack_require__(308));

//ViewSurvey
angular.module('AOTC').component('viewSurveyController', __webpack_require__(309));
//angular.module('AOTC').controller('ViewSurveyCtrl', require('./Wizards/ViewSurvey/ViewSurvey.controller'));
//angular.module('AOTC').factory('ViewSurveyService', require('./Wizards/ViewSurvey/ViewSurvey.service'));
//angular.module('AOTC').service('ViewSurveyUtil', require('./Wizards/ViewSurvey/ViewSurvey.utils'));



////******WizardsViewer
angular.module('AOTC').controller('WizardsViewerCtrl', __webpack_require__(310));


/***/ }),
/* 287 */
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function($) {var _editCreateSurveyComponent = {};


//angular
//    .module('AOTC')
//    .component('editCreateSurveyComponent', _editCreateSurveyComponent);

_editCreateSurveyComponent = {
    templateUrl: 'modules/SurveyModule/EditSurvey/EditableSurveysMenu/EditCreateSurvey/EditCreateSurvey.component.html',
    controllerAs: 'EditCreateSurveyCtrl',
    controller:
        ["$scope", "sharedService", "CreateSurveyService", "FillSurveyService", "$timeout", "$stateParams", "AddQuestionService", "$state",
             function ($scope, sharedService, CreateSurveyService, FillSurveyService, $timeout, $stateParams, AddQuestionService, $state) {


                 var selectedQuestions = [];
                 var check;
                 $scope.questionOptions = [];
                 $scope.newQuestion = {};
                 $scope.editQuestion = false;
                 $scope.valid = false
                 $scope.questionText = '';
                 console.log(CreateSurveyService.editQuestions)
                 CreateSurveyService.selectedSections = $scope.viewQuestions;


                 function checkSelectedQuestions() {
                     $("#preloader").css("display", "block");
                     FillSurveyService.getSurveyDetails($stateParams.id)
                         .then(function (result) {
                             $("#preloader").css("display", "none");

                             if (!result.data.success) {
                                 $scope.$emit('error', result.data.message);
                                 return;
                             }

                             $scope.viewQuestions = result.data.result;
                             CreateSurveyService.selectedSections = $scope.viewQuestions;
                             console.log($scope.viewQuestions)

                             if (CreateSurveyService.editQuestions.length != 0) {

                                 for (var k = 0; k < $scope.data.length; k++) {
                                     for (var i = 0; i < CreateSurveyService.editQuestions.length; i++) {
                                         if (CreateSurveyService.editQuestions[i].id == $scope.data[k].id) {
                                             $scope.data[k].check = true;
                                             // console.log(CreateSurveyService.editQuestions[i].index);
                                         }
                                     }
                                 }

                             }
                             selectDefaultQuestions();

                         }, function (result) {
                             $("#preloader").css("display", "none");
                         });


                 }



                 function selectDefaultQuestions() {
                     var temp = $scope.viewQuestions;
                     var data = $scope.data;
                     var localCheck = JSON.parse(localStorage.getItem("section"))
                     $scope.localHedge = localCheck
                     console.log(localCheck)
                     if (!localStorage.getItem("section")) {

                         for (var i = 0; i < data.length; i++) {

                             for (var j = 0; j < temp.sections.length; j++) {

                                 for (var k = 0; k < temp.sections[j].questions.length; k++) {

                                     if (data[i].id == temp.sections[j].questions[k].questionId) {
                                         var mark = 0;
                                         for (var s = 0; s < CreateSurveyService.validateQuestions.length; s++) {
                                             if (CreateSurveyService.validateQuestions[s].id == data[i].id) {
                                                 data[i].check = false;
                                                 mark = 1;
                                             }
                                         }
                                         if (mark != 1) {
                                             data[i].check = true

                                         }
                                     }
                                 }
                             }
                         }
                     }
                     else {

                         for (var i = 0; i < $scope.data.length; i++) {

                             var found = 0;
                             for (var data in localCheck) {

                                 console.log(localCheck[data])

                                 for (var t = 0; t < localCheck[data].length; t++) {

                                     if (localCheck[data][t].question) {

                                         if ($scope.data[i].id == localCheck[data][t].id) {

                                             found = 1;
                                             $scope.data[i].check = true
                                             break;
                                         }

                                     }

                                 }

                             }
                             if (found == 0) {
                                 $scope.data[i].check = false
                                 console.log(data[i])

                             }
                         }
                         for (var k = 0; k < $scope.data.length; k++) {
                             for (var i = 0; i < CreateSurveyService.editQuestions.length; i++) {
                                 if (CreateSurveyService.editQuestions[i].id == $scope.data[k].id) {
                                     $scope.data[k].check = true;
                                     console.log($scope.data[k])
                                     // console.log(CreateSurveyService.editQuestions[i].index);
                                 }
                             }
                         }
                         for (var k = 0; k < $scope.data.length; k++) {
                             for (var i = 0; i < CreateSurveyService.validateQuestions.length; i++) {
                                 if (CreateSurveyService.validateQuestions[i].id == $scope.data[k].id) {
                                     $scope.data[k].check = false;
                                     // console.log(CreateSurveyService.editQuestions[i].index);
                                 }
                             }
                         }

                     }


                 }

                 getAllQuestions();
                 function getAllQuestions() {
                     $("#preloader").css("display", "block");

                     CreateSurveyService.getAllQuestions().
                         then(function (result) {


                             var serverData = result.data;

                             if (serverData.success) {
                                 if (serverData) {
                                     $scope.data = serverData.result;
                                     if (CreateSurveyService.editQuestions.length != 0) {
                                         if (CreateSurveyService.editQuestions && CreateSurveyService.editQuestions[0].question) {
                                             for (var i = 0; i < $scope.data.length; i++) {
                                                 var found = 0;
                                                 var index = 0;

                                                 for (var j = 0; j < CreateSurveyService.editQuestions.length; j++) {

                                                     if (CreateSurveyService.editQuestions[j].id == $scope.data[i].id) {
                                                         found = 1;
                                                         break;
                                                         // console.log(CreateSurveyService.editQuestions[i].index);
                                                     }
                                                 }
                                                 if (found == 0) {
                                                     $scope.data[i].check = false;
                                                 }
                                                 else {
                                                     $scope.data[i].check = true;
                                                 }
                                             }



                                         }
                                     }
                                     checkSelectedQuestions();

                                 }
                             }

                         }, function (err) {
                             //some error
                             // console.log("Error: ", err);
                             $("#preloader").css("display", "none");
                         });
                 }

                 $scope.selectAllQuestions = function (check) {
                     var q = $scope.data
                     if (check) {
                         for (var i = 0; i < q.length; i++) {


                             var temp = {};
                             temp.question = q[i].questionText;
                             temp.id = q[i].id;
                             temp.section = q[i].section;
                             temp.sectionId = q[i].sectionId;
                             temp.ref_id = q[i].ref_id
                             temp.check = true;
                             q[i].check = true

                             if (q[i].options) {
                                 temp.options = JSON.parse(q[i].options)
                             } else {
                                 temp.options = null;
                             }
                             temp.index = i;
                             CreateSurveyService.editQuestions[i] = temp;



                         }




                     }
                     else {

                         for (var i = 0; i < q.length; i++) {


                             var temp = {};
                             temp.question = q[i].questionText;
                             temp.id = q[i].id;
                             temp.section = q[i].section;
                             temp.sectionId = q[i].sectionId;
                             temp.ref_id = q[i].ref_id
                             temp.check = false;
                             q[i].check = false
                             if (q[i].options) {
                                 temp.options = JSON.parse(q[i].options)
                             } else {
                                 temp.options = null;
                             }
                             temp.index = i;
                             $scope.data[i].check = false;
                             CreateSurveyService.editQuestions.pop()



                         }
                     }

                 }

                 $scope.addNewQuestion = function () {
                     AddQuestionService.setSelectedQuestion(null);
                     AddQuestionService.routeDecider = $stateParams.id
                     $state.go('AddQuestion');

                 }

                 $scope.editQuestion = function (question) {
                     AddQuestionService.setSelectedQuestion(question);
                     AddQuestionService.routeDecider = $stateParams.id
                     $state.go('AddQuestion');

                 }

                 $scope.selectedCheckbox = function (q, c, index) {
                     var dataCheck = CreateSurveyService.editQuestions;
                     console.log(q.id)
                     if (c) {
                         var temp = {};
                         temp.question = q.questionText;
                         temp.id = q.id;
                         temp.section = q.section;
                         temp.sectionId = q.sectionId;
                         temp.ref_id = q.ref_id
                         temp.check = c;
                         if (q.options) {
                             temp.options = JSON.parse(q.options)
                         } else {
                             temp.options = null;
                         }
                         temp.index = index;
                         CreateSurveyService.editQuestions.splice(index, 0, temp)
                         for (var t = 0; t < CreateSurveyService.validateQuestions.length; t++) {
                             if (CreateSurveyService.validateQuestions[t].id == q.id) {
                                 CreateSurveyService.validateQuestions.splice(t, 1)
                             }

                         }
                     }
                     else {
                         for (var i = 0; i < dataCheck.length; i++) {
                             if (q.id == dataCheck[i].id) {


                                 CreateSurveyService.editQuestions.splice(i, 1);

                             }
                         }
                         var temp = {};
                         temp.question = q.questionText;
                         temp.id = q.id;
                         temp.section = q.section;
                         temp.sectionId = q.sectionId;
                         temp.ref_id = q.ref_id
                         temp.check = c;
                         if (q.options) {
                             temp.options = JSON.parse(q.options)
                         } else {
                             temp.options = null;
                         }
                         temp.index = index;
                         CreateSurveyService.validateQuestions.push(temp)
                         // console.log( CreateSurveyService.editQuestions);
                     }
                     console.log(CreateSurveyService.editQuestions);
                 }
             }]
};

module.exports = _editCreateSurveyComponent;
/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 288 */
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function($) {

//angular
//    .module('AOTC')
//    .component('editViewSurveyComponent', _editViewSurveyComponent);

var _editViewSurveyComponent = {
    templateUrl: 'modules/SurveyModule/EditSurvey/EditableSurveysMenu/EditViewSurvey/EditViewSurvey.component.html',
    controllerAs: 'EditViewSurveyCtrl',
    controller:
    ["$scope", "sharedService", "CreateSurveyService", "ArrangeSurveyService", "AOTCService", "$timeout", "$state", "$stateParams",
                    function ($scope, sharedService, CreateSurveyService, ArrangeSurveyService, AOTCService, $timeout, $state, $stateParams) {
                        $scope.viewQuestions = [];
                        $scope.viewQuestions = ArrangeSurveyService.selectQuestions
                        $scope.sectionData = CreateSurveyService.editQuestions
                        console.log($scope.sectionData)
                        $scope.surveyName = ''
                        $scope.noticesNumber = 0;
                        $scope.noticesDates = [];
                        var length = 0;

                        $scope.dateFormat = 'MM-dd-yyyy';

                        $scope.availableDateOptions = {
                            formatYear: 'yy',
                            startingDay: 1,
                            minDate: new Date(1975, 1, 1),
                            maxDate: new Date(2030, 1, 1)
                        };




                        this.opneSaveSurveyModal = function () {
                            $('#confirmUpdateModal').modal('show');
                        };

                        this.UpdateSubmissions = function (_option) {
                            $scope.saveSurvey(_option);
                            $('#confirmUpdateModal').modal('hide');
                        };


                        $scope.saveSurvey = function (_updateSubmissions) {
                            $("#preloader").css("display", "block");
                            var user = localStorage.getItem('userId')
                            var temp = $scope.viewQuestions;
                            var sectionOrder = []
                            var surveyItems = [];

                            //if (_updateSubmissions)

                            for (i in temp) {
                                if (temp[i][temp[i].length - 1].sectionID) {
                                    sectionOrder[i] = { sectionId: temp[i][temp[i].length - 1].sectionID, sectionOrder: parseInt(i) }
                                }
                            }

                            var count = 0;

                            for (var i in temp) {
                                console.log(temp[i])
                                for (var j = 0; j < temp[i].length; j++) {


                                    if (temp[i][j].id) {

                                        surveyItems[count] = { questionId: [temp[i][j].id, temp[i][j].ref_id], questionOrder: count, sectionId: temp[i][temp[i].length - 1].sectionID }
                                        count += 1;
                                    }
                                }
                            }


                            var postData = { 'surveyId': $stateParams.id, 'surveyName': $scope.surveyName, 'modifiedBy': user, link: 'link', sectionOrder: sectionOrder, surveyItems: surveyItems, updateSubmissions: _updateSubmissions };
                            $scope.postData(postData)
                            console.log(postData)
                        }

                        $scope.setActive = function (data, options) {

                            console.log(options)
                            options.forEach(function (b) {
                                if (b.id == 1 || b.id == 3 || b.id == 4 || b.id == 5)
                                    b.answer.state = data === b;
                            });

                        }
                        $scope.addCalenderFields = function (numberOfFields, options) {

                            var length = 0;

                            if (options.length > numberOfFields) {
                                length = options.length - numberOfFields;
                                for (var i = 0; i < length; i++) {
                                    options.splice(options.length - 1, 1);
                                }
                            } else {
                                length = numberOfFields - options.length;
                                for (var i = 0; i < length; i++) {
                                    var obj = { opened: false, value: '' }
                                    options.push(obj);
                                }
                            }

                        }


                        $scope.dateValidation = function (data) {
                            console.log(data)
                        }
                        $scope.postData = function (postData) {

                            var url = 'surveys/updateSurvey';
                            AOTCService.postDataToServer(url, postData)
                                .then(function (result) {
                                    $("#preloader").css("display", "none");
                                    console.log("Survwey: ", result);
                                    $scope.surveyName = ''
                                    localStorage.removeItem("section")

                                    if (result.data.success) {
                                        $scope.$emit('success', result.data.message);
                                        $state.go('SurveyList')
                                    } else {
                                        $scope.$emit('danger', result.data.message);
                                    }
                                    $("#preloader").css("display", "none");

                                }, function (result) {
                                    $("#preloader").css("display", "none");
                                });
                        }


                        $scope.setNotices = function (data) {
                            if ($scope.noticesDates.length > data) {
                                length = $scope.noticesDates.length - data;
                                for (var i = 0; i < length; i++) {
                                    $scope.noticesDates.splice(i, 1);
                                }
                            } else {
                                length = data - $scope.noticesDates.length;
                                for (var i = 0; i < length; i++) {
                                    var obj = { opened: false, value: '' }
                                    $scope.noticesDates.push(obj);
                                }
                            }

                        }





                    }]


};
module.exports = _editViewSurveyComponent;
/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 289 */
/***/ (function(module, exports) {

_editSurveyCtrl.$inject = ["$scope", "CreateSurveyService"];
module.exports = _editSurveyCtrl;

//angular
//    .module('AOTC')
//    .controller('editSurveyCtrl', _editSurveyCtrl
//    );
function _editSurveyCtrl($scope, CreateSurveyService) {
    console.log('editSurvey')
    localStorage.removeItem("section")
    // CreateSurveyService.validateQuestions=[{}];
    // CreateSurveyService.editQuestions=[{}];
    if (CreateSurveyService.editQuestions[0]) {

        CreateSurveyService.editQuestions.length = 0;

    }
    if (CreateSurveyService.validateQuestions) {
        CreateSurveyService.validateQuestions.length = 0;
    }

    $scope.createSurveyRoute = true;
    $scope.viewSurveyRoute = false;
    $scope.arrangeQuestionsRoute = false;

    $scope.createSurvey = function () {
        // $state.go('Survey.CreateSurvey');
        // $scope.createSurvey=true;

        $scope.createSurveyRoute = true;
        $scope.viewSurveyRoute = false;
        $scope.arrangeQuestionsRoute = false

        $scope.loading = true;

    }

    $scope.viewSurvey = function () {
        //$state.go('Survey.ViewSurvey');

        $scope.createSurveyRoute = false;
        $scope.viewSurveyRoute = true;
        $scope.arrangeQuestionsRoute = false;

        $scope.loading = true;


    }

    $scope.arrangeQuestions = function () {
        //$state.go('Survey.ArrangeSurvey');
        console.log('ss')
        $scope.createSurveyRoute = false;
        $scope.viewSurveyRoute = false;
        $scope.arrangeQuestionsRoute = true;

        $scope.loading = true;

    }

}

/***/ }),
/* 290 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {

_FillSurvey.$inject = ["$state", "$stateParams",  "$scope", "FillSurveyService", "SurveySubmissionsService"];
module.exports = _FillSurvey;

//angular.module('AOTC').controller('FillSurvey', _FillSurvey
//);
function _FillSurvey($state, $stateParams, $scope, FillSurveyService, SurveySubmissionsService) {
    console.log("SurveyAnswer controller", $stateParams.id);


    $scope.viewQuestions = [];

    $scope.dateFormat = 'MM-dd-yyyy';
    $scope.opened = false;

    $scope.availableDateOptions = {
        formatYear: 'yy',
        startingDay: 1,
        minDate: new Date(1975, 1, 1),
        maxDate: new Date(2030, 1, 1)
    };
    $scope.intervieweeInformation = {};


    getUSstates();

    function getUSstates() {
        $("#preloader").css("display", "block");
        SurveySubmissionsService.getUSstates()
            .then(function (result) {
                $("#preloader").css("display", "none");
                console.log(result.data.result);
                $scope.states = result.data.result;
                $scope.intervieweeInformation.state = $scope.states[0].States;

            }, function (result) {
                console.log(result);
                $("#preloader").css("display", "none");
            });
    }


    $scope.addCalenderFields = function (numberOfFields, options) {

        FillSurveyService.getSurveyDetails($stateParams.id)
            .then(function (result) {
                console.log(result);

                var length = 0;

                if (options.length > numberOfFields) {
                    length = options.length - numberOfFields;
                    for (var i = 0; i < length; i++) {
                        options.splice(options.length - 1, 1);
                    }
                } else {
                    length = numberOfFields - options.length;
                    for (var i = 0; i < length; i++) {
                        var obj = { opened: false, value: '' }
                        options.push(obj);
                    }
                }

            });
    }

    $scope.setActive = function (data, options) {

        options.forEach(function (b) {
            if (b.id == 1 || b.id == 3 || b.id == 4 || b.id == 5)
                b.answer.state = data === b;
        });

    }

    $("#preloader").css("display", "block");


    FillSurveyService.getSurveyDetails($stateParams.id)
        .then(function (result) {
            console.log(result);
            $("#preloader").css("display", "none");

            if (!result.data.success) {
                $scope.$emit('error', result.data.message);
                return;
            }

            $scope.$emit('success', result.data.message);
            $scope.viewQuestions = result.data.result;

        }, function (result) {
            console.log(result);
            $("#preloader").css("display", "none");
        });


    $scope.intervieweeInformation = {};

    // $scope.showModalSubmissionName = function(infoForm){
    //      if (!infoForm.$valid) {
    //         angular.element("[name='" + infoForm.$name + "']").find('.ng-invalid:visible:first').focus();
    //         return false;
    //     }
    //     $('#myModalquestion').modal('toggle');
    // }
    $scope.saveSurveySubmission = function (name) {

        $("#preloader").css("display", "block");


        var postJSON = {
            surveyId: $stateParams.id,
            sections: $scope.viewQuestions.sections,
            information: $scope.intervieweeInformation
        };
        console.log(postJSON);

        FillSurveyService.saveSubmission(postJSON)
            .then(function (result) {
                $("#preloader").css("display", "none");

                console.log(result);

                if (!result.data.success) {
                    $scope.$emit('danger', result.data.message);
                    return;
                }


                $scope.$emit('success', result.data.message);
                setTimeout(function () {
                    $state.go('SubmissionList', { id: $stateParams.id });
                }, 2000);

            }, function (result) {
                console.log(result);
                $("#preloader").css("display", "none");
            });

    }
    $scope.dropDownClose = function (data, value) {
        $scope.intervieweeInformation.state = value;
        $('#menu').hide();
        console.log(data)

    }

}
/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 291 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


_FillSurveyService.$inject = ["$q","AOTCService"];
module.exports = _FillSurveyService;

//angular.module('AOTC')
//    .service('FillSurveyService', _FillSurveyService
//    );
function _FillSurveyService($q, AOTCService) {

    function getSurveyDetails(id) {
        var url = '/surveys/getSurveyById?id=' + id;

        var deferred = $q.defer();

        AOTCService.getDataFromServer(url)
            .then(function (result) {
                deferred.resolve(result);

            }, function (result) {
                deferred.reject(result);
                console.log(result);
            });
        return deferred.promise;

    };

    function getEditSurveyDetails(id) {
        var url = '/surveys/getEditedSurveyById?id=' + id;

        var deferred = $q.defer();

        AOTCService.getDataFromServer(url)
            .then(function (result) {
                deferred.resolve(result);

            }, function (result) {
                deferred.reject(result);
                console.log(result);
            });
        return deferred.promise;

    };


    function saveSubmission(data) {
        var url = '/surveys/submitSurvey';

        var deferred = $q.defer();

        AOTCService.postDataToServer(url, data)
            .then(function (result) {
                deferred.resolve(result);

            }, function (result) {
                deferred.reject(result);
                console.log(result);
            });
        return deferred.promise;

    };



    return {
        getSurveyDetails: getSurveyDetails,
        saveSubmission: saveSubmission,
        getEditSurveyDetails: getEditSurveyDetails
    };
}


/***/ }),
/* 292 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {

_SubmissionList.$inject = ["$stateParams", "$scope", "$state", "SubmissionListService"];
module.exports = _SubmissionList;

//angular.module('AOTC').controller('SubmissionList', _SubmissionList
//    );
function _SubmissionList($stateParams, $scope, $state, SubmissionListService) {


    $scope.GotoSurveySubmission = function (data) {
        console.log('212' + data.id)
        $state.go('SurveySubmissions', { id: data.id, surveyId: $stateParams.id });
    }

    $scope.GotoSurveyDeletion = function (_data) {
        $("#preloader").css("display", "block");
        var _obj = {
            "id": _data.id
        };
        SubmissionListService.deleteSubmission(_obj)
            .then(function (result) {

                if (!result.data.success) {
                    $scope.$emit('error', result.data.message);

                }
                else {
                    $scope.getSubmissions();
                }

                //$("#preloader").css("display", "none");

            }, function (result) {
                $("#preloader").css("display", "none");
            });
    };

    $scope.gotoSurveyAnswers = function () {

        $state.go('FillSurvey', { id: $stateParams.id });
    }

    $scope.getSubmissions = function () {
        $("#preloader").css("display", "block");

        SubmissionListService.getSubmissions($stateParams.id)
            .then(function (result) {
                //console.log(result);

                if (!result.data.success) {
                    $scope.$emit('error', result.data.message);
                }

                $scope.submissionData = result.data.result;

                $("#preloader").css("display", "none");

            }, function (result) {
                console.log(result);
                $("#preloader").css("display", "none");
            });
    }

}

/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 293 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


_SubmissionListService.$inject = ["$q","AOTCService"];
module.exports = _SubmissionListService;

//angular.module('AOTC')
//    .service('SubmissionListService', _SubmissionListService
//    );
function _SubmissionListService($q, AOTCService) {

    function getSubmissionDetails(id) {
        // var url = '/surveys/getSurveyById?id='+id;
        var url = '/surveys/getSubmittedSurveys?id=' + id
        var deferred = $q.defer();

        AOTCService.getDataFromServer(url)
            .then(function (result) {
                deferred.resolve(result);

            }, function (result) {
                deferred.reject(result);
                console.log(result);
            });
        return deferred.promise;

    };

    function deleteSubmission(data) {
        var url = '/surveys/deleteSubmission';

        var deferred = $q.defer();

        AOTCService.postDataToServer(url, data)
            .then(function (result) {
                deferred.resolve(result);

            }, function (result) {
                deferred.reject(result);
            });
        return deferred.promise;

    };



    return {
        getSubmissions: getSubmissionDetails,
        deleteSubmission: deleteSubmission
    };
}


/***/ }),
/* 294 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {

_SurveyList.$inject = ["$scope", "$location",  "$state", "SurveylistService"];
module.exports = _SurveyList;

//angular.module('AOTC').controller('SurveyList', _SurveyList
//    );
function _SurveyList($scope, $location, $state, SurveylistService) {
    console.log("SurveyList controller");
    $scope.surveyData=[];
    $scope.searchText='';

    $scope.getSurveyList=function () {
        $("#preloader").css("display", "block");

        SurveylistService.getAllSurvey().
        then(function(result) {
            $("#preloader").css("display", "none");

            var serverData = result.data;
            console.log(serverData)

            if (serverData.success) {
                if (serverData) {
                    $scope.surveyData=serverData.result;
                }
            }

        }, function(err) {
            //some error
            // console.log("Error: ", err);
            $("#preloader").css("display", "none");
        });
    }
    //==============================================DELETE SURVEY==========================
    $scope.selectedSurvey = {};
    
    $scope.onClickDeleteSurvey = function(survey){
        $scope.selectedSurvey = survey;
        $('#ConfirmModalquestion').modal('toggle');

    };

    $scope.GotoViewReports=function (data) {
        SurveylistService.name=data.surveyName;
        $state.go('Reports',{id:data.id});
    }

    $scope.deleteSurvey=function () {
        var json= {
            id:$scope.selectedSurvey.id
        };
        $("#preloader").css("display", "block");

        SurveylistService.deleteSurvey(json).
        then(function(result) {
            $("#preloader").css("display", "none");
            var serverData = result.data;

            if (serverData.success) {
                if (serverData) {
                    $scope.getSurveyList();
                    $scope.$emit('success',serverData.message);
                    return;
                }
                $scope.$emit('danger',serverData.message);

            }

        }, function(err) {
            //some error
            // console.log("Error: ", err);
            $("#preloader").css("display", "none");
        });
    }


    //==============================================DELETE SURVEY==========================
    
    $scope.GotoEditSurvey=function (data) {
        localStorage.removeItem("section")
        $state.go('EditSurvey',{id:data.id});
    }
    $scope.GotoSubmitAnswer = function(data){
        $state.go('FillSurvey',{id:data.id});
    }

    $scope.GotoViewSubmission = function(data){
        console.log(data)
        $state.go('SubmissionList',{id:data.id});
    }

}

/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 295 */
/***/ (function(module, exports) {

_SurveylistService.$inject = ["$q","AOTCService"];
module.exports = _SurveylistService;

//angular.module('AOTC')
//    .service('SurveylistService', _SurveylistService
//    );
function _SurveylistService($q, AOTCService) {
    var SurveyName;

    function getAllSurvey() {
        var url = '/surveys/getSurveysList';

        var deferred = $q.defer();

        AOTCService.getDataFromServer(url)
            .then(function (result) {
                deferred.resolve(result);

            }, function (result) {
                deferred.reject(result);
            });
        return deferred.promise;

    };


    function deleteSurvey(data) {
        var url = '/surveys/deleteSurvey';

        var deferred = $q.defer();

        AOTCService.postDataToServer(url, data)
            .then(function (result) {
                deferred.resolve(result);

            }, function (result) {
                deferred.reject(result);
            });
        return deferred.promise;

    };



    return {
        getAllSurvey: getAllSurvey,
        deleteSurvey: deleteSurvey
    };
}


/***/ }),
/* 296 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {

_SurveySubmissions.$inject = ["$state", "User_Config", "$q", "$stateParams", "$scope", "SurveySubmissionsService", "FillSurveyService"];
module.exports = _SurveySubmissions;

//angular.module('AOTC').controller('SurveySubmissions', _SurveySubmissions
//);
function _SurveySubmissions($state, User_Config, $q, $stateParams, $scope, SurveySubmissionsService, FillSurveyService) {
    console.log('SurveySubmissions', $stateParams)
    $scope.states = [];
    $scope.opened = false;

    $scope.availableDateOptions = User_Config.AVAILABLE_DATE_OPTIONS;
    $scope.dateFormat = User_Config.DATE_FORMAT;

    $scope.surveyId = $stateParams.surveyId;
    $scope.enableEdit = false;
    $scope.selectedNewOrUpdate = 0;

    $scope.Date = function (arg) {
        if (!arg) return;
        return new Date(arg);
    };

    $scope.setActive = function (data, options) {
        options.forEach(function (b) {
            if (b.id == 1 || b.id == 3 || b.id == 4 || b.id == 5)
                b.answer.state = data === b;
        });
    }

    $scope.addCalenderFields = function (numberOfFields, options) {

        var length = 0;

        if (options.length > numberOfFields) {
            length = options.length - numberOfFields;
            for (var i = 0; i < length; i++) {
                options.splice(options.length - 1, 1);
            }
        } else {
            length = numberOfFields - options.length;
            for (var i = 0; i < length; i++) {
                var obj = { opened: false, value: '' }
                options.push(obj);
            }
        }

    }


    function getSubmissions() {

        $("#preloader").css("display", "block");
        SurveySubmissionsService.getSurveySubmissions($stateParams.id)
            .then(function (result) {

                $("#preloader").css("display", "none");

                if (!result.data.success) {
                    $scope.$emit('danger', result.data.message);
                } else {
                    // $scope.$emit('success', result.data.message);
                    $scope.submissionData = result.data.result;
                    $scope.submissionData.information.dateCalled = new Date($scope.submissionData.information.dateCalled)
                }

            });

    }

    $scope.fetchData = function () {
        $("#preloader").css("display", "block");
        $q.all([
            SurveySubmissionsService.getSurveySubmissions($stateParams.id),
            SurveySubmissionsService.getUSstates()
        ])
            .then(function (data) {

                $("#preloader").css("display", "none");
                console.log(data);
                var result = data[0];
                if (!result.data.success) {
                    $scope.$emit('danger', result.data.message);
                } else {
                    // $scope.$emit('success', result.data.message);
                    $scope.submissionData = result.data.result;
                    $scope.submissionData.information.dateCalled = new Date($scope.submissionData.information.dateCalled)
                }

                $scope.states = data[1].data.result;
            });

    }



    function getUSstates() {
        SurveySubmissionsService.getUSstates()
            .then(function (result) {
                $scope.states = result.data.result;

            });
    }

    // $scope.askForName = function(infoForm) {
    //
    //     if (!infoForm.$valid) {
    //         angular.element("[name='" + infoForm.$name + "']").find('.ng-invalid:visible:first').focus();
    //         return false;
    //     }
    //     $('#myModalquestion').modal('toggle');
    //
    // }

    $scope.AddNewSurveyMetaData = function () {


        console.log('AddMewSurveyMetaData');
        console.log($scope.submissionData);

        var postJSON = {
            surveyId: $scope.surveyId,
            sections: $scope.submissionData.sections,
            information: $scope.submissionData.information
        };


        $("#preloader").css("display", "block");


        FillSurveyService.saveSubmission(postJSON)
            .then(function (result) {
                $("#preloader").css("display", "none");
                console.log(result);

                if (!result.data.success) {
                    $scope.$emit('danger', result.data.message);
                    return;
                }

                $scope.$emit('success', result.data.message);


                setTimeout(function () {
                    $state.go('SubmissionList', { id: $scope.surveyId });
                }, 2000);

            }, function (result) {
                console.log(result);
                $("#preloader").css("display", "none");
            });


    }


    $scope.UpdateSurveyMetaData = function (infoForm) {
        console.log('UpdateSurveyMetaData');


        if (!infoForm.$valid) {
            angular.element("[name='" + infoForm.$name + "']").find('.ng-invalid:visible:first').focus();
            return false;
        }
        console.log($scope.submissionData);

        $("#preloader").css("display", "block");
        SurveySubmissionsService.updateSubmittedForm($scope.submissionData)
            .then(function (result) {
                $("#preloader").css("display", "none");

                console.log(result);
                if (!result.data.success) {
                    $scope.$emit('danger', result.data.message);
                } else {
                    $scope.$emit('success', result.data.message);
                    getSubmissions();

                }

            }, function (result) {
                console.log(result);
                $("#preloader").css("display", "none");
            });
    }


    $scope.dropDownClose = function (data, value) {
        $scope.submissionData.information.state = value;
        $('#menu').hide();
        console.log(data)

    }
}

/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 297 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


_SurveySubmissionsService.$inject = ["$q","AOTCService"];
module.exports = _SurveySubmissionsService;

//angular.module('AOTC')
//    .service('SurveySubmissionsService', _SurveySubmissionsService
//    );
function _SurveySubmissionsService($q, AOTCService) {

    function getSurveySubmissions(id) {
        var url = '/surveys/getSubmittedSurveyById?id=' + id
        var deferred = $q.defer();

        AOTCService.getDataFromServer(url)
            .then(function (result) {
                deferred.resolve(result);

            }, function (result) {
                deferred.reject(result);
            });
        return deferred.promise;

    };


    function updateSubmittedForm(data) {
        var url = '/surveys/updateSubmittedForm'
        var deferred = $q.defer();

        AOTCService.postDataToServer(url, data)
            .then(function (result) {
                deferred.resolve(result);

            }, function (result) {
                deferred.reject(result);
            });
        return deferred.promise;

    };


    function getUSstates() {
        var url = '/surveys/getUSstates'
        var deferred = $q.defer();

        AOTCService.getDataFromServer(url)
            .then(function (result) {
                deferred.resolve(result);

            }, function (result) {
                deferred.reject(result);
            });
        return deferred.promise;

    };



    return {
        updateSubmittedForm: updateSubmittedForm,
        getSurveySubmissions: getSurveySubmissions,
        getUSstates: getUSstates
    };
}


/***/ }),
/* 298 */
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function($) {
_AddQuestionCtrl.$inject = ["$scope", "AddQuestionService",  "User_Config", "$state"];
module.exports = _AddQuestionCtrl;


//angular
//    .module('AOTC')
//    .controller('AddQuestionCtrl', _AddQuestionCtrl
//    );
function _AddQuestionCtrl($scope, AddQuestionService, User_Config, $state) {
    console.log("AddQuestionCtrl controller");

    $scope.dateFormat = User_Config.DATE_FORMAT;
    $scope.availableDateOptions = User_Config.AVAILABLE_DATE_OPTIONS;
    $scope.dropDownOptions = User_Config.DROPDOWN_OPTIONS_ANSWER_FIELD_TYPE;

    var vm = this;
    vm.questionOptions = [];

    $scope.newQuestion = {};
    vm.SaveNewQuestion = SaveNewQuestion;
    vm.editQuestion = false;

    var question = AddQuestionService.getSelectedQuestion();
    console.log(question);

    if (question) {
        vm.editQuestion = true;
        $scope.newQuestion = question;
        if (question.options)
            vm.questionOptions = JSON.parse(question.options);
    }

    $scope.SaveEditQuestion = function (newquestion) {
        $("#preloader").css("display", "block");
        console.log(newquestion)

        newquestion.options = JSON.stringify(vm.questionOptions);
        AddQuestionService.SaveEditedQuestion(newquestion)
            .then(function (result) {
                $("#preloader").css("display", "none");
                // console.log("result: ", result);

                if (!result.data.success) {
                    $scope.$emit('error', result.data.message);
                    return;
                }

                $scope.$emit('success', result.data.message);
                vm.questionOptions = [];
                setTimeout(function () {
                    var route = AddQuestionService.routeDecider;
                    if (route != "Surveys") {
                        $state.go($state.go('EditSurvey', { id: route }));

                    }
                    else {
                        $state.go("Survey");

                    }

                }, 2000);

            },
            function (err) {
                console.log("Error: ", err);
                $("#preloader").css("display", "none");
            });


    }


    $scope.valid = false
    $scope.questionText = '';

    function SaveNewQuestion(newquestion) {

        if (!newquestion.questionText) {
            $scope.valid = true;
        } else {
            $scope.valid = false;
            newquestion.options = JSON.stringify(vm.questionOptions);

            $("#preloader").css("display", "block");
            AddQuestionService.addNewQuestion(newquestion)
                .then(function (result) {
                    console.log("result: ", result);
                    $("#preloader").css("display", "none");


                    if (!result.data.success) {
                        $scope.$emit('error', result.data.message);
                        return;
                    }

                    $scope.$emit('success', result.data.message);
                    vm.questionOptions = [];
                    setTimeout(function () {
                        var route = AddQuestionService.routeDecider
                        console.log(route)
                        if (route != "Surveys") {
                            $state.go($state.go('EditSurvey', { id: route }));

                        }
                        else {
                            $state.go("Survey");

                        }
                    }, 2000);
                },
                function (err) {
                    console.log("Error: ", err);
                    $("#preloader").css("display", "none");
                });
        }
    }

}
/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 299 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


_AddQuestionService.$inject = ["$q","AOTCService"];
module.exports = _AddQuestionService;

//angular.module('AOTC')
//    .service('AddQuestionService', _AddQuestionService
//    );
function _AddQuestionService($q, AOTCService) {
    var selectedQuestion = null;
    var routeDecider = null;

    function setSelectedQuestion(question) {
        selectedQuestion = question;
    }

    function getSelectedQuestion() {
        return selectedQuestion;
    }

    function SaveEditedQuestion(data) {
        var url = '/surveys/updateQuestion';


        var deferred = $q.defer();

        AOTCService.postDataToServer(url, data)
            .then(function (result) {
                deferred.resolve(result);

            }, function (result) {
                deferred.reject(result);
                ////console.log(result);
            });
        return deferred.promise;
    }


    function addNewQuestion(data) {
        var url = '/surveys/addQuestion';

        var deferred = $q.defer();

        AOTCService.postDataToServer(url, data)
            .then(function (result) {
                deferred.resolve(result);

            }, function (result) {
                deferred.reject(result);
                ////console.log(result);
            });
        return deferred.promise;
    }




    return {
        setSelectedQuestion: setSelectedQuestion,
        getSelectedQuestion: getSelectedQuestion,
        addNewQuestion: addNewQuestion,
        SaveEditedQuestion: SaveEditedQuestion

    };
}


/***/ }),
/* 300 */
/***/ (function(module, exports) {




//angular
//    .module('AOTC')
//    .component('inputFields', _inputFields);

var _inputFields =  {
    templateUrl: 'modules/SurveyModule/Wizards/AddQuestion/generic-question-options.component.html',
    controllerAs: 'inputFields',
    bindings: {
        questionOptions: '='
    },
    controller: 
       ["$scope", "sharedService", "CreateSurveyService",
            function ($scope, sharedService, CreateSurveyService) {
                var vm = this;

                var selectedQuestions = [];
                var check;
                // vm.questionOptions = [];



                $scope.addOption = function (type) {

                    var option = {};

                    switch (type) {

                        case 0:
                            option = {
                                id: type,
                                inputValue: ''
                            }
                            break;

                        case 1:
                            option = {
                                id: type,
                                radioLabel: 'Text',
                            }
                            break;

                        case 2:
                            option = {
                                id: type,
                                checkboxLabel: 'Text',
                            }
                            break;

                        case 3:
                            option = {
                                id: type,
                                radioLabel: 'Text',
                                inputValue: ''
                            }
                            break;

                        case 4:
                            option = {
                                id: type,
                                radioLabel1: 'Text',
                                inputValue: '',
                                radioLabel2: 'Text',
                            }
                            break;

                        case 5:
                            option = {
                                id: type,
                                radioLabel: 'Text',
                                dropDownOptions: []
                            }
                            break;

                        case 6:
                            option = {
                                id: type,
                                checkboxLabel: 'Text',
                                dropDownOptions: []
                            }
                            break;

                        case 7:
                            option = {
                                id: type,
                                label: 'Text',
                                inputValue: ''
                            }
                            break;

                        case 8:
                            option = {
                                id: type,
                                inputValue: ''
                            }
                            break;

                        case 9:
                            option = {
                                id: type,
                                label: 'Text',
                                radioLabel1: 'Text',
                                radioLabel2: 'Text',
                            }
                            break;

                        case 10:
                            option = {
                                id: type,
                                label1: 'Text',
                                inputValue: '',
                                label2: 'Text',
                                radioLabel1: 'Text',
                                radioLabel2: 'Text'
                            }
                            break;



                        default:
                            break;

                    }

                    vm.questionOptions.push(option);
                }

            }]
};
module.exports = _inputFields;

/***/ }),
/* 301 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


_ArrangeSurveyCtrl.$inject = ["CreateSurveyService", "ArrangeSurveyService",  "$scope"];
module.exports = _ArrangeSurveyCtrl;

//angular.module('AOTC')
//    .controller('ArrangeSurveyCtrl', _ArrangeSurveyCtrl);
function _ArrangeSurveyCtrl(CreateSurveyService, ArrangeSurveyService, $scope) {
    //////console.log("Arrange Survey controller");

}

/***/ }),
/* 302 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


_ArrangeSurveyService.$inject = ["$q","AOTCService"];
module.exports = _ArrangeSurveyService;


//angular.module('AOTC')
//    .service('ArrangeSurveyService', _ArrangeSurveyService
//    );

function _ArrangeSurveyService($q, AOTCService) {
    this.selectQuestions = {};


    function getAllSections() {
        var url = '/surveys/getSections';

        var deferred = $q.defer();

        AOTCService.getDataFromServer(url)
            .then(function (result) {
                deferred.resolve(result);

            }, function (result) {
                deferred.reject(result);
                ////console.log(result);
            });
        return deferred.promise;

    };

    function addSection(data) {
        var url = '/surveys/addSection';

        var deferred = $q.defer();

        AOTCService.postDataToServer(url, data)
            .then(function (result) {
                deferred.resolve(result);

            }, function (result) {
                deferred.reject(result);
                ////console.log(result);
            });
        return deferred.promise;
    }

    return {
        getAllSections: getAllSections,
        addSection: addSection

    };
}


/***/ }),
/* 303 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


//_ArrangeSurveyUtil.$inject = [];
//module.exports = _ArrangeSurveyUtil;

angular.module('AOTC')
    .service('ArrangeSurveyUtil', function _ArrangeSurveyUtil() {

    });


/***/ }),
/* 304 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


_CreateSurveyService.$inject = ["$q","AOTCService"];
module.exports = _CreateSurveyService;

//angular.module('AOTC')
//    .factory('CreateSurveyService', _CreateSurveyService
//    );
function _CreateSurveyService($q, AOTCService) {
    this.selectQuestions = {};

    function getAllQuestions() {
        var url = '/surveys/getQuestions';

        var deferred = $q.defer();

        AOTCService.getDataFromServer(url)
            .then(function(result) {
                deferred.resolve(result);

            }, function(result) {
                deferred.reject(result);
                console.log(result);
            });
        return deferred.promise;
    }

       

    function deleteQuestion(data) {
        var url = '/surveys/deleteQuestion';

        var deferred = $q.defer();

        AOTCService.postDataToServer(url , data)
            .then(function(result) {
                deferred.resolve(result);

            }, function(result) {
                deferred.reject(result);
                console.log(result);
            });
        return deferred.promise;
    }

    return {
        getAllQuestions: getAllQuestions,
        deleteQuestion:deleteQuestion,
        questions: [{}],
        editQuestions: [{}],
        selectedSections: [{}],
        defaultModel:{},
        validateQuestions: [],
        variableSelected: [{}],

    };
}


/***/ }),
/* 305 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


//_CreateSurveyUtil.$inject = [];
//module.exports = _CreateSurveyUtil;

angular.module('AOTC')
    .service('CreateSurveyUtil', function _CreateSurveyUtil() {

    });


/***/ }),
/* 306 */
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function($) {


//angular
//    .module('AOTC')
//    .component('createSurveyComponent', _createSurveyComponent);

var _createSurveyComponent = {
    templateUrl: 'modules/SurveyModule/Wizards/CreateSurvey/CreateSurvey.html',
    controllerAs: 'CreateSurveyCtrl',
    controller:
       ["$scope", "$state", "CreateSurveyService", "$timeout", "AddQuestionService",
           function ($scope, $state, CreateSurveyService, $timeout, AddQuestionService) {
               console.log("Create Survey controller");
               var vm = this;
               getAllQuestions();


               function getAllQuestions() {
                   $("#preloader").css("display", "block");

                   CreateSurveyService.getAllQuestions().
                       then(function (result) {
                           $("#preloader").css("display", "none");

                           var serverData = result.data;

                           if (serverData.success) {
                               if (serverData) {
                                   vm.data = serverData.result;
                                   console.log(CreateSurveyService.questions)
                                   console.log(vm.data)
                                   if (CreateSurveyService.questions.length != 0) {
                                       if (CreateSurveyService.questions && CreateSurveyService.questions[0].question) {
                                           for (var i = 0; i < vm.data.length; i++) {
                                               var found = 0;
                                               var index = 0;

                                               for (var j = 0; j < CreateSurveyService.questions.length; j++) {

                                                   if (CreateSurveyService.questions[j].id == vm.data[i].id) {
                                                       console.log(i)
                                                       found = 1;
                                                       break;
                                                       // console.log(CreateSurveyService.questions[i].index);
                                                   }
                                               }
                                               if (found == 0) {
                                                   vm.data[i].check = false;
                                               }
                                               else {
                                                   vm.data[i].check = true;
                                               }
                                           }



                                       }
                                   }
                               }
                           }

                       }, function (err) {
                           //some error
                           // console.log("Error: ", err);
                           $("#preloader").css("display", "none");
                       });
               }
               $scope.selectAll = false;
               $scope.selectAllQuestions = function (check) {

                   var q = vm.data
                   if (check) {
                       for (var i = 0; i < q.length; i++) {


                           var temp = {};
                           temp.question = q[i].questionText;
                           temp.id = q[i].id;
                           temp.section = q[i].section;
                           temp.sectionId = q[i].sectionId;
                           temp.ref_id = q[i].ref_id
                           temp.check = true;
                           q[i].check = true

                           if (q[i].options) {
                               temp.options = JSON.parse(q[i].options)
                           } else {
                               temp.options = null;
                           }
                           temp.index = i;
                           CreateSurveyService.questions[i] = temp;



                       }



                   }
                   else {
                       console.log("untick")

                       for (var i = 0; i < q.length; i++) {


                           var temp = {};
                           temp.question = q[i].questionText;
                           temp.id = q[i].id;
                           temp.section = q[i].section;
                           temp.sectionId = q[i].sectionId;
                           temp.ref_id = q[i].ref_id
                           temp.check = false;
                           q[i].check = false
                           if (q[i].options) {
                               temp.options = JSON.parse(q[i].options)
                           } else {
                               temp.options = null;
                           }
                           temp.index = i;
                           vm.data[i].check = false;
                           console.log(vm.data[i])

                           CreateSurveyService.questions.pop()



                       }
                   }

               }

               vm.selectedCheckbox = function (q, c, index) {
                   var dataCheck = CreateSurveyService.questions;
                   console.log(q.id)
                   if (c) {
                       var temp = {};
                       temp.question = q.questionText;
                       temp.id = q.id;
                       temp.section = q.section;
                       temp.sectionId = q.sectionId;
                       temp.ref_id = q.ref_id
                       temp.check = c;
                       if (q.options) {
                           temp.options = JSON.parse(q.options)
                       } else {
                           temp.options = null;
                       }
                       temp.index = index;
                       CreateSurveyService.questions.splice(index, 0, temp)
                       console.log("inserting:---" + temp.question + " " + index)
                   }
                   else {
                       console.log(index)
                       for (var i = 0; i < dataCheck.length; i++) {
                           if (q.id == dataCheck[i].id) {
                               console.log(q)
                               console.log(i)

                               CreateSurveyService.questions.splice(i, 1);

                           }
                       }

                       // console.log( CreateSurveyService.questions);


                   }
                   console.log(CreateSurveyService.questions);

               }

               $scope.deleteQuestions = function (q) {
                   $("#preloader").css("display", "none");
                   CreateSurveyService.deleteQuestion(q)
                       .then(function (result) {
                           console.log("result: ", result);

                           if (!result.data.success) {
                               $scope.$emit('error', result.data.message);
                               return;
                           }
                           $scope.$emit('success', result.data.message);
                           getAllQuestions()
                       },
                       function (err) {
                           console.log("Error: ", err);
                           $("#preloader").css("display", "none");
                       });

               }

               $scope.addNewQuestion = function () {
                   AddQuestionService.setSelectedQuestion(null);
                   AddQuestionService.routeDecider = "Surveys"
                   $state.go('AddQuestion');

               }

               $scope.editQuestion = function (question) {
                   AddQuestionService.setSelectedQuestion(question);
                   AddQuestionService.routeDecider = "Surveys"
                   $state.go('AddQuestion');

               }


               $('#closemodal').click(function () {
                   $('#modalwindow').modal('hide');
               });
           }],



}
module.exports = _createSurveyComponent;
/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 307 */
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function($) {
_sectionSettingsCtrl.$inject = ["$scope", "sectionSettingsService", "CreateSurveyService", "$state"];
module.exports = _sectionSettingsCtrl;

//angular
//    .module('AOTC')
//    .controller('sectionSettingsCtrl', _sectionSettingsCtrl
//    );
function _sectionSettingsCtrl($scope, sectionSettingsService, CreateSurveyService, $state) {
    console.log("sectionSettings controllersssssssssssssssssssssss");
    $("#preloader").css("display", "block");


    $scope.getallSections =function () {

        console.log('data')

        sectionSettingsService.getAllSections().
            then(function(result) {
                var serverData = result.data;
                if (serverData.success) {
                    if(serverData) {
                        $scope.sections = serverData.result;
                        console.log( $scope.sections)

                    }

                }
                $("#preloader").css("display", "none");

            }, function(err) {
                //some error
                console.log("Error: ", err);
                $("#preloader").css("display", "none");
            })

    }






    $scope.openModal=function (data) {
        $scope.postSection={id:null,sectionText:null}
        console.log(data)
        $scope.postSection.id=data.sectionId;
        $scope.postSection.sectionText=data.section
        console.log($scope.postSection)
        $('#myModalquestion').modal('show');
    }

    $scope.editSection=function (data) {
        $("#preloader").css("display", "none");
        console.log(data)
        sectionSettingsService.addSection(data).then(function (result) {
            var serverData = result.data;
            $('#myModalquestion').modal('toggle');
            if (serverData.success) {
                $scope.$emit('success', result.data.message);
                if (serverData) {
                    $scope.getallSections();
                }
            }
            else {
                $scope.$emit('danger', result.data.message);
            }
            $("#preloader").css("display", "none");

        }, function (err) {
            //some error
            console.log("Error: ", err);
            $("#preloader").css("display", "none");
        })

    }

    $scope.removeSection=function (data) {
        postData={id:data.sectionId}
        console.log("removing")
        $("#preloader").css("display", "none");
        console.log(data)
        sectionSettingsService.deleteSection(postData).then(function (result) {
            var serverData = result.data;

            if (serverData.success) {
                $scope.$emit('success', result.data.message);
                if (serverData) {
                    $scope.getallSections();
                }
            }
            else {
                $scope.$emit('danger', result.data.message);
            }
            $("#preloader").css("display", "none");

        }, function (err) {
            //some error
            console.log("Error: ", err);
            $("#preloader").css("display", "none");
        })
    }

    $scope.goback = function () {
        $state.go('Survey')
    }



}
/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 308 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


_sectionSettingsService.$inject = ["$q","AOTCService"];
module.exports = _sectionSettingsService;

//angular.module('AOTC')
//    .service('sectionSettingsService', _sectionSettingsService
//    );
function _sectionSettingsService($q, AOTCService) {
    this.selectQuestions = {};


    function getAllSections() {
        var url = '/surveys/getSections';

        var deferred = $q.defer();

        AOTCService.getDataFromServer(url)
            .then(function (result) {
                deferred.resolve(result);

            }, function (result) {
                deferred.reject(result);
                ////console.log(result);
            });
        return deferred.promise;

    };

    function addSection(data) {
        var url = '/surveys/updateSection';

        var deferred = $q.defer();

        AOTCService.postDataToServer(url, data)
            .then(function (result) {
                deferred.resolve(result);

            }, function (result) {
                deferred.reject(result);
                ////console.log(result);
            });
        return deferred.promise;
    }

    function deleteSection(data) {
        var url = '/surveys/deleteSection';

        var deferred = $q.defer();

        AOTCService.postDataToServer(url, data)
            .then(function (result) {
                deferred.resolve(result);

            }, function (result) {
                deferred.reject(result);
                ////console.log(result);
            });
        return deferred.promise;
    }

    return {
        getAllSections: getAllSections,
        addSection: addSection,
        deleteSection: deleteSection

    };
}


/***/ }),
/* 309 */
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function($) {


//angular
//    .module('AOTC')
//    .component('viewSurveyController', _viewSurveyController);

var _viewSurveyController = {
    templateUrl: 'modules/SurveyModule/Wizards/ViewSurvey/ViewSurvey.html',
    controllerAs: 'ViewSurveyCtrl',
    controller:
        ["$scope", "sharedService", "CreateSurveyService", "ArrangeSurveyService", "AOTCService", "$timeout", "$state",
            function ($scope, sharedService, CreateSurveyService, ArrangeSurveyService, AOTCService, $timeout, $state) {
                $scope.viewQuestions = [];
                $scope.viewQuestions = ArrangeSurveyService.selectQuestions
                $scope.surveyName = ''
                $scope.noticesNumber = 0;
                $scope.noticesDates = [];
                var length = 0;

                $scope.dateFormat = 'MM-dd-yyyy';

                $scope.availableDateOptions = {
                    formatYear: 'yy',
                    startingDay: 1,
                    minDate: new Date(1975, 1, 1),
                    maxDate: new Date(2030, 1, 1)
                };



                $scope.saveSurvey = function () {
                    $("#preloader").css("display", "block");
                    var user = localStorage.getItem('userId')
                    var temp = $scope.viewQuestions;
                    var sectionOrder = []
                    var surveyItems = []

                    for (i in temp) {
                        if (temp[i][temp[i].length - 1].sectionID) {
                            sectionOrder[i] = { sectionId: temp[i][temp[i].length - 1].sectionID, sectionOrder: parseInt(i) }
                        }
                    }

                    var count = 0;

                    for (var i in temp) {
                        console.log(temp[i])
                        for (var j = 0; j < temp[i].length; j++) {


                            if (temp[i][j].id) {

                                surveyItems[count] = { questionId: temp[i][j].id, questionOrder: count, sectionId: temp[i][temp[i].length - 1].sectionID }
                                count += 1;
                            }
                        }
                    }

                    $('#myModalquestion').modal('toggle');

                    var postData = { 'surveyName': $scope.surveyName, 'createdBy': user, link: 'link', sectionOrder: sectionOrder, surveyItems: surveyItems }
                    $scope.postData(postData)
                    console.log(postData)
                }

                $scope.setActive = function (data, options) {

                    console.log(options)
                    options.forEach(function (b) {
                        if (b.id == 1 || b.id == 3 || b.id == 4 || b.id == 5)
                            b.answer.state = data === b;
                    });

                }
                $scope.addCalenderFields = function (numberOfFields, options) {

                    var length = 0;

                    if (options.length > numberOfFields) {
                        length = options.length - numberOfFields;
                        for (var i = 0; i < length; i++) {
                            options.splice(options.length - 1, 1);
                        }
                    } else {
                        length = numberOfFields - options.length;
                        for (var i = 0; i < length; i++) {
                            var obj = { opened: false, value: '' }
                            options.push(obj);
                        }
                    }

                }


                $scope.dateValidation = function (data) {
                    console.log(data)
                }
                $scope.postData = function (postData) {

                    var url = 'surveys/addSurvey';
                    AOTCService.postDataToServer(url, postData)
                        .then(function (result) {
                            $("#preloader").css("display", "none");
                            console.log("Survwey: ", result);
                            $scope.surveyName = ''

                            if (result.data.success) {
                                $scope.$emit('success', result.data.message);
                                $state.go('SurveyList')
                            } else {
                                $scope.$emit('danger', result.data.message);
                            }
                            $("#preloader").css("display", "none");

                        }, function (result) {
                            $("#preloader").css("display", "none");
                        });
                }


                $scope.setNotices = function (data) {
                    if ($scope.noticesDates.length > data) {
                        length = $scope.noticesDates.length - data;
                        for (var i = 0; i < length; i++) {
                            $scope.noticesDates.splice(i, 1);
                        }
                    } else {
                        length = data - $scope.noticesDates.length;
                        for (var i = 0; i < length; i++) {
                            var obj = { opened: false, value: '' }
                            $scope.noticesDates.push(obj);
                        }
                    }

                }





            }]



};

module.exports = _viewSurveyController;

/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 310 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


_WizardsViewerCtrl.$inject = ["$scope","$location","$state"];
module.exports = _WizardsViewerCtrl;

//angular.module('AOTC').controller('WizardsViewerCtrl', _WizardsViewerCtrl
//    );
function _WizardsViewerCtrl($scope, $location, $state) {
    console.log("WizardsViewerCtrl controller");
    var vm = this;
    vm.isActive = isActive;
    vm.arrangeQuestions = arrangeQuestions;
    vm.createSurvey = createSurvey;
    vm.viewSurvey = viewSurvey;
    $scope.loading=false;
    function isActive(viewLocation) {

        return viewLocation === $location.path();
    }
    $scope.createSurveyRoute=true;
    $scope.viewSurveyRoute=false;
    $scope.arrangeQuestionsRoute=false;

    function createSurvey() {
        // $state.go('Survey.CreateSurvey');
        // $scope.createSurvey=true;
        
        $scope.createSurveyRoute=true;
        $scope.viewSurveyRoute=false;
        $scope.arrangeQuestionsRoute=false

        $scope.loading=true;

    }

    function viewSurvey() {
        //$state.go('Survey.ViewSurvey');

        $scope.createSurveyRoute=false;
        $scope.viewSurveyRoute=true;
        $scope.arrangeQuestionsRoute=false;

        $scope.loading=true;


    }

    function arrangeQuestions() {
        //$state.go('Survey.ArrangeSurvey');
        console.log('ss')
        $scope.createSurveyRoute=false;
        $scope.viewSurveyRoute=false;
        $scope.arrangeQuestionsRoute=true;

        $scope.loading=true;

    }

}

/***/ }),
/* 311 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


//var angular = require('angular');

angular.module('AOTC').controller('TaskManagerCtrl', __webpack_require__(312));
angular.module('AOTC').service('taskService', __webpack_require__(313));

/***/ }),
/* 312 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {

_TaskManagerCtrl.$inject = ["$stateParams", "$state", "$location", "$scope", "$interval", "taskService", "$http", "__env", "$log", "AOTCService", "$timeout"];
module.exports = _TaskManagerCtrl;

//angular.module('AOTC').controller('TaskManagerCtrl', _TaskManagerCtrl
//    );

function _TaskManagerCtrl($stateParams, $state, $location, $scope, $interval, taskService, $http, __env, $log, AOTCService, $timeout) {
    ////console.log('task manager controller', $stateParams);
    $timeout(function() {
        if ($stateParams.messageFrom) {
            $scope.$emit('success', $stateParams.message)
        }
    }, 500);
    var flag = true;
    // I contain the list of friends to be rendered.
    $("#preloader").css('display', 'block');

    var loadRemoteData = function() {
        // The friendService returns a promise.
        taskService.getTasks().then(
            function(tasks) {
                ////console.log(tasks);
                applyRemoteData(tasks);
            });
    }

    loadRemoteData();
    var dataLoader = $interval(loadRemoteData, 5000);
    $scope.$on('$destroy', function() {
        $interval.cancel(dataLoader);
    });

    $scope.getDayDifference = function(task) {
        var date1 = new Date(task.uploadTime);
        var date2 = new Date();
        var timeDiff = Math.abs(date2.getTime() - date1.getTime());
        var diffDays = Math.ceil(timeDiff / (1000 * 3600 * 24));
        var old = false;

        if (diffDays > 1) {
            old = true;
        }
        return old;
    }

    // I apply the remote data to the local scope.

    $scope.gotoProperties = function(task) {
        ////console.log('i clicked')
        $("#preloader").css('display', 'block');
        
        localStorage.setItem('propertyId', task.propertyId);

        var propertyId = localStorage.getItem("propertyId");
        taskService.getPropertyDetails().then(
            function(props) {
                ////console.log('----->'+props)

                $("#preloader").css('display', 'none');

                if (task.type == "IE" && task.propertyId !== "-1") {
                    localStorage.setItem('propertyDetails', angular.toJson(props.result[0].n.properties));

                    $state.go('viewIERR.income_expense');
                } else if (task.type == "RR" && task.propertyId !== "-1") {
                    localStorage.setItem('propertyDetails', angular.toJson(props.result[0].n.properties));

                    $state.go('viewIERR.rent_role');
                } else {
                    $state.go('PropertyList.private_property_list');
                }
            });
    }

    $scope.gotoPrivateProps = function(task) {
        $state.go('PropertyList.private_property_list');
    }



    function applyRemoteData(newTasks) {
        if (newTasks.success) {
            $scope.tasks = [];
            $scope.tasks = newTasks.result;
        }
        $("#preloader").css('display', 'none');

    }

}
/**
 * Created by MW Team 3 on 4/21/2017.
 */

/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 313 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/**
 * Created by MW Team 3 on 4/23/2017.
 */


_taskService.$inject = ["$http", "$q", "$location"];
module.exports = _taskService;


//angular.module('AOTC')
//    .service(
//    "taskService", _taskService
    
//);
function _taskService($http, $q, $location) {
    // Return public API.
    return({

        getTasks: getTasks,
        getPropertyDetails: getPropertyDetails

    });
    // ---
    // PUBLIC METHODS.
    // ---

    /// I get all of the tasks in the remote collection.
    function getTasks() {
        var request = $http({
            method: "get",
            url: "/taskManager/getTasksByUserId",
            params: {
                action: "get"
            }
        });
        return( request.then( handleSuccess, handleError ) );
    }
        
    function getPropertyDetails() {
        var request = $http({
            method: "POST",
            url: "/properties/getPropertiesById",
            data: {
                propId: parseInt(localStorage.getItem("propertyId"))
            }
        });
        return( request.then( handleSuccess, handleError ) );
    }

    // ---
    // PRIVATE METHODS.
    // ---
    // I transform the error response, unwrapping the application dta from
    // the API response payload.
    function handleError( response ) {
        // The API response from the server should be returned in a
        // nomralized format. However, if the request was not handled by the
        // server (or what not handles properly - ex. server error), then we
        // may have to normalize it on our end, as best we can.
        if (
            ! angular.isObject( response.data ) ||
            ! response.data.message
        ) {
            return( $q.reject( "An unknown error occurred." ) );
        }
        // Otherwise, use expected error message.
        return( $q.reject( response.data.message ) );
    }
    // I transform the successful response, unwrapping the application data
    // from the API response payload.
    function handleSuccess( response ) {
        return( response.data );
    }

    function handleSuccessPropertyData( response ) {
        ////console.log('****** response is',response)
        return( response);
    }
}





/***/ }),
/* 314 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


//var angular = require('angular');

//******MultipleRegistration
angular.module('AOTC').controller('UserRegistration', __webpack_require__(315));


//******SingleRegistration

angular.module('AOTC').controller('Registered', __webpack_require__(316));

angular.module('AOTC').controller('UserRolesListCtrl', __webpack_require__(317));

//*Inventory
angular.module('AOTC').controller('InventoryCtrl', __webpack_require__(318));


/***/ }),
/* 315 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {

_UserRegistration.$inject = ["$anchorScroll", "$state", "DTOptionsBuilder", "DTColumnDefBuilder", "$location", "$scope", "$http", "__env", "$log", "AOTCService", "$timeout"];
module.exports = _UserRegistration;


//angular.module('AOTC').controller('UserRegistration', _UserRegistration
//    );
function _UserRegistration($anchorScroll, $state, DTOptionsBuilder, DTColumnDefBuilder, $location, $scope, $http, __env, $log, AOTCService, $timeout) {
    //////console.log("UserRegistration controller");
    var vm = this;
    //==========================Variables======================================//
    $scope.popup_custom_success = "";
    var userId = localStorage.getItem("userId");
    vm.dtOptions = DTOptionsBuilder.newOptions()
        .withOption('order', [
            [1, 'asc']
        ])
        .withOption('lengthMenu', [
            [20, 50, 100, -1],
            [20, 50, 100, "All"]
        ])
        .withDisplayLength(20);
    vm.dtColumnDefs = [
        DTColumnDefBuilder.newColumnDef(0).notSortable()
    ];
    //==========================Attributes======================================//
    vm.showTableRelatedDivs = false;
    vm.old = $location.hash();
    vm.myFile = "";
    vm.fileName = "";
    vm.checkAll = 1;
    vm.emailSubject = "We'd like you to add as designee";
    vm.usersToBeRegistered = [];
    vm.data = 'none';
    //==========================Behaviour======================================//


    vm.toggleCheckAll = toggleCheckAll;
    vm.toggleState = toggleState;
    vm.submitUserRegistrationData = submitUserRegistrationData;

    vm.upload = function (data) {
        //////console.log(vm.myFile);
        //////console.log(data);
    }

    $scope.fileNameChanged = function () {
        //////console.log('file used');
        vm.usersToBeRegistered = [];
        var result = [];
        $scope.$digest();
        var files = document.getElementById('file-1').files;
        vm.fileName = files[0].name;
        var url = '/users/uploadUserFile';
        $scope.$apply();


        AOTCService.uploadFiles(url, files)
            .then(function (result) {
                ////console.log(result);

                if (result.data.success) {
                    //////console.log('show mee')
                    vm.showTableRelatedDivs = true;
                    vm.usersToBeRegistered = result.data.result;
                    // $scope.popup_custom_success= "File  successfully";
                    // $scope.$digest();
                    // $scope.$apply();
                    // $("#popup_custom_success").fadeIn(1500).delay(500).fadeOut(500);


                } else {
                    //show error
                    vm.showTableRelatedDivs = false;
                    $("#error_main").fadeIn(1500).delay(500).fadeOut(500);
                }
                //$anchorScroll();
                $("#preloader").css("display", "none");

            }, function (result) {
                $("#preloader").css("display", "none");
                //////console.log(file);
                vm.fileName = file.name;

            });
    }

    function submitUserRegistrationData() {
        $('#myModalinvite').modal("toggle");
        $("#preloader").css("display", "block");

        // //////console.log(vm.usersToBeRegistered);
        var now = new Date;

        var utc_timestamp = Date.UTC(now.getUTCFullYear(), now.getUTCMonth(), now.getUTCDate(),
            now.getUTCHours(), now.getUTCMinutes(), now.getUTCSeconds(), now.getUTCMilliseconds());

        var arrOfUsers = [];

        for (var i = 0; i < vm.usersToBeRegistered.length; i++) {
            var obj = vm.usersToBeRegistered[i]

            if (obj.state == 1) {

                var data = {
                    name: obj.firstName,
                    lastName: obj.lastName,
                    company: obj.company,
                    city: obj.city,
                    email1: obj.userEmail,
                    role: obj.role
                };

                arrOfUsers.push(data);
            }
        }

        var toSend = {
            bulkUsers: arrOfUsers,
            emailSubject: vm.emailSubject
        };

        //////console.log(toSend);

        var url = '/users/addBulkUsersRef';

        AOTCService.postDataToServer(url, toSend)
            .then(function (result) {
                //////console.log(result);

                if (result.data.success) {

                    $("#preloader").css("display", "none");
                    $state.go('Registered', { messageFrom: "bulkUserRegistration" });

                }



            }, function (result) {
                //some error
                $("#preloader").css("display", "none");

                //////console.log(result);
            });

    }
    //-----------------------------------------------
    // upload file 
    //-----------------------------------------------

    $scope.uploadFile = function (event) {
        //////console.log(event);

    }
    //-----------------------------------------------
    // ui manipulation
    //-----------------------------------------------

    function toggleCheckAll() {
        $timeout(function () {

            vm.checkAll = +!vm.checkAll;
            if (vm.checkAll) {
                setDataState(vm.usersToBeRegistered, 1);

            } else {
                setDataState(vm.usersToBeRegistered, 0);
            }
        }, 100);
    }

    function setDataState(users, state) {

        for (var i = 0; i < users.length; i++) {
            users[i].state = state;
        }
    }

    function toggleState(user) {
        user.state = +!user.state;
        vm.checkAll = 0; //future change this one
        //if all user have this state stateof th will be that one also
    }
}

/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 316 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {

_Registered.$inject = ["$stateParams", "$rootScope", "DTOptionsBuilder", "DTColumnDefBuilder", "$location", "$scope", "$http", "__env", "$log", "AOTCService", "$timeout"];
module.exports = _Registered;

//angular.module('AOTC').controller('Registered', _Registered
//    );
function _Registered($stateParams, $rootScope, DTOptionsBuilder, DTColumnDefBuilder, $location, $scope, $http, __env, $log, AOTCService, $timeout) {
    ////console.log("Registered controller", $stateParams);
    var vm = this;

    if ($stateParams.messageFrom == "bulkUserRegistration") {
        $timeout(function () {
            $scope.$emit('success', 'Invitation sent successfully');
        }, 100);
    }

    //==========================Variables======================================//
    var userId = localStorage.getItem("userId");
    vm.dtOptions = DTOptionsBuilder.newOptions()
        .withDisplayLength(20)
        .withOption('lengthMenu', [
            [20, 50, 100, -1],
            [20, 50, 100, "All"]
        ])
        .withOption('order', [
            [2, 'desc']
        ]);
    vm.dtColumnDefs = [];
    //==========================Attributes======================================//
    vm.tableData = [];
    vm.emailSubject = "";
    vm.anotherUserActive = 0;
    vm.data = {
        name: "",
        lastName: "",
        company: "",
        city: "",
        email1: "",
        role: ""
    };

    //==========================Behaviour======================================//
    vm.showEmailPopup = showEmailPopup;
    vm.addNewUser = addNewUser;
    vm.anotherUserToggle = anotherUserToggle;

    getUsers();

    function getUsers() {
        var url = '/users/getAllInvitedUsers?adminId=' + userId;
        ////console.log(url);
        $("#preloader").css("display", "block");

        AOTCService.getDataFromServer(url)
            .then(function (result) {

                ////console.log('----------Serverdata : getAllInvitedUsers--------------');
                ////console.log(result);

                if (result.data.success) {
                    vm.tableData = result.data.result;

                    $("#preloader").css("display", "none");
                    if (vm.tableData.length == 0) {
                        $scope.$emit('error', 'No Data Found');
                    }


                } else {
                    $scope.$emit('error', result.data.message)
                }

            }, function (result) {
                //some error
                //////console.log(result);
            });
    }

    function showEmailPopup() {

        vm.emailSubject = "We'd like you to add as Designee";
        $('#myModal').modal('toggle');
        $('#myModalinvite').modal('toggle'); //email body modal

    }

    function addNewUser() {

        var url = '/users/addBulkUsersRef';
        $('#myModalinvite').modal('toggle');
        var arrOfUsers = [];
        arrOfUsers.push(vm.data); // because our endpoint receive array
        var toSend = {
            bulkUsers: arrOfUsers,
            emailSubject: vm.emailSubject
        };

        $("#preloader").css("display", "block");

        AOTCService.postDataToServer(url, toSend)
            .then(function (result) {
                ////console.log(result);
                if (result.data.success) {

                    $("#preloader").css("display", "none");

                    vm.data = {
                        name: "",
                        lastName: "",
                        company: "",
                        city: "",
                        email1: "",
                        role: ""
                    };
                    $scope.inviteForm.$setPristine();
                    $scope.inviteForm.$setUntouched();
                    // $scope.inviteForm.$setValidity();


                    if (vm.anotherUserActive) {
                        //close modal
                        $('#myModal').modal('toggle');
                        // $('modal').closeModal();
                    }

                    $scope.$emit('success', 'Invitation sent successfully');

                    getUsers();
                }

            }, function (result) {
                //////console.log(result);
                $("#preloader").css("display", "none");
            });

    }


    function anotherUserToggle() {
        vm.anotherUserActive = !+vm.anotherUserActive;
    }

    angular.element(document).ready(function () {
        $(".pushme").click(function() {
            $(this).text(function(i, v) {
                return v === 'Show less information' ? 'Show more information' : 'Show less information'
            })
        });
    });

}
/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 317 */
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function($) {_userRolesListCtrl.$inject = ["$stateParams", "$state", "$location", "$scope", "AOTCService", "$timeout", "$filter", "$q"];
module.exports = _userRolesListCtrl;

//angular.module('AOTC').controller('UserRolesListCtrl',
//    _userRolesListCtrl);

function _userRolesListCtrl($stateParams, $state, $location, $scope, AOTCService, $timeout, $filter, $q) {

    //Bindable Members
    var $ctrl = this;

    $ctrl.showNewRightModal = function () {
        $('#newRightModal').modal('show');
    };

    $ctrl.allUserRoles = [];
    //========================Starting Logic =======================//

    $scope.uRole = {
        "contracts": false,
        "createContract": false,
        "masterSlave": false,
        "name": "",
        "newsFeed": false,
        "properties": false,
        "publicData": false,
        "surveys": false,
        "taskmanager": false,
        "timeline": false,
        "uploadProperties": false
    };

    getContracts();

    function getContracts() {

        var url = '/admin/getAllUserRoles';
        //var defer = $q.defer();
        $('#preloader').css("display", "block");

        AOTCService.getDataFromServer(url).
        then(function (result) {
            if (result.data.success) {
                $ctrl.allUserRoles = result.data.result;

            }
            $('#preloader').css("display", "none");

        }, function (err) {
            $('#preloader').css("display", "none");

        });

        //return defer.promise;
    }

    $ctrl.updateUserRole = function (_data, _id, _form) {
        var _objData = {
            "roleId": _id,
            "role": _data
        };
        var _url = '/admin/updateUserRole';
        $('#preloader').css("display", "block");

        AOTCService.postDataToServer(_url, _objData)
            .then(function successCallback(response) {
                $('#preloader').css("display", "none");

                ////console.log("result is ", response);
                var serverData = response.data;
                //set token
                if (serverData.success) {
                    //_form.$setPristine();
                    _form.$setPristine();
                    $scope.$emit('success', serverData.message);
                } else {
                    $scope.$emit('danger', serverData.message);
                }


            }, function errorCallback(response) {
                $('#preloader').css("display", "none");
            });

    };

    $ctrl.addNewRole = function (_data, _form) {
        //if(!_form.name) return;
        var _objData = _data;
        var _url = '/admin/addNewRole';
        $('#preloader').css("display", "block");

        AOTCService.postDataToServer(_url, _objData)
            .then(function successCallback(response) {
                $('#preloader').css("display", "none");

                ////console.log("result is ", response);
                var serverData = response.data;
                //set token
                if (serverData.success) {
                    $('#newRightModal').modal('hide');
                    getContracts();
                    $scope.$emit('success', serverData.message);
                } else {
                    $scope.$emit('danger', serverData.message);
                }


            }, function errorCallback(response) {
                $('#preloader').css("display", "none");
            });

    };

}
/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 318 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {

_Inventory.$inject = ["$state","$location", "$scope", "AOTCService"];
module.exports = _Inventory;


function _Inventory($state, $scope, $location, AOTCService) {
    //////console.log("UserRegistration controller");
    var vm = this;
    vm.properties = null
    vm.year ='2012'

    getInventoryIE();


    function getInventoryIE() {
        var url = '/properties/getFileStatusIE';
        var sendData = {id: '9916454'}
        $('#preloader').css("display", "block");

        AOTCService.postDataToServer(url, sendData)
            .then(function successCallback(response) {
                $('#preloader').css("display", "none");
                var serverData = response.data;
                if (serverData.success) {
                    vm.properties = serverData.result
                    console.log( vm.properties)
                    angular.forEach(vm.properties, function(value,key){
                        console.log(value,key)
                    })

                } else {
                    $scope.$emit('danger', serverData.message);
                }

            }, function errorCallback(response) {
                $('#preloader').css("display", "none");
            });
        //return defer.promise;
    }

}

/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 319 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


//var angular = require('angular');

angular.module('AOTC').factory('AOTCService', __webpack_require__(320));
angular.module('AOTC').factory('DataMappingService', __webpack_require__(321));

angular.module('AOTC').config(__webpack_require__(322));
angular.module('AOTC').factory('fileReader', __webpack_require__(323));

angular.module('AOTC').factory('UtilService', __webpack_require__(324));

angular.module('AOTC').factory('AOTCPermissions', __webpack_require__(325));
angular.module('AOTC').factory('AOTCAuth', __webpack_require__(326));










/***/ }),
/* 320 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


_AOTCService.$inject = ["$http", "$rootScope"];
module.exports = _AOTCService;

//angular.module('AOTC')
//   .factory('AOTCService', _AOTCService
//    );
function _AOTCService($http, $rootScope) {

    function getDataFromServer(apiUrl) {
        var token = localStorage.getItem('token');
        var req = $http({
            method: "GET",
            url: apiUrl,
            headers: {
                "Access-Control-Allow-Origin": "*",
                "Content-Type": "application/json",
                "Authorization": token
            }
        });
        return req;
    }

    function putDataToServer(url, userData) {
        var token = localStorage.getItem('token');
        var request = $http({
            method: "PUT",
            url: url,
            data: userData,
            headers: {
                "Access-Control-Allow-Origin": "*",
                "Content-Type": "application/json",
                "Authorization": token
            }
        });
        return request;
    }

    function postDataToServer(url, userData) {
        var token = localStorage.getItem('token');
        var request = $http({
            method: "POST",
            url: url,
            data: userData,
            headers: {
                "Access-Control-Allow-Origin": "*",
                "Content-Type": "application/json",
                "Authorization": token
            }
        });
        return request;
    }


    function uploadFiles(uploadUrl, files) {
        // console.log(jsonForm);
        var token = localStorage.getItem('token');
        var fd = new FormData();

        for (var i = 0; i < files.length; i++) {
            fd.append('file', files[i]);

        }

        return $http.post(uploadUrl, fd, {
            transformRequest: angular.identity,
            headers: {
                'Content-Type': undefined,
                "Authorization": token
            }
        });
    }

    function uploadFilesWithDescription(uploadUrl, files, desc) {
        var token = localStorage.getItem('token');

        var fd = new FormData();

        for (var i = 0; i < files.length; i++) {
            fd.append('file', files[i]);
        }
        fd.append('description', desc);
        return $http.post(uploadUrl, fd, {
            transformRequest: angular.identity,
            headers: {
                'Content-Type': undefined,
                "Athorization": token
            }
        });
    }

    function getNotifications() {
            //$("#preloader").css("display", "block");
            $rootScope.unreadNotifications = 0;
            var url = 'timeline/getNotifications';
            getDataFromServer(url)
                .then(function (response) {
                    try{
                        if (response.data.success) {
                            $rootScope.allNotifications = {external:[], internal:[]};
                             var allData = response.data.result;
                            for(var i=0; i<allData.length;i++){
                                var _item = allData[i];
                                if(_item.notification.properties.readFlag==0) 
                                $rootScope.unreadNotifications++;
                                if((_item.notifications.properties.eventType.indexOf('inter'))!=-1)
                                {$rootScope.allNotifications.internal.push(_item);}
                                else
                                {$rootScope.allNotifications.external.push(_item);}
                            }
                        } else {
                           // $scope.$emit('danger', response.data.message);
                        }
                    }
                    catch(_e){}

                   // $("#preloader").css("display", "none");

                }, function (result) {
                   // $("#preloader").css("display", "none");
                });
        }

    return {

        getDataFromServer: getDataFromServer,
        uploadFilesWithDescription: uploadFilesWithDescription,
        uploadFiles: uploadFiles,
        postDataToServer: postDataToServer,
        putDataToServer: putDataToServer,
        getNotifications: getNotifications

    };

}


/***/ }),
/* 321 */
/***/ (function(module, exports) {


_DataMappingService.$inject = [];
module.exports = _DataMappingService;

//angular.module('AOTC').factory('DataMappingService', _DataMappingService
//    );
function _DataMappingService() {
    var factory = {};

    var mapping = {};
    var dictionary = {};
    var rows;
    var headers = "";
    var index = 0;



    factory.setVariables = function (dictionar, row, header, inde) {
        dictionary = dictionar;
        rows = row;
        headers = header;
        index = inde;
    };

    factory.getDictionary = function () {
        return dictionary;
    }
    factory.getRows = function () {
        return rows;
    }
    factory.getHeaders = function () {
        return headers;
    }
    factory.getIndex = function () {
        return index;
    }

    factory.checkVariables = function () {
        console.log(dictionary)
        console.log(rows)
        console.log(headers)
        console.log(index)
    }

    return factory;
}


/***/ }),
/* 322 */
/***/ (function(module, exports) {

// Intercepting HTTP calls with AngularJS.

_MyHttpInterceptor.$inject = ["$provide", "$httpProvider"];
module.exports = _MyHttpInterceptor;

//angular.module('AOTC')
//    .config(_MyHttpInterceptor
//    );
function _MyHttpInterceptor($provide, $httpProvider) {

    // Intercept http calls.
    //var s= `testfail`;
    $provide.factory('MyHttpInterceptor', ["$q", "$injector", "$log", function ($q, $injector, $log) {
        return {
            // On request success
            request: function (config) {
                // console.log('=============in request====================');
                // console.log(config); // Contains the data about the request before it is sent.
                // var url = config.url;
                // console.log('=========URL', url);
                // var auth_required = url.indexOf(".html");

                // if (auth_required == -1) {
                // // not html url then check if login no token 

                //     if (url == __env.login_url) {
                //         console.log('login authentication url '); // noneed of token
                //     } else {
                //         var token = localStorage.getItem('Token');
                //         console.log('=========token', token);
                //         config.headers.authorization = token;
                //     }

                // }


                // console.log(config); // Contains the data about the request before it is sent.
                // Return the config or wrap it in a promise if blank.
                return config || $q.when(config);
            },

            // On request failure
            requestError: function (rejection) {
                // console.log('=============in requestError====================');

                // console.log(rejection); // Contains the data about the error on the request.

                // Return the promise rejection.
                return $q.reject(rejection);
            },

            // On response success
            response: function (response) {
                // console.log('=============in response====================');

                // console.log(response); // Contains the data from the response.

                // Return the response or promise.
                return response || $q.when(response);
            },

            // On response failture
            responseError: function (rejection) {
                // console.log('=============in responseError====================');

                // console.log(rejection); // Contains the data about the error.

                if (rejection.status == 401) {

                    $injector.get('$state').transitionTo('login');

                }

                // Return the promise rejection.
                return $q.reject(rejection);
            }
        };
    }]);

    // Add the interceptor to the $httpProvider.
    $httpProvider.interceptors.push('MyHttpInterceptor');

}


/***/ }),
/* 323 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

fileReader.$inject = ["$q", "$log"];
module.exports = fileReader;

function fileReader($q, $log) {

    var onLoad = function(reader, deferred, scope) {
        return function() {
            scope.$apply(function() {
                deferred.resolve(reader.result);
            });
        };
    };

    var onError = function(reader, deferred, scope) {
        return function() {
            scope.$apply(function() {
                deferred.reject(reader.result);
            });
        };
    };

    var onProgress = function(reader, scope) {
        return function(event) {
            scope.$broadcast("fileProgress", {
                total: event.total,
                loaded: event.loaded
            });
        };
    };

    var getReader = function(deferred, scope) {
        var reader = new FileReader();
        reader.onload = onLoad(reader, deferred, scope);
        reader.onerror = onError(reader, deferred, scope);
        reader.onprogress = onProgress(reader, scope);
        return reader;
    };

    var readAsDataURL = function(file, scope) {
        var deferred = $q.defer();

        var reader = getReader(deferred, scope);
        reader.readAsDataURL(file);

        return deferred.promise;
    };

    return {
        readAsDataUrl: readAsDataURL
    };
};

//angular.module('AOTC')
//    .factory("fileReader", ["$q", "$log", fileReader]);




/***/ }),
/* 324 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


_UtilService.$inject = ["$http", "$filter"];
module.exports = _UtilService;

function isArray(a) {

    return (!!a) && (a.constructor === Array);
}

function sortFunction(a, b) {
    a[2] = parseInt(a[2]);
    b[2] = parseInt(b[2]);

    if (a[2] === b[2]) {
        return 0;
    } else {
        return (a[2] < b[2]) ? -1 : 1;
    }
}

function sortFunctionForGrid(a, b) {
    a[Object.keys(a)[0]][2] = parseInt(a[Object.keys(a)[0]][2]);
    b[Object.keys(b)[0]][2] = parseInt(b[Object.keys(b)[0]][2]);

    if (a[Object.keys(a)[0]][2] === b[Object.keys(b)[0]][2]) {
        return 0;
    } else {
        return (a[Object.keys(a)[0]][2] < b[Object.keys(b)[0]][2]) ? -1 : 1;
    }
}


//angular.module('AOTC')
//    .factory('UtilService', _UtilService
//    );
function _UtilService($http, $filter) {

    function numberFormatter(keyArr) {
        // element = element.toString();
        var value = keyArr[1];

        // if(keyArr[3] == '4'){
        // }
        console.log(keyArr)

        if (keyArr[1] != 'null' && keyArr[1] != '' && keyArr[1] != null) {
            switch (keyArr[3]) {
                case '1': // Numeric
                    var roundedValue;
                    if (value.indexOf(',') != -1) {
                        //roundedValue = Number(parseFloat(keyArr[1]).toFixed(0)).toLocaleString();
                        roundedValue = value;
                    } else {
                        roundedValue = Number(parseFloat(keyArr[1]).toFixed(0)).toLocaleString();
                        //oundedValue = value;
                    }
                    value = roundedValue;
                    break;
                case '2': // Currency
                    //if (value >= 0) {

                    //     value = '$' + roundedValue;
                    // } else {

                    //     roundedValue = roundedValue.slice(1);

                    if(value.indexOf('-') != -1) {
                        value = '$(' + (value.replace('-','')) + ')';
                    } else {
                        value = '$ ' + (value) + ' ';
                    }
                    //}
                    break;
                case '3': // Percentage
                    value = value + " %";
                    break;
                case '4': // Date as it is
                    var val;
                    if (value.indexOf('/') != -1) {
                        val = new Date(value);
                    }
                    else val = new Date(parseInt(value));
                    if (val) {
                        var finalDate = $filter('date')(val, 'MM/dd/yyyy');
                        //var finalDate = (val.getMonth() + 1) + "/" + val.getDate() + "/" + val.getFullYear();
                        value = finalDate;
                    }

                    break;
                case '5': // String as it is
                    // value = roundedValue;
                    break;
                default:
                    value = value;
            }
        } else {
            value = null;
        }
        return value;
    }

    function numberFormatterValuation(value, roundedValue) {
        // value = value*-1;
        if (value >= 0) {
            value = '$' + roundedValue;
        } else if (value < 0) {

            roundedValue = roundedValue.slice(1);
            value = '$(' + (roundedValue) + ')'
        } else
            value = value
        // console.log(value);
        return value;
    }

    function keyValMaker(object) {
        var newArr = [];

        for (var element in object) {
            if (isArray(object[element]) && object[element][2] !== undefined && object[element][3] !== undefined) {
                newArr.push(object[element]);
            }
        }

        return newArr.sort(sortFunction);
    }

    function keyValMakerForGrid(object) {
        var newArr = [];

        for (var element in object) {
            if (isArray(object[element]) && object[element][2] !== undefined && object[element][3] !== undefined) {
                var jsonFormat = {};
                jsonFormat[element] = object[element];
                newArr.push(jsonFormat);
            }
        }
        var result = newArr.sort(sortFunctionForGrid);
        return result;
    }

    function reducedData(object) {
        var newArr = [];
        for (var element in object[0]) {
            if (isArray(object[element]) && object[element][2] !== undefined && object[element][3] !== undefined) {
                newArr.push(object[element]);
            }
        }

        var finalArray = newArr.sort(sortFunction);
        console.log(finalArray);
        return finalArray;
        // for(var i = 1;i<object.length;i++){
        //
        // }
    }


    function clearFile() {
        angular.forEach(
            angular.element("input[type='file']"),
            function (inputElem) {
                angular.element(inputElem).val(null);
            });
    }


    return {
        clearFile: clearFile,
        numberFormatter: numberFormatter,
        keyValMakerForGrid: keyValMakerForGrid,
        numberFormatterValuation: numberFormatterValuation,
        keyValMaker: keyValMaker,
        reducedData: reducedData,

    };
}

/***/ }),
/* 325 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

_permissions.$inject = ["$rootScope"];
module.exports = _permissions;

//angular.module('AOTC')
//    .factory("AOTCPermissions", ["$q", "$log", _permissions]);

function _permissions($rootScope) {
    var serviceObject;
    try{
        serviceObject = {
            permissionMainObj: {},
            permissionPerPropertyObj: (JSON.parse(localStorage.getItem('propertyDetails')).roles)
        };
    }
    catch(_e){
        serviceObject = {
            permissionMainObj: {},
            permissionPerPropertyObj:  {}
        };
    }




    return {
        setPermissions: _setPermissions,
        // setPermissionPerProperty: _setPermissionPerProperty,
        // hasPermissionForProperty: _hasPermissionForProperty,
        hasPermission: _hasPermission
    };



    function _hasPermission(permissionKey, permissionObjKey) {
        permissionKey = permissionKey.trim();
        //var d = "df";
        return (serviceObject[permissionObjKey][permissionKey]);

        ///////
        // return permissionList.some(function(item) {
        //     if (typeof item.Name !== 'string') { // item.Name is only used because when I called setPermission, I had a Name property
        //         return false;
        //     }
        //     return item.Name.trim() === permission;
        // });
    }

    function _setPermissions(permissions, permissionObjKey) {
        serviceObject[permissionObjKey] = permissions;
        $rootScope.$broadcast('permissionsChangedFor'+permissionObjKey);
    }

    // function _setPermissionPerProperty(permissions) {
    //     permissionPerPropertyObj = permissions;
    //     //$rootScope.$broadcast('permissionsChanged');
    // }

    // function _hasPermissionForProperty(permissionKey) {
    //     permissionKey = permissionKey.trim();
    //     return (permissionPerPropertyObj[permissionKey]);

    // }
}

/***/ }),
/* 326 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

_auth.$inject = ["$rootScope", "$q", "$http", "$timeout", "AOTCService"];
module.exports = _auth;

//angular.module('AOTC')
//    .factory("AOTCAuth", ["$q", "$log", _auth]);

function _auth($rootScope, $q, $http, $timeout, AOTCService) {
    var permissionObj;

    return {
        setToken: _setToken,
        removeToken: _removeToken
    };


    function _setToken(token) {
        if(!token) return;
        var _deferred = $q.defer(); {
            //save token in local
            // serverData.token = 123;
            //$rootScope.isLoggedIn = true;
            //var token = serverData.result.token;
            localStorage.setItem('token', token);
            $http.defaults.headers.common.Authorization = token;
            $http.defaults.headers.common['If-Modified-Since'] = 'Mon, 26 Jul 1997 05:00:00 GMT';
            // extra
            $http.defaults.headers.common['Cache-Control'] = 'no-cache';
            $http.defaults.headers.common['Pragma'] = 'no-cache';
        }
        $timeout(function () {
            try{
                AOTCService.getNotifications();
            }
            catch(_e){}
            _deferred.resolve();
        });
        return _deferred.promise;
    }

    function _removeToken() {
        var _deferred = $q.defer(); {
            $http.defaults.headers.common.Authorization = '';
            localStorage.removeItem('token');
        }
        $timeout(function () {
            _deferred.resolve();
        });
        return _deferred.promise;
    }


}

/***/ }),
/* 327 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var angular = __webpack_require__(102);
/////
angular.module('AOTC').constant('User_Config', (__webpack_require__(329))());

/***/ }),
/* 328 */,
/* 329 */
/***/ (function(module, exports) {

//User_Config.$inject = [];
module.exports = User_Config;

//var myApp = angular.module("AOTC")

//.constant('User_Config', (User_Config)());

function User_Config() {
    // Define your variable
    var PMF_Role = 'Asset Manager';
    var AJ_Role = 'Assessing Authority';
    var RESIDENTIAL_USER = 'Residential User';
    var NO_IMAGE_AVAILABLE = 'assets/img/noImageAvailable.jpg';
    var AVAILABLE_DATE_OPTIONS = {
        formatYear: 'yy',
        startingDay: 1,
        minDate: new Date(1969, 1, 1),
        maxDate: new Date(2030, 1, 1)
    };
    var DROPDOWN_OPTIONS_ANSWER_FIELD_TYPE = [
        { type: 'text' },
        { type: 'number' }
    ];

    var DATE_FORMAT = 'MM-dd-yyyy';

    // Use the variable in your constants
    return {
        DROPDOWN_OPTIONS_ANSWER_FIELD_TYPE: DROPDOWN_OPTIONS_ANSWER_FIELD_TYPE,
        DATE_FORMAT: DATE_FORMAT,
        AVAILABLE_DATE_OPTIONS: AVAILABLE_DATE_OPTIONS,
        PMF_USER: PMF_Role,
        AJ_USER: AJ_Role,
        RESIDENTIAL_USER: RESIDENTIAL_USER,
        MULTI_PART: 'multipart',
        MULTI_ACCOUNT: 'multiaccount',
        NO_DATA: 'No Data Found',
        Admin: 'Admin',
        NO_IMAGE_AVAILABLE: NO_IMAGE_AVAILABLE
    }
};

/***/ }),
/* 330 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


//var angular = require('angular');

angular.module('AOTC').controller('ViewReportsCtrl', __webpack_require__(331));
angular.module('AOTC').service('ReportService', __webpack_require__(103).ReportService);
angular.module('AOTC').factory('Excel', __webpack_require__(103).Excel);

/***/ }),
/* 331 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {

_ViewReportsCtrl.$inject = ["SurveylistService", "$scope", "Excel", "$timeout", "ReportService", "$stateParams"];
module.exports = _ViewReportsCtrl;
//angular.module('AOTC').controller('ViewReportsCtrl', _ViewReportsCtrl);

agGrid.initialiseAgGridWithAngular1(angular);

function _ViewReportsCtrl(SurveylistService, $scope, Excel, $timeout, ReportService, $stateParams) {

    var vm = this;
    $scope.data = null;
    $scope.switch = false;
    $scope.surveyName = 'Download';

    $scope.switchTable = function () {
        if ($scope.switch) {
            $scope.switch = false;
        }
        else {
            $scope.switch = true;
        }
    }

    $scope.exportToExcel = function () { // ex: '#my-table'
        var exportHref = Excel.tableToExcel('#myGridContracts', 'WireWorkbenchDataExport');
        $timeout(function () {
            var a = document.createElement('a');
            a.href = exportHref;
            a.download = $scope.surveyName + ".xls";
            document.body.appendChild(a);
            a.click();
            a.remove();

        }, 100); // trigger download
    }

    $scope.initTest = function () {

        $scope.surveyName = SurveylistService.name;
        $("#preloader").css("display", "block");
        ReportService.getSurveyReports($stateParams.id)
            .then(function (result) {

                $("#preloader").css("display", "none");

                if (!result.data.success) {
                    $scope.$emit('danger', result.data.message);
                } else {
                    $scope.data = result.data;
                    initGrid(angular.copy($scope.data.result));
                    //console.log($scope.data)
                }

            });

    };


    //New code for ag grid
    var rowData = [];
    var columnDefs = [];
    var gridOptions = {
        columnDefs: [],
        rowData: [],
        headerHeight: 25,
        rowHeight: 40,
        suppressCellSelection: true,
        enableColResize: true,
        getRowHeight: function (params) {
            // assuming 50 characters per line, working how how many lines we need
            return 21 * (Math.floor(params.data.question.length / 17) + 1);
        }
    };
    function initGrid(_data) {
        columnDefs = insertDefaultColumns(columnDefs);
        columnDefs = insertColumnsForJurs(_data, columnDefs);
        rowData = createDataForQuestion(_data);

        gridOptions.columnDefs = columnDefs;
        gridOptions.rowData = rowData;

        //rowData = createDataForAnswers(_data, rowData);
        $timeout(function () {
            var gridDiv = document.querySelector('#myGridContracts');
            new agGrid.Grid(gridDiv, gridOptions);
            //gridOptions.api.sizeColumnsToFit()
        });

    };


    function insertDefaultColumns(_columnDefs) {
        _columnDefs = [
            { headerName: "Question", field: "question", width: 250, pinned: 'left', cellStyle: { color: 'black', 'font-weight': 'bold', 'white-space': 'normal','border-right': '1px solid #d6d6d6' } },
            //{ headerName: "Actions", field: "abc", width: 260, cellRenderer: renderButtons }, //, cellClass: 'padding-normal'        
            { headerName: "Options", field: "options", width: 150, pinned: 'left', cellRenderer: renderOptions, cellStyle: { 'border-right': '1px solid #d6d6d6' } }];
        return _columnDefs;
    };
    function insertColumnsForJurs(_data, _columnDefs) {
        for (var i = 0; i < _data.jurisdictions.length; i++) {
            var _juridicrionKey = i + 'jur';
            var _temp = {
                headerName: _data.jurisdictions[i], field: _juridicrionKey, cellRenderer: renderAnswers};
            _columnDefs.push(_temp);
        }
        return _columnDefs;
    };

    function createDataForQuestion(_data) {
        var _dataArray = [];
        //var jurisdictionObj = createJursObj(_data.jurisdictions);
        for (var i = 0; i < _data.questions.length; i++) {
            var _temp = {
                question: _data.questions[i].question,
                options: _data.questions[i].options
            };
            for (var j = 0; j < _data.questions[i].answers.length; j++) {
                _temp[j + 'jur'] = _data.questions[i].answers[j];
            }
            _dataArray.push(_temp);
        }
        return _dataArray;

    };

    function renderOptions(params) {
        try {
            var _TemplateContainer = document.createElement('div');
            var _col  = params.column.colId;
            var _some = "";
            for(var i=0; i<params.data.options.length;  i++){
                _some += '<span class="fa fa-square fa-1x font-set" > &nbsp;<span style="font-family: Open Sans, Helvetica Neue,Arial"> ' + (params.data.options[i] || "")+ '</span>'+
                ' </span><br>';

            }

        _TemplateContainer.innerHTML = _some;
            return _TemplateContainer;

        }
        catch (_e) { return ""; }

    };


    $scope.exportReport = function(){

       // $scope.exportToExcel = function () { // ex: '#my-table'
        var exportHref = Excel.tableToExcel('#tableToExport1', 'WireWorkbenchDataExport');
            $timeout(function () {
                var a = document.createElement('a');
                a.href = exportHref;
                a.download = "Survey Report" + ".xls";
                document.body.appendChild(a);
                a.click();
                a.remove();

            }, 100); // trigger download
       // }
    };
    function formattingFunction(params) {
        //console.log(params)
        if ((params.column.getColId().indexOf('jur') != -1 || params.column.getColId() == 'options')  && params.value) {
            var _temppp = '';
            for (var i = 0; i < params.value.length; i++)
            {
                _temppp += params.value[i] + '\n'
            }
            return _temppp;
        } else {
            return params.value;
        }
    }

    function renderAnswers(params) {
        try {
            var _TemplateContainer = document.createElement('div');
            var _col = params.column.colId;
            var _some = '';
            for (var i = 0; i < params.data[_col].length; i++) {
                _some += '<span ng-show="val" class="fa fa-chevron-right"></span>&nbsp;' + (params.data[_col][i] || "") + '<br>';
                '  &nbsp;<br>' +
                    ' </span>';

            }
            _TemplateContainer.innerHTML = _some;
            return _TemplateContainer;

        }
        catch (_e) { return ""; }

    }

    // function createDataForAnswers(_data, _rowDataArray) {
    //     var _dataArray = [];
    //     var jurisdictionObj = createJursObj(_data.jurisdictions);

    //     for (var i = 0; i < _data.questions; i++) {

    //         for (var j = 0; j < _data.questions[i].question; j++) {
    //             _dataArray = _rowDataArray.map(function (_obj) {
    //                 _obj

    //             });
    //         }
    //         _dataArray.push(_temp);
    //     };



    //     return _dataArray;

    // };

    // function createJursObj(_jursdata) {
    //     var _tempjursobj = {};
    //     for (var k = 0; k < _jursdata.length; k++) {
    //         _tempjursobj[k+'jur'] = '';
    //     };
    //     return _tempjursobj;

    // };

    // function renderButtons(params) {
    //     try {
    //         var _TemplateContainer = document.createElement('div');
    //         var _editBtn = '<button class="btn btn-info edit-btn-grid btn-sm" style="margin-right: 10px; background: rgba(122, 218, 16, 0.82)"' +
    //             ' value="' + params.data.id + '"' +
    //             ' border: none;    padding: 4px;" data-toggle="tooltip" data-placement="right" title="Edit details">' +
    //             '  <i class="fa  fa-pencil fa-lg"></i> </button>';
    //         _TemplateContainer.innerHTML = _btns;
    //         return _TemplateContainer;

    //     }
    //     catch (_e) { return ""; }

    // };






};

/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 332 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


//var angular = require('angular');

////components
//contract-editor
angular.module('AOTC').controller('timelineGraphicalCtrl', __webpack_require__(333));

/***/ }),
/* 333 */
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function($) {_timelineGraphicalCtrl.$inject = ["$stateParams", "$state", "$location", "$scope", "AOTCService", "$timeout", "$filter", "$q", "$rootScope"];
module.exports = _timelineGraphicalCtrl;

//angular.module('AOTC').controller('timelineGraphicalCtrl',
//    _timelineGraphicalCtrl);

function _timelineGraphicalCtrl($stateParams, $state, $location, $scope, AOTCService, $timeout, $filter, $q, $rootScope) {

    //Bindable Members
    var $ctrl = this;
    $scope.viewFormat = 'all-properties';
    $ctrl.jurisdictionTimeline = [];
    $ctrl.selectedEvent = {};


    $ctrl.currentYear = '2018';
    $ctrl.yearChange = function (_year) {
        try {
            $("#preloader").css("display", "block");
            _year = parseInt(_year);
            $ctrl.myConfig.options.year.text = '' + _year + '';
            loadChart();
        } catch (_e) {}
    };
    $ctrl.previousYear = function () {
        try {
            $("#preloader").css("display", "block");
            var _year = parseInt($ctrl.currentYear) - 1;
            $ctrl.currentYear = _year;
            $ctrl.myConfig.options.year.text = '' + _year + '';
            loadChart();
        } catch (_e) {}
    };
    $ctrl.nextYear = function () {
        try {
            $("#preloader").css("display", "block");
            var _year = parseInt($ctrl.currentYear) + 1;
            $ctrl.currentYear = _year;
            $ctrl.myConfig.options.year.text = '' + _year + '';
            loadChart();
        } catch (_e) {}
    };
    //dropdown values
    $ctrl.selectedJurisdiction = '';
    $ctrl.selectedByproperty = '';
    //modal functions
    $ctrl.showEventModal = function () {
        $('#mySaveModal').modal("show");
    };
    $ctrl.allInternalEvents = [];
    $ctrl.showSelectModal = function (_singleEvent) {
        $('#mySelectModal').modal('show');
        try {
            $ctrl.selectedExternalId = _singleEvent.id;
            if ($ctrl.allInternalEvents.length == 0) {
                $("#preloader").css("display", "block");
                var url = 'timeline/getInternalEvent';
                AOTCService.getDataFromServer(url)
                    .then(function (response) {
                        if (response.data.success) {
                            $ctrl.allInternalEvents = response.data.result;
                        } else {
                            $scope.$emit('danger', response.data.message);
                        }
                        $("#preloader").css("display", "none");

                    }, function (result) {
                        $("#preloader").css("display", "none");
                    });
            }
        } catch (_e) {}

    };
    $ctrl.$selectedInternalEvents = [];
    $ctrl.addToSelected = function (_id, _val) {
        if (_val) {
            if ($ctrl.$selectedInternalEvents.indexOf(_id) == -1) $ctrl.$selectedInternalEvents.push(_id);
        } else {
            var _i = $ctrl.$selectedInternalEvents.indexOf(_id);
            $ctrl.$selectedInternalEvents.splice(_i, 1);
        }
    };
    $ctrl.$selectedPropsForInternalEvents = [];
    $ctrl.addToSelectedProperties = function (_id, _val) {
        if (_val) {
            if ($ctrl.$selectedPropsForInternalEvents.indexOf(_id) == -1) $ctrl.$selectedPropsForInternalEvents.push(_id);
        } else {
            var _i = $ctrl.$selectedPropsForInternalEvents.indexOf(_id);
            $ctrl.$selectedPropsForInternalEvents.splice(_i, 1);
        }
    };
    //linkInternalEvent
    $ctrl.saveInternalEvents = function () {
        if (!$ctrl.selectedExternalId || !$ctrl.$selectedInternalEvents.length || !$ctrl.$selectedPropsForInternalEvents.length) {
            return;
        }
        $("#preloader").css("display", "block");
        var url = 'timeline/linkInternalEvent';
        var data = {
            "externalId": $ctrl.selectedExternalId,
            "internalIds": $ctrl.$selectedInternalEvents,
            "propertyIds": $ctrl.$selectedPropsForInternalEvents
        };
        AOTCService.postDataToServer(url, data)
            .then(function (response) {
                if (response.data.success) {
                    $scope.$emit('success', response.data.message);
                    $('#mySelectModal').modal('hide');
                } else {
                    $scope.$emit('danger', response.data.message);
                }
                $("#preloader").css("display", "none");

            }, function (result) {
                $("#preloader").css("display", "none");
            });
    };

    $scope.formats = ['dd-MMMM-yyyy', 'yyyy/MM/dd', 'dd.MM.yyyy', 'shortDate'];
    $scope.format = $scope.formats[0];
    $scope.altInputFormats = ['M!/d!/yyyy'];

    $scope.popup1 = {
        opened: false
    };
    $scope.open1 = function () {
        $scope.popup1.opened = true;
    };

    function processDateAsString(_tobj) {
        try{
            _tobj.deadline = $filter('date')(_tobj.deadline, 'M/d/yyyy'); 
            return _tobj;
        }
        catch(_e){ return _tobj;}
    }
    //createNewInternalEvent
    $ctrl.createNewInternalEvent = function (_data) {
        $("#preloader").css("display", "block");
        var url = 'timeline/createNewInternalEvent';
        var data = {
            "internalEvent": processDateAsString(_data)
        };
        AOTCService.postDataToServer(url, data)
            .then(function (response) {
                if (response.data.success) {
                    $scope.$emit('success', response.data.message);
                    $('#mySaveModal').modal('hide');
                    $("#preloader").css("display", "block");
                    var url = 'timeline/getInternalEvent';
                    AOTCService.getDataFromServer(url)
                        .then(function (response) {
                            if (response.data.success) {
                                $ctrl.allInternalEvents = response.data.result;
                            } else {
                                $scope.$emit('danger', response.data.message);
                            }
                            $("#preloader").css("display", "none");

                        }, function (result) {
                            $("#preloader").css("display", "none");
                        });
                } else {
                    $scope.$emit('danger', response.data.message);
                    $("#preloader").css("display", "none");
                }
                //$("#preloader").css("display", "none");


            }, function (result) {
                $("#preloader").css("display", "none");
            });
    };
    //getAllPropertiesTimelineStatus
    var getAllPropertiesTimelineStatus = function () {
        $("#preloader").css("display", "block");
        var url = 'timeline/getAllPropertiesTimelineStatus';
        var data = {};
        AOTCService.postDataToServer(url, data)
            .then(function (response) {
                if (response.data.success) {
                    $ctrl.allPropertiesTimelineStatus = response.data.result;
                    setDefaults();
                } else {
                    $scope.$emit('danger', response.data.message);
                }
                $("#preloader").css("display", "none");

            }, function (result) {
                $("#preloader").css("display", "none");
            });
    }();
    ////getJurisdictions
    //var getJurisdictions = function () {
    //    $("#preloader").css("display", "block");
    //    var url = 'timeline/getJurisdictions';
    //    AOTCService.getDataFromServer(url)
    //        .then(function (response) {
    //            if (response.data.success) {
    //                $ctrl.allJurisdictions = response.data.result;
    //            } else {
    //                $scope.$emit('danger', response.data.message);
    //            }
    //            $("#preloader").css("display", "none");

    //        }, function (result) {
    //            $("#preloader").css("display", "none");
    //        });
    //}();

    //on tab change
    $ctrl.tabChangeFunc = function (_tabname) {
        try {
            $scope.viewFormat = _tabname;
            if (_tabname == 'by-jurisdiction') {
                if (!$ctrl.jurisdictionTimeline.length) {
                    var _selectedJurisdiction = $ctrl.selectedJurisdiction || 'Maryland';
                    getTimelineLineData(_selectedJurisdiction).then(function () {
                        findAllPropertiesinJurisdiction();
                        loadChart();
                    });
                } else {
                    $rootScope.$on('$includeContentLoaded', function (_event, _url) {
                        if (_url.indexOf('jurisdiction') != -1) loadChart();
                    });
                    $("#preloader").css("display", "block");
                    loadChart();
                }
                //findAllPropertiesinJurisdiction();

            } else if (_tabname == 'by-property') {
                if (!$ctrl.jurisdictionTimeline.length) {
                    var _selectedJurisdiction = findJurisdictionAgainstProperty($ctrl.selectedByproperty);
                    getTimelineLineData(_selectedJurisdiction).then(function () {
                        //findAllPropertiesinJurisdiction();
                        loadChart();
                        var _tempProp = findPropertyInJurisdcitionArray($ctrl.selectedByproperty);
                        //$ctrl.addToSelectedProperties();
                        _tempProp['cbox'] = true;
                        $ctrl.allPropertiesinJurisdiction = [_tempProp];
                    });
                } else {
                    $("#preloader").css("display", "block");
                    $rootScope.$on('$includeContentLoaded', function (_event, _url) {
                        if (_url.indexOf('by-property') != -1) loadChart();
                    });
                    var _tempProp = findPropertyInJurisdcitionArray($ctrl.selectedByproperty);
                    $ctrl.allPropertiesinJurisdiction = [_tempProp];
                }
            }


            //if ($ctrl.allPropertiesinJurisdiction.length == 0) 

        } catch (_e) {}
    };


    //to show info of the selected property
    //$ctrl.selectedPropertiesFromDropdown = [];
    //Proprties Dropdown
    $ctrl.propertiesFromDropdown = function (_selection) {

        var _selectedJurisdiction = findJurisdictionAgainstProperty($ctrl.selectedByproperty);
        getTimelineLineData(_selectedJurisdiction).then(function () {
            loadChart();
        });
        var _tempProp = findPropertyInJurisdcitionArray($ctrl.selectedByproperty);
        _tempProp['cbox'] = true;
        //$ctrl.addToSelectedProperties();
        $ctrl.allPropertiesinJurisdiction = [_tempProp];
    };

    //called from Jurisdiction Dropdown
    $ctrl.getJurisdictionTimeline = function (_selection) {
        getTimelineLineData(_selection).then(function () {
            findAllPropertiesinJurisdiction();
            loadChart();
        });
    };


    function findPropertyInJurisdcitionArray(_name) {
        var _result;
        angular.forEach($ctrl.allPropertiesTimelineStatus, function (_item, _index) {
            if (_item.propertyName == _name) {
                _result = _item;
            }
        });
        return _result;
    };

    function findJurisdictionAgainstProperty(_name) {
        var _result;
        angular.forEach($ctrl.allPropertiesTimelineStatus, function (_item, _index) {
            if (_item.propertyName == _name) {
                _result = _item.jurisdiction;
            }
        });
        return _result;
    };

    function getTimelineLineData(_selection) {
        $("#preloader").css("display", "block");
        var url = 'timeline/getJurisdictionTimeline';
        //to make it a promise
        var deferred = $q.defer();
        var data = {
            "jurisdictionName": _selection
        };
        AOTCService.postDataToServer(url, data)
            .then(function (response) {
                if (response.data.success) {
                    $ctrl.jurisdictionTimeline = response.data.result;
                    addevents($ctrl.jurisdictionTimeline);

                    //loadChart();

                    //Get relevant props and show in list
                    //findAllPropertiesinJurisdiction();
                    deferred.resolve();

                } else {
                    $scope.$emit('danger', response.data.message);
                    deferred.reject();
                }
                //$("#preloader").css("display", "none");

            }, function (result) {
                $("#preloader").css("display", "none");
            });
        return deferred.promise;
    }
    //$ctrl.allPropertyNames = [];
    $ctrl.allJurisdictionNames = [];

    function setDefaults() {
        //first set default values for jurisdiction dropdown
        var _allprops = [];
        angular.forEach($ctrl.allPropertiesTimelineStatus, function (_item, _index) {
            if (_index == 0) {
                $ctrl.selectedJurisdiction = _item.jurisdiction;
                $ctrl.selectedByproperty = _item.propertyName;
                if (_allprops.indexOf(_item.jurisdiction) == -1) {
                    _allprops.push(_item.jurisdiction);
                }
            }
        });
        $ctrl.allJurisdictionNames = _allprops;

        ////$ctrl.selectedJurisdiction;

        ////get all properties relevant to the selected jurisdiction and show in the list
        //$ctrl.selectedJurisdiction = '';

        ////then get all properties
        //$ctrl.allPropertiesTimelineStatus;

        ////then set default values for property dropdown
        //$ctrl.selectedByproperty = '';


        ////get the relevant property object and show its value in the list


    }
    $ctrl.selectedEvents = [];

    function findEvent(p) {
        // try {
        $ctrl.selectedEvents = [];
        var _tempArray = [];
        var _nodeCodes = p['data-info2'];
        var _nodeids = p['data-info1'];
        for (var i = 0; i < $ctrl.jurisdictionTimeline.length; i++) {
            var _item = $ctrl.jurisdictionTimeline[i].event._id;
            if (_nodeids.indexOf(_item) != _ - 1) {
                //$timeout(function () {

                var _obje = addExternalInternalEventsToSelected($ctrl.selectedEvents, $ctrl.jurisdictionTimeline, i, _nodeCodes);
                _tempArray.push(_obje);

                // $ctrl.selectedEvent = $ctrl.jurisdictionTimeline[i].event.properties;

                // if ($scope.viewFormat == 'by-property') {
                //     var _ieventsArray = [];
                //     angular.forEach($ctrl.jurisdictionTimeline[i].internalEvents, function (__item) {
                //         if (__item.propertyNames.indexOf($ctrl.selectedByproperty) != -1) {
                //             _ieventsArray.push(__item);
                //         }
                //     });
                //     $ctrl.selectedEvent['internalEvents'] = _ieventsArray;
                // } else {
                //     $ctrl.selectedEvent['internalEvents'] = $ctrl.jurisdictionTimeline[i].internalEvents;
                // }
                // $ctrl.selectedExternalId = $ctrl.jurisdictionTimeline[i].event._id;

                //});
                //break;
            }
        }
        $timeout(function () {
            $ctrl.selectedEvents = _tempArray;
            //$ctrl.selectedExternalId = $ctrl.jurisdictionTimeline[foundAtIndex].event._id;
        });
        // } catch (_e) {}
    }

    function addExternalInternalEventsToSelected(_selectedEventsArray, _jurisdictionTimelineArray, foundAtIndex, _nodeCodes) {
        //_selectedEventsArray = [];
        var _temp, __id;
        if ($scope.viewFormat == 'by-property') {
            var _ieventsArray = [];
            angular.forEach(_jurisdictionTimelineArray[foundAtIndex].internalEvents, function (__item) {
                if (__item.propertyNames.indexOf($ctrl.selectedByproperty) != -1) {
                    _ieventsArray.push(__item);
                }
            });
            _temp = _jurisdictionTimelineArray[foundAtIndex].event.properties;
            __id = _jurisdictionTimelineArray[foundAtIndex].event._id;
            angular.extend(_temp, {
                internalEvents: _ieventsArray,
                nodeCodes: _nodeCodes,
                id: __id
            });
            //_selectedEventsArray.push(_temp);

        } else {
            _temp = _jurisdictionTimelineArray[foundAtIndex].event.properties;
            __id = _jurisdictionTimelineArray[foundAtIndex].event._id;

            angular.extend(_temp, {
                internalEvents: _jurisdictionTimelineArray[foundAtIndex].internalEvents,
                nodeCodes: _nodeCodes,
                id: __id
            });
            //_selectedEventsArray.push(_temp);
        }


        return _temp;
    }

    function addevents(_eventData) {
        // try {
        $ctrl.myConfig.options.values = [];
        $ctrl.myConfig.options.day.items = {};
        for (var i = 0; i < _eventData.length; i++) {
            var _item = _eventData[i];
            var _sdate = $filter('date')(new Date(_item.event.properties.deadlineStart), 'yyyy-MM-dd');
            var _edate = $filter('date')(new Date(_item.event.properties.deadlineEnd), 'yyyy-MM-dd');


            $ctrl.myConfig.options.day.items['d-' + _sdate] = {
                backgroundColor: 'green',
                color: 'white'
            };
            $ctrl.myConfig.options.day.items['d-' + _edate] = {
                backgroundColor: 'orange',
                color: 'white'
            };

            var _dupeDatesObj = findDuplicateDateInValues($ctrl.myConfig.options.values, _sdate, _edate);
            if (_dupeDatesObj.s.length) {
                insertOtherEvent(_sdate,
                    '<br><br>Event Code: ' + String.fromCharCode(65 + (i % 25)) + '<br>Deadline Start: ' + _sdate + '<br>Event Name: ' + _item.event.properties.eventName,
                    _item.event._id,
                    String.fromCharCode(65 + (i % 25)),
                    _dupeDatesObj.s,
                    $ctrl.myConfig.options.day.items,
                    $ctrl.myConfig.options.values);
            } else {
                $ctrl.myConfig.options.values.push([_sdate, 1, 'Event Code: ' + String.fromCharCode(65 + (i % 25)) + '<br>Deadline Start: ' + _sdate + '<br>Event Name: ' + _item.event.properties.eventName, [_item.event._id],
                    [String.fromCharCode(65 + (i % 25))]
                ]);
            }
            if (_dupeDatesObj.e.length) {
                //
                insertOtherEvent(_edate,
                    '<br><br>Event Code: ' + String.fromCharCode(65 + (i % 25)) + '<br>Deadline End: ' + _sdate + '<br>Event Name: ' + _item.event.properties.eventName,
                    _item.event._id,
                    String.fromCharCode(65 + (i % 25)),
                    _dupeDatesObj.e,
                    $ctrl.myConfig.options.day.items,
                    $ctrl.myConfig.options.values);
            } else {
                $ctrl.myConfig.options.values.push([_edate, 1, 'Event Code: ' + String.fromCharCode(65 + (i % 25)) + '<br>Deadline End: ' + _sdate + '<br>Event Name: ' + _item.event.properties.eventName, [_item.event._id],
                    [String.fromCharCode(65 + (i % 25))]
                ]);
            }
        }

        //}
        //catch(_e){}


    }

    function insertOtherEvent(_date, _eventDetail, _eventId, _charCode, _dupesArray, _configObj, _valArray) {
        for (var o = 0; o < _dupesArray.length; o++) {
            var _index = _dupesArray[o];
            var _existingEventString = _valArray[_index][2];
            var _existingIds = _valArray[_index][3];
            var _existingCodes = _valArray[_index][4];

            _existingEventString += _eventDetail;
            _existingIds.push(_eventId);
            _existingCodes.push(_charCode);
            _valArray[_index][2] = _existingEventString;
            _valArray[_index][3] = _existingIds;
            _valArray[_index][4] = _existingCodes;

        }
        _configObj['d-' + _date] = {
            backgroundColor: 'purple',
            color: 'white',
            fontSize: 10
        };
    }

    function findDuplicateDateInValues(_valueArray, _startdateToCompare, _enddateToCompare) {
        var _duplicateIndexesForstart = [];
        var _duplicateIndexesForEnd = [];
        for (var i = 0; i < _valueArray.length; i++) {
            var _arrayItem = _valueArray[i];
            if (_arrayItem[0] == _startdateToCompare) {
                _duplicateIndexesForstart.push(i);
            } else if (_arrayItem[0] == _enddateToCompare) {
                _duplicateIndexesForEnd.push(i);
            }
        }
        return {
            s: _duplicateIndexesForstart,
            e: _duplicateIndexesForEnd
        };
    }

    //getting properties in selected jurisdiction 
    function findAllPropertiesinJurisdiction() {
        try {
            var _temp = [];
            angular.forEach($ctrl.allPropertiesTimelineStatus, function (_item) {
                if (_item.jurisdiction == $ctrl.selectedJurisdiction) {
                    _temp.push(_item);
                }
            });
            $ctrl.allPropertiesinJurisdiction = _temp;
        } catch (_e) {}

    };

    function loadChart() {
        $timeout(function () {

            zingchart.exec('myChart', 'destroy');
            zingchart.complete = function (p) {
                $("#preloader").css("display", "none");
            };
            zingchart.loadModules('calendar', function () {
                zingchart.render({
                    id: 'myChart',
                    data: $ctrl.myConfig,
                    height: 250
                });
            });
            //addevents();
            zingchart.node_click = function (p) {
                findEvent(p);
            };
        }, 0);
    }
    $ctrl.myConfig = {
        type: 'calendar',
        options: {
            year: {
                text: '2018',
                visible: false
            },
            startMonth: 1,
            endMonth: 12,
            palette: ['none', 'red'],
            month: {
                item: {
                    fontColor: 'gray',
                    fontSize: 9
                }
            },
            day: { // Configure the styling by day.
                items: { // Use this object to style the cells by individual calendar day.
                    //'d-2017-02-14': {
                    //    backgroundColor: 'purple',
                    //},
                },
                inactive: { // Use this object to style the cells of all inactive days.
                    backgroundColor: '#fafafa'
                }
            },
            weekday: {
                values: ['', 'M', '', 'W', '', 'F', ''],
                item: {
                    fontColor: 'gray',
                    fontSize: 9
                }
            },
            values: []
        },
        labels: [],

        tooltip: { //Lefthand Label (bottom portion)
            text: '%data-info0',
        },

        plotarea: {
            marginTop: '8%',
            marginBottom: '10%',
            marginLeft: '-2%',
            marginRight: '0%'
        },
        plot: {
            valueBox: [{ // Use this object to configure the value boxes.
                    fontColor: 'gray',
                    fontFamily: 'Courier New',
                    fontSize: 8,
                    fontWeight: 'normal',
                    "rules": [{
                        "rule": "%data-info1 != null",
                        "visible": "false"
                    }],
                    text: "%data-monthday"
                },
                { // Use this object to configure the value boxes.
                    fontColor: 'white',
                    fontFamily: 'Courier New',
                    fontSize: 12,
                    fontWeight: 'normal',
                    "rules": [{
                        "rule": "%data-info1 == null",
                        "visible": "false"
                    }],
                    text: "%data-info2"
                }
            ]

        },
    };


}
/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))

/***/ }),
/* 334 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


//var angular = require('angular');

angular.module('AOTC').directive('hasPermission', __webpack_require__(335));
angular.module('AOTC').directive('permissionPerProperty', __webpack_require__(336));










/***/ }),
/* 335 */
/***/ (function(module, exports) {

//angular.module('AOTC').directive('hasPermission', _hasPermission);
_hasPermission.$inject = ['AOTCPermissions'];
module.exports = _hasPermission;


function _hasPermission(AOTCPermissions) {
    return {
        link: function (scope, element, attrs) {
            // if (!_.isString(attrs.hasPermission)) {
            //     throw 'hasPermission value must be a string'
            // }
            var _key = attrs.hasPermission.trim();
            var _obj = 'permissionMainObj';
            try {
                _obj = attrs.permissionObject.trim() || 'permissionMainObj';
            } catch (_e) {_obj = 'permissionMainObj';}

            // var notPermissionFlag = value[0] === '!';
            // if (notPermissionFlag) {
            //     value = value.slice(1).trim();
            // }

            function toggleVisibilityBasedOnPermission() {
                //console.log(value);
                try{

                    var hasPermission;
                    if(_obj=='userObj'){
                        var _permissionStatus =  AOTCPermissions.hasPermission(_key, _obj).trim();
                        hasPermission = (_permissionStatus =='Admin') ? true: false;
                    }
                    else{
                        hasPermission = AOTCPermissions.hasPermission(_key, _obj);
                    }
                    
                    if (hasPermission) {
                        //element[0].setAttribute("disabled", null);
                        // element[0].style.display = 'block';
                    } else {
                        element[0].style.display = 'none';
                    }            
                }
                catch(_e){}

            }

            toggleVisibilityBasedOnPermission();
            scope.$on('permissionsChanged', toggleVisibilityBasedOnPermission);
        }
    };
}

/***/ }),
/* 336 */
/***/ (function(module, exports) {

//angular.module('AOTC').directive('permissionPerProperty', _permissionPerProperty);
_permissionPerProperty.$inject = ['AOTCPermissions'];
module.exports = _permissionPerProperty;


function _permissionPerProperty(AOTCPermissions) {
    return {
        link: function (scope, element, attrs) {
            // if (!_.isString(attrs.hasPermission)) {
            //     throw 'hasPermission value must be a string'
            // }
            var _key = attrs.permissionPerProperty.trim();
            var behaviourType = attrs.behaviourType.trim();
            
            /// var notPermissionFlag = value[0] === '!';
            // if (notPermissionFlag) {
            //     value = value.slice(1).trim();
            // }

            function toggleVisibilityBasedOnPermission() {
                try{
                    var hasPermission = AOTCPermissions.hasPermission(_key, 'permissionPerPropertyObj');
                    if (hasPermission) {
                        //element[0].style.display = 'none';
                        //element[0].setAttribute("disabled", null);
                    } else {
                        if(behaviourType=='hide') element[0].style.display = 'none';
                        if(behaviourType=='disable'){
                            element[0].setAttribute("disabled", true);
                        } 
                        
                    }
                }
                catch(_e){}
                //console.log(value);

            }

            toggleVisibilityBasedOnPermission();
            //scope.$on('permissionsChanged', toggleVisibilityBasedOnPermission);
        }
    };
}

/***/ })
],[138]);
//# sourceMappingURL=app.bundle.js.map